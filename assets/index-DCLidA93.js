const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./blosc-eOvwLB0b.js","./chunk-INHXZS53-D3tQiqtZ.js","./lz4-DMxY7r4t.js","./zstd-qZ8jC7Re.js"])))=>i.map(i=>d[i]);
var Zd=Object.defineProperty;var Oc=a=>{throw TypeError(a)};var $d=(a,e,t)=>e in a?Zd(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var K=(a,e,t)=>$d(a,typeof e!="symbol"?e+"":e,t),Cn=(a,e,t)=>e.has(a)||Oc("Cannot "+t);var me=(a,e,t)=>(Cn(a,e,"read from private field"),t?t.call(a):e.get(a)),He=(a,e,t)=>e.has(a)?Oc("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,t),Oe=(a,e,t,i)=>(Cn(a,e,"write to private field"),i?i.call(a,t):e.set(a,t),t),Dn=(a,e,t)=>(Cn(a,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();var ef=1e-6,Qe=typeof Float32Array<"u"?Float32Array:Array;function Zn(){var a=new Qe(9);return Qe!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function tf(a,e){return a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[4],a[4]=e[5],a[5]=e[6],a[6]=e[8],a[7]=e[9],a[8]=e[10],a}function pa(a,e,t,i,r,s,n,o,c){var l=new Qe(9);return l[0]=a,l[1]=e,l[2]=t,l[3]=i,l[4]=r,l[5]=s,l[6]=n,l[7]=o,l[8]=c,l}function af(a,e){var t=e[0],i=e[1],r=e[2],s=e[3],n=e[4],o=e[5],c=e[6],l=e[7],h=e[8],d=h*n-o*l,f=-h*s+o*c,u=l*s-n*c,m=t*d+i*f+r*u;return m?(m=1/m,a[0]=d*m,a[1]=(-h*i+r*l)*m,a[2]=(o*i-r*n)*m,a[3]=f*m,a[4]=(h*t-r*c)*m,a[5]=(-o*t+r*s)*m,a[6]=u*m,a[7]=(-l*t+i*c)*m,a[8]=(n*t-i*s)*m,a):null}function ih(a,e,t){var i=e[0],r=e[1],s=e[2],n=e[3],o=e[4],c=e[5],l=e[6],h=e[7],d=e[8],f=t[0],u=t[1],m=t[2],p=t[3],g=t[4],b=t[5],A=t[6],y=t[7],x=t[8];return a[0]=f*i+u*n+m*l,a[1]=f*r+u*o+m*h,a[2]=f*s+u*c+m*d,a[3]=p*i+g*n+b*l,a[4]=p*r+g*o+b*h,a[5]=p*s+g*c+b*d,a[6]=A*i+y*n+x*l,a[7]=A*r+y*o+x*h,a[8]=A*s+y*c+x*d,a}function we(){var a=new Qe(16);return Qe!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a}function Ke(a){var e=new Qe(16);return e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],e[4]=a[4],e[5]=a[5],e[6]=a[6],e[7]=a[7],e[8]=a[8],e[9]=a[9],e[10]=a[10],e[11]=a[11],e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15],e}function rf(a,e){return a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[4]=e[4],a[5]=e[5],a[6]=e[6],a[7]=e[7],a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15],a}function Ct(a,e,t,i,r,s,n,o,c,l,h,d,f,u,m,p){var g=new Qe(16);return g[0]=a,g[1]=e,g[2]=t,g[3]=i,g[4]=r,g[5]=s,g[6]=n,g[7]=o,g[8]=c,g[9]=l,g[10]=h,g[11]=d,g[12]=f,g[13]=u,g[14]=m,g[15]=p,g}function rh(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function xt(a,e){if(a===e){var t=e[1],i=e[2],r=e[3],s=e[6],n=e[7],o=e[11];a[1]=e[4],a[2]=e[8],a[3]=e[12],a[4]=t,a[6]=e[9],a[7]=e[13],a[8]=i,a[9]=s,a[11]=e[14],a[12]=r,a[13]=n,a[14]=o}else a[0]=e[0],a[1]=e[4],a[2]=e[8],a[3]=e[12],a[4]=e[1],a[5]=e[5],a[6]=e[9],a[7]=e[13],a[8]=e[2],a[9]=e[6],a[10]=e[10],a[11]=e[14],a[12]=e[3],a[13]=e[7],a[14]=e[11],a[15]=e[15];return a}function bt(a,e){var t=e[0],i=e[1],r=e[2],s=e[3],n=e[4],o=e[5],c=e[6],l=e[7],h=e[8],d=e[9],f=e[10],u=e[11],m=e[12],p=e[13],g=e[14],b=e[15],A=t*o-i*n,y=t*c-r*n,x=t*l-s*n,E=i*c-r*o,I=i*l-s*o,w=r*l-s*c,v=h*p-d*m,M=h*g-f*m,C=h*b-u*m,D=d*g-f*p,S=d*b-u*p,k=f*b-u*g,F=A*k-y*S+x*D+E*C-I*M+w*v;return F?(F=1/F,a[0]=(o*k-c*S+l*D)*F,a[1]=(r*S-i*k-s*D)*F,a[2]=(p*w-g*I+b*E)*F,a[3]=(f*I-d*w-u*E)*F,a[4]=(c*C-n*k-l*M)*F,a[5]=(t*k-r*C+s*M)*F,a[6]=(g*x-m*w-b*y)*F,a[7]=(h*w-f*x+u*y)*F,a[8]=(n*S-o*C+l*v)*F,a[9]=(i*C-t*S-s*v)*F,a[10]=(m*I-p*x+b*A)*F,a[11]=(d*x-h*I-u*A)*F,a[12]=(o*M-n*D-c*v)*F,a[13]=(t*D-i*M+r*v)*F,a[14]=(p*y-m*E-g*A)*F,a[15]=(h*E-d*y+f*A)*F,a):null}function Da(a,e,t){var i=e[0],r=e[1],s=e[2],n=e[3],o=e[4],c=e[5],l=e[6],h=e[7],d=e[8],f=e[9],u=e[10],m=e[11],p=e[12],g=e[13],b=e[14],A=e[15],y=t[0],x=t[1],E=t[2],I=t[3];return a[0]=y*i+x*o+E*d+I*p,a[1]=y*r+x*c+E*f+I*g,a[2]=y*s+x*l+E*u+I*b,a[3]=y*n+x*h+E*m+I*A,y=t[4],x=t[5],E=t[6],I=t[7],a[4]=y*i+x*o+E*d+I*p,a[5]=y*r+x*c+E*f+I*g,a[6]=y*s+x*l+E*u+I*b,a[7]=y*n+x*h+E*m+I*A,y=t[8],x=t[9],E=t[10],I=t[11],a[8]=y*i+x*o+E*d+I*p,a[9]=y*r+x*c+E*f+I*g,a[10]=y*s+x*l+E*u+I*b,a[11]=y*n+x*h+E*m+I*A,y=t[12],x=t[13],E=t[14],I=t[15],a[12]=y*i+x*o+E*d+I*p,a[13]=y*r+x*c+E*f+I*g,a[14]=y*s+x*l+E*u+I*b,a[15]=y*n+x*h+E*m+I*A,a}function qa(a,e,t){var i=t[0],r=t[1],s=t[2],n,o,c,l,h,d,f,u,m,p,g,b;return e===a?(a[12]=e[0]*i+e[4]*r+e[8]*s+e[12],a[13]=e[1]*i+e[5]*r+e[9]*s+e[13],a[14]=e[2]*i+e[6]*r+e[10]*s+e[14],a[15]=e[3]*i+e[7]*r+e[11]*s+e[15]):(n=e[0],o=e[1],c=e[2],l=e[3],h=e[4],d=e[5],f=e[6],u=e[7],m=e[8],p=e[9],g=e[10],b=e[11],a[0]=n,a[1]=o,a[2]=c,a[3]=l,a[4]=h,a[5]=d,a[6]=f,a[7]=u,a[8]=m,a[9]=p,a[10]=g,a[11]=b,a[12]=n*i+h*r+m*s+e[12],a[13]=o*i+d*r+p*s+e[13],a[14]=c*i+f*r+g*s+e[14],a[15]=l*i+u*r+b*s+e[15]),a}function Vc(a,e,t){var i=t[0],r=t[1],s=t[2];return a[0]=e[0]*i,a[1]=e[1]*i,a[2]=e[2]*i,a[3]=e[3]*i,a[4]=e[4]*r,a[5]=e[5]*r,a[6]=e[6]*r,a[7]=e[7]*r,a[8]=e[8]*s,a[9]=e[9]*s,a[10]=e[10]*s,a[11]=e[11]*s,a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15],a}function Bs(a,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[4],n=e[5],o=e[6],c=e[7],l=e[8],h=e[9],d=e[10],f=e[11];return e!==a&&(a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[4]=s*r+l*i,a[5]=n*r+h*i,a[6]=o*r+d*i,a[7]=c*r+f*i,a[8]=l*r-s*i,a[9]=h*r-n*i,a[10]=d*r-o*i,a[11]=f*r-c*i,a}function Ps(a,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],n=e[1],o=e[2],c=e[3],l=e[4],h=e[5],d=e[6],f=e[7];return e!==a&&(a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[0]=s*r+l*i,a[1]=n*r+h*i,a[2]=o*r+d*i,a[3]=c*r+f*i,a[4]=l*r-s*i,a[5]=h*r-n*i,a[6]=d*r-o*i,a[7]=f*r-c*i,a}function sf(a,e,t){var i=t[0],r=t[1],s=t[2],n=Math.sqrt(i*i+r*r+s*s),o,c,l;return n<ef?null:(n=1/n,i*=n,r*=n,s*=n,o=Math.sin(e),c=Math.cos(e),l=1-c,a[0]=i*i*l+c,a[1]=r*i*l+s*o,a[2]=s*i*l-r*o,a[3]=0,a[4]=i*r*l-s*o,a[5]=r*r*l+c,a[6]=s*r*l+i*o,a[7]=0,a[8]=i*s*l+r*o,a[9]=r*s*l-i*o,a[10]=s*s*l+c,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)}function nf(a,e,t,i,r,s,n){var o=1/(e-t),c=1/(i-r),l=1/(s-n);return a[0]=-2*o,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*c,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*l,a[11]=0,a[12]=(e+t)*o,a[13]=(r+i)*c,a[14]=(n+s)*l,a[15]=1,a}var Os=nf;function of(a,e,t){return a[0]=e[0]*t,a[1]=e[1]*t,a[2]=e[2]*t,a[3]=e[3]*t,a[4]=e[4]*t,a[5]=e[5]*t,a[6]=e[6]*t,a[7]=e[7]*t,a[8]=e[8]*t,a[9]=e[9]*t,a[10]=e[10]*t,a[11]=e[11]*t,a[12]=e[12]*t,a[13]=e[13]*t,a[14]=e[14]*t,a[15]=e[15]*t,a}var sh=Da;function Ce(){var a=new Qe(3);return Qe!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function Nt(a){var e=new Qe(3);return e[0]=a[0],e[1]=a[1],e[2]=a[2],e}function ya(a){var e=a[0],t=a[1],i=a[2];return Math.sqrt(e*e+t*t+i*i)}function ee(a,e,t){var i=new Qe(3);return i[0]=a,i[1]=e,i[2]=t,i}function Lc(a,e){return a[0]=e[0],a[1]=e[1],a[2]=e[2],a}function ka(a,e,t){return a[0]=e[0]+t[0],a[1]=e[1]+t[1],a[2]=e[2]+t[2],a}function Fe(a,e,t){return a[0]=e[0]-t[0],a[1]=e[1]-t[1],a[2]=e[2]-t[2],a}function xo(a,e,t){return a[0]=Math.min(e[0],t[0]),a[1]=Math.min(e[1],t[1]),a[2]=Math.min(e[2],t[2]),a}function wo(a,e,t){return a[0]=Math.max(e[0],t[0]),a[1]=Math.max(e[1],t[1]),a[2]=Math.max(e[2],t[2]),a}function cf(a,e,t){return a[0]=e[0]*t,a[1]=e[1]*t,a[2]=e[2]*t,a}function lf(a,e){var t=e[0]-a[0],i=e[1]-a[1],r=e[2]-a[2];return Math.sqrt(t*t+i*i+r*r)}function hf(a,e){return a[0]=-e[0],a[1]=-e[1],a[2]=-e[2],a}function It(a,e){var t=e[0],i=e[1],r=e[2],s=t*t+i*i+r*r;return s>0&&(s=1/Math.sqrt(s)),a[0]=e[0]*s,a[1]=e[1]*s,a[2]=e[2]*s,a}function df(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]}function $s(a,e,t){var i=e[0],r=e[1],s=e[2],n=t[0],o=t[1],c=t[2];return a[0]=r*c-s*o,a[1]=s*n-i*c,a[2]=i*o-r*n,a}function ff(a,e,t,i){var r=e[0],s=e[1],n=e[2];return a[0]=r+i*(t[0]-r),a[1]=s+i*(t[1]-s),a[2]=n+i*(t[2]-n),a}function Gc(a,e,t){var i=e[0],r=e[1],s=e[2];return a[0]=i*t[0]+r*t[3]+s*t[6],a[1]=i*t[1]+r*t[4]+s*t[7],a[2]=i*t[2]+r*t[5]+s*t[8],a}function _n(a,e){var t=a[0],i=a[1],r=a[2],s=e[0],n=e[1],o=e[2],c=Math.sqrt((t*t+i*i+r*r)*(s*s+n*n+o*o)),l=c&&df(a,e)/c;return Math.acos(Math.min(Math.max(l,-1),1))}var zc=Fe,fs=ya;(function(){var a=Ce();return function(e,t,i,r,s,n){var o,c;for(t||(t=3),i||(i=0),r?c=Math.min(r*t+i,e.length):c=e.length,o=i;o<c;o+=t)a[0]=e[o],a[1]=e[o+1],a[2]=e[o+2],s(a,a,n),e[o]=a[0],e[o+1]=a[1],e[o+2]=a[2];return e}})();function aa(){var a=new Qe(4);return Qe!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0,a[3]=0),a}function ma(a){var e=new Qe(4);return e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],e}function Be(a,e,t,i){var r=new Qe(4);return r[0]=a,r[1]=e,r[2]=t,r[3]=i,r}function Kc(a,e,t){return a[0]=e[0]+t[0],a[1]=e[1]+t[1],a[2]=e[2]+t[2],a[3]=e[3]+t[3],a}function uf(a,e,t){return a[0]=e[0]-t[0],a[1]=e[1]-t[1],a[2]=e[2]-t[2],a[3]=e[3]-t[3],a}function bf(a,e,t){return a[0]=e[0]*t,a[1]=e[1]*t,a[2]=e[2]*t,a[3]=e[3]*t,a}function it(a,e,t){var i=e[0],r=e[1],s=e[2],n=e[3];return a[0]=t[0]*i+t[4]*r+t[8]*s+t[12]*n,a[1]=t[1]*i+t[5]*r+t[9]*s+t[13]*n,a[2]=t[2]*i+t[6]*r+t[10]*s+t[14]*n,a[3]=t[3]*i+t[7]*r+t[11]*s+t[15]*n,a}var pf=uf;(function(){var a=aa();return function(e,t,i,r,s,n){var o,c;for(t||(t=4),i||(i=0),r?c=Math.min(r*t+i,e.length):c=e.length,o=i;o<c;o+=t)a[0]=e[o],a[1]=e[o+1],a[2]=e[o+2],a[3]=e[o+3],s(a,a,n),e[o]=a[0],e[o+1]=a[1],e[o+2]=a[2],e[o+3]=a[3];return e}})();function mf(){var a=new Qe(2);return Qe!=Float32Array&&(a[0]=0,a[1]=0),a}function Hc(a,e){var t=new Qe(2);return t[0]=a,t[1]=e,t}function gf(a,e,t){return a[0]=e[0]*t,a[1]=e[1]*t,a}function qc(a){var e=a[0],t=a[1];return Math.sqrt(e*e+t*t)}function Af(a,e){var t=e[0],i=e[1],r=t*t+i*i;return r>0&&(r=1/Math.sqrt(r)),a[0]=e[0]*r,a[1]=e[1]*r,a}(function(){var a=mf();return function(e,t,i,r,s,n){var o,c;for(t||(t=2),i||(i=0),r?c=Math.min(r*t+i,e.length):c=e.length,o=i;o<c;o+=t)a[0]=e[o],a[1]=e[o+1],s(a,a,n),e[o]=a[0],e[o+1]=a[1];return e}})();var Fa=256,en=[],Vs;for(;Fa--;)en[Fa]=(Fa+256).toString(16).substring(1);function $n(){var a=0,e,t="";if(!Vs||Fa+16>256){for(Vs=Array(a=256);a--;)Vs[a]=256*Math.random()|0;a=Fa=0}for(;a<16;a++)e=Vs[Fa+a],a==6?t+=en[e&15|64]:a==8?t+=en[e&63|128]:t+=en[e],a&1&&a>1&&a<11&&(t+="-");return Fa++,t}var dn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function nh(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}function yf(a){if(Object.prototype.hasOwnProperty.call(a,"__esModule"))return a;var e=a.default;if(typeof e=="function"){var t=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(a).forEach(function(i){var r=Object.getOwnPropertyDescriptor(a,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return a[i]}})}),t}var Sn,Wc;function xf(){return Wc||(Wc=1,Sn=function(e,t){var i=e.length;if(e===t)return!0;if(i!==t.length)return!1;for(var r=0;r<i;r++)if(e[r]!==t[r])return!1;return!0}),Sn}var wf=xf();const vf=nh(wf),oh=-1,xn=0,ns=1,fn=2,vo=3,Eo=4,To=5,Io=6,ch=7,lh=8,Yc=typeof self=="object"?self:globalThis,Ef=(a,e)=>{const t=(r,s)=>(a.set(s,r),r),i=r=>{if(a.has(r))return a.get(r);const[s,n]=e[r];switch(s){case xn:case oh:return t(n,r);case ns:{const o=t([],r);for(const c of n)o.push(i(c));return o}case fn:{const o=t({},r);for(const[c,l]of n)o[i(c)]=i(l);return o}case vo:return t(new Date(n),r);case Eo:{const{source:o,flags:c}=n;return t(new RegExp(o,c),r)}case To:{const o=t(new Map,r);for(const[c,l]of n)o.set(i(c),i(l));return o}case Io:{const o=t(new Set,r);for(const c of n)o.add(i(c));return o}case ch:{const{name:o,message:c}=n;return t(new Yc[o](c),r)}case lh:return t(BigInt(n),r);case"BigInt":return t(Object(BigInt(n)),r);case"ArrayBuffer":return t(new Uint8Array(n).buffer,n);case"DataView":{const{buffer:o}=new Uint8Array(n);return t(new DataView(o),n)}}return t(new Yc[s](n),r)};return i},Tf=a=>Ef(new Map,a)(0),Ka="",{toString:If}={},{keys:Mf}=Object,qr=a=>{const e=typeof a;if(e!=="object"||!a)return[xn,e];const t=If.call(a).slice(8,-1);switch(t){case"Array":return[ns,Ka];case"Object":return[fn,Ka];case"Date":return[vo,Ka];case"RegExp":return[Eo,Ka];case"Map":return[To,Ka];case"Set":return[Io,Ka];case"DataView":return[ns,t]}return t.includes("Array")?[ns,t]:t.includes("Error")?[ch,t]:[fn,t]},Ls=([a,e])=>a===xn&&(e==="function"||e==="symbol"),Cf=(a,e,t,i)=>{const r=(n,o)=>{const c=i.push(n)-1;return t.set(o,c),c},s=n=>{if(t.has(n))return t.get(n);let[o,c]=qr(n);switch(o){case xn:{let h=n;switch(c){case"bigint":o=lh,h=n.toString();break;case"function":case"symbol":if(a)throw new TypeError("unable to serialize "+c);h=null;break;case"undefined":return r([oh],n)}return r([o,h],n)}case ns:{if(c){let f=n;return c==="DataView"?f=new Uint8Array(n.buffer):c==="ArrayBuffer"&&(f=new Uint8Array(n)),r([c,[...f]],n)}const h=[],d=r([o,h],n);for(const f of n)h.push(s(f));return d}case fn:{if(c)switch(c){case"BigInt":return r([c,n.toString()],n);case"Boolean":case"Number":case"String":return r([c,n.valueOf()],n)}if(e&&"toJSON"in n)return s(n.toJSON());const h=[],d=r([o,h],n);for(const f of Mf(n))(a||!Ls(qr(n[f])))&&h.push([s(f),s(n[f])]);return d}case vo:return r([o,n.toISOString()],n);case Eo:{const{source:h,flags:d}=n;return r([o,{source:h,flags:d}],n)}case To:{const h=[],d=r([o,h],n);for(const[f,u]of n)(a||!(Ls(qr(f))||Ls(qr(u))))&&h.push([s(f),s(u)]);return d}case Io:{const h=[],d=r([o,h],n);for(const f of n)(a||!Ls(qr(f)))&&h.push(s(f));return d}}const{message:l}=n;return r([o,{name:c,message:l}],n)};return s},Df=(a,{json:e,lossy:t}={})=>{const i=[];return Cf(!(e||t),!!e,new Map,i)(a),i};var Xe=Uint8Array,Qa=Uint16Array,_f=Int32Array,hh=new Xe([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),dh=new Xe([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Sf=new Xe([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),fh=function(a,e){for(var t=new Qa(31),i=0;i<31;++i)t[i]=e+=1<<a[i-1];for(var r=new _f(t[30]),i=1;i<30;++i)for(var s=t[i];s<t[i+1];++s)r[s]=s-t[i]<<5|i;return{b:t,r}},uh=fh(hh,2),bh=uh.b,Ff=uh.r;bh[28]=258,Ff[258]=28;var Rf=fh(dh,0),Nf=Rf.b,eo=new Qa(32768);for(var ke=0;ke<32768;++ke){var ca=(ke&43690)>>1|(ke&21845)<<1;ca=(ca&52428)>>2|(ca&13107)<<2,ca=(ca&61680)>>4|(ca&3855)<<4,eo[ke]=((ca&65280)>>8|(ca&255)<<8)>>1}var os=(function(a,e,t){for(var i=a.length,r=0,s=new Qa(e);r<i;++r)a[r]&&++s[a[r]-1];var n=new Qa(e);for(r=1;r<e;++r)n[r]=n[r-1]+s[r-1]<<1;var o;if(t){o=new Qa(1<<e);var c=15-e;for(r=0;r<i;++r)if(a[r])for(var l=r<<4|a[r],h=e-a[r],d=n[a[r]-1]++<<h,f=d|(1<<h)-1;d<=f;++d)o[eo[d]>>c]=l}else for(o=new Qa(i),r=0;r<i;++r)a[r]&&(o[r]=eo[n[a[r]-1]++]>>15-a[r]);return o}),Ss=new Xe(288);for(var ke=0;ke<144;++ke)Ss[ke]=8;for(var ke=144;ke<256;++ke)Ss[ke]=9;for(var ke=256;ke<280;++ke)Ss[ke]=7;for(var ke=280;ke<288;++ke)Ss[ke]=8;var ph=new Xe(32);for(var ke=0;ke<32;++ke)ph[ke]=5;var kf=os(Ss,9,1),Uf=os(ph,5,1),Fn=function(a){for(var e=a[0],t=1;t<a.length;++t)a[t]>e&&(e=a[t]);return e},St=function(a,e,t){var i=e/8|0;return(a[i]|a[i+1]<<8)>>(e&7)&t},Rn=function(a,e){var t=e/8|0;return(a[t]|a[t+1]<<8|a[t+2]<<16)>>(e&7)},mh=function(a){return(a+7)/8|0},tn=function(a,e,t){return(e==null||e<0)&&(e=0),(t==null||t>a.length)&&(t=a.length),new Xe(a.subarray(e,t))},jf=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ct=function(a,e,t){var i=new Error(e||jf[a]);if(i.code=a,Error.captureStackTrace&&Error.captureStackTrace(i,ct),!t)throw i;return i},wn=function(a,e,t,i){var r=a.length,s=0;if(!r||e.f&&!e.l)return t||new Xe(0);var n=!t,o=n||e.i!=2,c=e.i;n&&(t=new Xe(r*3));var l=function(Ae){var _e=t.length;if(Ae>_e){var Pe=new Xe(Math.max(_e*2,Ae));Pe.set(t),t=Pe}},h=e.f||0,d=e.p||0,f=e.b||0,u=e.l,m=e.d,p=e.m,g=e.n,b=r*8;do{if(!u){h=St(a,d,1);var A=St(a,d+1,3);if(d+=3,A)if(A==1)u=kf,m=Uf,p=9,g=5;else if(A==2){var I=St(a,d,31)+257,w=St(a,d+10,15)+4,v=I+St(a,d+5,31)+1;d+=14;for(var M=new Xe(v),C=new Xe(19),D=0;D<w;++D)C[Sf[D]]=St(a,d+D*3,7);d+=w*3;for(var S=Fn(C),k=(1<<S)-1,F=os(C,S,1),D=0;D<v;){var B=F[St(a,d,k)];d+=B&15;var y=B>>4;if(y<16)M[D++]=y;else{var O=0,L=0;for(y==16?(L=3+St(a,d,3),d+=2,O=M[D-1]):y==17?(L=3+St(a,d,7),d+=3):y==18&&(L=11+St(a,d,127),d+=7);L--;)M[D++]=O}}var _=M.subarray(0,I),q=M.subarray(I);p=Fn(_),g=Fn(q),u=os(_,p,1),m=os(q,g,1)}else ct(1);else{var y=mh(d)+4,x=a[y-4]|a[y-3]<<8,E=y+x;if(E>r){c&&ct(0);break}o&&l(f+x),t.set(a.subarray(y,E),f),e.b=f+=x,e.p=d=E*8,e.f=h;continue}if(d>b){c&&ct(0);break}}o&&l(f+131072);for(var J=(1<<p)-1,Z=(1<<g)-1,Y=d;;Y=d){var O=u[Rn(a,d)&J],W=O>>4;if(d+=O&15,d>b){c&&ct(0);break}if(O||ct(2),W<256)t[f++]=W;else if(W==256){Y=d,u=null;break}else{var T=W-254;if(W>264){var D=W-257,ne=hh[D];T=St(a,d,(1<<ne)-1)+bh[D],d+=ne}var le=m[Rn(a,d)&Z],de=le>>4;le||ct(3),d+=le&15;var q=Nf[de];if(de>3){var ne=dh[de];q+=Rn(a,d)&(1<<ne)-1,d+=ne}if(d>b){c&&ct(0);break}o&&l(f+131072);var Me=f+T;if(f<q){var Ne=s-q,ge=Math.min(q,Me);for(Ne+f<0&&ct(3);f<ge;++f)t[f]=i[Ne+f]}for(;f<Me;++f)t[f]=t[f-q]}}e.l=u,e.p=Y,e.b=f,e.f=h,u&&(h=1,e.m=p,e.d=m,e.n=g)}while(!h);return f!=t.length&&n?tn(t,0,f):t.subarray(0,f)},Bf=new Xe(0),gh=function(a){(a[0]!=31||a[1]!=139||a[2]!=8)&&ct(6,"invalid gzip data");var e=a[3],t=10;e&4&&(t+=(a[10]|a[11]<<8)+2);for(var i=(e>>3&1)+(e>>4&1);i>0;i-=!a[t++]);return t+(e&2)},Pf=function(a){var e=a.length;return(a[e-4]|a[e-3]<<8|a[e-2]<<16|a[e-1]<<24)>>>0},Of=function(a,e){return((a[0]&15)!=8||a[0]>>4>7||(a[0]<<8|a[1])%31)&&ct(6,"invalid zlib data"),(a[1]>>5&1)==1&&ct(6,"invalid zlib data: "+(a[1]&32?"need":"unexpected")+" dictionary"),(a[1]>>3&4)+2},Nn=(function(){function a(e,t){typeof e=="function"&&(t=e,e={}),this.ondata=t;var i=e&&e.dictionary&&e.dictionary.subarray(-32768);this.s={i:0,b:i?i.length:0},this.o=new Xe(32768),this.p=new Xe(0),i&&this.o.set(i)}return a.prototype.e=function(e){if(this.ondata||ct(5),this.d&&ct(4),!this.p.length)this.p=e;else if(e.length){var t=new Xe(this.p.length+e.length);t.set(this.p),t.set(e,this.p.length),this.p=t}},a.prototype.c=function(e){this.s.i=+(this.d=e||!1);var t=this.s.b,i=wn(this.p,this.s,this.o);this.ondata(tn(i,t,this.s.b),this.d),this.o=tn(i,this.s.b-32768),this.s.b=this.o.length,this.p=tn(this.p,this.s.p/8|0),this.s.p&=7},a.prototype.push=function(e,t){this.e(e),this.c(t)},a})();function Vf(a,e){return wn(a,{i:2},e,e)}var Lf=(function(){function a(e,t){this.v=1,this.r=0,Nn.call(this,e,t)}return a.prototype.push=function(e,t){if(Nn.prototype.e.call(this,e),this.r+=e.length,this.v){var i=this.p.subarray(this.v-1),r=i.length>3?gh(i):4;if(r>i.length){if(!t)return}else this.v>1&&this.onmember&&this.onmember(this.r-i.length);this.p=i.subarray(r),this.v=0}Nn.prototype.c.call(this,t),this.s.f&&!this.s.l&&!t&&(this.v=mh(this.s.p)+9,this.s={i:0},this.o=new Xe(0),this.push(new Xe(0),t))},a})();function Gf(a,e){var t=gh(a);return t+8>a.length&&ct(6,"invalid gzip data"),wn(a.subarray(t,-8),{i:2},new Xe(Pf(a)),e)}function zf(a,e){return wn(a.subarray(Of(a),-4),{i:2},e,e)}function Kf(a,e){return a[0]==31&&a[1]==139&&a[2]==8?Gf(a,e):(a[0]&15)!=8||a[0]>>4>7||(a[0]<<8|a[1])%31?Vf(a,e):zf(a,e)}var Hf=typeof TextDecoder<"u"&&new TextDecoder,qf=0;try{Hf.decode(Bf,{stream:!0}),qf=1}catch{}class Ah{constructor(e,t,i,r){K(this,"esize");K(this,"ecode");K(this,"edata");K(this,"littleEndian");if(e%16!=0)throw new Error("This does not appear to be a NIFTI extension");this.esize=e,this.ecode=t,this.edata=i,this.littleEndian=r}toArrayBuffer(){let e=new Uint8Array(this.esize),t=new Uint8Array(this.edata);e.set(t,8);let i=new DataView(e.buffer);return i.setInt32(0,this.esize,this.littleEndian),i.setInt32(4,this.ecode,this.littleEndian),e.buffer}}const ot=class ot{static getStringAt(e,t,i){var r="",s,n;for(s=t;s<i;s+=1)n=e.getUint8(s),n!==0&&(r+=String.fromCharCode(n));return r}static getIntAt(e,t,i){return e.getInt32(t,i)}static getFloatAt(e,t,i){return e.getFloat32(t,i)}static getDoubleAt(e,t,i){return e.getFloat64(t,i)}static getInt64At(e,t,i){const r=e.getUint32(t,i),s=e.getInt32(t+4,i);let n;return i?n=s*2**32+r:n=r*2**32+s,s<0&&(n+=-1*2**32*2**32),n}static getUint64At(e,t,i){const r=e.getUint32(t+(i?0:4),i),s=e.getUint32(t+(i?4:0),i);return i?s*2**32+r:r*2**32+s}static getExtensionsAt(e,t,i,r){let s=[],n=t;for(;n<r;){let o=i,c=ot.getIntAt(e,n,i);if(!c)break;if(c+n>r&&(o=!o,c=ot.getIntAt(e,n,o),c+n>r))throw new Error("This does not appear to be a valid NIFTI extension");if(c%16!=0)throw new Error("This does not appear to be a NIFTI extension");let l=ot.getIntAt(e,n+4,o),h=e.buffer.slice(n+8,n+c),d=new Ah(c,l,h,o);s.push(d),n+=c}return s}static toArrayBuffer(e){var t,i,r;for(t=new ArrayBuffer(e.length),i=new Uint8Array(t),r=0;r<e.length;r+=1)i[r]=e[r];return t}static isString(e){return typeof e=="string"||e instanceof String}static formatNumber(e,t=void 0){let i;return ot.isString(e)?i=Number(e):i=e,t?i=i.toPrecision(5):i=i.toPrecision(7),parseFloat(i)}static makeCRCTable(){let e,t=[];for(var i=0;i<256;i++){e=i;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[i]=e}return t}static crc32(e){ot.crcTable||(ot.crcTable=ot.makeCRCTable());const t=ot.crcTable;let i=-1;for(var r=0;r<e.byteLength;r++)i=i>>>8^t[(i^e.getUint8(r))&255];return(i^-1)>>>0}};K(ot,"crcTable",null),K(ot,"GUNZIP_MAGIC_COOKIE1",31),K(ot,"GUNZIP_MAGIC_COOKIE2",139),K(ot,"getByteAt",function(e,t){return e.getUint8(t)}),K(ot,"getShortAt",function(e,t,i){return e.getInt16(t,i)});let te=ot;const ae=class ae{constructor(){K(this,"littleEndian",!1);K(this,"dim_info",0);K(this,"dims",[]);K(this,"intent_p1",0);K(this,"intent_p2",0);K(this,"intent_p3",0);K(this,"intent_code",0);K(this,"datatypeCode",0);K(this,"numBitsPerVoxel",0);K(this,"slice_start",0);K(this,"slice_end",0);K(this,"slice_code",0);K(this,"pixDims",[]);K(this,"vox_offset",0);K(this,"scl_slope",1);K(this,"scl_inter",0);K(this,"xyzt_units",0);K(this,"cal_max",0);K(this,"cal_min",0);K(this,"slice_duration",0);K(this,"toffset",0);K(this,"description","");K(this,"aux_file","");K(this,"intent_name","");K(this,"qform_code",0);K(this,"sform_code",0);K(this,"quatern_a",0);K(this,"quatern_b",0);K(this,"quatern_c",0);K(this,"quatern_d",0);K(this,"qoffset_x",0);K(this,"qoffset_y",0);K(this,"qoffset_z",0);K(this,"affine",[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]);K(this,"qfac",1);K(this,"quatern_R");K(this,"magic","0");K(this,"isHDR",!1);K(this,"extensionFlag",[0,0,0,0]);K(this,"extensionSize",0);K(this,"extensionCode",0);K(this,"extensions",[]);K(this,"getDatatypeCodeString",function(e){return e===ae.TYPE_UINT8?"1-Byte Unsigned Integer":e===ae.TYPE_INT16?"2-Byte Signed Integer":e===ae.TYPE_INT32?"4-Byte Signed Integer":e===ae.TYPE_FLOAT32?"4-Byte Float":e===ae.TYPE_FLOAT64?"8-Byte Float":e===ae.TYPE_RGB24?"RGB":e===ae.TYPE_INT8?"1-Byte Signed Integer":e===ae.TYPE_UINT16?"2-Byte Unsigned Integer":e===ae.TYPE_UINT32?"4-Byte Unsigned Integer":e===ae.TYPE_INT64?"8-Byte Signed Integer":e===ae.TYPE_UINT64?"8-Byte Unsigned Integer":"Unknown"});K(this,"getTransformCodeString",function(e){return e===ae.XFORM_SCANNER_ANAT?"Scanner":e===ae.XFORM_ALIGNED_ANAT?"Aligned":e===ae.XFORM_TALAIRACH?"Talairach":e===ae.XFORM_MNI_152?"MNI":"Unknown"});K(this,"getUnitsCodeString",function(e){return e===ae.UNITS_METER?"Meters":e===ae.UNITS_MM?"Millimeters":e===ae.UNITS_MICRON?"Microns":e===ae.UNITS_SEC?"Seconds":e===ae.UNITS_MSEC?"Milliseconds":e===ae.UNITS_USEC?"Microseconds":e===ae.UNITS_HZ?"Hz":e===ae.UNITS_PPM?"PPM":e===ae.UNITS_RADS?"Rads":"Unknown"});K(this,"nifti_mat33_mul",function(e,t){var i=[[0,0,0],[0,0,0],[0,0,0]],r,s;for(r=0;r<3;r+=1)for(s=0;s<3;s+=1)i[r][s]=e[r][0]*t[0][s]+e[r][1]*t[1][s]+e[r][2]*t[2][s];return i});K(this,"nifti_mat33_determ",function(e){var t,i,r,s,n,o,c,l,h;return t=e[0][0],i=e[0][1],r=e[0][2],s=e[1][0],n=e[1][1],o=e[1][2],c=e[2][0],l=e[2][1],h=e[2][2],t*n*h-t*l*o-s*i*h+s*l*r+c*i*o-c*n*r})}readHeader(e){var t=new DataView(e),i=te.getIntAt(t,0,this.littleEndian),r,s,n,o;if(i!==ae.MAGIC_COOKIE&&(this.littleEndian=!0,i=te.getIntAt(t,0,this.littleEndian)),i!==ae.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.dim_info=te.getByteAt(t,39),r=0;r<8;r+=1)o=40+r*2,this.dims[r]=te.getShortAt(t,o,this.littleEndian);for(this.intent_p1=te.getFloatAt(t,56,this.littleEndian),this.intent_p2=te.getFloatAt(t,60,this.littleEndian),this.intent_p3=te.getFloatAt(t,64,this.littleEndian),this.intent_code=te.getShortAt(t,68,this.littleEndian),this.datatypeCode=te.getShortAt(t,70,this.littleEndian),this.numBitsPerVoxel=te.getShortAt(t,72,this.littleEndian),this.slice_start=te.getShortAt(t,74,this.littleEndian),r=0;r<8;r+=1)o=76+r*4,this.pixDims[r]=te.getFloatAt(t,o,this.littleEndian);if(this.vox_offset=te.getFloatAt(t,108,this.littleEndian),this.scl_slope=te.getFloatAt(t,112,this.littleEndian),this.scl_inter=te.getFloatAt(t,116,this.littleEndian),this.slice_end=te.getShortAt(t,120,this.littleEndian),this.slice_code=te.getByteAt(t,122),this.xyzt_units=te.getByteAt(t,123),this.cal_max=te.getFloatAt(t,124,this.littleEndian),this.cal_min=te.getFloatAt(t,128,this.littleEndian),this.slice_duration=te.getFloatAt(t,132,this.littleEndian),this.toffset=te.getFloatAt(t,136,this.littleEndian),this.description=te.getStringAt(t,148,228),this.aux_file=te.getStringAt(t,228,252),this.qform_code=te.getShortAt(t,252,this.littleEndian),this.sform_code=te.getShortAt(t,254,this.littleEndian),this.quatern_b=te.getFloatAt(t,256,this.littleEndian),this.quatern_c=te.getFloatAt(t,260,this.littleEndian),this.quatern_d=te.getFloatAt(t,264,this.littleEndian),this.quatern_a=Math.sqrt(1-(Math.pow(this.quatern_b,2)+Math.pow(this.quatern_c,2)+Math.pow(this.quatern_d,2))),this.qoffset_x=te.getFloatAt(t,268,this.littleEndian),this.qoffset_y=te.getFloatAt(t,272,this.littleEndian),this.qoffset_z=te.getFloatAt(t,276,this.littleEndian),this.qform_code<1&&this.sform_code<1&&(this.affine[0][0]=this.pixDims[1],this.affine[1][1]=this.pixDims[2],this.affine[2][2]=this.pixDims[3]),this.qform_code>0&&this.sform_code<this.qform_code){const c=this.quatern_a,l=this.quatern_b,h=this.quatern_c,d=this.quatern_d;for(this.qfac=this.pixDims[0]===0?1:this.pixDims[0],this.quatern_R=[[c*c+l*l-h*h-d*d,2*l*h-2*c*d,2*l*d+2*c*h],[2*l*h+2*c*d,c*c+h*h-l*l-d*d,2*h*d-2*c*l],[2*l*d-2*c*h,2*h*d+2*c*l,c*c+d*d-h*h-l*l]],s=0;s<3;s+=1)for(n=0;n<3;n+=1)this.affine[s][n]=this.quatern_R[s][n]*this.pixDims[n+1],n===2&&(this.affine[s][n]*=this.qfac);this.affine[0][3]=this.qoffset_x,this.affine[1][3]=this.qoffset_y,this.affine[2][3]=this.qoffset_z}else if(this.sform_code>0)for(s=0;s<3;s+=1)for(n=0;n<4;n+=1)o=280+(s*4+n)*4,this.affine[s][n]=te.getFloatAt(t,o,this.littleEndian);if(this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.intent_name=te.getStringAt(t,328,344),this.magic=te.getStringAt(t,344,348),this.isHDR=this.magic===String.fromCharCode.apply(null,ae.MAGIC_NUMBER2),t.byteLength>ae.MAGIC_COOKIE){this.extensionFlag[0]=te.getByteAt(t,348),this.extensionFlag[1]=te.getByteAt(t,349),this.extensionFlag[2]=te.getByteAt(t,350),this.extensionFlag[3]=te.getByteAt(t,351);let c=!0;!this.isHDR&&this.vox_offset<=352&&(c=!1),t.byteLength<=368&&(c=!1),c&&this.extensionFlag[0]&&(this.extensions=te.getExtensionsAt(t,this.getExtensionLocation(),this.littleEndian,this.vox_offset),this.extensionSize=this.extensions[0].esize,this.extensionCode=this.extensions[0].ecode)}}toFormattedString(){var e=te.formatNumber,t="";return t+="Dim Info = "+this.dim_info+`
`,t+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+`
`,t+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+`
`,t+="Intent Code = "+this.intent_code+`
`,t+="Datatype = "+this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+`)
`,t+="Bits Per Voxel = "+this.numBitsPerVoxel+`
`,t+="Slice Start = "+this.slice_start+`
`,t+="Voxel Dimensions (1-8): "+e(this.pixDims[0])+", "+e(this.pixDims[1])+", "+e(this.pixDims[2])+", "+e(this.pixDims[3])+", "+e(this.pixDims[4])+", "+e(this.pixDims[5])+", "+e(this.pixDims[6])+", "+e(this.pixDims[7])+`
`,t+="Image Offset = "+this.vox_offset+`
`,t+="Data Scale:  Slope = "+e(this.scl_slope)+"  Intercept = "+e(this.scl_inter)+`
`,t+="Slice End = "+this.slice_end+`
`,t+="Slice Code = "+this.slice_code+`
`,t+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(ae.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(ae.TEMPORAL_UNITS_MASK&this.xyzt_units)+`)
`,t+="Display Range:  Max = "+e(this.cal_max)+"  Min = "+e(this.cal_min)+`
`,t+="Slice Duration = "+this.slice_duration+`
`,t+="Time Axis Shift = "+this.toffset+`
`,t+='Description: "'+this.description+`"
`,t+='Auxiliary File: "'+this.aux_file+`"
`,t+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+`)
`,t+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+`)
`,t+="Quaternion Parameters:  b = "+e(this.quatern_b)+"  c = "+e(this.quatern_c)+"  d = "+e(this.quatern_d)+`
`,t+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+`
`,t+="S-Form Parameters X: "+e(this.affine[0][0])+", "+e(this.affine[0][1])+", "+e(this.affine[0][2])+", "+e(this.affine[0][3])+`
`,t+="S-Form Parameters Y: "+e(this.affine[1][0])+", "+e(this.affine[1][1])+", "+e(this.affine[1][2])+", "+e(this.affine[1][3])+`
`,t+="S-Form Parameters Z: "+e(this.affine[2][0])+", "+e(this.affine[2][1])+", "+e(this.affine[2][2])+", "+e(this.affine[2][3])+`
`,t+='Intent Name: "'+this.intent_name+`"
`,this.extensionFlag[0]&&(t+="Extension: Size = "+this.extensionSize+"  Code = "+this.extensionCode+`
`),t}getQformMat(){return this.convertNiftiQFormToNiftiSForm(this.quatern_b,this.quatern_c,this.quatern_d,this.qoffset_x,this.qoffset_y,this.qoffset_z,this.pixDims[1],this.pixDims[2],this.pixDims[3],this.pixDims[0])}convertNiftiQFormToNiftiSForm(e,t,i,r,s,n,o,c,l,h){var d=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],f,u=e,m=t,p=i,g,b,A;return d[3][0]=d[3][1]=d[3][2]=0,d[3][3]=1,f=1-(u*u+m*m+p*p),f<1e-7?(f=1/Math.sqrt(u*u+m*m+p*p),u*=f,m*=f,p*=f,f=0):f=Math.sqrt(f),g=o>0?o:1,b=c>0?c:1,A=l>0?l:1,h<0&&(A=-A),d[0][0]=(f*f+u*u-m*m-p*p)*g,d[0][1]=2*(u*m-f*p)*b,d[0][2]=2*(u*p+f*m)*A,d[1][0]=2*(u*m+f*p)*g,d[1][1]=(f*f+m*m-u*u-p*p)*b,d[1][2]=2*(m*p-f*u)*A,d[2][0]=2*(u*p-f*m)*g,d[2][1]=2*(m*p+f*u)*b,d[2][2]=(f*f+p*p-m*m-u*u)*A,d[0][3]=r,d[1][3]=s,d[2][3]=n,d}convertNiftiSFormToNEMA(e){var t,i,r,s,n,o,c,l,h,d,f,u,m,p,g,b,A,y,x,E,I,w,v,M,C,D,S,k,F,B,O,L,_,q;if(g=0,S=[[0,0,0],[0,0,0],[0,0,0]],k=[[0,0,0],[0,0,0],[0,0,0]],t=e[0][0],i=e[0][1],r=e[0][2],s=e[1][0],n=e[1][1],o=e[1][2],c=e[2][0],l=e[2][1],h=e[2][2],d=Math.sqrt(t*t+s*s+c*c),d===0||(t/=d,s/=d,c/=d,d=Math.sqrt(i*i+n*n+l*l),d===0))return null;if(i/=d,n/=d,l/=d,d=t*i+s*n+c*l,Math.abs(d)>1e-4){if(i-=d*t,n-=d*s,l-=d*c,d=Math.sqrt(i*i+n*n+l*l),d===0)return null;i/=d,n/=d,l/=d}if(d=Math.sqrt(r*r+o*o+h*h),d===0?(r=s*l-c*n,o=c*i-l*t,h=t*n-s*i):(r/=d,o/=d,h/=d),d=t*r+s*o+c*h,Math.abs(d)>1e-4){if(r-=d*t,o-=d*s,h-=d*c,d=Math.sqrt(r*r+o*o+h*h),d===0)return null;r/=d,o/=d,h/=d}if(d=i*r+n*o+l*h,Math.abs(d)>1e-4){if(r-=d*i,o-=d*n,h-=d*l,d=Math.sqrt(r*r+o*o+h*h),d===0)return null;r/=d,o/=d,h/=d}if(S[0][0]=t,S[0][1]=i,S[0][2]=r,S[1][0]=s,S[1][1]=n,S[1][2]=o,S[2][0]=c,S[2][1]=l,S[2][2]=h,f=this.nifti_mat33_determ(S),f===0)return null;for(D=-666,x=w=v=M=1,E=2,I=3,m=1;m<=3;m+=1)for(p=1;p<=3;p+=1)if(m!==p){for(g=1;g<=3;g+=1)if(!(m===g||p===g))for(k[0][0]=k[0][1]=k[0][2]=k[1][0]=k[1][1]=k[1][2]=k[2][0]=k[2][1]=k[2][2]=0,b=-1;b<=1;b+=2)for(A=-1;A<=1;A+=2)for(y=-1;y<=1;y+=2)k[0][m-1]=b,k[1][p-1]=A,k[2][g-1]=y,u=this.nifti_mat33_determ(k),u*f>0&&(C=this.nifti_mat33_mul(k,S),d=C[0][0]+C[1][1]+C[2][2],d>D&&(D=d,x=m,E=p,I=g,w=b,v=A,M=y))}switch(F=B=O=L=_=q="",x*w){case 1:F="X",L="+";break;case-1:F="X",L="-";break;case 2:F="Y",L="+";break;case-2:F="Y",L="-";break;case 3:F="Z",L="+";break;case-3:F="Z",L="-";break}switch(E*v){case 1:B="X",_="+";break;case-1:B="X",_="-";break;case 2:B="Y",_="+";break;case-2:B="Y",_="-";break;case 3:B="Z",_="+";break;case-3:B="Z",_="-";break}switch(I*M){case 1:O="X",q="+";break;case-1:O="X",q="-";break;case 2:O="Y",q="+";break;case-2:O="Y",q="-";break;case 3:O="Z",q="+";break;case-3:O="Z",q="-";break}return F+B+O+L+_+q}getExtensionLocation(){return ae.MAGIC_COOKIE+4}getExtensionSize(e){return te.getIntAt(e,this.getExtensionLocation(),this.littleEndian)}getExtensionCode(e){return te.getIntAt(e,this.getExtensionLocation()+4,this.littleEndian)}addExtension(e,t=-1){t==-1?this.extensions.push(e):this.extensions.splice(t,0,e),this.vox_offset+=e.esize}removeExtension(e){let t=this.extensions[e];t&&(this.vox_offset-=t.esize),this.extensions.splice(e,1)}toArrayBuffer(e=!1){let r=352;if(e)for(let c of this.extensions)r+=c.esize;let s=new Uint8Array(r),n=new DataView(s.buffer);n.setInt32(0,348,this.littleEndian),n.setUint8(39,this.dim_info);for(let c=0;c<8;c++)n.setUint16(40+2*c,this.dims[c],this.littleEndian);n.setFloat32(56,this.intent_p1,this.littleEndian),n.setFloat32(60,this.intent_p2,this.littleEndian),n.setFloat32(64,this.intent_p3,this.littleEndian),n.setInt16(68,this.intent_code,this.littleEndian),n.setInt16(70,this.datatypeCode,this.littleEndian),n.setInt16(72,this.numBitsPerVoxel,this.littleEndian),n.setInt16(74,this.slice_start,this.littleEndian);for(let c=0;c<8;c++)n.setFloat32(76+4*c,this.pixDims[c],this.littleEndian);n.setFloat32(108,this.vox_offset,this.littleEndian),n.setFloat32(112,this.scl_slope,this.littleEndian),n.setFloat32(116,this.scl_inter,this.littleEndian),n.setInt16(120,this.slice_end,this.littleEndian),n.setUint8(122,this.slice_code),n.setUint8(123,this.xyzt_units),n.setFloat32(124,this.cal_max,this.littleEndian),n.setFloat32(128,this.cal_min,this.littleEndian),n.setFloat32(132,this.slice_duration,this.littleEndian),n.setFloat32(136,this.toffset,this.littleEndian),s.set(new TextEncoder().encode(this.description),148),s.set(new TextEncoder().encode(this.aux_file),228),n.setInt16(252,this.qform_code,this.littleEndian),n.setInt16(254,this.sform_code,this.littleEndian),n.setFloat32(256,this.quatern_b,this.littleEndian),n.setFloat32(260,this.quatern_c,this.littleEndian),n.setFloat32(264,this.quatern_d,this.littleEndian),n.setFloat32(268,this.qoffset_x,this.littleEndian),n.setFloat32(272,this.qoffset_y,this.littleEndian),n.setFloat32(276,this.qoffset_z,this.littleEndian);const o=this.affine.flat();for(let c=0;c<12;c++)n.setFloat32(280+4*c,o[c],this.littleEndian);if(s.set(new TextEncoder().encode(this.intent_name),328),s.set(new TextEncoder().encode(this.magic),344),e){s.set(Uint8Array.from([1,0,0,0]),348);let c=this.getExtensionLocation();for(const l of this.extensions)n.setInt32(c,l.esize,l.littleEndian),n.setInt32(c+4,l.ecode,l.littleEndian),s.set(new Uint8Array(l.edata),c+8),c+=l.esize}else s.set(new Uint8Array(4).fill(0),348);return s.buffer}};K(ae,"TYPE_NONE",0),K(ae,"TYPE_BINARY",1),K(ae,"TYPE_UINT8",2),K(ae,"TYPE_INT16",4),K(ae,"TYPE_INT32",8),K(ae,"TYPE_FLOAT32",16),K(ae,"TYPE_COMPLEX64",32),K(ae,"TYPE_FLOAT64",64),K(ae,"TYPE_RGB24",128),K(ae,"TYPE_INT8",256),K(ae,"TYPE_UINT16",512),K(ae,"TYPE_UINT32",768),K(ae,"TYPE_INT64",1024),K(ae,"TYPE_UINT64",1280),K(ae,"TYPE_FLOAT128",1536),K(ae,"TYPE_COMPLEX128",1792),K(ae,"TYPE_COMPLEX256",2048),K(ae,"XFORM_UNKNOWN",0),K(ae,"XFORM_SCANNER_ANAT",1),K(ae,"XFORM_ALIGNED_ANAT",2),K(ae,"XFORM_TALAIRACH",3),K(ae,"XFORM_MNI_152",4),K(ae,"SPATIAL_UNITS_MASK",7),K(ae,"TEMPORAL_UNITS_MASK",56),K(ae,"UNITS_UNKNOWN",0),K(ae,"UNITS_METER",1),K(ae,"UNITS_MM",2),K(ae,"UNITS_MICRON",3),K(ae,"UNITS_SEC",8),K(ae,"UNITS_MSEC",16),K(ae,"UNITS_USEC",24),K(ae,"UNITS_HZ",32),K(ae,"UNITS_PPM",40),K(ae,"UNITS_RADS",48),K(ae,"MAGIC_COOKIE",348),K(ae,"STANDARD_HEADER_SIZE",348),K(ae,"MAGIC_NUMBER_LOCATION",344),K(ae,"MAGIC_NUMBER",[110,43,49]),K(ae,"MAGIC_NUMBER2",[110,105,49]),K(ae,"EXTENSION_HEADER_SIZE",8);let pe=ae;const Pt=class Pt{constructor(){K(this,"littleEndian",!1);K(this,"dim_info",0);K(this,"dims",[]);K(this,"intent_p1",0);K(this,"intent_p2",0);K(this,"intent_p3",0);K(this,"intent_code",0);K(this,"datatypeCode",0);K(this,"numBitsPerVoxel",0);K(this,"slice_start",0);K(this,"slice_end",0);K(this,"slice_code",0);K(this,"pixDims",[]);K(this,"vox_offset",0);K(this,"scl_slope",1);K(this,"scl_inter",0);K(this,"xyzt_units",0);K(this,"cal_max",0);K(this,"cal_min",0);K(this,"slice_duration",0);K(this,"toffset",0);K(this,"description","");K(this,"aux_file","");K(this,"intent_name","");K(this,"qform_code",0);K(this,"sform_code",0);K(this,"quatern_b",0);K(this,"quatern_c",0);K(this,"quatern_d",0);K(this,"qoffset_x",0);K(this,"qoffset_y",0);K(this,"qoffset_z",0);K(this,"affine",[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]);K(this,"magic","0");K(this,"extensionFlag",[0,0,0,0]);K(this,"extensions",[]);K(this,"extensionSize",0);K(this,"extensionCode",0);K(this,"getExtensionLocation",function(){return Pt.MAGIC_COOKIE+4});K(this,"getExtensionSize",pe.prototype.getExtensionSize);K(this,"getExtensionCode",pe.prototype.getExtensionCode);K(this,"addExtension",pe.prototype.addExtension);K(this,"removeExtension",pe.prototype.removeExtension);K(this,"getDatatypeCodeString",pe.prototype.getDatatypeCodeString);K(this,"getTransformCodeString",pe.prototype.getTransformCodeString);K(this,"getUnitsCodeString",pe.prototype.getUnitsCodeString);K(this,"getQformMat",pe.prototype.getQformMat);K(this,"convertNiftiQFormToNiftiSForm",pe.prototype.convertNiftiQFormToNiftiSForm);K(this,"convertNiftiSFormToNEMA",pe.prototype.convertNiftiSFormToNEMA);K(this,"nifti_mat33_mul",pe.prototype.nifti_mat33_mul);K(this,"nifti_mat33_determ",pe.prototype.nifti_mat33_determ)}readHeader(e){var t=new DataView(e),i=te.getIntAt(t,0,this.littleEndian),r,s,n,o;if(i!==Pt.MAGIC_COOKIE&&(this.littleEndian=!0,i=te.getIntAt(t,0,this.littleEndian)),i!==Pt.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.magic=te.getStringAt(t,4,12),this.datatypeCode=te.getShortAt(t,12,this.littleEndian),this.numBitsPerVoxel=te.getShortAt(t,14,this.littleEndian),r=0;r<8;r+=1)o=16+r*8,this.dims[r]=te.getInt64At(t,o,this.littleEndian);for(this.intent_p1=te.getDoubleAt(t,80,this.littleEndian),this.intent_p2=te.getDoubleAt(t,88,this.littleEndian),this.intent_p3=te.getDoubleAt(t,96,this.littleEndian),r=0;r<8;r+=1)o=104+r*8,this.pixDims[r]=te.getDoubleAt(t,o,this.littleEndian);for(this.vox_offset=te.getInt64At(t,168,this.littleEndian),this.scl_slope=te.getDoubleAt(t,176,this.littleEndian),this.scl_inter=te.getDoubleAt(t,184,this.littleEndian),this.cal_max=te.getDoubleAt(t,192,this.littleEndian),this.cal_min=te.getDoubleAt(t,200,this.littleEndian),this.slice_duration=te.getDoubleAt(t,208,this.littleEndian),this.toffset=te.getDoubleAt(t,216,this.littleEndian),this.slice_start=te.getInt64At(t,224,this.littleEndian),this.slice_end=te.getInt64At(t,232,this.littleEndian),this.description=te.getStringAt(t,240,320),this.aux_file=te.getStringAt(t,320,344),this.qform_code=te.getIntAt(t,344,this.littleEndian),this.sform_code=te.getIntAt(t,348,this.littleEndian),this.quatern_b=te.getDoubleAt(t,352,this.littleEndian),this.quatern_c=te.getDoubleAt(t,360,this.littleEndian),this.quatern_d=te.getDoubleAt(t,368,this.littleEndian),this.qoffset_x=te.getDoubleAt(t,376,this.littleEndian),this.qoffset_y=te.getDoubleAt(t,384,this.littleEndian),this.qoffset_z=te.getDoubleAt(t,392,this.littleEndian),s=0;s<3;s+=1)for(n=0;n<4;n+=1)o=400+(s*4+n)*8,this.affine[s][n]=te.getDoubleAt(t,o,this.littleEndian);this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.slice_code=te.getIntAt(t,496,this.littleEndian),this.xyzt_units=te.getIntAt(t,500,this.littleEndian),this.intent_code=te.getIntAt(t,504,this.littleEndian),this.intent_name=te.getStringAt(t,508,524),this.dim_info=te.getByteAt(t,524),t.byteLength>Pt.MAGIC_COOKIE&&(this.extensionFlag[0]=te.getByteAt(t,540),this.extensionFlag[1]=te.getByteAt(t,541),this.extensionFlag[2]=te.getByteAt(t,542),this.extensionFlag[3]=te.getByteAt(t,543),this.extensionFlag[0]&&(this.extensions=te.getExtensionsAt(t,this.getExtensionLocation(),this.littleEndian,this.vox_offset),this.extensionSize=this.extensions[0].esize,this.extensionCode=this.extensions[0].ecode))}toFormattedString(){var e=te.formatNumber,t="";return t+="Datatype = "+ +this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+`)
`,t+="Bits Per Voxel =  = "+this.numBitsPerVoxel+`
`,t+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+`
`,t+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+`
`,t+="Voxel Dimensions (1-8): "+e(this.pixDims[0])+", "+e(this.pixDims[1])+", "+e(this.pixDims[2])+", "+e(this.pixDims[3])+", "+e(this.pixDims[4])+", "+e(this.pixDims[5])+", "+e(this.pixDims[6])+", "+e(this.pixDims[7])+`
`,t+="Image Offset = "+this.vox_offset+`
`,t+="Data Scale:  Slope = "+e(this.scl_slope)+"  Intercept = "+e(this.scl_inter)+`
`,t+="Display Range:  Max = "+e(this.cal_max)+"  Min = "+e(this.cal_min)+`
`,t+="Slice Duration = "+this.slice_duration+`
`,t+="Time Axis Shift = "+this.toffset+`
`,t+="Slice Start = "+this.slice_start+`
`,t+="Slice End = "+this.slice_end+`
`,t+='Description: "'+this.description+`"
`,t+='Auxiliary File: "'+this.aux_file+`"
`,t+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+`)
`,t+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+`)
`,t+="Quaternion Parameters:  b = "+e(this.quatern_b)+"  c = "+e(this.quatern_c)+"  d = "+e(this.quatern_d)+`
`,t+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+`
`,t+="S-Form Parameters X: "+e(this.affine[0][0])+", "+e(this.affine[0][1])+", "+e(this.affine[0][2])+", "+e(this.affine[0][3])+`
`,t+="S-Form Parameters Y: "+e(this.affine[1][0])+", "+e(this.affine[1][1])+", "+e(this.affine[1][2])+", "+e(this.affine[1][3])+`
`,t+="S-Form Parameters Z: "+e(this.affine[2][0])+", "+e(this.affine[2][1])+", "+e(this.affine[2][2])+", "+e(this.affine[2][3])+`
`,t+="Slice Code = "+this.slice_code+`
`,t+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(pe.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(pe.TEMPORAL_UNITS_MASK&this.xyzt_units)+`)
`,t+="Intent Code = "+this.intent_code+`
`,t+='Intent Name: "'+this.intent_name+`"
`,t+="Dim Info = "+this.dim_info+`
`,t}toArrayBuffer(e=!1){let r=544;if(e)for(let c of this.extensions)r+=c.esize;let s=new Uint8Array(r),n=new DataView(s.buffer);n.setInt32(0,540,this.littleEndian),s.set(new TextEncoder().encode(this.magic),4),n.setInt16(12,this.datatypeCode,this.littleEndian),n.setInt16(14,this.numBitsPerVoxel,this.littleEndian);for(let c=0;c<8;c++)n.setBigInt64(16+8*c,BigInt(this.dims[c]),this.littleEndian);n.setFloat64(80,this.intent_p1,this.littleEndian),n.setFloat64(88,this.intent_p2,this.littleEndian),n.setFloat64(96,this.intent_p3,this.littleEndian);for(let c=0;c<8;c++)n.setFloat64(104+8*c,this.pixDims[c],this.littleEndian);n.setBigInt64(168,BigInt(this.vox_offset),this.littleEndian),n.setFloat64(176,this.scl_slope,this.littleEndian),n.setFloat64(184,this.scl_inter,this.littleEndian),n.setFloat64(192,this.cal_max,this.littleEndian),n.setFloat64(200,this.cal_min,this.littleEndian),n.setFloat64(208,this.slice_duration,this.littleEndian),n.setFloat64(216,this.toffset,this.littleEndian),n.setBigInt64(224,BigInt(this.slice_start),this.littleEndian),n.setBigInt64(232,BigInt(this.slice_end),this.littleEndian),s.set(new TextEncoder().encode(this.description),240),s.set(new TextEncoder().encode(this.aux_file),320),n.setInt32(344,this.qform_code,this.littleEndian),n.setInt32(348,this.sform_code,this.littleEndian),n.setFloat64(352,this.quatern_b,this.littleEndian),n.setFloat64(360,this.quatern_c,this.littleEndian),n.setFloat64(368,this.quatern_d,this.littleEndian),n.setFloat64(376,this.qoffset_x,this.littleEndian),n.setFloat64(384,this.qoffset_y,this.littleEndian),n.setFloat64(392,this.qoffset_z,this.littleEndian);const o=this.affine.flat();for(let c=0;c<12;c++)n.setFloat64(400+8*c,o[c],this.littleEndian);if(n.setInt32(496,this.slice_code,this.littleEndian),n.setInt32(500,this.xyzt_units,this.littleEndian),n.setInt32(504,this.intent_code,this.littleEndian),s.set(new TextEncoder().encode(this.intent_name),508),n.setUint8(524,this.dim_info),e){s.set(Uint8Array.from([1,0,0,0]),540);let c=this.getExtensionLocation();for(const l of this.extensions)n.setInt32(c,l.esize,l.littleEndian),n.setInt32(c+4,l.ecode,l.littleEndian),s.set(new Uint8Array(l.edata),c+8),c+=l.esize}else s.set(new Uint8Array(4).fill(0),540);return s.buffer}};K(Pt,"MAGIC_COOKIE",540),K(Pt,"MAGIC_NUMBER_LOCATION",4),K(Pt,"MAGIC_NUMBER",[110,43,50,0,13,10,26,10]),K(Pt,"MAGIC_NUMBER2",[110,105,50,0,13,10,26,10]);let ft=Pt;function Wf(a,e=!1){var t,i,r,s;return a.byteLength<pe.STANDARD_HEADER_SIZE?!1:(t=new DataView(a),t&&(i=t.getUint8(pe.MAGIC_NUMBER_LOCATION)),r=t.getUint8(pe.MAGIC_NUMBER_LOCATION+1),s=t.getUint8(pe.MAGIC_NUMBER_LOCATION+2),e&&i===pe.MAGIC_NUMBER2[0]&&r===pe.MAGIC_NUMBER2[1]&&s===pe.MAGIC_NUMBER2[2]?!0:i===pe.MAGIC_NUMBER[0]&&r===pe.MAGIC_NUMBER[1]&&s===pe.MAGIC_NUMBER[2])}function Yf(a,e=!1){var t,i,r,s;return a.byteLength<pe.STANDARD_HEADER_SIZE?!1:(t=new DataView(a),i=t.getUint8(ft.MAGIC_NUMBER_LOCATION),r=t.getUint8(ft.MAGIC_NUMBER_LOCATION+1),s=t.getUint8(ft.MAGIC_NUMBER_LOCATION+2),e&&i===ft.MAGIC_NUMBER2[0]&&r===ft.MAGIC_NUMBER2[1]&&s===ft.MAGIC_NUMBER2[2]?!0:i===ft.MAGIC_NUMBER[0]&&r===ft.MAGIC_NUMBER[1]&&s===ft.MAGIC_NUMBER[2])}function Mo(a){var e,t,i;return!!(a&&(e=new DataView(a),t=e.getUint8(0),i=e.getUint8(1),t===te.GUNZIP_MAGIC_COOKIE1||i===te.GUNZIP_MAGIC_COOKIE2))}function Xf(a){return Kf(new Uint8Array(a)).buffer}async function Qf(a){const e=new Uint8Array(a),t=e[0]===31&&e[1]===139&&e[2]===8?"gzip":e[0]===120&&(e[1]===1||e[1]===94||e[1]===156||e[1]===218)?"deflate":"deflate-raw",i=new DecompressionStream(t),r=i.writable.getWriter();r.write(e).catch(console.error);const s=r.close().catch(console.error),o=await new Response(i.readable).arrayBuffer();return await s,o}async function Xc(a,e=1/0){const t=u=>u[0]===31&&u[1]===139&&u[2]===8?"gzip":u[0]===120&&[1,94,156,218].includes(u[1])?"deflate":"deflate-raw",i=new Uint8Array(a),r=t(i),s=new DecompressionStream(r),n=new TransformStream({transform(u,m){m.enqueue(u)},flush(u){u.terminate()}}),{readable:o,writable:c}=s,l=c.getWriter(),h=o.pipeThrough(n).getReader();l.write(i).catch(u=>{u instanceof Error&&u.name==="AbortError"||console.error("Error during write:",u)});const d=[];let f=0;try{for(;f<e;){const{done:u,value:m}=await h.read();if(u)break;const p=e-f,g=m.subarray(0,Math.min(m.length,p));if(d.push(g),f+=g.length,f>=e){await Promise.all([h.cancel().catch(()=>{}),l.abort().catch(()=>{})]);break}}}catch(u){u instanceof Error&&u.name==="AbortError"||console.error("Error during decompression:",u)}finally{await Promise.allSettled([h.cancel().catch(()=>{}),l.close().catch(()=>{})])}return d.length===1?d[0].buffer:d.reduce((u,m)=>{const p=new Uint8Array(u.byteLength+m.byteLength);return p.set(new Uint8Array(u),0),p.set(m,u.byteLength),p.buffer},new ArrayBuffer(0))}function Jf(a,e=!1){let t=null;if(Mo(a)&&(a=Xf(a)),Wf(a,e)?t=new pe:Yf(a,e)&&(t=new ft),t)t.readHeader(a);else throw new Error("That file does not appear to be NIFTI!");return t}async function $r(a,e=!1){if(!Mo(a))return Jf(a,e);let t=null,i=await Xc(a,540),r=!0,s=!0;var n=new DataView(i);const o=n.getInt32(0,!0),c=n.getInt32(0,!1);if(o!==348)if(c===348)r=!1;else if(o===540)s=!1;else if(c===540)s=!1,r=!1;else throw new Error("That file does not appear to be NIFTI!");let l=Math.round(n.getFloat32(108,r));return ft&&(l=te.getUint64At(n,168,r)),l>i.byteLength&&(i=await Xc(a,l)),s?t=new pe:t=new ft,t.readHeader(i),t}function Zf(a){return a.extensionFlag[0]!=0}function Qc(a,e){var t=a.vox_offset,i=1,r=1;a.dims[4]&&(i=a.dims[4]),a.dims[5]&&(r=a.dims[5]);var s=a.dims[1]*a.dims[2]*a.dims[3]*i*r*(a.numBitsPerVoxel/8);return e.slice(t,t+s)}function yh(a,e,t,i={}){return e!==void 0&&t!==void 0&&(i={...i,headers:{...i.headers,Range:`bytes=${e}-${e+t-1}`}}),fetch(a,i)}function $f(a,e){return{...a,...e,headers:{...a.headers,...e.headers}}}function Jc(a,e){const t=typeof a=="string"?new URL(a):a;t.pathname.endsWith("/")||(t.pathname+="/");const i=new URL(e.slice(1),t);return i.search=t.search,i}async function Zc(a){if(a.status!==404){if(a.status===200||a.status===206)return new Uint8Array(await a.arrayBuffer());throw new Error(`Unexpected response status ${a.status} ${a.statusText}`)}}async function eu(a,e,t,i){if(i)return fetch(a,{...t,headers:{...t.headers,Range:`bytes=-${e}`}});let r=await fetch(a,{...t,method:"HEAD"});if(!r.ok)return r;let s=r.headers.get("Content-Length"),n=Number(s);return yh(a,n-e,n,t)}var As,ys,xs,to;class tu{constructor(e,t={}){He(this,xs);K(this,"url");He(this,As);He(this,ys);this.url=e,Oe(this,As,t.overrides??{}),Oe(this,ys,t.useSuffixRequest??!1)}async get(e,t={}){let i=Jc(this.url,e).href,r=await fetch(i,Dn(this,xs,to).call(this,t));return Zc(r)}async getRange(e,t,i={}){let r=Jc(this.url,e),s=Dn(this,xs,to).call(this,i),n;return"suffixLength"in t?n=await eu(r,t.suffixLength,s,me(this,ys)):n=await yh(r,t.offset,t.length,s),Zc(n)}}As=new WeakMap,ys=new WeakMap,xs=new WeakSet,to=function(e){return $f(me(this,As),e)};const au="modulepreload",iu=function(a,e){return new URL(a,e).href},$c={},cs=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let n=function(h){return Promise.all(h.map(d=>Promise.resolve(d).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};const o=document.getElementsByTagName("link"),c=document.querySelector("meta[property=csp-nonce]"),l=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));r=n(t.map(h=>{if(h=iu(h,i),h in $c)return;$c[h]=!0;const d=h.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(!!i)for(let p=o.length-1;p>=0;p--){const g=o[p];if(g.href===h&&(!d||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${f}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":au,d||(m.as="script"),m.crossOrigin="",m.href=h,l&&m.setAttribute("nonce",l),document.head.appendChild(m),d)return new Promise((p,g)=>{m.addEventListener("load",p),m.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(n){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=n,window.dispatchEvent(o),!o.defaultPrevented)throw n}return r.then(n=>{for(const o of n||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};var yt;class xh{constructor(e,t,i){He(this,yt);typeof e=="number"?Oe(this,yt,new Uint8Array(e)):e instanceof ArrayBuffer?Oe(this,yt,new Uint8Array(e,t,i)):Oe(this,yt,new Uint8Array(Array.from(e,r=>r?1:0)))}get BYTES_PER_ELEMENT(){return 1}get byteOffset(){return me(this,yt).byteOffset}get byteLength(){return me(this,yt).byteLength}get buffer(){return me(this,yt).buffer}get length(){return me(this,yt).length}get(e){let t=me(this,yt)[e];return typeof t=="number"?t!==0:t}set(e,t){me(this,yt)[e]=t?1:0}fill(e){me(this,yt).fill(e?1:0)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}yt=new WeakMap;var $a;class Co{constructor(e,t,i,r){K(this,"_data");K(this,"chars");He(this,$a);if(this.chars=e,Oe(this,$a,new TextEncoder),typeof t=="number")this._data=new Uint8Array(t*e);else if(t instanceof ArrayBuffer)r&&(r=r*e),this._data=new Uint8Array(t,i,r);else{let s=Array.from(t);this._data=new Uint8Array(s.length*e);for(let n=0;n<s.length;n++)this.set(n,s[n])}}get BYTES_PER_ELEMENT(){return this.chars}get byteOffset(){return this._data.byteOffset}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get length(){return this.byteLength/this.BYTES_PER_ELEMENT}get(e){const t=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);return new TextDecoder().decode(t).replace(/\x00/g,"")}set(e,t){const i=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);i.fill(0),i.set(me(this,$a).encode(t))}fill(e){const t=me(this,$a).encode(e);for(let i=0;i<this.length;i++)this._data.set(t,i*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}$a=new WeakMap;var tt;const Ko=class Ko{constructor(e,t,i,r){He(this,tt);K(this,"chars");if(this.chars=e,typeof t=="number")Oe(this,tt,new Int32Array(t*e));else if(t instanceof ArrayBuffer)r&&(r*=e),Oe(this,tt,new Int32Array(t,i,r));else{const s=t,n=new Ko(e,1);Oe(this,tt,new Int32Array((function*(){for(let o of s)n.set(0,o),yield*me(n,tt)})()))}}get BYTES_PER_ELEMENT(){return me(this,tt).BYTES_PER_ELEMENT*this.chars}get byteLength(){return me(this,tt).byteLength}get byteOffset(){return me(this,tt).byteOffset}get buffer(){return me(this,tt).buffer}get length(){return me(this,tt).length/this.chars}get(e){const t=this.chars*e;let i="";for(let r=0;r<this.chars;r++)i+=String.fromCodePoint(me(this,tt)[t+r]);return i.replace(/\u0000/g,"")}set(e,t){const i=this.chars*e,r=me(this,tt).subarray(i,i+this.chars);r.fill(0);for(let s=0;s<this.chars;s++)r[s]=t.codePointAt(s)??0}fill(e){this.set(0,e);let t=me(this,tt).subarray(0,this.chars);for(let i=1;i<this.length;i++)me(this,tt).set(t,i*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}};tt=new WeakMap;let us=Ko;function Fs(a){const e=new TextDecoder().decode(a);return JSON.parse(e)}function el(a,e){const t=e/2,i=e-1;let r=0;for(let s=0;s<a.length;s+=e)for(let n=0;n<t;n+=1)r=a[s+n],a[s+n]=a[s+i-n],a[s+i-n]=r}function wh(a){if(a==="v2:object")return globalThis.Array;let e=a.match(/v2:([US])(\d+)/);if(e){let[,i,r]=e;return(i==="U"?us:Co).bind(null,Number(r))}let t={int8:Int8Array,int16:Int16Array,int32:Int32Array,int64:globalThis.BigInt64Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,uint64:globalThis.BigUint64Array,float16:globalThis.Float16Array,float32:Float32Array,float64:Float64Array,bool:xh}[a];return Ye(t,`Unknown or unsupported data_type: ${a}`),t}function Ua(a,e){const t=a.length;typeof e=="string"&&(e=e==="C"?Array.from({length:t},(s,n)=>n):Array.from({length:t},(s,n)=>t-1-n)),Ye(t===e.length,"Order length must match the number of dimensions.");let i=1,r=new Array(t);for(let s=e.length-1;s>=0;s--)r[e[s]]=i,i*=a[e[s]];return r}function ru({name:a,configuration:e}){if(a==="default"){const t=(e==null?void 0:e.separator)??"/";return i=>["c",...i].join(t)}if(a==="v2"){const t=(e==null?void 0:e.separator)??".";return i=>i.join(t)||"0"}throw new Error(`Unknown chunk key encoding: ${a}`)}function su(a){if(a==="|O")return{data_type:"v2:object"};let e=a.match(/^([<|>])(.*)$/);Ye(e,`Invalid dtype: ${a}`);let[,t,i]=e,r={b1:"bool",i1:"int8",u1:"uint8",i2:"int16",u2:"uint16",i4:"int32",u4:"uint32",i8:"int64",u8:"uint64",f2:"float16",f4:"float32",f8:"float64"}[i]??(i.startsWith("S")||i.startsWith("U")?`v2:${i}`:void 0);return Ye(r,`Unsupported or unknown dtype: ${a}`),t==="|"?{data_type:r}:{data_type:r,endian:t==="<"?"little":"big"}}function nu(a,e={}){let t=[],i=su(a.dtype);a.order==="F"&&t.push({name:"transpose",configuration:{order:"F"}}),"endian"in i&&i.endian==="big"&&t.push({name:"bytes",configuration:{endian:"big"}});for(let{id:r,...s}of a.filters??[])t.push({name:r,configuration:s});if(a.compressor){let{id:r,...s}=a.compressor;t.push({name:r,configuration:s})}return{zarr_format:3,node_type:"array",shape:a.shape,data_type:i.data_type,chunk_grid:{name:"regular",configuration:{chunk_shape:a.chunks}},chunk_key_encoding:{name:"v2",configuration:{separator:a.dimension_separator??"."}},codecs:t,fill_value:a.fill_value,attributes:e}}function ou(a,e={}){return{zarr_format:3,node_type:"group",attributes:e}}function cu(a,e){if(e!=="number"&&e!=="bigint"&&e!=="boolean"&&e!=="object"&&e!=="string")return a===e;let t=a==="bool";if(e==="boolean")return t;let i=a.startsWith("v2:U")||a.startsWith("v2:S");if(e==="string")return i;let r=a==="int64"||a==="uint64";if(e==="bigint")return r;let s=a==="v2:object";return e==="object"?s:!i&&!r&&!t&&!s}function lu(a){return(a==null?void 0:a.name)==="sharding_indexed"}function vh(a){return(a.data_type==="uint64"||a.data_type==="int64")&&a.fill_value!=null?BigInt(a.fill_value):a.fill_value}function Eh(a,...e){if(!e.some(t=>a instanceof t))throw a}function Ye(a,e=""){if(!a)throw new Error(e)}async function Th(a,{format:e,signal:t}){const i=a instanceof Response?a:new Response(a);Ye(i.body,"Response does not contain body.");try{return await new Response(i.body.pipeThrough(new DecompressionStream(e),{signal:t})).arrayBuffer()}catch{throw t==null||t.throwIfAborted(),new Error(`Failed to decode ${e}`)}}class Do{constructor(e,t){K(this,"kind","array_to_array");Ye(e.keepbits>=0,"keepbits must be zero or positive")}static fromConfig(e,t){return new Do(e,t)}encode(e){throw new Error("`BitroundCodec.encode` is not implemented. Please open an issue at https://github.com/manzt/zarrita.js/issues.")}decode(e){return e}}const tl=hu();function hu(){const a=new Uint32Array([305419896]);return new Uint8Array(a.buffer,a.byteOffset,a.byteLength)[0]!==18}function al(a){return"BYTES_PER_ELEMENT"in a?a.BYTES_PER_ELEMENT:4}var ws,ba,vs,Es,ei;const Ho=class Ho{constructor(e,t){K(this,"kind","array_to_bytes");He(this,ws);He(this,ba);He(this,vs);He(this,Es);He(this,ei);Oe(this,ei,e==null?void 0:e.endian),Oe(this,ba,wh(t.data_type)),Oe(this,Es,t.shape),Oe(this,ws,Ua(t.shape,"C"));const i=new(me(this,ba))(0);Oe(this,vs,i.BYTES_PER_ELEMENT)}static fromConfig(e,t){return new Ho(e,t)}encode(e){let t=new Uint8Array(e.data.buffer);return tl&&me(this,ei)==="big"&&el(t,al(me(this,ba))),t}decode(e){return tl&&me(this,ei)==="big"&&el(e,al(me(this,ba))),{data:new(me(this,ba))(e.buffer,e.byteOffset,e.byteLength/me(this,vs)),shape:me(this,Es),stride:me(this,ws)}}};ws=new WeakMap,ba=new WeakMap,vs=new WeakMap,Es=new WeakMap,ei=new WeakMap;let un=Ho;class _o{constructor(){K(this,"kind","bytes_to_bytes")}static fromConfig(){return new _o}encode(e){throw new Error("Not implemented")}decode(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength-4)}}class So{constructor(){K(this,"kind","bytes_to_bytes")}static fromConfig(e){return new So}encode(e){throw new Error("Gzip encoding is not enabled by default. Please register a custom codec with `numcodecs/gzip`.")}async decode(e){const t=await Th(e,{format:"gzip"});return new Uint8Array(t)}}function du(a,e){return Ye(!Number.isNaN(e),"JsonCodec allow_nan is false but NaN was encountered during encoding."),Ye(e!==Number.POSITIVE_INFINITY,"JsonCodec allow_nan is false but Infinity was encountered during encoding."),Ye(e!==Number.NEGATIVE_INFINITY,"JsonCodec allow_nan is false but -Infinity was encountered during encoding."),e}function fu(a,e){return e instanceof Object&&!Array.isArray(e)?Object.keys(e).sort().reduce((t,i)=>(t[i]=e[i],t),{}):e}var Ts,Is;const qo=class qo{constructor(e={}){K(this,"configuration");K(this,"kind","array_to_bytes");He(this,Ts);He(this,Is);this.configuration=e;const{encoding:t="utf-8",skipkeys:i=!1,ensure_ascii:r=!0,check_circular:s=!0,allow_nan:n=!0,sort_keys:o=!0,indent:c,strict:l=!0}=e;let h=e.separators;h||(c?h=[", ",": "]:h=[",",":"]),Oe(this,Ts,{encoding:t,skipkeys:i,ensure_ascii:r,check_circular:s,allow_nan:n,indent:c,separators:h,sort_keys:o}),Oe(this,Is,{strict:l})}static fromConfig(e){return new qo(e)}encode(e){const{indent:t,encoding:i,ensure_ascii:r,check_circular:s,allow_nan:n,sort_keys:o}=me(this,Ts);Ye(i==="utf-8","JsonCodec does not yet support non-utf-8 encoding.");const c=[];Ye(s,"JsonCodec does not yet support skipping the check for circular references during encoding."),n||c.push(du),o&&c.push(fu);const l=Array.from(e.data);l.push("|O"),l.push(e.shape);let h;c.length&&(h=(f,u)=>{let m=u;for(let p of c)m=p(f,m);return m});let d=JSON.stringify(l,h,t);return r&&(d=d.replace(/[\u007F-\uFFFF]/g,f=>{const u=`0000${f.charCodeAt(0).toString(16)}`;return`\\u${u.substring(u.length-4)}`})),new TextEncoder().encode(d)}decode(e){const{strict:t}=me(this,Is);Ye(t,"JsonCodec does not yet support non-strict decoding.");const i=Fs(e),r=i.pop();i.pop(),Ye(r,"0D not implemented for JsonCodec.");const s=Ua(r,"C");return{data:i,shape:r,stride:s}}};Ts=new WeakMap,Is=new WeakMap;let ao=qo;function il(a){return a instanceof xh||a instanceof Co||a instanceof us?new Proxy(a,{get(t,i){return t.get(Number(i))},set(t,i,r){return t.set(Number(i),r),!0}}):a}function uu(a,e){let t;return a.data instanceof Co||a.data instanceof us?t=new a.constructor(a.data.length,a.data.chars):t=new a.constructor(a.data.length),{data:t,shape:a.shape,stride:Ua(a.shape,e)}}function bu(a,e){let t=uu(a,e),i=a.shape.length,r=a.data.length,s=Array(i).fill(0),n=il(a.data),o=il(t.data);for(let c=0;c<r;c++){let l=0;for(let h=0;h<i;h++)l+=s[h]*t.stride[h];o[l]=n[c],s[0]+=1;for(let h=0;h<i;h++)if(s[h]===a.shape[h]){if(h+1===i)break;s[h]=0,s[h+1]+=1}}return t}function pu(a){let e=a.shape.length;return Ye(e===a.stride.length,"Shape and stride must have the same length."),a.stride.map((t,i)=>({stride:t,index:i})).sort((t,i)=>i.stride-t.stride).map(t=>t.index)}function mu(a,e){let t=pu(a);return Ye(t.length===e.length,"Orders must match"),t.every((i,r)=>i===e[r])}var Ms,ti;const Wo=class Wo{constructor(e,t){K(this,"kind","array_to_array");He(this,Ms);He(this,ti);let i=e.order??"C",r=t.shape.length,s=new Array(r),n=new Array(r);if(i==="C")for(let o=0;o<r;++o)s[o]=o,n[o]=o;else if(i==="F")for(let o=0;o<r;++o)s[o]=r-o-1,n[o]=r-o-1;else s=i,s.forEach((o,c)=>{Ye(n[o]===void 0,`Invalid permutation: ${JSON.stringify(i)}`),n[o]=c});Oe(this,Ms,s),Oe(this,ti,n)}static fromConfig(e,t){return new Wo(e,t)}encode(e){return mu(e,me(this,ti))?e:bu(e,me(this,ti))}decode(e){return{data:e.data,shape:e.shape,stride:Ua(e.shape,me(this,Ms))}}};Ms=new WeakMap,ti=new WeakMap;let io=Wo;var Cs,Ds;const Yo=class Yo{constructor(e){K(this,"kind","array_to_bytes");He(this,Cs);He(this,Ds);Oe(this,Cs,e),Oe(this,Ds,Ua(e,"C"))}static fromConfig(e,t){return new Yo(t.shape)}encode(e){throw new Error("Method not implemented.")}decode(e){let t=new TextDecoder,i=new DataView(e.buffer),r=Array(i.getUint32(0,!0)),s=4;for(let n=0;n<r.length;n++){let o=i.getUint32(s,!0);s+=4,r[n]=t.decode(e.buffer.slice(s,s+o)),s+=o}return{data:r,shape:me(this,Cs),stride:me(this,Ds)}}};Cs=new WeakMap,Ds=new WeakMap;let ro=Yo;class Fo{constructor(){K(this,"kind","bytes_to_bytes")}static fromConfig(e){return new Fo}encode(e){throw new Error("Zlib encoding is not enabled by default. Please register a codec with `numcodecs/zlib`.")}async decode(e){const t=await Th(e,{format:"deflate"});return new Uint8Array(t)}}function gu(){return new Map().set("blosc",()=>cs(()=>import("./blosc-eOvwLB0b.js"),__vite__mapDeps([0,1]),import.meta.url).then(a=>a.default)).set("lz4",()=>cs(()=>import("./lz4-DMxY7r4t.js"),__vite__mapDeps([2,1]),import.meta.url).then(a=>a.default)).set("zstd",()=>cs(()=>import("./zstd-qZ8jC7Re.js"),__vite__mapDeps([3,1]),import.meta.url).then(a=>a.default)).set("gzip",()=>So).set("zlib",()=>Fo).set("transpose",()=>io).set("bytes",()=>un).set("crc32c",()=>_o).set("vlen-utf8",()=>ro).set("json2",()=>ao).set("bitround",()=>Do)}const Au=gu();function so(a){let e;return{async encode(t){e||(e=await rl(a));for(const r of e.array_to_array)t=await r.encode(t);let i=await e.array_to_bytes.encode(t);for(const r of e.bytes_to_bytes)i=await r.encode(i);return i},async decode(t){e||(e=await rl(a));for(let r=e.bytes_to_bytes.length-1;r>=0;r--)t=await e.bytes_to_bytes[r].decode(t);let i=await e.array_to_bytes.decode(t);for(let r=e.array_to_array.length-1;r>=0;r--)i=await e.array_to_array[r].decode(i);return i}}}async function rl(a){let e=a.codecs.map(async s=>{var o;let n=await((o=Au.get(s.name))==null?void 0:o());return Ye(n,`Unknown codec: ${s.name}`),{Codec:n,meta:s}}),t=[],i,r=[];for await(let{Codec:s,meta:n}of e){let o=s.fromConfig(n.configuration,a);switch(o.kind){case"array_to_array":t.push(o);break;case"array_to_bytes":i=o;break;default:r.push(o)}}return i||(Ye(yu(a),`Cannot encode ${a.data_type} to bytes without a codec`),i=un.fromConfig({endian:"little"},a)),{array_to_array:t,array_to_bytes:i,bytes_to_bytes:r}}function yu(a){return a.data_type!=="v2:object"}class Rs extends Error{constructor(e,t={}){super(`Node not found: ${e}`,t),this.name="NodeNotFoundError"}}class Ro extends Error{constructor(e){super(`Missing key: ${e}`),this.name="KeyError"}}const sl=18446744073709551615n;function xu(a,e,t,i){Ye(a.store.getRange,"Store does not support range requests");let r=a.store.getRange.bind(a.store),s=e.map((c,l)=>c/i.chunk_shape[l]),n=so({data_type:"uint64",shape:[...s,2],codecs:i.index_codecs}),o={};return async c=>{let l=c.map((A,y)=>Math.floor(A/s[y])),h=a.resolve(t(l)).path,d;if(h in o)d=o[h];else{let A=4,y=16*s.reduce((E,I)=>E*I,1),x=await r(h,{suffixLength:y+A});d=o[h]=x?await n.decode(x):null}if(d===null)return;let{data:f,shape:u,stride:m}=d,p=c.map((A,y)=>A%u[y]).reduce((A,y,x)=>A+y*m[x],0),g=f[p],b=f[p+1];if(!(g===sl&&b===sl))return r(h,{offset:Number(g),length:Number(b)})}}class Va{constructor(e,t="/"){K(this,"store");K(this,"path");this.store=e,this.path=t}resolve(e){let t=new URL(`file://${this.path.endsWith("/")?this.path:`${this.path}/`}`);return new Va(this.store,decodeURIComponent(new URL(e,t).pathname))}}function wu(a){return new Va(a??new Map)}var _s;class No extends Va{constructor(t,i,r){super(t,i);K(this,"kind","group");He(this,_s);Oe(this,_s,r)}get attrs(){return me(this,_s).attributes}}_s=new WeakMap;function nl(a){var t;const e=a.find(i=>i.name==="transpose");return((t=e==null?void 0:e.configuration)==null?void 0:t.order)??"C"}const es=Symbol("zarrita.context");function vu(a){return a[es]}function Eu(a,e){let{configuration:t}=e.codecs.find(lu)??{},i={encode_chunk_key:ru(e.chunk_key_encoding),TypedArray:wh(e.data_type),fill_value:e.fill_value};if(t){let s=nl(t.codecs);return{...i,kind:"sharded",chunk_shape:t.chunk_shape,codec:so({data_type:e.data_type,shape:t.chunk_shape,codecs:t.codecs}),get_strides(n){return Ua(n,s)},get_chunk_bytes:xu(a,e.chunk_grid.configuration.chunk_shape,i.encode_chunk_key,t)}}let r=nl(e.codecs);return{...i,kind:"regular",chunk_shape:e.chunk_grid.configuration.chunk_shape,codec:so({data_type:e.data_type,shape:e.chunk_grid.configuration.chunk_shape,codecs:e.codecs}),get_strides(s){return Ua(s,r)},async get_chunk_bytes(s,n){let o=i.encode_chunk_key(s),c=a.resolve(o).path;return a.store.get(c,n)}}}var eh,th,Na,ah;let bn=(ah=class extends(th=Va,eh=es,th){constructor(t,i,r){super(t,i);K(this,"kind","array");He(this,Na);K(this,eh);Oe(this,Na,{...r,fill_value:vh(r)}),this[es]=Eu(this,r)}get attrs(){return me(this,Na).attributes}get shape(){return me(this,Na).shape}get chunks(){return this[es].chunk_shape}get dtype(){return me(this,Na).data_type}async getChunk(t,i){let r=this[es],s=await r.get_chunk_bytes(t,i);if(!s){let n=r.chunk_shape.reduce((c,l)=>c*l,1),o=new r.TypedArray(n);return o.fill(r.fill_value),{data:o,shape:r.chunk_shape,stride:r.get_strides(r.chunk_shape)}}return r.codec.decode(s)}is(t){return cu(this.dtype,t)}},Na=new WeakMap,ah);function*Tu(a,e,t=1){e===void 0&&(e=a,a=0);for(let i=a;i<e;i+=t)yield i}function*Iu(...a){if(a.length===0)return;const e=a.map(i=>i[Symbol.iterator]()),t=e.map(i=>i.next());if(t.some(i=>i.done))throw new Error("Input contains an empty iterator.");for(let i=0;;){if(t[i].done){if(e[i]=a[i][Symbol.iterator](),t[i]=e[i].next(),++i>=e.length)return}else yield t.map(({value:r})=>r),i=0;t[i]=e[i].next()}}function Mu({start:a,stop:e,step:t},i){if(t===0)throw new Error("slice step cannot be zero");t=t??1;const r=t<0,[s,n]=r?[-1,i-1]:[0,i];return a===null?a=r?n:s:a<0?(a+=i,a<s&&(a=s)):a>n&&(a=n),e===null?e=r?s:n:e<0?(e+=i,e<s&&(e=s)):e>n&&(e=n),[a,e,t]}function ls(a,e,t=null){return e===void 0&&(e=a,a=null),{start:a,stop:e,step:t}}function Cu(){const a=[];return{add:e=>a.push(e()),onIdle:()=>Promise.all(a)}}class ko extends Error{constructor(e){super(e),this.name="IndexError"}}function Du(a,e){throw new ko(`too many indicies for array; expected ${e.length}, got ${a.length}`)}function _u(a){throw new ko(`index out of bounds for dimension with length ${a}`)}function Su(){throw new ko("only slices with step >= 1 are supported")}function Fu(a,e){a.length>e.length&&Du(a,e)}function Ru(a,e){return a=Math.trunc(a),a<0&&(a=e+a),(a>=e||a<0)&&_u(e),a}class Nu{constructor({dim_sel:e,dim_len:t,dim_chunk_len:i}){K(this,"dim_sel");K(this,"dim_len");K(this,"dim_chunk_len");K(this,"nitems");e=Ru(e,t),this.dim_sel=e,this.dim_len=t,this.dim_chunk_len=i,this.nitems=1}*[Symbol.iterator](){const e=Math.floor(this.dim_sel/this.dim_chunk_len),t=e*this.dim_chunk_len,i=this.dim_sel-t;yield{dim_chunk_ix:e,dim_chunk_sel:i}}}class ol{constructor({dim_sel:e,dim_len:t,dim_chunk_len:i}){K(this,"start");K(this,"stop");K(this,"step");K(this,"dim_len");K(this,"dim_chunk_len");K(this,"nitems");K(this,"nchunks");const[r,s,n]=Mu(e,t);this.start=r,this.stop=s,this.step=n,this.step<1&&Su(),this.dim_len=t,this.dim_chunk_len=i,this.nitems=Math.max(0,Math.ceil((this.stop-this.start)/this.step)),this.nchunks=Math.ceil(this.dim_len/this.dim_chunk_len)}*[Symbol.iterator](){const e=Math.floor(this.start/this.dim_chunk_len),t=Math.ceil(this.stop/this.dim_chunk_len);for(const i of Tu(e,t)){const r=i*this.dim_chunk_len,s=Math.min(this.dim_len,(i+1)*this.dim_chunk_len),n=s-r;let o=0,c=0;if(this.start<r){const u=(r-this.start)%this.step;u&&(c+=this.step-u),o=Math.ceil((r-this.start)/this.step)}else c=this.start-r;const l=this.stop>s?n:this.stop-r,h=[c,l,this.step],d=Math.ceil((l-c)/this.step),f=[o,o+d,1];yield{dim_chunk_ix:i,dim_chunk_sel:h,dim_out_sel:f}}}}function ku(a,e){let t=[];return a===null?t=e.map(i=>ls(null)):Array.isArray(a)&&(t=a.map(i=>i??ls(null))),Fu(t,e),t}class Uu{constructor({selection:e,shape:t,chunk_shape:i}){K(this,"dim_indexers");K(this,"shape");this.dim_indexers=ku(e,t).map((r,s)=>new(typeof r=="number"?Nu:ol)({dim_sel:r,dim_len:t[s],dim_chunk_len:i[s]})),this.shape=this.dim_indexers.filter(r=>r instanceof ol).map(r=>r.nitems)}*[Symbol.iterator](){for(const e of Iu(...this.dim_indexers)){const t=e.map(r=>r.dim_chunk_ix),i=e.map(r=>"dim_out_sel"in r?{from:r.dim_chunk_sel,to:r.dim_out_sel}:{from:r.dim_chunk_sel,to:null});yield{chunk_coords:t,mapping:i}}}}function ju(a,e){return"get"in a?a.get(e):a[e]}async function Bu(a,e,t,i){var c;let r=vu(a),s=new Uu({selection:e,shape:a.shape,chunk_shape:a.chunks}),n=i.prepare(new r.TypedArray(s.shape.reduce((l,h)=>l*h,1)),s.shape,r.get_strides(s.shape)),o=((c=t.create_queue)==null?void 0:c.call(t))??Cu();for(const{chunk_coords:l,mapping:h}of s)o.add(async()=>{let{data:d,shape:f,stride:u}=await a.getChunk(l,t.opts),m=i.prepare(d,f,u);i.set_from_chunk(n,m,h)});return await o.onIdle(),s.shape.length===0?ju(n.data,0):n}function Uo(a,e=0,t){let i=t??a.length-e;return{length:i,subarray(r,s=i){return Uo(a,e+r,s-r)},set(r,s=0){for(let n=0;n<r.length;n++)a[e+s+n]=r.get(n)},get(r){return a[e+r]}}}function kn(a){return globalThis.Array.isArray(a.data)?{data:Uo(a.data),stride:a.stride,bytes_per_element:1}:{data:new Uint8Array(a.data.buffer,a.data.byteOffset,a.data.byteLength),stride:a.stride,bytes_per_element:a.data.BYTES_PER_ELEMENT}}function Pu(a){return"chars"in a?a.constructor.bind(null,a.chars):a.constructor}function Ou(a,e){if(globalThis.Array.isArray(a.data))return Uo([e]);let t=Pu(a.data),i=new t([e]);return new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}const Vu={prepare(a,e,t){return{data:a,shape:e,stride:t}},set_scalar(a,e,t){let i=kn(a);no(i,e,Ou(a,t),i.bytes_per_element)},set_from_chunk(a,e,t){let i=kn(a);an(i,kn(e),i.bytes_per_element,t)}};async function cl(a,e=null,t={}){return Bu(a,e,t,Vu)}function Ih(a,e,t){return t<0&&e<a?Math.floor((a-e-1)/-t)+1:a<e?Math.floor((e-a-1)/t)+1:0}function no(a,e,t,i){if(e.length===0){a.data.set(t,0);return}const[r,...s]=e,[n,...o]=a.stride;if(typeof r=="number"){const f=a.data.subarray(n*r*i);no({data:f,stride:o},s,t,i);return}const[c,l,h]=r,d=Ih(c,l,h);if(s.length===0){for(let f=0;f<d;f++)a.data.set(t,n*(c+h*f)*i);return}for(let f=0;f<d;f++){const u=a.data.subarray(n*(c+h*f)*i);no({data:u,stride:o},s,t,i)}}function an(a,e,t,i){const[r,...s]=i,[n,...o]=a.stride,[c,...l]=e.stride;if(r.from===null){if(s.length===0){a.data.set(e.data.subarray(0,t),r.to*t);return}an({data:a.data.subarray(n*r.to*t),stride:o},e,t,s);return}if(r.to===null){if(s.length===0){let b=r.from*t;a.data.set(e.data.subarray(b,b+t),0);return}an(a,{data:e.data.subarray(c*r.from*t),stride:l},t,s);return}const[h,d,f]=r.to,[u,m,p]=r.from,g=Ih(h,d,f);if(s.length===0){if(f===1&&p===1&&n===1&&c===1){let b=u*t,A=g*t;a.data.set(e.data.subarray(b,b+A),h*t);return}for(let b=0;b<g;b++){let A=c*(u+p*b)*t;a.data.set(e.data.subarray(A,A+t),n*(h+f*b)*t)}return}for(let b=0;b<g;b++)an({data:a.data.subarray(n*(h+b*f)*t),stride:o},{data:e.data.subarray(c*(u+b*p)*t),stride:l},t,s)}let vn=Lu();function Lu(){let a=new WeakMap;function e(t){let i=a.get(t)??{v2:0,v3:0};return a.set(t,i),i}return{increment(t,i){e(t)[i]+=1},version_max(t){let i=e(t);return i.v3>i.v2?"v3":"v2"}}}async function Gu(a){let e=await a.store.get(a.resolve(".zattrs").path);return e?Fs(e):{}}async function zu(a,e={}){let t="store"in a?a:new Va(a),i={};return(e.attrs??!0)&&(i=await Gu(t)),e.kind==="array"?ll(t,i):e.kind==="group"?hl(t,i):ll(t,i).catch(r=>(Eh(r,Rs),hl(t,i)))}async function ll(a,e){let{path:t}=a.resolve(".zarray"),i=await a.store.get(t);if(!i)throw new Rs("v2 array",{cause:new Ro(t)});return vn.increment(a.store,"v2"),new bn(a.store,a.path,nu(Fs(i),e))}async function hl(a,e){let{path:t}=a.resolve(".zgroup"),i=await a.store.get(t);if(!i)throw new Rs("v2 group",{cause:new Ro(t)});return vn.increment(a.store,"v2"),new No(a.store,a.path,ou(Fs(i),e))}async function Ku(a){let{store:e,path:t}=a.resolve("zarr.json"),i=await a.store.get(t);if(!i)throw new Rs("v3 array or group",{cause:new Ro(t)});let r=Fs(i);return r.node_type==="array"&&(r.fill_value=vh(r)),r.node_type==="array"?new bn(e,a.path,r):new No(e,a.path,r)}async function Hu(a,e={}){let t="store"in a?a:new Va(a),i=await Ku(t);if(vn.increment(t.store,"v3"),e.kind===void 0||e.kind==="array"&&i instanceof bn||e.kind==="group"&&i instanceof No)return i;let r=i instanceof bn?"array":"group";throw new Error(`Expected node of kind ${e.kind}, found ${r}.`)}async function ga(a,e={}){let t="store"in a?a.store:a,i=vn.version_max(t),r=i==="v2"?ga.v2:ga.v3,s=i==="v2"?ga.v3:ga.v2;return r(a,e).catch(n=>(Eh(n,Rs),s(a,e)))}ga.v2=zu;ga.v3=Hu;var Mh=Object.defineProperty,Ch=a=>{throw TypeError(a)},qu=(a,e,t)=>e in a?Mh(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,En=(a,e)=>{for(var t in e)Mh(a,t,{get:e[t],enumerable:!0})},U=(a,e,t)=>qu(a,typeof e!="symbol"?e+"":e,t),Dh=(a,e,t)=>e.has(a)||Ch("Cannot "+t),se=(a,e,t)=>(Dh(a,e,"read from private field"),t?t.call(a):e.get(a)),Wa=(a,e,t)=>e.has(a)?Ch("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,t),fa=(a,e,t,i)=>(Dh(a,e,"write to private field"),e.set(a,t),t),Wu={version:"0.65.0"},Yu=new Float32Array([-1,-1,-1,.28,.28,.28,-1,-1,-1,.28,.28,.28,-1,1,-1,.28,.28,.28,1,-1,-1,.28,.28,.28,1,1,-1,.28,.28,.28,1,1,-1,.28,.28,.28,-1,-1,1,.8,.8,.8,-1,-1,1,.8,.8,.8,1,-1,1,.8,.8,.8,-1,1,1,.8,.8,.8,1,1,1,.8,.8,.8,1,1,1,.8,.8,.8,-1,1,-1,0,0,.74,-1,1,-1,0,0,.74,-1,1,1,0,0,.74,1,1,-1,0,0,.74,1,1,1,0,0,.74,1,1,1,0,0,.74,-1,-1,-1,.42,0,.42,-1,-1,-1,.42,0,.42,1,-1,-1,.42,0,.42,-1,-1,1,.42,0,.42,1,-1,1,.42,0,.42,1,-1,1,.42,0,.42,-1,-1,-1,.64,0,0,-1,-1,-1,.64,0,0,-1,-1,1,.64,0,0,-1,1,-1,.64,0,0,-1,1,1,.64,0,0,-1,1,1,.64,0,0,1,-1,-1,0,.5,0,1,-1,-1,0,.5,0,1,1,-1,0,.5,0,1,-1,1,0,.5,0,1,1,1,0,.5,0,1,1,1,0,.5,0,-.45,1,-.8,0,0,0,-.45,1,-.8,0,0,0,-.45,1,.8,0,0,0,-.25,1,-.8,0,0,0,-.25,1,.8,0,0,0,-.25,1,.8,0,0,0,-.25,1,.6,0,0,0,-.25,1,.6,0,0,0,-.25,1,.8,0,0,0,.45,1,.6,0,0,0,.25,1,.8,0,0,0,.25,1,.8,0,0,0,.25,1,.1,0,0,0,.25,1,.1,0,0,0,.25,1,.6,0,0,0,.45,1,.1,0,0,0,.45,1,.6,0,0,0,.45,1,.6,0,0,0,-.25,1,-.1,0,0,0,-.25,1,-.1,0,0,0,-.25,1,.1,0,0,0,.25,1,-.1,0,0,0,.45,1,.1,0,0,0,.45,1,.1,0,0,0,.45,-1,-.8,0,0,0,.45,-1,-.8,0,0,0,.05,-1,.8,0,0,0,.25,-1,-.8,0,0,0,-.15,-1,.8,0,0,0,-.15,-1,.8,0,0,0,-.25,-1,-.8,0,0,0,-.25,-1,-.8,0,0,0,.05,-1,.8,0,0,0,-.45,-1,-.8,0,0,0,-.15,-1,.8,0,0,0,-.15,-1,.8,0,0,0,.13,-1,-.3,0,0,0,.13,-1,-.3,0,0,0,.07,-1,-.1,0,0,0,-.33,-1,-.3,0,0,0,-.27,-1,-.1,0,0,0,-.27,-1,-.1,0,0,0,-.45,.6,1,0,0,0,-.45,.6,1,0,0,0,-.45,.4,1,0,0,0,-.25,.8,1,0,0,0,-.25,.4,1,0,0,0,-.25,.4,1,0,0,0,-.25,.8,1,0,0,0,-.25,.8,1,0,0,0,-.25,.6,1,0,0,0,.25,.8,1,0,0,0,.45,.6,1,0,0,0,.45,.6,1,0,0,0,.25,.8,1,0,0,0,.25,.8,1,0,0,0,.25,-.1,1,0,0,0,.45,.6,1,0,0,0,.45,.1,1,0,0,0,.45,.1,1,0,0,0,-.25,.1,1,0,0,0,-.25,.1,1,0,0,0,-.45,-.1,1,0,0,0,.25,.1,1,0,0,0,.25,-.1,1,0,0,0,.25,-.1,1,0,0,0,-.45,-.1,1,0,0,0,-.45,-.1,1,0,0,0,-.45,-.6,1,0,0,0,-.25,-.1,1,0,0,0,-.25,-.8,1,0,0,0,-.25,-.8,1,0,0,0,-.25,-.6,1,0,0,0,-.25,-.6,1,0,0,0,-.25,-.8,1,0,0,0,.45,-.6,1,0,0,0,.25,-.8,1,0,0,0,.25,-.8,1,0,0,0,.25,-.4,1,0,0,0,.25,-.4,1,0,0,0,.25,-.6,1,0,0,0,.45,-.4,1,0,0,0,.45,-.6,1,0,0,0,.45,-.6,1,0,0,0,-.1,-.8,-1,0,0,0,-.1,-.8,-1,0,0,0,-.1,.8,-1,0,0,0,.1,-.8,-1,0,0,0,.1,.8,-1,0,0,0,.1,.8,-1,0,0,0,-1,-.45,-.8,0,0,0,-1,-.45,-.8,0,0,0,-1,-.45,.8,0,0,0,-1,-.25,-.8,0,0,0,-1,-.25,.8,0,0,0,-1,-.25,.8,0,0,0,-1,-.25,-.8,0,0,0,-1,-.25,-.8,0,0,0,-1,-.25,-.6,0,0,0,-1,.45,-.8,0,0,0,-1,.45,-.6,0,0,0,-1,.45,-.6,0,0,0,1,.45,-.8,0,0,0,1,.45,-.8,0,0,0,1,.45,.8,0,0,0,1,.25,-.8,0,0,0,1,.25,.8,0,0,0,1,.25,.8,0,0,0,1,.25,.6,0,0,0,1,.25,.6,0,0,0,1,.25,.8,0,0,0,1,-.45,.6,0,0,0,1,-.25,.8,0,0,0,1,-.25,.8,0,0,0,1,-.25,.1,0,0,0,1,-.25,.1,0,0,0,1,-.25,.6,0,0,0,1,-.45,.1,0,0,0,1,-.45,.6,0,0,0,1,-.45,.6,0,0,0,1,.25,-.1,0,0,0,1,.25,-.1,0,0,0,1,.25,.1,0,0,0,1,-.25,-.1,0,0,0,1,-.45,.1,0,0,0,1,-.45,.1,0,0,0,1,-.25,-.8,0,0,0,1,-.25,-.8,0,0,0,1,-.05,-.1,0,0,0,1,-.45,-.8,0,0,0,1,-.25,-.1,0,0,0,1,-.25,-.1,0,0,0]),Ee=class{constructor(e,t,i,r,s=null,n=null){U(this,"sphereIdx",[]),U(this,"sphereVtx",[]),U(this,"renderShaders",[]),U(this,"isVisible",!0),U(this,"isPickable",!0),U(this,"vertexBuffer"),U(this,"indexCount"),U(this,"indexBuffer"),U(this,"vao"),U(this,"mode"),U(this,"glFlags",0),U(this,"id"),U(this,"colorId"),U(this,"modelMatrix",we()),U(this,"scale",[1,1,1]),U(this,"position",[0,0,0]),U(this,"rotation",[0,0,0]),U(this,"rotationRadians",0),U(this,"extentsMin",[]),U(this,"extentsMax",[]),U(this,"furthestVertexFromOrigin"),U(this,"originNegate"),U(this,"fieldOfViewDeObliqueMM"),U(this,"mm"),this.vertexBuffer=t,this.indexCount=r,this.indexBuffer=s,this.vao=n,this.mode=i,this.id=e,this.colorId=[(e>>0&255)/255,(e>>8&255)/255,(e>>16&255)/255,(e>>24&255)/255]}};U(Ee,"BLEND",1);U(Ee,"CULL_FACE",2);U(Ee,"CULL_FRONT",4);U(Ee,"CULL_BACK",8);U(Ee,"ENABLE_DEPTH_TEST",16);U(Ee,"generateCrosshairs",function(a,e,t,i,r,s,n=20,o=0){const c=Ee.generateCrosshairsGeometry(a,t,i,r,s,n,o);return new Ee(e,c.vertexBuffer,a.TRIANGLES,c.indexCount,c.indexBuffer,c.vao)});U(Ee,"generateCrosshairsGeometry",function(a,e,t,i,r,s=20,n=0){const o=[],c=[],l=r*n;if(l<=0){let u=ee(t[0],e[1],e[2]),m=ee(i[0],e[1],e[2]);Ee.makeCylinder(o,c,u,m,r,s),u=ee(e[0],t[1],e[2]),m=ee(e[0],i[1],e[2]),Ee.makeCylinder(o,c,u,m,r,s),u=ee(e[0],e[1],t[2]),m=ee(e[0],e[1],i[2]),Ee.makeCylinder(o,c,u,m,r,s)}else{let u=ee(t[0],e[1],e[2]),m=ee(e[0]-l,e[1],e[2]);Ee.makeCylinder(o,c,u,m,r,s,!1),u=ee(e[0]+l,e[1],e[2]),m=ee(i[0],e[1],e[2]),Ee.makeCylinder(o,c,u,m,r,s,!1),u=ee(e[0],t[1],e[2]),m=ee(e[0],e[1]-l,e[2]),Ee.makeCylinder(o,c,u,m,r,s,!1),u=ee(e[0],e[1]+l,e[2]),m=ee(e[0],i[1],e[2]),Ee.makeCylinder(o,c,u,m,r,s,!1),u=ee(e[0],e[1],t[2]),m=ee(e[0],e[1],e[2]-l),Ee.makeCylinder(o,c,u,m,r,s,!1),u=ee(e[0],e[1],e[2]+l),m=ee(e[0],e[1],i[2]),Ee.makeCylinder(o,c,u,m,r,s,!1)}const h=a.createBuffer();if(h===null)throw new Error("could not instantiate vertex buffer");a.bindBuffer(a.ARRAY_BUFFER,h),a.bufferData(a.ARRAY_BUFFER,new Float32Array(o),a.STATIC_DRAW);const d=a.createBuffer();if(d===null)throw new Error("could not instantiate index buffer");a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,d),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint32Array(c),a.STATIC_DRAW);const f=a.createVertexArray();return a.bindVertexArray(f),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,d),a.bindBuffer(a.ARRAY_BUFFER,h),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,3,a.FLOAT,!1,0,0),a.bindVertexArray(null),{vertexBuffer:h,indexBuffer:d,indexCount:c.length,vao:f}});U(Ee,"getFirstPerpVector",function(a){const e=ee(0,0,0);return a[0]===0?e[0]=1:a[1]===0?e[1]=1:a[2]===0?e[2]=1:(e[0]=a[2],e[1]=a[2],e[2]=-(a[0]+a[1]),It(e,e)),e});U(Ee,"subdivide",function(a,e){let t=a.length/3,i=e.length/3;const r=i,s=Ce(),n=Ce();for(let o=0;o<r;o++){const c=e[o*3+0],l=e[o*3+1],h=e[o*3+2],d=ee(a[c*3+0],a[c*3+1],a[c*3+2]),f=ee(a[l*3+0],a[l*3+1],a[l*3+2]),u=ee(a[h*3+0],a[h*3+1],a[h*3+2]);ka(s,d,f),It(n,s),a.push(...n),ka(s,f,u),It(n,s),a.push(...n),ka(s,d,u),It(n,s),a.push(...n);let m=[t,t+1,t+2];e.push(...m),m=[c,t,t+2],e.push(...m),m=[t,l,t+1],e.push(...m),e[o*3+0]=t+2,e[o*3+1]=t+1,e[o*3+2]=h,i=i+3,t=t+3}});U(Ee,"weldVertices",function(a,e){const t=a.length/3;let i=0;const r=new Int32Array(t);for(let o=0;o<t-1;o++){if(r[o]!==0)continue;r[o]=i;let c=o*3;const l=a[c],h=a[c+1],d=a[c+2];for(let f=o+1;f<t;f++)c+=3,l===a[c]&&h===a[c+1]&&d===a[c+2]&&(r[f]=i);i++}if(i===t)return a;const s=e.length;for(let o=0;o<s;o++)e[o]=r[e[o]];const n=a.slice(0,i*3-1);for(let o=0;o<t-1;o++){const c=o*3,l=r[o]*3;n[l]=a[c],n[l+1]=a[c+1],n[l+2]=a[c+2]}return n});U(Ee,"makeSphere",function(a,e,t,i=[0,0,0]){let r=[0,0,1,.894,0,.447,.276,.851,.447,-.724,.526,.447,-.724,-.526,.447,.276,-.851,.447,.724,.526,-.447,-.276,.851,-.447,-.894,0,-.447,-.276,-.851,-.447,.724,-.526,-.447,0,0,-1];const s=[0,1,2,0,2,3,0,3,4,0,4,5,0,5,1,7,6,11,8,7,11,9,8,11,10,9,11,6,10,11,6,2,1,7,3,2,8,4,3,9,5,4,10,1,5,6,7,2,7,8,3,8,9,4,9,10,5,10,6,1];Ee.subdivide(r,s),Ee.subdivide(r,s),r=Ee.weldVertices(r,s);for(let l=0;l<r.length;l++)r[l]=r[l]*t;const n=r.length/3;let o=0;for(let l=0;l<n;l++)r[o]=r[o]+i[0],o++,r[o]=r[o]+i[1],o++,r[o]=r[o]+i[2],o++;const c=Math.floor(a.length/3);for(let l=0;l<s.length;l++)s[l]=s[l]+c;e.push(...s),a.push(...r)});U(Ee,"makeCylinder",function(a,e,t,i,r,s=20,n=!0){s<3&&(s=3);const o=Ce();Fe(o,i,t),It(o,o);const c=Ee.getFirstPerpVector(o),l=Ce();$s(l,o,c),It(l,l);let h=2*s,d=2*s;n&&(d+=2*s,h+=2);const f=Math.floor(a.length/3),u=new Uint32Array(d*3),m=new Float32Array(h*3);function p(E,I){m[E*3+0]=I[0],m[E*3+1]=I[1],m[E*3+2]=I[2]}function g(E,I,w,v){u[E*3+0]=I+f,u[E*3+1]=w+f,u[E*3+2]=v+f}const b=2*s,A=b+1;n&&(p(b,t),p(A,i));const y=Ce(),x=Ce();for(let E=0;E<s;E++){const I=Math.cos(E/s*2*Math.PI),w=Math.sin(E/s*2*Math.PI);y[0]=r*(I*c[0]+w*l[0]),y[1]=r*(I*c[1]+w*l[1]),y[2]=r*(I*c[2]+w*l[2]),ka(x,t,y),p(E,x),ka(x,i,y),p(E+s,x);let v=0;E<s-1&&(v=E+1),g(E*2,E,v,E+s),g(E*2+1,v,v+s,E+s),n&&(g(s*2+E,E,b,v),g(s*2+E+s,A,E+s,v+s))}e.push(...u),a.push(...m)});U(Ee,"makeColoredCylinder",function(a,e,t,i,r,s,n=[192,0,0,255],o=20,c=!1){let l=a.length/3;Ee.makeCylinder(a,e,i,r,s,o,c),l=a.length/3-l;const h=[];for(let d=0;d<l*4-1;d+=4)h[d]=n[0],h[d+1]=n[1],h[d+2]=n[2],h[d+3]=n[3];t.push(...h)});U(Ee,"makeColoredSphere",function(a,e,t,i,r=[0,0,0],s=[0,0,192,255]){let n=a.length/3;Ee.makeSphere(a,e,i,r),n=a.length/3-n;const o=[];for(let c=0;c<n*4-1;c+=4)o[c]=s[0],o[c+1]=s[1],o[c+2]=s[2],o[c+3]=s[3];t.push(...o)});var ja=Ee,_h=class Ft{constructor({name:e="niivue",level:t="info"}={}){U(this,"level"),U(this,"name"),this.name=`${e}`,this.level=t}debug(...e){Ft.levels[this.level]>Ft.levels.debug||console.debug(`${this.name}-debug`,...e)}info(...e){Ft.levels[this.level]>Ft.levels.info||console.info(`${this.name}-info`,...e)}warn(...e){Ft.levels[this.level]>Ft.levels.warn||console.warn(`${this.name}-warn`,...e)}error(...e){Ft.levels[this.level]>Ft.levels.error||console.error(`${this.name}-error`,...e)}fatal(...e){Ft.levels[this.level]>Ft.levels.fatal||console.error(`${this.name}-fatal`,...e)}setLogLevel(e){this.level=e}setName(e){this.name=e}};U(_h,"levels",{debug:0,info:1,warn:2,error:3,fatal:4,silent:1/0});var Xu=_h,V=new Xu({name:"niivue",level:"info"}),rn={};En(rn,{$itksnap:()=>Qu,$slicer3d:()=>Ju,actc:()=>Zu,afni_blues_inv:()=>dp,afni_reds_inv:()=>fp,batlow:()=>$u,bcgwhw:()=>tb,bcgwhw_dark:()=>eb,blue:()=>nb,blue2cyan:()=>rb,blue2magenta:()=>ib,blue2red:()=>ab,bluegrn:()=>sb,bone:()=>ob,bronze:()=>cb,cet_l17:()=>lb,cividis:()=>hb,cool:()=>db,copper:()=>ub,copper2:()=>fb,ct_airways:()=>bb,ct_artery:()=>pb,ct_bones:()=>mb,ct_brain:()=>Ab,ct_brain_gray:()=>gb,ct_cardiac:()=>yb,ct_head:()=>xb,ct_kidneys:()=>wb,ct_liver:()=>vb,ct_muscles:()=>Eb,ct_scalp:()=>Tb,ct_skull:()=>Ib,ct_soft:()=>Mb,ct_soft_tissue:()=>Cb,ct_surface:()=>Db,ct_vessels:()=>_b,ct_w_contrast:()=>Sb,cubehelix:()=>Fb,electric_blue:()=>Rb,freesurfer:()=>Nb,ge_color:()=>kb,gold:()=>Ub,gray:()=>jb,green:()=>Bb,green2cyan:()=>Pb,green2orange:()=>Ob,hot:()=>Lb,hotiron:()=>Vb,hsv:()=>Gb,inferno:()=>zb,jet:()=>Kb,kry:()=>Hb,linspecer:()=>qb,lipari:()=>Wb,magma:()=>Yb,mako:()=>Xb,navia:()=>Qb,nih:()=>Jb,plasma:()=>Zb,random:()=>$b,red:()=>ep,redyell:()=>tp,rocket:()=>ap,roi_i256:()=>up,surface:()=>ip,thermal:()=>rp,turbo:()=>sp,violet:()=>np,viridis:()=>op,warm:()=>cp,winter:()=>lp,x_rain:()=>hp});var Qu={R:[0,255,0,0,255,0,255,255,0,205,210,102,0,0,46,255,106,221,233,165,255,147,218,75,255,60,255,255,218,0,188,255,255,222,127,139,124,255,70,0,238,238,240,245,184,32,255,25,112,34,248,245,255,144,173,65,255,250,128,50,244,255,123,255,173,255,127,255,143,220,253,255,0,0,128,255,250,148,178,255,135,100,240,250,255,107,135,0,139,245,186,255,255,0,210,255,47,72,175,128,176,255,139,240,255,216,119,219,72,255,199,154,189,240,230,0,85,64,153,205,250,95,0,255,224,176,138,30,240,152,160],G:[0,0,255,0,255,255,0,239,0,133,180,205,0,139,139,228,90,160,150,42,250,112,112,0,182,179,235,228,165,128,143,105,218,184,255,69,252,255,130,100,130,232,255,222,134,178,20,25,128,139,248,255,160,238,255,105,99,240,0,205,164,255,104,165,216,192,255,140,188,20,245,250,206,255,0,250,128,0,34,127,206,149,230,235,245,142,206,0,0,245,85,228,222,191,105,248,79,61,238,128,224,240,0,255,215,191,136,112,209,0,21,205,183,248,230,250,107,224,50,92,250,158,128,69,255,196,43,144,128,251,82],B:[0,0,0,255,0,255,255,213,205,63,140,170,128,139,87,225,205,221,122,42,250,219,214,130,193,113,205,196,32,128,143,180,185,135,0,19,0,224,180,0,238,170,240,179,11,170,147,112,144,34,255,250,122,144,47,225,71,230,0,50,96,240,238,0,230,203,212,0,143,60,230,240,209,127,128,205,114,211,34,80,235,237,140,215,238,35,250,139,139,220,211,181,173,255,30,220,79,139,238,0,230,245,0,255,0,216,153,147,204,255,133,50,107,255,250,154,47,208,204,92,210,160,0,0,255,222,226,255,128,152,45],A:[0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130]},Ju={labels:["background","tissue","bone","skin","connective tissue","blood","organ","mass","muscle","foreign object","waste","teeth","fat","gray matter","white matter","nerve","vein","artery","capillary","ligament","tendon","cartilage","meniscus","lymph node","lymphatic vessel","cerebro-spinal fluid","bile","urine","feces","gas","fluid","edema","bleeding","necrosis","clot","embolism","head","central nervous system","brain","gray matter of brain","telencephalon","cerebral cortex","right frontal lobe","left frontal lobe","right temporal lobe","left temporal lobe","right parietal lobe","left parietal lobe","right occipital lobe","left occipital lobe","right insular lobe","left insular lobe","right limbic lobe","left limbic lobe","right striatum","left striatum","right caudate nucleus","left caudate nucleus","right putamen","left putamen","right pallidum","left pallidum","right amygdaloid complex","left amygdaloid complex","diencephalon","thalamus","right thalamus","left thalamus","pineal gland","midbrain","substantia nigra","right substantia nigra","left substantia nigra","cerebral white matter","right superior longitudinal fasciculus","left superior longitudinal fasciculus","right inferior longitudinal fasciculus","left inferior longitudinal fasciculus","right arcuate fasciculus","left arcuate fasciculus","right uncinate fasciculus","left uncinate fasciculus","right cingulum bundle","left cingulum bundle","projection fibers","right corticospinal tract","left corticospinal tract","right optic radiation","left optic radiation","right medial lemniscus","left medial lemniscus","right superior cerebellar peduncle","left superior cerebellar peduncle","right middle cerebellar peduncle","left middle cerebellar peduncle","right inferior cerebellar peduncle","left inferior cerebellar peduncle","optic chiasm","right optic tract","left optic tract","right fornix","left fornix","commissural fibers","corpus callosum","posterior commissure","cerebellar white matter","CSF space","ventricles of brain","right lateral ventricle","left lateral ventricle","right third ventricle","left third ventricle","cerebral aqueduct","fourth ventricle","subarachnoid space","spinal cord","gray matter of spinal cord","white matter of spinal cord","endocrine system of brain","pituitary gland","adenohypophysis","neurohypophysis","meninges","dura mater","arachnoid","pia mater","muscles of head","salivary glands","lips","nose","tongue","soft palate","right inner ear","left inner ear","right external ear","left external ear","right middle ear","left middle ear","right eyeball","left eyeball","skull","right frontal bone","left frontal bone","right parietal bone","left parietal bone","right temporal bone","left temporal bone","right sphenoid bone","left sphenoid bone","right ethmoid bone","left ethmoid bone","occipital bone","maxilla","right zygomatic bone","right lacrimal bone","vomer bone","right palatine bone","left palatine bone","mandible","neck","muscles of neck","pharynx","larynx","thyroid gland","right parathyroid glands","left parathyroid glands","skeleton of neck","hyoid bone","cervical vertebral column","thorax","trachea","bronchi","right lung","left lung","superior lobe of right lung","superior lobe of left lung","middle lobe of right lung","inferior lobe of right lung","inferior lobe of left lung","pleura","heart","right atrium","left atrium","atrial septum","ventricular septum","right ventricle of heart","left ventricle of heart","mitral valve","tricuspid valve","aortic valve","pulmonary valve","aorta","pericardium","pericardial cavity","esophagus","thymus","mediastinum","skin of thoracic wall","muscles of thoracic wall","skeleton of thorax","thoracic vertebral column","ribs","sternum","right clavicle","left clavicle","abdominal cavity","abdomen","peritoneum","omentum","peritoneal cavity","retroperitoneal space","stomach","duodenum","small bowel","colon","anus","liver","biliary tree","gallbladder","pancreas","spleen","urinary system","right kidney","left kidney","right ureter","left ureter","urinary bladder","urethra","right adrenal gland","left adrenal gland","female internal genitalia","uterus","right fallopian tube","left fallopian tube","right ovary","left ovary","vagina","male internal genitalia","prostate","right seminal vesicle","left seminal vesicle","right deferent duct","left deferent duct","skin of abdominal wall","muscles of abdominal wall","skeleton of abdomen","lumbar vertebral column","female external genitalia","male external genitalia","skeleton of upper limb","muscles of upper limb","right upper limb","left upper limb","right shoulder","left shoulder","right arm"],R:[0,128,241,177,111,216,221,144,192,220,78,255,230,200,250,244,0,216,183,183,152,111,178,68,111,85,0,214,78,218,170,140,188,216,145,150,177,244,250,200,68,128,83,83,162,162,141,141,182,182,188,188,154,154,177,177,30,30,210,210,48,48,98,98,69,166,122,122,253,145,46,0,0,250,127,127,159,159,125,125,106,106,154,154,126,201,201,78,78,174,174,139,139,148,148,186,186,99,156,156,64,64,138,97,126,194,85,88,88,88,88,88,88,88,88,244,200,250,82,57,60,92,255,255,255,255,201,70,188,177,166,182,229,229,174,174,201,201,194,194,241,203,203,229,229,255,255,209,209,248,248,255,196,255,255,255,242,242,222,177,213,184,150,62,62,62,242,250,255,177,182,175,197,197,172,172,202,224,224,255,206,210,203,233,195,181,152,159,166,218,225,224,255,184,211,47,255,173,188,255,226,253,244,205,205,186,177,255,234,204,180,216,255,205,204,255,221,0,139,249,157,203,185,185,247,247,222,124,249,249,244,255,255,227,213,213,193,216,230,245,245,241,241,177,171,217,212,185,185,198,194,177,177,177,177,177],G:[0,174,214,122,184,101,130,238,104,245,63,250,220,200,250,214,151,101,156,214,189,184,212,172,197,188,145,230,63,255,250,224,65,191,60,98,122,214,250,200,131,174,146,146,115,115,93,93,166,166,135,135,150,150,140,140,111,111,157,157,129,129,153,153,110,113,101,101,135,92,101,108,108,250,150,150,116,116,102,102,174,174,146,146,126,160,160,152,152,140,140,126,126,120,120,135,135,106,171,171,123,123,95,113,161,195,188,106,106,106,106,106,106,106,106,214,200,250,174,157,143,162,244,244,244,244,121,163,91,122,84,105,147,147,122,122,112,112,142,142,213,179,179,204,204,243,243,185,185,223,223,230,172,255,250,237,217,217,198,122,124,105,208,162,162,162,206,210,255,122,228,216,165,165,138,138,164,186,186,245,110,115,108,138,100,85,55,63,70,123,130,97,244,122,171,150,244,121,95,239,202,232,217,179,179,124,122,255,234,142,119,132,253,167,168,224,130,145,150,180,108,136,102,102,182,182,154,186,186,186,170,181,190,153,141,141,123,146,158,172,172,172,172,124,85,198,188,135,135,175,98,122,122,122,122,122],B:[0,128,145,101,210,79,101,144,88,20,0,220,70,235,210,49,206,79,220,211,207,210,242,100,131,255,30,130,0,255,250,228,28,216,66,83,101,49,225,215,98,128,164,164,105,105,137,137,110,110,166,166,201,201,190,190,85,85,166,166,126,126,112,112,53,137,38,38,192,109,131,112,112,225,88,88,163,163,154,154,155,155,83,83,55,133,133,141,141,103,103,177,177,72,72,135,135,24,108,108,147,147,74,158,197,164,255,215,215,215,215,215,215,215,215,49,215,225,128,110,83,109,209,209,209,209,77,117,95,101,94,107,118,118,90,90,73,73,0,0,144,77,77,109,109,152,152,85,85,131,131,138,68,167,160,145,123,123,101,101,109,108,243,114,114,114,142,139,207,101,255,244,145,145,115,115,140,162,162,217,84,89,81,112,73,57,13,27,38,97,104,76,209,154,143,103,209,88,76,172,134,158,154,108,108,161,101,220,194,178,153,105,229,142,143,199,101,30,98,111,162,116,83,83,164,164,132,223,150,150,147,158,165,130,113,113,103,127,140,147,147,151,151,92,68,131,102,134,134,125,79,101,101,101,101,101],A:[0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},Zu={R:[0,0,24,248,255],G:[0,0,177,254,0],B:[0,136,0,0,0],A:[0,32,64,78,128],I:[0,64,128,156,255]},$u={R:[1,10,15,17,21,27,36,49,65,82,99,118,140,161,183,203,222,238,248,253,253,253,252,250],G:[25,42,56,68,79,88,97,105,111,116,122,127,133,138,142,146,150,155,162,170,178,186,195,204],B:[89,92,95,96,98,98,96,91,83,74,64,55,46,43,49,62,79,100,126,151,175,199,223,250],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,11,22,33,44,55,66,77,88,99,110,121,133,144,155,166,177,188,199,210,221,232,243,255]},eb={R:[0,248,242,235,229,222,212,202,193,183,173,145,117,78,39,0,0,0,0,0,0,64,128,191,255,255,255,255,255,238,221,204,214,224,235,245,255,249,242,236,229,223,217,210,204,197,191,184,176,169,161,154,146,139,132,124,117,109,102,0],G:[0,251,247,243,239,235,235,235,235,235,235,216,197,174,150,127,153,178,204,229,255,255,255,255,255,220,185,150,115,77,38,0,31,61,92,122,153,138,122,107,92,77,61,46,31,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B:[0,254,253,252,251,250,251,252,253,254,255,226,198,132,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40,80,120,160,200,199,198,197,196,196,195,194,193,192,191,184,176,169,161,154,146,139,132,124,117,109,102,0],A:[256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256],I:[0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160,164,168,172,176,180,184,188,192,196,200,204,208,212,216,220,224,228,232,236,240,244,248,255]},tb={R:[255,248,242,235,229,222,212,202,193,183,173,145,117,78,39,0,0,0,0,0,0,64,128,191,255,255,255,255,255,238,221,204,214,224,235,245,255,249,242,236,229,223,217,210,204,197,191,184,176,169,161,154,146,139,132,124,117,109,102,0],G:[255,251,247,243,239,235,235,235,235,235,235,216,197,174,150,127,153,178,204,229,255,255,255,255,255,220,185,150,115,77,38,0,31,61,92,122,153,138,122,107,92,77,61,46,31,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B:[255,254,253,252,251,250,251,252,253,254,255,226,198,132,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40,80,120,160,200,199,198,197,196,196,195,194,193,192,191,184,176,169,161,154,146,139,132,124,117,109,102,0],A:[256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256],I:[0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160,164,168,172,176,180,184,188,192,196,200,204,208,212,216,220,224,228,232,236,240,244,248,255]},ab={R:[0,0,0,0,196,255],G:[0,32,128,128,128,32],B:[0,255,196,0,0,0],A:[0,128,64,64,64,128],I:[0,1,64,128,192,255]},ib={R:[0,255],G:[0,0],B:[255,255],A:[0,128],I:[0,255]},rb={R:[0,0],G:[0,255],B:[255,255],A:[0,128],I:[0,255]},sb={R:[0,0,0,0],G:[0,1,128,255],B:[0,222,127,32],A:[0,0,64,128],I:[0,1,128,255]},nb={R:[0,0,0],G:[0,0,0],B:[0,128,255],A:[0,64,128],I:[0,128,255]},ob={R:[0,103,255],G:[0,126,255],B:[0,165,255],A:[0,76,128],I:[0,153,255]},cb={R:[0,43,103,199,216,255],G:[0,0,37,155,213,255],B:[0,0,20,97,201,255],A:[0,44,48,54,56,56],I:[0,64,128,196,240,255]},lb={R:[0,9,24,33,40,46,52,57,62,66,70,74,78,81,85,88,91,94,98,101,103,106,109,112,114,117,119,121,124,126,128,130,133,135,137,139,141,143,145,147,149,151,153,155,157,159,161,163,164,166,168,169,171,172,174,175,177,178,180,181,183,184,186,187,189,190,191,193,194,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,222,223,224,224,225,226,226,227,228,228,229,229,230,231,231,232,233,233,234,234,235,235,236,236,236,237,237,237,238,238,238,239,239,239,240,240,240,241,241,241,242,242,242,243,243,243,243,243,243,243,243,244,244,244,244,244,244,244,244,244,244,244,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,244,244,244,244,244,244,244,244,244,244,244,244,244,244,244,243,243,243,243,243,243,243,243,243,243,243,243,242,242,242,242,242,242,242,242,241,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,243,243,244,244,245,246,246,247,247,248,249,249,250,250,251,251,252,252,253,253,254,254,254],G:[42,41,41,41,40,40,40,39,39,39,38,38,37,37,36,36,35,35,34,34,33,32,32,31,30,30,30,30,29,29,29,29,28,28,28,27,27,27,26,26,26,25,25,25,24,24,24,24,24,25,25,26,27,27,28,28,29,30,30,31,31,32,33,33,34,34,35,36,36,37,38,39,40,42,43,44,45,47,48,49,50,51,53,54,55,56,57,58,59,60,62,63,64,65,66,68,69,71,72,73,75,76,77,79,80,81,83,84,85,87,88,89,90,92,93,94,95,97,98,100,101,102,104,105,107,108,109,111,112,113,115,116,117,119,120,121,122,124,125,126,128,129,130,132,133,134,136,137,138,140,141,142,144,145,146,147,149,150,151,153,154,155,156,158,159,160,161,163,164,165,167,168,169,170,172,173,174,175,176,178,179,180,181,183,184,185,186,187,189,190,191,192,193,194,196,197,198,199,200,201,203,204,205,206,207,208,209,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,228,229,230,231,232,233,234,235,236,237,238,238,239,240,241,241,242,243,244,244,245,246,247,248,248,249,250,251,251,252,253,254,255],B:[167,167,166,166,166,165,165,165,164,164,164,163,163,162,162,162,161,161,161,160,160,160,159,159,158,158,157,157,156,155,155,154,154,153,153,152,151,151,150,150,149,149,148,147,147,146,146,145,144,144,143,143,142,141,141,140,139,139,138,137,137,136,135,135,134,133,133,132,131,131,130,130,129,128,128,127,127,126,125,125,124,124,123,123,122,121,121,120,119,119,118,118,117,116,116,116,115,115,114,114,113,113,113,112,112,111,111,110,110,109,109,109,108,108,107,107,106,106,106,106,106,105,105,105,105,105,105,105,104,104,104,104,104,103,103,103,103,103,102,102,102,103,103,103,103,104,104,104,104,104,105,105,105,105,106,106,106,106,106,107,107,107,107,108,108,109,110,111,111,112,113,113,114,115,115,116,117,117,118,119,120,120,121,122,122,123,124,125,126,128,129,130,131,132,134,135,136,137,138,140,141,142,143,144,146,147,148,149,150,152,153,155,157,158,160,162,163,165,167,168,170,172,173,175,177,178,180,182,183,185,187,188,190,193,196,199,201,204,207,210,212,215,218,221,224,226,229,232,235,238,240,243,246,249,252,255],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},hb={R:[0,86,166,255],G:[32,92,156,233],B:[76,108,117,69],A:[0,56,80,88],I:[0,64,192,255]},db={R:[0,0,0],G:[127,196,254],B:[255,255,255],A:[0,64,128],I:[0,128,255]},fb={R:[0,61,122,183,244,255],G:[0,41,81,122,163,255],B:[0,25,51,76,102,255],A:[0,25,51,71,102,128],I:[0,51,102,153,204,255]},ub={R:[0,61,122,183,244,255],G:[0,41,81,122,163,203],B:[0,25,51,76,102,127],A:[0,25,51,71,102,128],I:[0,51,102,153,204,255]},bb={min:-643,max:-235,R:[0,0,0],G:[154,154,154],B:[179,179,101],A:[0,32,0],I:[0,163,255]},pb={min:114,max:800,R:[0,255,255,255],G:[0,0,129,255],B:[0,0,0,255],A:[0,64,88,228],I:[0,80,160,255]},mb={min:180,max:600,R:[0,0,113,255],G:[0,0,109,250],B:[0,0,101,245],A:[0,0,100,160],I:[0,1,128,255]},gb={min:-10,max:110,R:[0,127,255],G:[0,127,255],B:[0,127,255],A:[0,48,128],I:[0,124,255]},Ab={min:-10,max:110,R:[0,199,255],G:[0,127,255],B:[0,127,255],A:[0,48,128],I:[0,124,255]},yb={min:-80,max:1e3,R:[0,189,150,150,150,150,255],G:[0,169,54,54,54,54,240],B:[0,153,52,52,52,52,242],A:[0,32,64,0,0,64,64],I:[0,1,82,92,234,242,255]},xb={min:-590,max:600,R:[0,241,241,248,248,178,178,232,255,255,255],G:[0,156,156,222,222,36,36,51,255,255,255],B:[0,130,130,169,169,24,24,37,255,255,255],A:[0,8,0,0,0,64,64,0,0,222,222],I:[0,2,3,64,122,142,172,182,252,253,255]},wb={min:114,max:302,R:[0,255,255],G:[0,129,255],B:[0,0,255],A:[0,88,228],I:[0,103,255]},vb={min:-23,max:246,R:[0,44,255,255,255],G:[0,128,90,255,255],B:[0,0,70,0,255],A:[0,0,82,184,228],I:[0,64,131,196,255]},Eb={min:-100,max:246,R:[0,128,159,255,255,255,255],G:[0,0,56,90,0,255,255],B:[0,0,41,70,0,0,255],A:[0,63,105,135,167,184,228],I:[0,100,128,155,180,209,255]},Tb={min:-590,max:600,R:[0,241,241,248,248,178,232,255,255],G:[0,156,156,222,222,36,51,255,255],B:[0,130,130,169,169,24,37,255,255],A:[0,63,105,135,167,184,228,228,228],I:[0,1,52,127,137,162,172,252,255]},Ib={min:140,max:1024,R:[0,2,113,255],G:[0,1,109,250],B:[0,1,101,245],A:[0,1,96,168],I:[0,1,128,255]},Mb={min:-923,max:679,R:[0,0,0,0,0,255,255,255],G:[154,154,154,154,0,0,254,255],B:[179,179,179,179,0,0,0,255],A:[0,3,8,0,0,10,15,20],I:[0,30,62,88,170,200,232,255]},Cb={min:-10,max:110,R:[0,199,255],G:[0,127,255],B:[0,127,255],A:[0,48,128],I:[0,124,255]},Db={min:-600,max:100,R:[0,134,255],G:[0,109,250],B:[0,101,245],A:[0,60,148],I:[0,128,255]},_b={min:114,max:246,R:[0,255,255],G:[0,128,255],B:[0,128,255],A:[0,64,96],I:[0,87,255]},Sb={min:50,max:1e3,R:[98,210,169,128,255],G:[94,26,77,128,255],B:[45,21,74,128,255],A:[0,25,0,4,168],I:[0,41,87,154,255]},Fb={R:[0,13,21,26,27,25,22,21,22,28,39,54,75,98,124,148,171,189,202,210,213,211,206,200,195,193,195,201,211,225,240,255],G:[0,5,11,20,31,44,58,72,86,99,109,116,120,122,122,122,121,121,124,129,137,147,161,175,190,205,218,229,238,245,251,255],B:[0,14,30,46,61,71,77,78,75,68,60,52,48,47,53,65,83,105,131,157,183,205,222,235,241,243,242,240,239,240,245,255],A:[0,4,8,12,17,21,25,29,33,37,41,45,50,54,58,62,66,70,74,78,83,87,91,95,99,103,107,111,116,120,124,128],I:[0,8,16,25,33,41,49,58,66,74,82,90,99,107,115,123,132,140,148,156,165,173,181,189,197,206,214,222,230,239,247,255]},Rb={R:[0,10,136,255],G:[0,39,220,255],B:[0,223,253,255],A:[0,48,64,70],I:[0,92,192,255]},Nb={R:[0,245,205,120,196,220,230,0,122,236,12,204,42,119,220,103,60,255,165,160,0,245,205,120,196,220,230,0,122,236,13,220,103,255,165,160,0,120,200,255,255,164,164,164,234,0,0,0,0,0],G:[0,245,62,18,58,248,148,118,186,13,48,182,204,159,216,255,60,165,42,32,200,245,62,18,58,248,148,118,186,13,48,216,255,165,42,32,200,190,70,148,148,108,108,108,169,0,0,0,0,0],B:[0,245,78,134,250,164,34,14,220,176,255,142,164,176,20,255,60,0,42,240,200,245,78,134,250,164,34,14,220,176,255,20,255,0,42,240,221,150,255,10,10,226,226,226,30,64,112,160,208,255],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,2,3,4,5,7,8,10,11,12,13,14,15,16,17,18,24,26,28,30,31,41,42,43,44,46,47,49,50,51,52,53,54,58,60,62,63,72,77,78,79,80,81,82,85,251,252,253,254,255]},kb={R:[0,0,128,255,255],G:[0,128,0,128,255],B:[0,125,255,0,255],A:[0,32,64,96,128],I:[0,63,128,192,255]},Ub={R:[0,142,227,255],G:[0,85,170,255],B:[0,14,76,255],A:[0,42,84,128],I:[0,85,170,255]},jb={R:[0,255],G:[0,255],B:[0,255],A:[0,128],I:[0,255]},Bb={R:[0,0,0],G:[0,128,255],B:[0,0,0],A:[0,64,128],I:[0,128,255]},Pb={R:[0,0,0],G:[72,72,255],B:[0,255,255],A:[0,64,128],I:[0,88,255]},Ob={R:[0,255,255],G:[72,88,255],B:[0,0,0],A:[0,64,128],I:[0,88,255]},Vb={R:[0,255,255,255],G:[0,0,126,255],B:[0,0,0,255],A:[0,64,96,128],I:[0,128,191,255]},Lb={R:[3,255,255,255],G:[0,0,255,255],B:[0,0,0,255],A:[0,48,96,128],I:[0,95,191,255]},Gb={R:[255,255,0,0,0,255,255],G:[0,255,255,255,0,0,0],B:[0,0,0,255,255,255,0],A:[0,14,28,43,57,71,85],I:[0,43,85,128,170,213,255]},zb={R:[0,120,237,240],G:[0,28,105,249],B:[4,109,37,33],A:[0,56,80,88],I:[0,64,192,255]},Kb={R:[0,0,127,255,127],G:[0,127,255,127,0],B:[127,255,127,0,0],A:[0,32,64,96,128],I:[0,63,128,192,255]},Hb={R:[0,255,255],G:[0,0,255],B:[0,0,0],A:[0,64,64],I:[0,86,255]},qb={R:[94,50,90,152,215,238,249,254,252,241,209,158],G:[79,131,186,214,240,244,237,210,157,100,57,1],B:[162,189,167,164,155,169,168,123,86,68,79,66],A:[0,12,23,35,47,58,70,81,93,105,116,128],I:[0,23,46,70,93,116,139,162,185,209,232,255]},Wb={R:[3,7,13,25,45,67,84,98,110,124,138,154,173,191,210,225,233,233,231,229,230,235,243,253],G:[19,33,48,63,77,87,92,94,95,96,96,97,99,101,106,118,133,149,163,177,192,208,225,245],B:[38,58,79,99,114,122,122,120,117,113,110,105,101,97,94,96,103,112,122,134,149,169,192,218],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,11,22,33,44,55,66,77,88,99,110,121,133,144,155,166,177,188,199,210,221,232,243,255]},Yb={R:[0,148,183,223,247,252],G:[0,44,55,74,112,253],B:[4,128,121,104,92,191],A:[0,44,53,64,75,107],I:[0,107,128,154,179,255]},Xb={R:[11,59,55,222],G:[4,45,165,245],B:[5,91,172,229],A:[0,23,70,107],I:[0,56,167,255]},Qb={R:[3,5,6,8,12,19,28,36,42,48,54,61,68,76,86,96,110,129,154,181,205,224,239,252],G:[19,32,44,58,72,86,98,108,116,122,128,134,141,149,157,167,178,191,204,216,225,232,239,244],B:[39,60,82,104,123,137,144,145,142,138,134,130,126,121,116,110,105,104,112,131,155,178,198,217],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,11,22,33,44,55,66,77,88,99,110,121,133,144,155,166,177,188,199,210,221,232,243,255]},Jb={R:[0,85,0,0,0,0,0,0,85,255,255,255,172],G:[0,0,0,0,85,170,255,255,255,255,85,0,0],B:[0,170,85,255,255,170,170,0,85,0,0,0,0],A:[0,5,10,21,26,32,37,42,48,53,64,72,85],I:[0,15,31,63,79,95,111,127,143,159,191,217,255]},Zb={R:[13,156,237,240],G:[8,23,121,249],B:[135,158,83,33],A:[0,56,80,88],I:[0,64,192,255]},$b={R:[208,71,33,192,32,195,208,173,233,202,25,210,145,89,87,245,246,38,3,25,57,167,245,86,227,208,81,64,90,199,140,48,212,180,70,120,9,192,245,177,65,157,9,193,100,181,125,145,62,8,108,36,140,237,242,248,161,189,41,114,65,121,97,50,238,149,44,214,124,167,40,167,127,178,231,30,173,244,193,203,204,238,139,135,71,234,234,217,66,14,129,19,97,165,112,244,35,73,192,12,149,71,33,192,32,195,208,173,233,202,25,210,145,89,87,245,246,38,3,25,57,167,245,86,227,208,81,64,90,199,140,48,212,180,70,120,9,192,245,177,65,157,9,193,100,181,125,145,62,8,108,36,140,237,242,248,161,189,41,114,65,121,97,50,238,149,44,214,124,167,40,167,127,178,231,30,173,244,193,203,204,238,139,135,71,234,234,217,66,14,129,19,97,165,112,244,35,73,192,12,149,71,33,192,32,195,208,173,233,202,25,210,145,89,87,245,246,38,3,25,57,167,245,86,227,208,81,64,90,199,140,48,212,180,70,120,9,192,245,177,65,157,9,193,100,181,125,145,62,8,108,36,140,237,242,248],G:[182,46,78,199,79,89,41,208,135,20,154,35,21,43,230,113,191,147,208,37,28,27,86,203,25,209,148,187,139,111,48,102,76,110,106,130,37,160,34,222,90,165,245,222,102,47,19,130,4,232,137,211,240,11,140,21,42,22,241,61,99,115,199,166,114,190,204,60,233,66,115,230,125,103,203,125,13,176,94,131,39,198,167,124,67,175,254,1,15,198,62,237,159,31,218,58,244,47,61,67,94,46,78,199,79,89,41,208,135,20,154,35,21,43,230,113,191,147,208,37,28,27,86,203,25,209,148,187,139,111,48,102,76,110,106,130,37,160,34,222,90,165,245,222,102,47,19,130,4,232,137,211,240,11,140,21,42,22,241,61,99,115,199,166,114,190,204,60,233,66,115,230,125,103,203,125,13,176,94,131,39,198,167,124,67,175,254,1,15,198,62,237,159,31,218,58,244,47,61,67,94,46,78,199,79,89,41,208,135,20,154,35,21,43,230,113,191,147,208,37,28,27,86,203,25,209,148,187,139,111,48,102,76,110,106,130,37,160,34,222,90,165,245,222,102,47,19,130,4,232,137,211,240,11,140,21],B:[191,154,43,10,207,204,164,231,136,58,239,30,147,230,101,111,150,35,128,57,252,79,173,120,25,126,81,85,8,7,122,237,190,152,246,182,130,219,67,76,167,178,235,250,28,61,186,250,199,67,58,50,86,182,108,77,89,112,59,125,226,50,205,227,125,128,104,27,59,66,53,133,159,203,97,125,139,159,158,7,215,47,140,226,223,231,44,110,184,61,233,47,67,148,22,120,173,156,117,181,94,154,43,10,207,204,164,231,136,58,239,30,147,230,101,111,150,35,128,57,252,79,173,120,25,126,81,85,8,7,122,237,190,152,246,182,130,219,67,76,167,178,235,250,28,61,186,250,199,67,58,50,86,182,108,77,89,112,59,125,226,50,205,227,125,128,104,27,59,66,53,133,159,203,97,125,139,159,158,7,215,47,140,226,223,231,44,110,184,61,233,47,67,148,22,120,173,156,117,181,94,154,43,10,207,204,164,231,136,58,239,30,147,230,101,111,150,35,128,57,252,79,173,120,25,126,81,85,8,7,122,237,190,152,246,182,130,219,67,76,167,178,235,250,28,61,186,250,199,67,58,50,86,182,108,77],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},ep={R:[0,128,255],G:[0,0,0],B:[0,0,0],A:[0,64,128],I:[0,128,255]},tp={R:[192,224,255],G:[1,128,255],B:[0,0,0],A:[0,64,128],I:[0,128,255]},ap={R:[3,112,144,188,236,246,255],G:[5,31,29,22,76,158,250],B:[26,87,91,86,62,117,235],A:[0,30,38,49,67,85,107],I:[0,73,92,118,160,205,255]},ip={R:[1,240,255],G:[1,128,255],B:[1,128,255],A:[0,76,128],I:[0,153,255]},rp={R:[0,5,18,34,53,72,90,107,126,144,161,178,194,209,222,233,242,248,251,251,249,244,241,252],G:[0,4,10,11,9,11,17,23,30,36,43,50,59,70,83,98,117,136,157,177,199,220,240,254],B:[3,24,50,76,96,106,109,110,108,104,97,89,79,67,55,42,26,12,6,22,47,79,121,164],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,11,22,33,44,55,66,77,88,99,110,121,133,144,155,166,177,188,199,210,221,232,243,255]},sp={R:[48,48,64,70,65,25,132,195,244,254,218,122],G:[18,18,64,107,150,226,255,241,199,158,57,4],B:[59,59,162,227,255,187,81,52,58,47,7,3],A:[0,22,26,30,34,43,52,57,63,67,77,86],I:[0,1,16,32,49,83,118,140,164,181,219,255]},np={R:[0,128,255],G:[0,0,0],B:[0,128,255],A:[0,64,128],I:[0,128,255]},op={R:[68,49,53,253],G:[1,104,183,231],B:[84,142,121,37],A:[0,56,80,88],I:[0,64,192,255]},cp={R:[255,255,255],G:[127,196,254],B:[0,0,0],A:[0,64,128],I:[0,128,255]},lp={R:[0,0,0],G:[0,128,255],B:[255,196,128],A:[0,64,128],I:[0,128,255]},hp={R:[3,64,0,0,255,255,255],G:[0,0,0,255,255,192,3],B:[0,32,48,56,64,96,128],A:[0,8,16,24,32,52,80],I:[0,32,64,96,160,192,255]},dp={min:0,max:0,R:[0,37],G:[242,0],B:[255,255],A:[0,64],I:[0,255]},fp={R:[255,255],G:[255,11],B:[0,0],A:[0,64],I:[0,255]},up={min:0,max:0,R:[65,10,223,120,216,207,251,93,252,217,21,253,131,165,173,143,144,217,86,89,63,254,172,1,142,107,42,78,221,8,222,71,127,126,167,33,104,2,208,216,0,251,7,105,2,101,248,190,253,62,255,224,166,37,110,138,45,34,6,37,69,201,43,122,199,37,173,194,103,211,75,159,96,4,239,98,110,193,253,166,40,255,48,130,140,243,101,9,177,220,133,32,4,81,48,48,210,109,60,132,1,119,1,159,247,33,212,187,253,144,196,254,168,79,64,196,39,97,73,173,104,216,217,43,101,119,254,5,237,103,203,122,57,87,251,164,19,75,200,2,252,150,66,0,255,157,23,254,55,16,240,161,69,253,207,195,5,60,255,251,200,217,134,123,253,180,27,246,130,136,250,232,4,125,140,22,253,255,13,180,123,61,254,111,10,185,76,192,255,223,186,61,198,5,172,13,83,172,171,6,23,73,134,133,109,61,213,55,57,132,36,209,2,144,1,253,68,155,3,160,2,77,121,70,67,176,223,131,4,162,232,255,150,94,235,191,207,10,246,0,225,4,209,116,57,112,172,253,1,6,92,227,73,62,135,223],G:[162,50,112,245,4,124,176,243,56,125,183,139,182,68,189,4,225,10,20,223,7,46,31,193,225,250,219,41,2,100,83,181,34,150,72,223,168,248,80,253,7,117,214,2,248,10,3,59,179,160,90,244,146,4,207,4,125,255,96,100,1,208,130,51,116,181,236,53,244,5,165,28,181,86,96,42,254,1,134,194,214,92,41,204,137,86,207,3,143,3,100,239,164,94,65,251,131,244,173,57,143,107,217,53,210,0,148,250,45,198,81,40,61,218,252,88,171,0,248,24,248,4,41,100,187,46,208,145,43,168,121,46,175,250,125,107,233,112,207,231,174,215,53,9,43,153,52,124,128,65,210,147,255,147,63,200,148,254,0,179,241,42,239,2,230,8,82,135,87,16,3,87,86,151,254,8,255,86,53,19,7,192,171,201,253,247,197,103,251,126,0,149,54,183,61,126,79,113,10,103,184,75,11,195,222,136,149,131,8,99,240,177,252,255,198,16,7,68,178,66,191,150,73,26,211,109,78,209,240,254,1,166,247,131,2,0,167,127,133,10,43,99,235,3,214,142,176,82,132,38,10,249,255,215,44,81],B:[176,182,248,37,117,35,96,69,32,152,108,20,237,250,2,89,141,216,111,251,211,149,10,44,214,103,31,251,3,32,252,246,97,1,219,167,197,4,36,116,206,118,106,43,205,204,114,69,127,205,87,80,41,251,145,204,253,161,247,1,149,9,43,253,97,72,136,161,171,181,26,255,108,80,218,214,231,255,84,31,109,4,218,3,217,36,68,85,241,39,221,2,240,2,173,42,206,5,110,46,103,27,212,184,2,207,246,45,116,72,110,253,38,105,248,159,243,81,192,93,141,145,24,157,234,131,57,178,62,75,65,176,148,40,253,66,76,240,51,154,17,251,139,253,207,9,114,49,200,254,96,73,138,118,204,102,137,89,145,161,4,112,66,234,147,178,212,205,185,11,203,131,2,250,118,169,1,185,154,53,171,197,61,175,249,96,15,254,95,5,222,75,246,194,2,61,180,25,133,165,15,233,59,35,221,140,109,7,114,255,198,0,115,168,252,23,242,80,75,142,137,255,12,182,68,201,4,111,37,228,83,248,24,192,249,5,54,223,160,122,160,114,145,119,252,31,253,250,10,214,8,47,0,142,222,70],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},bp=class{constructor(){U(this,"gamma",1),U(this,"version",.1),U(this,"cluts",{});const e=Object.keys(rn).filter(t=>!t.startsWith("$")).sort(new Intl.Collator("en").compare);for(const t of e)this.cluts[t]=rn[t]}addColormap(a,e){this.cluts[a]=e}colormaps(){return Object.keys(this.cluts)}colorMaps(){return this.colormaps()}colormapFromKey(a){let e=this.cluts[a];return e!==void 0||(e=this.cluts[a.toLowerCase()],e!==void 0)?e:(a.length>0&&V.warn("No color map named "+a),{min:0,max:0,R:[0,255],G:[0,255],B:[0,255],A:[0,255],I:[0,255]})}colormap(a="",e=!1){const t=this.colormapFromKey(a);return this.makeLut(t.R,t.G,t.B,t.A,t.I,e)}makeLabelLut(a,e=255,t=1/0){if(a.R===void 0||a.G===void 0||a.B===void 0)throw new Error(`Invalid colormap table: ${a}`);const i=a.R.length,r=a.I??[...Array(i).keys()];let s=!1;for(let f=0;f<r.length;f++)r[f]>t&&(s=!0,r[f]=t);if(s&&V.warn("Some colormap indices clamped to match label range."),i!==a.G.length||i!==a.B.length||i!==r.length)throw new Error(`colormap does not make sense: ${a} Rs ${a.R.length} Gs ${a.G.length} Bs ${a.B.length} Is ${r.length}`);let n=new Uint8ClampedArray(i).fill(e);n[0]=0,a.A!==void 0&&(n=Uint8ClampedArray.from(a.A));const o=Math.min(...r),c=Math.max(...r),l=c-o+1,h=new Uint8ClampedArray(l*4).fill(0);for(let f=0;f<i;f++){let u=(r[f]-o)*4;h[u++]=a.R[f],h[u++]=a.G[f],h[u++]=a.B[f],h[u++]=n[f]}const d={lut:h,min:o,max:c};if(a.labels){const f=a.labels.length;if(f===l)d.labels=a.labels;else if(f===i){d.labels=Array(l).fill("?");for(let u=0;u<i;u++){const m=r[u];d.labels[m]=a.labels[u]}}}return d}async makeLabelLutFromUrl(a,e=255,t=1/0){const r=await(await fetch(a)).json();return this.makeLabelLut(r,e,t)}makeDrawLut(a){let e=typeof a=="object"?a:rn[a];e===void 0&&(V.warn("colormap undefined ",a),e=this.colormapFromKey(""));const t=this.makeLabelLut(e,255);if(t.labels===void 0&&(t.labels=[]),t.labels.length<256){const n=t.labels.length;for(let o=n;o<256;o++)t.labels.push(o.toString())}const i=new Uint8ClampedArray(256*4);let r=0;for(let n=0;n<256;n++)i[r++]=255,i[r++]=0,i[r++]=0,i[r++]=255;i[3]=0;const s=Math.min(t.lut.length,256*4);if(s>0)for(let n=0;n<s;n++)i[n]=t.lut[n];return{lut:i,labels:t.labels}}makeLut(a,e,t,i,r,s){const n=a.length,o=[...a],c=[...e],l=[...t];if(!r){r=new Array(n);for(let u=0;u<n;u++)r[u]=u/(n-1)*255}i||(i=new Array(n).fill(64),i[0]=0);let h=Uint8ClampedArray.from(i),d=Uint8ClampedArray.from(r);if(s)for(let u=0;u<n;u++)o[u]=a[n-1-u],c[u]=e[n-1-u],l[u]=t[n-1-u],h[u]=255-i[n-1-u],d[u]=255-r[n-1-u];const f=new Uint8ClampedArray(256*4);if(typeof d>"u"){d=new Uint8ClampedArray(n).fill(0);for(let u=0;u<n;u++)d[u]=Math.round(u*255/(n-1))}typeof h>"u"&&(h=new Uint8ClampedArray(n).fill(64),h[0]=0);for(let u=0;u<n-1;u++){const m=d[u];let p=d[u+1];u===0&&m!==0&&V.warn("colormap issue: indices expected to start with 0 not ",m),u===d.length-2&&p!==255&&(V.warn("padding colormap: indices expected end with 255 not ",p),p=255);const g=p-m;let b=m*4;for(let A=m;A<=p;A++){const y=(A-m)/g;f[b++]=o[u]+y*(o[u+1]-o[u]),f[b++]=c[u]+y*(c[u+1]-c[u]),f[b++]=l[u]+y*(l[u+1]-l[u]),f[b++]=h[u]+y*(h[u+1]-h[u])}}if(this.gamma===1)return f;for(let u=0;u<1020;u++)u%4!==3&&(f[u]=Math.pow(f[u]/255,1/this.gamma)*255);return f}},Ie=new bp,_a=class{static getClusterBoundaryU8(a,e){const t=new Array(a.length).fill(!1),i=new Array(a.length).fill(!1);for(let n=0;n<a.length;n++)a[n]>0&&(i[n]=!0);const r=e.length/3;let s=0;for(let n=0;n<r;n++){const o=e[s],c=e[s+1],l=e[s+2];s+=3,!(i[o]===i[c]&&i[o]===i[l]&&i[c]===i[l])&&(t[o]=!0,t[c]=!0,t[l]=!0)}return t}static async gzip(a){const e=new CompressionStream("gzip"),t=e.writable.getWriter();t.write(a).catch(console.error);const i=t.close().catch(console.error),r=new Response(e.readable),s=new Uint8Array(await r.arrayBuffer());return await i,s}static createMZ3(a,e,t=!1,i=null){const s=i instanceof Uint8Array&&i.length===a.length/3*4,n=s?7:3,o=e.length/3,c=a.length/3,l=0,h=16,d=o*3*4,f=c*3*4,u=s?i.length:0,m=h+d+f+u,p=new ArrayBuffer(m),g=new DataView(p);g.setUint16(0,23117,!0),g.setUint16(2,n,!0),g.setUint32(4,o,!0),g.setUint32(8,c,!0),g.setUint32(12,l,!0);let b=h;if(new Uint32Array(p,b,e.length).set(e),b+=d,new Float32Array(p,b,a.length).set(a),s&&(b+=f,new Uint8Array(p,b,i.length).set(i)),t)throw new Error("Call async createMZ3Async() for compression");return p}static async createMZ3Async(a,e,t=!1,i=null){const r=this.createMZ3(a,e,t,i);return t?await this.gzip(new Uint8Array(r)):r}static createOBJ(a,e){let t="";for(let s=0;s<a.length;s+=3)t+=`v ${a[s]} ${a[s+1]} ${a[s+2]}
`;for(let s=0;s<e.length;s+=3)t+=`f ${e[s]+1} ${e[s+1]+1} ${e[s+2]+1}
`;return new TextEncoder().encode(t).buffer}static createSTL(a,e){const t=e.length/3,i=84+t*50,r=new ArrayBuffer(i),s=new DataView(r);for(let o=0;o<80;o++)s.setUint8(o,0);s.setUint32(80,t,!0);let n=84;for(let o=0;o<e.length;o+=3){const c=e[o]*3,l=e[o+1]*3,h=e[o+2]*3;s.setFloat32(n,0,!0),s.setFloat32(n+4,0,!0),s.setFloat32(n+8,0,!0),n+=12,s.setFloat32(n,a[c],!0),s.setFloat32(n+4,a[c+1],!0),s.setFloat32(n+8,a[c+2],!0),n+=12,s.setFloat32(n,a[l],!0),s.setFloat32(n+4,a[l+1],!0),s.setFloat32(n+8,a[l+2],!0),n+=12,s.setFloat32(n,a[h],!0),s.setFloat32(n+4,a[h+1],!0),s.setFloat32(n+8,a[h+2],!0),n+=12,s.setUint16(n,0,!0),n+=2}return r}static downloadArrayBuffer(a,e){const t=new Blob([a],{type:"application/octet-stream"}),i=URL.createObjectURL(t),r=document.createElement("a");r.href=i,r.download=e,document.body.appendChild(r),r.style.display="none",r.click(),setTimeout(()=>{document.body.removeChild(r),URL.revokeObjectURL(i)},0)}static async saveMesh(a,e,t=".mz3",i=!1){let r=new ArrayBuffer(0);return/\.obj$/i.test(t)?r=this.createOBJ(a,e):/\.stl$/i.test(t)?r=this.createSTL(a,e):(/\.mz3$/i.test(t)||(t+=".mz3"),r=await this.createMZ3Async(a,e,i)),t.length>4&&this.downloadArrayBuffer(r,t),r}static getClusterBoundary(a,e){const t=new Uint32Array(a.buffer),i=new Array(t.length).fill(!1),r=e.length/3;let s=0;for(let n=0;n<r;n++){const o=e[s],c=e[s+1],l=e[s+2];s+=3,!(t[o]===t[c]&&t[o]===t[l]&&t[c]===t[l])&&(i[o]=!0,i[c]=!0,i[l]=!0)}return i}static getExtents(a){if(!ArrayBuffer.isView(a)&&!Array.isArray(a)||a.length<3)return{mxDx:0,extentsMin:0,extentsMax:0};let e=0;const t=ee(a[0],a[1],a[2]),i=ee(a[0],a[1],a[2]);for(let n=0;n<a.length;n+=3){const o=ee(a[n],a[n+1],a[n+2]);e=Math.max(e,fs(o)),xo(t,t,o),wo(i,i,o)}const r=[t[0],t[1],t[2]],s=[i[0],i[1],i[2]];return{mxDx:e,extentsMin:r,extentsMax:s}}static generateNormals(a,e){const t=[];let i;const r=a.length;let s,n,o,c,l,h,d,f,u;const m=new Float32Array(r),p=e.length;for(i=0;i<p;i+=3){d=e[i]*3,f=e[i+1]*3,u=e[i+2]*3;const g=[a[d],a[d+1],a[d+2]],b=[a[f],a[f+1],a[f+2]],A=[a[u],a[u+1],a[u+2]];s=b[0]-g[0],n=b[1]-g[1],o=b[2]-g[2],c=A[0]-g[0],l=A[1]-g[1],h=A[2]-g[2],t[0]=l*o-h*n,t[1]=h*s-c*o,t[2]=c*n-l*s,m[d]+=t[0],m[d+1]+=t[1],m[d+2]+=t[2],m[f]+=t[0],m[f+1]+=t[1],m[f+2]+=t[2],m[u]+=t[0],m[u+1]+=t[1],m[u+2]+=t[2]}for(i=0;i<r;i+=3){t[0]=-1*m[i],t[1]=-1*m[i+1],t[2]=-1*m[i+2];let g=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];g>0&&(g=1/Math.sqrt(g),t[0]*=g,t[1]*=g,t[2]*=g),m[i]=t[0],m[i+1]=t[1],m[i+2]=t[2]}return m}},he,dt,sn,oo,ts,Sh=class{constructor(a){Wa(this,he),Wa(this,dt,0),Wa(this,sn,[]),Wa(this,oo,[]),Wa(this,ts),fa(this,he,new DataView(a)),this.read()}async extract(a){const e=new Uint8Array(se(this,he).buffer.slice(a.startsAt,a.startsAt+a.compressedSize));if(a.compressionMethod===0)return e;if(a.compressionMethod===8){const t=new DecompressionStream("deflate-raw"),i=t.writable.getWriter();i.write(e).catch(console.error);const r=i.close().catch(console.error),s=new Response(t.readable),n=new Uint8Array(await s.arrayBuffer());return await r,n}throw new Error(`Unsupported compression method: ${a.compressionMethod}`)}read(){for(;!se(this,ts)&&se(this,dt)<se(this,he).byteLength;){const a=se(this,he).getUint32(se(this,dt),!0);if(a===67324752){const e=this.readLocalFile(se(this,dt));e.extract=this.extract.bind(this,e),se(this,sn).push(e);const t=(e.generalPurpose&8)!==0;if(e.startsAt=se(this,dt)+30+e.fileNameLength+e.extraLength,e.compressedSize===0&&t){let i=e.startsAt;for(;i+20<=se(this,he).byteLength;){if(se(this,he).getUint32(i,!0)===134695760&&se(this,he).getUint16(i+16,!0)===19280){i+=4;break}i++}e.crc=se(this,he).getUint32(i,!0),e.compressedSize=se(this,he).getUint32(i+4,!0),e.uncompressedSize=se(this,he).getUint32(i+8,!0),fa(this,dt,i+12)}else fa(this,dt,e.startsAt+e.compressedSize)}else if(a===33639248){const e=this.readCentralDirectory(se(this,dt));se(this,oo).push(e),fa(this,dt,se(this,dt)+(46+e.fileNameLength+e.extraLength+e.fileCommentLength))}else if(a===101010256){fa(this,ts,this.readEndCentralDirectory(se(this,dt)));break}else if(a===101075792){fa(this,ts,this.readEndCentralDirectory64(se(this,dt)));break}else{console.error(`Unexpected ZIP signature 0x${a.toString(16).padStart(8,"0")} at index ${se(this,dt)}`);break}}}readLocalFile(a){let e=se(this,he).getUint32(a+18,!0),t=se(this,he).getUint32(a+22,!0);const i=se(this,he).getUint16(a+26,!0),r=se(this,he).getUint16(a+28,!0),s=a+30+i;if(this.readString(s,r),e===4294967295&&t===4294967295){let n=s,o=!1;for(;n<s+r-4;){const c=se(this,he).getUint16(n,!0),l=se(this,he).getUint16(n+2,!0);if(n+=4,c===1)if(l>=16){t=Number(se(this,he).getBigUint64(n,!0)),n+=8,e=Number(se(this,he).getBigUint64(n,!0)),o=!0;break}else throw new Error(`ZIP64 extra field found but is too small (expected at least 16 bytes, got ${l}).`);n+=l}if(!o)throw new Error("ZIP64 format missing extra field with signature 0x0001.")}return{signature:this.readString(a,4),version:se(this,he).getUint16(a+4,!0),generalPurpose:se(this,he).getUint16(a+6,!0),compressionMethod:se(this,he).getUint16(a+8,!0),lastModifiedTime:se(this,he).getUint16(a+10,!0),lastModifiedDate:se(this,he).getUint16(a+12,!0),crc:se(this,he).getUint32(a+14,!0),compressedSize:e,uncompressedSize:t,fileNameLength:i,extraLength:r,fileName:this.readString(a+30,i),extra:this.readString(a+30+i,r)}}readCentralDirectory(a){return{versionCreated:se(this,he).getUint16(a+4,!0),versionNeeded:se(this,he).getUint16(a+6,!0),fileNameLength:se(this,he).getUint16(a+28,!0),extraLength:se(this,he).getUint16(a+30,!0),fileCommentLength:se(this,he).getUint16(a+32,!0),diskNumber:se(this,he).getUint16(a+34,!0),internalAttributes:se(this,he).getUint16(a+36,!0),externalAttributes:se(this,he).getUint32(a+38,!0),offset:se(this,he).getUint32(a+42,!0),comments:this.readString(a+46,se(this,he).getUint16(a+32,!0))}}readEndCentralDirectory(a){const e=se(this,he).getUint16(a+20,!0);return{numberOfDisks:se(this,he).getUint16(a+4,!0),centralDirectoryStartDisk:se(this,he).getUint16(a+6,!0),numberCentralDirectoryRecordsOnThisDisk:se(this,he).getUint16(a+8,!0),numberCentralDirectoryRecords:se(this,he).getUint16(a+10,!0),centralDirectorySize:se(this,he).getUint32(a+12,!0),centralDirectoryOffset:se(this,he).getUint32(a+16,!0),commentLength:e,comment:this.readString(a+22,e)}}readEndCentralDirectory64(a){const e=Number(se(this,he).getBigUint64(a+0,!0));return{numberOfDisks:se(this,he).getUint32(a+16,!0),centralDirectoryStartDisk:se(this,he).getUint32(a+20,!0),numberCentralDirectoryRecordsOnThisDisk:Number(se(this,he).getBigUint64(a+24,!0)),numberCentralDirectoryRecords:Number(se(this,he).getBigUint64(a+32,!0)),centralDirectorySize:Number(se(this,he).getBigUint64(a+40,!0)),centralDirectoryOffset:Number(se(this,he).getBigUint64(a+48,!0)),commentLength:e,comment:""}}readString(a,e){return Array.from({length:e},(t,i)=>String.fromCharCode(se(this,he).getUint8(a+i))).join("")}get entries(){return se(this,sn)}};he=new WeakMap;dt=new WeakMap;sn=new WeakMap;oo=new WeakMap;ts=new WeakMap;var ce=class Ya{static arrayBufferToBase64(e){const t=new Uint8Array(e);return Ya.uint8tob64(t)}static async decompress(e){const t=e[0]===31&&e[1]===139&&e[2]===8?"gzip":e[0]===120&&(e[1]===1||e[1]===94||e[1]===156||e[1]===218)?"deflate":"deflate-raw",i=new DecompressionStream(t),r=i.writable.getWriter();r.write(e).catch(console.error);const s=r.close().catch(console.error),n=new Response(i.readable),o=new Uint8Array(await n.arrayBuffer());return await s,o}static async decompressToBuffer(e){const t=await Ya.decompress(e);return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}static async readMatV4(e,t=!1){let i=e.byteLength;if(i<40)throw new Error("File too small to be MAT v4: bytes = "+e.byteLength);let r=new DataView(e),s=r.getUint16(0,!0),n=e;if(s===35615||s===8075){const m=await this.decompress(new Uint8Array(e));r=new DataView(m.buffer),s=r.getUint16(0,!0),n=m.buffer,i=n.byteLength}const o=new TextDecoder("utf-8"),c=new Uint8Array(n);let l=0;const h={};function d(m){return Math.floor(m/10)%10}function f(m,p,g){const b=new Uint8Array(c.subarray(p,g));return m===1?new Float32Array(b.buffer):m===2?new Int32Array(b.buffer):m===3?new Int16Array(b.buffer):m===4?new Uint16Array(b.buffer):m===5?new Uint8Array(b.buffer):new Float64Array(b.buffer)}function u(){const m=r.getUint32(l,!0),p=r.getUint32(l+4,!0),g=r.getUint32(l+8,!0),b=r.getUint32(l+12,!0),A=r.getUint32(l+16,!0);if(l+=20,b!==0)throw new Error("Matlab V4 reader does not support imaginary numbers");const y=p*g;if(y<1)throw new Error("mrows * ncols must be greater than one");const x=new Uint8Array(c.subarray(l,l+A));let E=o.decode(x).trim().replaceAll("\0","");t&&(E=E.replaceAll(".","_"));const I=d(m);let w=8;if(I>=1&&I<=2)w=4;else if(I>=3&&I<=4)w=2;else if(I===5)w=1;else if(I!==0)throw new Error("impossible Matlab v4 datatype");if(l+=A,m>50)throw new Error("Does not appear to be little-endian V4 Matlab file");const v=l+y*w;h[E]=f(I,l,v),l=v}for(;l+20<i;)u();return h}static b64toUint8(e){const t=atob(e),i=t.length,r=new Uint8Array(i);for(let s=0;s<i;s++)r[s]=t.charCodeAt(s);return r}static uint8tob64(e){let t="";const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=e.byteLength,s=r%3,n=r-s;let o,c,l,h,d;for(let f=0;f<n;f=f+3)d=e[f]<<16|e[f+1]<<8|e[f+2],o=(d&16515072)>>18,c=(d&258048)>>12,l=(d&4032)>>6,h=d&63,t+=i[o]+i[c]+i[l]+i[h];return s===1?(d=e[n],o=(d&252)>>2,c=(d&3)<<4,t+=i[o]+i[c]+"=="):s===2&&(d=e[n]<<8|e[n+1],o=(d&64512)>>10,c=(d&1008)>>4,l=(d&15)<<2,t+=i[o]+i[c]+i[l]+"="),t}static download(e,t,i){const r=document.createElement("a"),s=Array.isArray(e)?e:[e],n=new Blob(s,{type:i});r.href=URL.createObjectURL(n),r.download=t,r.click()}static readFileAsync(e){return new Promise((t,i)=>{const r=new FileReader;r.onload=()=>{t(r.result)},r.onerror=i,r.readAsArrayBuffer(e)})}static blobToBase64(e){return new Promise(t=>{const i=new FileReader;i.onloadend=()=>t(i.result),i.readAsDataURL(e)})}static async decompressBase64String(e){const t=atob(e),i=new ArrayBuffer(t.length),r=new Uint8Array(i);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return Ya.decompressArrayBuffer(r)}static async compressToBase64String(e){const t=await Ya.compressStringToArrayBuffer(e);return Ya.uint8tob64(new Uint8Array(t))}static strToU8(e,t){if(t){const c=new Uint8Array(e.length);for(let l=0;l<e.length;++l)c[l]=e.charCodeAt(l);return c}const i=e.length,r=(c,l,h)=>((h==null||h>c.length)&&(h=c.length),new Uint8Array(c.subarray(l,h)));let s=new Uint8Array(e.length+(e.length>>1)),n=0;const o=c=>{s[n++]=c};for(let c=0;c<i;++c){if(n+5>s.length){const h=new Uint8Array(n+8+(i-c<<1));h.set(s),s=h}let l=e.charCodeAt(c);l<128||t?o(l):l<2048?(o(192|l>>6),o(128|l&63)):(l>55295&&l<57344,l=65536+(l&1047552)|e.charCodeAt(++c)&1023,o(240|l>>18),o(128|l>>12&63),o(128|l>>6&63),o(128|l&63))}return r(s,0,n)}static async compress(e,t="gzip"){const i=new CompressionStream(t),r=i.writable.getWriter();r.write(e).catch(console.error);const s=r.close().catch(console.error),o=await new Response(i.readable).arrayBuffer();return await s,o}static async compressStringToArrayBuffer(e){const t=this.strToU8(e);return await this.compress(t)}static isArrayBufferCompressed(e){if(e&&e.byteLength){const t=new Uint8Array(e);return(t[0]<<8|t[1])===8075}else return!1}static strFromU8(e,t){if(t){let i="";for(let r=0;r<e.length;r+=16384)i+=String.fromCharCode.apply(null,e.subarray(r,r+16384));return i}else{const i=(o,c,l)=>((c==null||c<0)&&(c=0),(l==null||l>o.length)&&(l=o.length),new Uint8Array(o.subarray(c,l))),r=o=>{for(let c="",l=0;;){let h=o[l++];const d=(h>127)+(h>223)+(h>239);if(l+d>o.length)return{s:c,r:i(o,l-1)};d?d===3?(h=((h&15)<<18|(o[l++]&63)<<12|(o[l++]&63)<<6|o[l++]&63)-65536,c+=String.fromCharCode(55296|h>>10,56320|h&1023)):d&1?c+=String.fromCharCode((h&31)<<6|o[l++]&63):c+=String.fromCharCode((h&15)<<12|(o[l++]&63)<<6|o[l++]&63):c+=String.fromCharCode(h)}},{s,r:n}=r(e);if(n.length)throw new Error("Unexpected trailing bytes in UTF-8 decoding");return s}}static async decompressArrayBuffer(e){const t=await this.decompress(new Uint8Array(e));return this.strFromU8(t)}static arraysAreEqual(e,t){return vf(e,t)}static range(e,t,i){return Array.from({length:(t-e)/i+1},(r,s)=>e+s*i)}static sph2cartDeg(e,t){const i=-t*(Math.PI/180),r=(e-90)%360*(Math.PI/180),s=[Math.cos(i)*Math.cos(r),Math.cos(i)*Math.sin(r),Math.sin(i)],n=Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]);return n<=0||(s[0]/=n,s[1]/=n,s[2]/=n),s}static vox2mm(e,t){const i=Ke(t);xt(i,i);const r=Be(e[0],e[1],e[2],1);return it(r,r,i),ee(r[0],r[1],r[2])}},Wr=V,je=class qe{static readTRACT(e){const t=e.byteLength;if(t<20)throw new Error("File too small to be niml.tract: bytes = "+t);const i=new DataView(e),r=new Uint8Array(e);let s=0;function n(){for(;s<t&&r[s]!==60;)s++;const p=s;for(;s<t&&r[s]!==62;)s++;return s++,s-p<1?"":new TextDecoder().decode(e.slice(p,s-1)).trim()}let o=n();function c(p){const g=o.indexOf(p);if(g<0)return 0;const b=o.indexOf('"',g)+1,A=o.indexOf('"',b),y=o.slice(b,A);return parseInt(y)}const l=c("N_tracts=");(!o.startsWith("<network")||l<1)&&V.warn("This is not a valid niml.tract file "+o);let h=0;const d=[];d.push(h);const f=[],u=[];for(let p=0;p<l;p++){o=n();const g=c("ni_dimen="),b=c("Bundle_Tag="),A=o.includes("binary.lsbfirst");for(let y=0;y<g;y++){s+=4;const x=i.getUint32(s,A)/3;s+=4;for(let E=0;E<x;E++)f.push(i.getFloat32(s,A)),s+=4,f.push(-i.getFloat32(s,A)),s+=4,f.push(i.getFloat32(s,A)),s+=4;h+=x,d.push(h),u.push(b)}o=n()}const m=[];return m.push({id:"tract",vals:Float32Array.from(u)}),{pts:new Float32Array(f),offsetPt0:new Uint32Array(d),dps:m}}static async readTT(e){let t=new Uint32Array(0),i=new Float32Array(0);const r=await ce.readMatV4(e);if(!("trans_to_mni"in r))throw new Error("TT format file must have 'trans_to_mni'");if(!("voxel_size"in r))throw new Error("TT format file must have 'voxel_size'");if(!("track"in r))throw new Error("TT format file must have 'track'");let s=we();const n=r.trans_to_mni;s=Ct(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15]),xt(s,s);function o(c){const l=new DataView(c.buffer),h=[];let d=0,f=0;for(;f<c.length;){h.push(f);const p=l.getUint32(f,!0);f=f+p+13,d+=p}t=new Uint32Array(h.length+1),i=new Float32Array(d);let u=0;for(let p=0;p<h.length;p++){t[p]=u/3;let g=h[p];const b=l.getUint32(g,!0)/3;let A=l.getInt32(g+4,!0),y=l.getInt32(g+8,!0),x=l.getInt32(g+12,!0);g+=16,i[u++]=A,i[u++]=y,i[u++]=x;for(let E=2;E<=b;E++)A=A+l.getInt8(g++),y=y+l.getInt8(g++),x=x+l.getInt8(g++),i[u++]=A,i[u++]=y,i[u++]=x}for(let p=0;p<u;p++)i[p]=i[p]/32;let m=0;for(let p=0;p<u/3;p++){const g=Be(i[m],i[m+1],i[m+2],1);it(g,g,s),i[m++]=g[0],i[m++]=g[1],i[m++]=g[2]}t[h.length]=u/3}return o(r.track),{pts:i,offsetPt0:t}}static assembleDpgFromMap(e,t){if(!Array.isArray(t)||t.length===0)throw new Error('assembleDpgFromMap: "groups" is empty or missing; cannot assemble dpg.');for(let c=0;c<t.length;c++){const l=String(t[c].id);if(!e[l])throw new Error(`assembleDpgFromMap: missing dpgMap entry for group "${l}".`);if(!Array.isArray(e[l]))throw new Error(`assembleDpgFromMap: dpgMap["${l}"] is not an array.`)}const i=String(t[0].id),r=e[i],s=[],n=new Set;for(const c of r){if(!c||typeof c.id!="string")throw new Error(`assembleDpgFromMap: invalid entry in group "${i}".`);if(n.has(c.id))throw new Error(`assembleDpgFromMap: duplicate tag "${c.id}" in group "${i}".`);n.add(c.id),s.push(c.id)}if(n.size===0)throw new Error(`assembleDpgFromMap: no tags found in group "${i}".`);for(let c=1;c<t.length;c++){const l=String(t[c].id),h=e[l],d=new Map;for(const f of h){if(!f||typeof f.id!="string")throw new Error(`assembleDpgFromMap: invalid entry in group "${l}".`);d.set(f.id,(d.get(f.id)||0)+1)}for(const[f,u]of d.entries())if(u>1)throw new Error(`assembleDpgFromMap: multiple entries for tag "${f}" in group "${l}".`);if(d.size!==n.size)throw new Error(`assembleDpgFromMap: tag coverage mismatch for group "${l}". Expected ${n.size} tags but found ${d.size}.`);for(const f of n)if(!d.has(f))throw new Error(`assembleDpgFromMap: group "${l}" missing tag "${f}".`)}const o=[];for(const c of s){const l=[];let h=0;for(let u=0;u<t.length;u++){const m=String(t[u].id),g=e[m].filter(A=>A.id===c);if(g.length===0)throw new Error(`assembleDpgFromMap: missing tag "${c}" for group "${m}".`);if(g.length>1)throw new Error(`assembleDpgFromMap: multiple entries for tag "${c}" in group "${m}".`);const b=g[0];if(b.vals instanceof Float32Array)l.push(b.vals),h+=b.vals.length;else try{const A=Float32Array.from(b.vals);l.push(A),h+=A.length}catch{throw new Error(`assembleDpgFromMap: invalid vals for tag "${c}" in group "${m}".`)}}const d=new Float32Array(h);let f=0;for(const u of l)d.set(u,f),f+=u.length;o.push({id:c,vals:d})}return o}static async readTRX(e){function t(p){const g=(p&31744)>>10,b=p&1023;return(p>>15?-1:1)*(g?g===31?b?NaN:1/0:Math.pow(2,g-15)*(1+b/1024):6103515625e-14*(b/1024))}let i=0,r=0,s=new Float32Array([]);const n=[],o={},c=[],l=[],h=[];let d=[],f=!1;const u=new Sh(e);for(let p=0;p<u.entries.length;p++){const g=u.entries[p];if(g.uncompressedSize===0)continue;const b=g.fileName.split("/"),A=b.slice(-1)[0];if(A.startsWith("."))continue;const y=b.slice(-3)[0],x=b.slice(-2)[0],E=A.split(".")[0],I=await g.extract();if(A.includes("header.json")){const M=new TextDecoder().decode(I);d=JSON.parse(M);continue}let w=0,v=[];if(A.endsWith(".uint64")||A.endsWith(".int64")){w=I.length/8,v=new Uint32Array(w);const M=new Uint32Array(I.buffer);let C=0;for(let D=0;D<w;D++)v[D]=M[C],M[C+1]!==0&&(f=!0),C+=2}else if(A.endsWith(".uint32"))v=new Uint32Array(I.buffer);else if(A.endsWith(".uint16"))v=new Uint16Array(I.buffer);else if(A.endsWith(".uint8"))v=new Uint8Array(I.buffer);else if(A.endsWith(".int32"))v=new Int32Array(I.buffer);else if(A.endsWith(".int16"))v=new Int16Array(I.buffer);else if(A.endsWith(".int8"))v=new Int8Array(I.buffer);else if(A.endsWith(".float64"))v=new Float64Array(I.buffer);else if(A.endsWith(".float32"))v=new Float32Array(I.buffer);else if(A.endsWith(".float16")){w=I.length/2,v=new Float32Array(w);const M=new Uint16Array(I.buffer),C=new Float32Array(65536);for(let D=0;D<65536;D++)C[D]=t(D);for(let D=0;D<w;D++)v[D]=C[M[D]]}else continue;if(w=v.length,x.includes("groups")){c.push({id:E,vals:Float32Array.from(v.slice())});continue}if(y.includes("dpg")){const M=String(x);o[M]||(o[M]=[]),o[M].push({id:E,vals:Float32Array.from(v.slice())});continue}if(x.includes("dpv")){h.push({id:E,vals:Float32Array.from(v.slice())});continue}if(x.includes("dps")){l.push({id:E,vals:Float32Array.from(v.slice())});continue}if(A.startsWith("offsets.")){i=w;for(let M=0;M<w;M++)n[M]=v[M]}A.startsWith("positions.3.")&&(r=w,s=new Float32Array(v))}if(i===0||r===0)throw new Error("Failure reading TRX format (no offsets or points).");if(f)throw new Error("Too many vertices: JavaScript does not support 64 bit integers");let m=[];return c.length>0&&o&&Object.keys(o).length>0&&(m=this.assembleDpgFromMap(o,c)),n[i]=r/3,{pts:s,offsetPt0:new Uint32Array(n),dpg:m,dps:l,dpv:h,groups:c,header:d}}static readTXT(e,t=0){const r=new TextDecoder("utf-8").decode(e).split(/\r?\n|\r/).filter(n=>n.trim().length>0);t<=0&&(t=r.length);const s=new Float32Array(t);for(let n=0;n<t&&n<r.length;n++){const o=parseFloat(r[n].trim());s[n]=Number.isFinite(o)?o:0}return s}static readTSF(e,t=0){const i=new Float32Array(t),r=e.byteLength;if(r<20)throw new Error("File too small to be TSF: bytes = "+r);const s=new Uint8Array(e);let n=0;function o(){for(;n<r&&s[n]===10;)n++;const f=n;for(;n<r&&s[n]!==10;)n++;return n++,n-f<1?"":new TextDecoder().decode(e.slice(f,n-1))}let c=o();if(!c.includes("mrtrix track scalars"))throw new Error("Not a valid TSF file");let l=-1;for(;n<r&&!c.includes("END");)if(c=o(),c.toLowerCase().startsWith("file:")&&(l=parseInt(c.split(" ").pop())),c.toLowerCase().startsWith("datatype:")&&!c.endsWith("Float32LE"))throw new Error("Only supports TSF files with Float32LE");if(l<20)throw new Error("Not a valid TSF file (missing file offset)");n=l;const h=new DataView(e);let d=0;for(;n+4<=r&&d<t;){const f=h.getFloat32(n,!0);if(n+=4,isFinite(f))i[d++]=f;else if(!isNaN(f))break}return i}static readTCK(e){const t=e.byteLength;if(t<20)throw new Error("File too small to be TCK: bytes = "+t);const i=new Uint8Array(e);let r=0;function s(){for(;r<t&&i[r]===10;)r++;const m=r;for(;r<t&&i[r]!==10;)r++;return r++,r-m<1?"":new TextDecoder().decode(e.slice(m,r-1))}let n=s();if(!n.includes("mrtrix tracks"))throw new Error("Not a valid TCK file");let o=-1;for(;r<t&&!n.includes("END");)n=s(),n.toLowerCase().startsWith("file:")&&(o=parseInt(n.split(" ").pop()));if(o<20)throw new Error("Not a valid TCK file (missing file offset)");r=o;const c=new DataView(e);let l=0,h=new Uint32Array(t/16),d=0,f=0,u=new Float32Array(t/4);for(h[0]=0;r+12<t;){const m=c.getFloat32(r,!0);r+=4;const p=c.getFloat32(r,!0);r+=4;const g=c.getFloat32(r,!0);if(r+=4,isFinite(m))u[f++]=m,u[f++]=p,u[f++]=g,l++;else if(h[d++]=l,!isNaN(m))break}return u=u.slice(0,f),h=h.slice(0,d),{pts:u,offsetPt0:h}}static async readTRK(e){let t=new DataView(e),i=t.getUint32(0,!0);if(i!==1128354388){let D;if(i===4247762216)throw new Error("zstd TRK decompression is not supported");D=await ce.decompress(new Uint8Array(e)),e=D.buffer,t=new DataView(e),i=t.getUint32(0,!0)}const r=t.getUint32(992,!0),s=t.getUint32(996,!0);if(r>2||s!==1e3||i!==1128354388)throw new Error("Not a valid TRK file");const n=t.getInt16(36,!0),o=[];for(let D=0;D<n;D++){const S=new Uint8Array(e.slice(38+D*20,58+D*20)),k=new TextDecoder().decode(S).split("\0").shift();o.push({id:k.trim(),vals:[]})}const c=t.getFloat32(12,!0),l=t.getFloat32(16,!0),h=t.getFloat32(20,!0),d=Ct(1/c,0,0,-.5,0,1/l,0,-.5,0,0,1/h,-.5,0,0,0,1),f=t.getInt16(238,!0),u=[];for(let D=0;D<f;D++){const S=new Uint8Array(e.slice(240+D*20,260+D*20)),k=new TextDecoder().decode(S).split("\0").shift();u.push({id:k.trim(),vals:[]})}const m=we();for(let D=0;D<16;D++)m[D]=t.getFloat32(440+D*4,!0);m[15]===0&&(V.warn("TRK vox_to_ras not set"),rh(m));const p=we();sh(p,d,m);let g=null,b=null;g=new Int32Array(e.slice(s)),b=new Float32Array(g.buffer);const A=g.length;if(A<1)throw new Error("Empty TRK file.");let y=0,x=0,E=new Uint32Array(g.length/4),I=0,w=new Float32Array(g.length),v=0;for(;y<A;){const D=g[y];y=y+1,E[I++]=x;for(let S=0;S<D;S++){const k=b[y+0],F=b[y+1],B=b[y+2];if(y+=3,w[v++]=k*p[0]+F*p[1]+B*p[2]+p[3],w[v++]=k*p[4]+F*p[5]+B*p[6]+p[7],w[v++]=k*p[8]+F*p[9]+B*p[10]+p[11],n>0)for(let O=0;O<n;O++)o[O].vals.push(b[y]),y++;x++}if(f>0)for(let S=0;S<f;S++)u[S].vals.push(b[y]),y++}const M=[];for(let D=0;D<u.length;D++)M.push({id:u[D].id,vals:Float32Array.from(u[D].vals)});const C=[];for(let D=0;D<o.length;D++)C.push({id:o[D].id,vals:Float32Array.from(o[D].vals)});return E[I++]=x,w=w.slice(0,v),E=E.slice(0,I),{pts:w,offsetPt0:E,dps:M,dpv:C}}static readTxtVTK(e){const r=new TextDecoder("utf-8").decode(e).split(`
`);if(r.length<7||!r[0].startsWith("# vtk DataFile"))throw new Error("Invalid VTK image");if(!r[2].startsWith("ASCII"))throw new Error("Not ASCII VTK mesh");let n=3;for(;r[n].length<1;)n++;if(!r[n].includes("POLYDATA"))throw new Error("Not ASCII VTK polydata");for(n++;r[n].length<1;)n++;if(!r[n].startsWith("POINTS"))throw new Error("Not VTK POINTS");let o=r[n].trim().split(/\s+/);const c=parseInt(o[1]),l=c*3,h=new Float32Array(c*3);let d=0;for(;d<c*3;){n++;const p=r[n].trim().trim().split(/\s+/);for(let g=0;g<p.length&&!(d>=l);g++)h[d]=parseFloat(p[g]),d++}const f=[];for(n++;r[n].length<1;)n++;if(r[n].startsWith("METADATA")){for(;r[n].length>1;)n++;n++}if(o=r[n].trim().split(/\s+/),n++,o[0].includes("LINES")){const m=parseInt(o[1]);if(m<1)throw new Error("Corrupted VTK ASCII");let p=r[n].trim();const g=[];let b=[];if(p.startsWith("OFFSETS")){n++;let A=0;for(;A<m;){p=r[n].trim(),n++;const y=p.trim().split(/\s+/);for(let x=0;x<y.length&&(g[A]=parseInt(y[x]),A++,!(A>=m));x++);}b=Array.from(h)}else{let A=function(){p=r[n].trim();const I=p.trim().split(/\s+/);x=[];for(let w=0;w<I.length;w++)x.push(parseInt(I[w]));E=0,n++},y=0;g[0]=0;let x=[],E=0;A();for(let I=0;I<m;I++){E>=x.length&&A();const w=x[E++];y+=w,g[I+1]=y;for(let v=0;v<w;v++){E>=x.length&&A();const M=x[E++]*3;b.push(h[M+0]),b.push(h[M+1]),b.push(h[M+2])}}}return{pts:Float32Array.from(b),offsetPt0:Uint32Array.from(g)}}else if(o[0].includes("TRIANGLE_STRIPS")){const m=parseInt(o[1]);for(let p=0;p<m;p++){const g=r[n].trim();n++;const b=g.trim().split(/\s+/),A=parseInt(b[0])-2;let y=1;for(let x=0;x<A;x++)x%2?(f.push(parseInt(b[y+2])),f.push(parseInt(b[y+1])),f.push(parseInt(b[y]))):(f.push(parseInt(b[y])),f.push(parseInt(b[y+1])),f.push(parseInt(b[y+2]))),y+=1}}else if(o[0].includes("POLYGONS")){const m=parseInt(o[1]);for(let p=0;p<m;p++){const g=r[n].trim();n++;const b=g.trim().split(/\s+/),A=parseInt(b[0])-2,y=parseInt(b[1]);let x=parseInt(b[2]);for(let E=0;E<A;E++){const I=parseInt(b[3+E]);f.push(y),f.push(x),f.push(I),x=I}}}else throw new Error("Unsupported ASCII VTK datatype "+o[0]);const u=new Uint32Array(f);return{positions:h,indices:u}}static async readLayer(e="",t,i,r=.5,s="warm",n="winter",o=!1,c=null,l=null,h=0){const d={...Ip,colormapInvert:!1,colormapType:0,isTransparentBelowCalMin:!0,isAdditiveBlend:!1,colorbarVisible:!0,colormapLabel:null},f=/(?:\.([^.]+))?$/;let u=f.exec(e)[1];u=u.toUpperCase(),u==="GZ"&&(u=f.exec(e.slice(0,-3))[1],u=u.toUpperCase());const m=i.vertexCount/3;if(i.offsetPt0){const b=e.split("/");let A="Unknown";if(b.length>1&&b.pop()&&(A=A.split(".").slice(0,-1).join(".")),u==="TXT"){const w=i.offsetPt0.length-1,v=qe.readTXT(t,w);if(v.length!==w)throw new Error(`TXT file has ${v.length} items, expected one per streamline (${w}).`);i.dps||(i.dps=[]);const M=v.reduce((D,S)=>Math.min(D,S)),C=v.reduce((D,S)=>Math.max(D,S));return i.dps.push({id:A,vals:Float32Array.from(v.slice()),global_min:M,global_max:C,cal_min:M,cal_max:C}),d}if(u!=="TSF")throw new Error("readLayer for streamlines only supports TSF and TXT files.");const y=i.pts.length/3,x=qe.readTSF(t,y);i.dpv||(i.dpv=[]);const E=x.reduce((w,v)=>Math.min(w,v)),I=x.reduce((w,v)=>Math.max(w,v));return i.dpv.push({id:A,vals:Float32Array.from(x.slice()),global_min:E,global_max:I,cal_min:E,cal_max:I}),d}if(m<3){V.error("n_vert < 3 in layer");return}if(u==="MZ3"){const b=await qe.readMZ3(t,m);d.values=b.scalars,"colormapLabel"in b&&(d.colormapLabel=b.colormapLabel)}else if(u==="ANNOT"){const b=qe.readANNOT(t,m,!0);b instanceof Uint32Array?d.values=b:(d.values=b.scalars,d.colormapLabel=b.colormapLabel)}else if(u==="CRV"||u==="CURV"||u==="THICKNESS"||u==="AREA")d.values=qe.readCURV(t,m),d.isTransparentBelowCalMin=!1;else if(u==="GII"){const b=await qe.readGII(t,m);d.values=b.scalars,d.colormapLabel=b.colormapLabel}else if(u==="MGH"||u==="MGZ"){const b=await qe.readMGH(t,m,!0);"scalars"in b?(d.values=b.scalars,d.colormapLabel=b.colormapLabel):d.values=b}else if(u==="NII")d.values=await qe.readNII(t,i.pts,i.anatomicalStructurePrimary);else if(u==="SMP")d.values=await qe.readSMP(t,m);else if(u==="STC")d.values=qe.readSTC(t,m);else if(qe.isCurv(t))d.values=qe.readCURV(t,m),d.isTransparentBelowCalMin=!1;else return V.warn("Unknown layer overlay format "+e),d;if(!d.values){V.error("no values in layer");return}d.nFrame4D=d.values.length/m,d.frame4D=0,d.outlineBorder=h;let p=d.values[0],g=d.values[0];for(let b=0;b<d.values.length;b++)p=Math.min(p,d.values[b]),g=Math.max(g,d.values[b]);return d.global_min=p,d.global_max=g,d.cal_min=c||0,c||(d.cal_min=p),d.cal_max=l||0,l||(d.cal_max=g),d.cal_minNeg=NaN,d.cal_maxNeg=NaN,d.opacity=r,d.colormap=s,d.colormapNegative=n,d.useNegativeCmap=o,d}static async readSMP(e,t){const i=e.byteLength;let r=new DataView(e),s=r.getUint16(0,!0);if(s>5){const d=await ce.decompress(new Uint8Array(e));r=new DataView(d.buffer),s=r.getUint16(0,!0),e=d.buffer}s>5&&V.error("Unsupported or invalid BrainVoyager SMP version "+s);const n=r.getUint32(2,!0);n!==t&&V.error("SMP file has "+n+" vertices, background mesh has "+t);const o=r.getUint16(6,!0),c=new Float32Array(n*o);let l=9;function h(){const d=l;for(;l<i&&r.getUint8(l)!==0;)l++;return l++,new TextDecoder().decode(e.slice(d,l-1))}h();for(let d=0;d<o;d++){const f={};f.mapType=r.getUint32(l,!0),l+=4,s>=3&&f.mapType===3&&(f.nLags=r.getUint32(l,!0),l+=4,f.mnLag=r.getUint32(l,!0),l+=4,f.mxLag=r.getUint32(l,!0),l+=4,f.ccOverlay=r.getUint32(l,!0),l+=4),f.clusterSize=r.getUint32(l,!0),l+=4,f.clusterCheck=r.getUint8(l),l+=1,f.critThresh=r.getFloat32(l,!0),l+=4,f.maxThresh=r.getFloat32(l,!0),l+=4,s>=4&&(f.includeValuesGreaterThreshMax=r.getUint32(l,!0),l+=4),f.df1=r.getUint32(l,!0),l+=4,f.df2=r.getUint32(l,!0),l+=4,s>=5?(f.posNegFlag=r.getUint32(l,!0),l+=4):f.posNegFlag=3,f.cortexBonferroni=r.getUint32(l,!0),l+=4,f.posMinRGB=[0,0,0],f.posMaxRGB=[0,0,0],f.negMinRGB=[0,0,0],f.negMaxRGB=[0,0,0],s>=2&&(f.posMinRGB[0]=r.getUint8(l),l++,f.posMinRGB[1]=r.getUint8(l),l++,f.posMinRGB[2]=r.getUint8(l),l++,f.posMaxRGB[0]=r.getUint8(l),l++,f.posMaxRGB[1]=r.getUint8(l),l++,f.posMaxRGB[2]=r.getUint8(l),l++,s>=4&&(f.negMinRGB[0]=r.getUint8(l),l++,f.negMinRGB[1]=r.getUint8(l),l++,f.negMinRGB[2]=r.getUint8(l),l++,f.negMaxRGB[0]=r.getUint8(l),l++,f.negMaxRGB[1]=r.getUint8(l),l++,f.negMaxRGB[2]=r.getUint8(l),l++),f.enableSMPColor=r.getUint8(l),l++,s>=4&&(f.lut=h()),f.colorAlpha=r.getFloat32(l,!0),l+=4),f.name=h();const u=new Float32Array(e,l,n);c.set(u,d*n),l+=n*4}return c}static readSTC(e,t){const i=new DataView(e),r=i.getInt32(8,!1);if(r!==t)throw new Error("Overlay has "+r+" vertices, expected "+t);let s=12+r*4;const n=i.getUint32(s,!1);s+=4;const o=new Float32Array(n*r);for(let c=0;c<n*r;c++)o[c]=i.getFloat32(s,!1),s+=4;return o}static isCurv(e){const t=new DataView(e),i=t.getUint8(0),r=t.getUint8(1),s=t.getUint8(2);return i!==255||r!==255||s!==255?(Wr.debug("Unable to recognize file type: does not appear to be FreeSurfer format."),!1):!0}static readCURV(e,t){const i=new DataView(e),r=i.getUint8(0),s=i.getUint8(1),n=i.getUint8(2),o=i.getUint32(3,!1),c=i.getUint32(11,!1);if((r!==255||s!==255||n!==255)&&Wr.debug("Unable to recognize file type: does not appear to be FreeSurfer format."),t!==o)throw new Error("CURV file has different number of vertices ( "+o+")than mesh ("+t+")");if(e.byteLength<15+4*o*c)throw new Error("CURV file smaller than specified");const l=new Float32Array(c*o);let h=15;for(let m=0;m<c*o;m++)l[m]=i.getFloat32(h,!1),h+=4;let d=l[0],f=l[0];for(let m=0;m<l.length;m++)d=Math.min(d,l[m]),f=Math.max(f,l[m]);const u=1/(f-d);for(let m=0;m<l.length;m++)l[m]=1-(l[m]-d)*u;return l}static readANNOT(e,t,i=!1){const r=new DataView(e),s=r.getUint32(0,!1),n=this.decimateLayerVertices(s,t);if(t!==n)throw new Error("ANNOT file has different number of vertices than mesh");if(e.byteLength<4+8*s)throw new Error("ANNOT file smaller than specified");let o=0;const c=new Uint32Array(s);for(let y=0;y<s;y++){const x=r.getUint32(o+=4,!1);c[x]=r.getUint32(o+=4,!1)}if(!i)return c;let l=0;try{l=r.getInt32(o+=4,!1)}catch{return c}if(l!==1||r.getInt32(o+=4,!1)>0)return c;const f=r.getInt32(o+=4,!1),u=r.getInt32(o+=4,!1);o+=u;const m=r.getInt32(o+=4,!1);if(m<1)return c;const p={R:Array(f).fill(0),G:Array(f).fill(0),B:Array(f).fill(0),A:Array(f).fill(0),I:Array(f).fill(0),labels:Array(f).fill("")};for(let y=0;y<m;y++){const x=r.getInt32(o+=4,!1),E=r.getInt32(o+=4,!1);o+=4;let I="";for(let D=0;D<E;D++){const S=r.getUint8(o++);if(S===0)break;I+=String.fromCharCode(S)}o-=4;const w=r.getInt32(o+=4,!1),v=r.getInt32(o+=4,!1),M=r.getInt32(o+=4,!1),C=r.getInt32(o+=4,!1);if(x<0||x>=f){V.warn("annot entry out of range");continue}p.R[x]=w,p.G[x]=v,p.B[x]=M,p.A[x]=C,p.I[x]=(C<<24)+(M<<16)+(v<<8)+w,p.labels[x]=I}const g=new Float32Array(s);g.fill(-1);let b=0;for(let y=0;y<t;y++){const x=c[y];for(let E=0;E<f;E++)if(p.I[E]===x){g[y]=E;break}g[y]<0&&(b++,g[y]=0)}b>0&&V.error(`annot vertex colors do not match ${b} of ${s} vertices.`);for(let y=0;y<f;y++)p.I[y]=y;const A=Ie.makeLabelLut(p);return{scalars:g,colormapLabel:A}}static readNV(e){const t=e.byteLength,i=new Uint8Array(e);let r=0;function s(){for(;r<t&&i[r]===10;)r++;const f=r;for(;r<t&&i[r]!==10;)r++;return r++,r-f<1?"":new TextDecoder().decode(e.slice(f,r-1))}let n=0,o=0,c=0,l=0,h,d;for(;r<t;){const f=s();if(f.startsWith("#"))continue;const u=f.trim().split(/\s+/);if(n<1){n=parseInt(u[0]),h=new Float32Array(n*3);continue}if(c<n*3){h[c]=parseFloat(u[0]),h[c+1]=parseFloat(u[1]),h[c+2]=parseFloat(u[2]),c+=3;continue}if(o<1){o=parseInt(u[0]),d=new Uint32Array(o*3);continue}if(l>=o*3)break;d[l+2]=parseInt(u[0])-1,d[l+1]=parseInt(u[1])-1,d[l+0]=parseInt(u[2])-1,l+=3}return{positions:h,indices:d}}static readASC(e){const t=e.byteLength,i=new Uint8Array(e);let r=0;function s(){for(;r<t&&i[r]===10;)r++;const u=r;for(;r<t&&i[r]!==10;)r++;return r++,r-u<1?"":new TextDecoder().decode(e.slice(u,r-1))}let n=s();n.startsWith("#!ascii")||V.warn("Invalid ASC mesh"),n=s();let o=n.trim().split(/\s+/);const c=parseInt(o[0]),l=parseInt(o[1]),h=new Float32Array(c*3);let d=0;for(let u=0;u<c;u++)n=s(),o=n.trim().split(/\s+/),h[d]=parseFloat(o[0]),h[d+1]=parseFloat(o[1]),h[d+2]=parseFloat(o[2]),d+=3;const f=new Uint32Array(l*3);d=0;for(let u=0;u<l;u++)n=s(),o=n.trim().split(/\s+/),f[d]=parseInt(o[0]),f[d+1]=parseInt(o[1]),f[d+2]=parseInt(o[2]),d+=3;return{positions:h,indices:f}}static readVTK(e){const t=e.byteLength;if(t<20)throw new Error("File too small to be VTK: bytes = "+e.byteLength);const i=new Uint8Array(e);let r=0;function s(p=!0){if(p)for(;r<t&&i[r]===10;)r++;const g=r;for(;r<t&&i[r]!==10;)r++;return r++,r-g<1?"":new TextDecoder().decode(e.slice(g,r-1))}let n=s();if(!n.startsWith("# vtk DataFile"))throw new Error("Invalid VTK mesh");if(n=s(!1),n=s(),n.startsWith("ASCII"))return qe.readTxtVTK(e);if(!n.startsWith("BINARY"))throw new Error("Invalid VTK image, expected ASCII or BINARY "+n);if(n=s(),!n.includes("POLYDATA"))throw new Error("Only able to read VTK POLYDATA "+n);n=s(),(!n.includes("POINTS")||!n.includes("double")&&!n.includes("float"))&&V.warn("Only able to read VTK float or double POINTS"+n);const o=n.includes("double");let c=n.trim().split(/\s+/);const h=parseInt(c[1])*3,d=new Float32Array(h),f=new DataView(e);if(o)for(let p=0;p<h;p++)d[p]=f.getFloat64(r,!1),r+=8;else for(let p=0;p<h;p++)d[p]=f.getFloat32(r,!1),r+=4;n=s(),c=n.trim().split(/\s+/);const u=[];if(c[0].includes("LINES")){const p=parseInt(c[1]),g=r;if(n=s(),n.startsWith("OFFSETS")){let x=!1;n.includes("int64")&&(x=!0);const E=new Uint32Array(p);if(x){let w=!1;for(let v=0;v<p;v++){let M=f.getInt32(r,!1);M!==0&&(w=!0),r+=4,M=f.getInt32(r,!1),r+=4,E[v]=M}w&&V.warn("int32 overflow: JavaScript does not support int64")}else for(let w=0;w<p;w++){const v=f.getInt32(r,!1);r+=4,E[w]=v}return{pts:d,offsetPt0:E}}r=g;let b=0;const A=[],y=[];A.push(b);for(let x=0;x<p;x++){const E=f.getInt32(r,!1);r+=4,b+=E,A.push(b);for(let I=0;I<E;I++){const w=f.getInt32(r,!1)*3;r+=4,y.push(d[w+0]),y.push(d[w+1]),y.push(d[w+2])}}return{pts:Float32Array.from(y),offsetPt0:Uint32Array.from(A)}}else if(c[0].includes("TRIANGLE_STRIPS")){const p=parseInt(c[1]);for(let g=0;g<p;g++){const b=f.getInt32(r,!1)-2;r+=4;for(let A=0;A<b;A++)A%2?(u.push(f.getInt32(r+8,!1)),u.push(f.getInt32(r+4,!1)),u.push(f.getInt32(r,!1))):(u.push(f.getInt32(r,!1)),u.push(f.getInt32(r+4,!1)),u.push(f.getInt32(r+8,!1))),r+=4;r+=8}}else if(c[0].includes("POLYGONS")){const p=parseInt(c[1]),g=r,b=s();if(b.startsWith("OFFSETS")){let A=b.includes("int64");const y=new Uint32Array(p);let x=!1;for(let v=0;v<p;v++)A&&(f.getInt32(r,!1)!==0&&(x=!0),r+=4),y[v]=f.getInt32(r,!1),r+=4;if(!Number.isSafeInteger(p)||p>=2147483648||x)throw new Error("values exceed 2GB limit");const E=s();if(!E.startsWith("CONNECTIVITY"))throw new Error("Expected CONNECTIVITY after OFFSETS");A=E.includes("int64");const I=y[p-1],w=new Uint32Array(I);for(let v=0;v<I;v++)A&&(r+=4),w[v]=f.getInt32(r,!1),r+=4;for(let v=0;v<p;v++){const M=v===0?0:y[v-1],C=y[v];for(let D=1;D<C-M-1;D++)u.push(w[M]),u.push(w[M+D]),u.push(w[M+D+1])}}else{r=g;for(let A=0;A<p;A++){const y=f.getInt32(r,!1)-2;if(A===0&&y>65535)throw new Error("Invalid VTK binary polygons using little-endian data (MRtrix)");r+=4;const x=f.getInt32(r,!1);r+=4;let E=f.getInt32(r,!1);r+=4;for(let I=0;I<y;I++){const w=f.getInt32(r,!1);r+=4,u.push(x,E,w),E=w}}}}else throw new Error("Unsupported binary VTK datatype "+c[0]);const m=new Uint32Array(u);return{positions:d,indices:m}}static readWRL(e){const t=new TextDecoder("utf-8").decode(e),i=/coord\s+Coordinate\s*\{\s*point\s*\[([\s\S]*?)\]/,r=/coordIndex\s*\[([\s\S]*?)\]/,s=/color\s+Color\s*\{\s*color\s*\[([\s\S]*?)\]/,n=i.exec(t),o=r.exec(t),c=s.exec(t);if(!n||!o)throw new Error("Invalid WRL file: Could not find vertices or indices.");const l=new Float32Array(n[1].trim().split(/[\s,]+/).map(Number));let h=null;if(c){h=new Float32Array(c[1].trim().split(/[\s,]+/).map(Number));const f=l.length/3;h.length!==f*3&&(console.warn(`Unexpected color count: expected ${f*3}, got ${h.length}`),h=null)}const d=new Uint32Array(o[1].trim().split(/[\s,]+/).map(Number).filter(f=>f!==-1));return{positions:l,indices:d,colors:h}}static readDFS(e){const t=new DataView(e),i=t.getUint32(0,!0),r=t.getUint16(4,!0);(i!==1599292996||r!==17740)&&V.warn("Not a little-endian brainsuite DFS mesh");const s=t.getUint32(12,!0),n=t.getUint32(24,!0),o=t.getUint32(28,!0),c=t.getUint32(48,!0);let l=s;const h=new Uint32Array(e,l,n*3);l+=n*3*4;const d=new Float32Array(e,l,o*3);for(let u=0;u<o*3;u+=3){const m=d[u];d[u]=d[u+1],d[u+1]=m}let f;return c>=0&&(f=new Float32Array(e,c,o*3)),{positions:d,indices:h,colors:f}}static async readMZ3(e,t=0){if(e.byteLength<20)throw new Error("File too small to be mz3: bytes = "+e.byteLength);let i=new DataView(e),r=e,s=i.getUint16(0,!0);if(s===35615||s===8075){const M=await ce.decompress(new Uint8Array(e));i=new DataView(M.buffer),s=i.getUint16(0,!0),r=M.buffer}const n=i.getUint16(2,!0),o=i.getUint32(4,!0);let c=i.getUint32(8,!0);const l=i.getUint32(12,!0);if(Wr.debug("MZ3 magic %d attr %d face %d vert %d skip %d",s,n,o,c,l),s!==23117)throw new Error("Invalid MZ3 file");const h=(n&1)!==0,d=(n&2)!==0,f=(n&4)!==0;let u=(n&8)!==0;const m=(n&16)!==0,p=(n&32)!==0,g=(n&64)!==0;if(Wr.debug(`isFace=${h} isVert=${d} isRGBA=${f} isSCALAR=${u} isDOUBLE=${m} isAOMAP=${p} isLOOKUP=${g}`),n>127)throw new Error("Unsupported future version of MZ3 file");let b=4;m&&(b=8);let A=0;if(t>0&&!h&&o<1&&!f&&(u=!0),u){const M=t||c,C=16+l+(h?o*12:0)+(d?M*12:0)+(f?M*4:0),D=Math.floor((r.byteLength-C)/b);c!==t&&D%t===0&&(c=t),A=Math.floor(D/c),A<1&&(V.warn("Corrupt MZ3: file reports NSCALAR but not enough bytes"),u=!1)}if(c<3&&t<3)throw new Error("Not a mesh MZ3 file (maybe scalar)");t>0&&t!==c&&V.warn("Layer has "+c+"vertices, but background mesh has "+t);let y=16+l;const x=new DataView(r);let E=null;if(h){E=new Uint32Array(o*3);for(let M=0;M<o*3;M++)E[M]=x.getUint32(y,!0),y+=4}let I=null;if(d){I=new Float32Array(c*3);for(let M=0;M<c*3;M++)I[M]=x.getFloat32(y,!0),y+=4}let w=null;if(f){w=new Float32Array(c*3);for(let M=0;M<c;M++){for(let C=0;C<3;C++)w[M*3+C]=x.getUint8(y++)/255;y++}}let v=new Float32Array;if(u&&A>0)if(m){const M=new Float64Array(A*c);for(let C=0;C<A*c;C++)M[C]=x.getFloat64(y,!0),y+=8;v=Float32Array.from(M)}else{v=new Float32Array(A*c);for(let M=0;M<A*c;M++)v[M]=x.getFloat32(y,!0),y+=4}if(t>0&&g&&u){const M=new TextDecoder("utf-8"),C=new Uint8Array(r,16,l),D=M.decode(C),S=JSON.parse(D),k=Ie.makeLabelLut(S);return{scalars:v,colormapLabel:k}}if(t>0&&f&&u){let M=v[0];for(let S=0;S<c;S++)M=Math.max(M,v[S]);const C={R:[],G:[],B:[],A:[],I:[],labels:[]};for(let S=0;S<=M;S++)for(let k=0;k<c;k++)if(S===v[k]){const F=k*3;C.I.push(S),C.R.push(w[F]*255),C.G.push(w[F+1]*255),C.B.push(w[F+2]*255),C.A.push(255),C.labels.push(`${S}`);break}const D=Ie.makeLabelLut(C);return{scalars:v,colormapLabel:D}}return t>0?{scalars:v}:{positions:I,indices:E,scalars:v,colors:w}}static readPLY(e){const t=e.byteLength,i=new Uint8Array(e);let r=0;function s(){for(;r<t&&i[r]===10;)r++;const v=r;for(;r<t&&i[r]!==10;)r++;return r++,r-v<1?"":new TextDecoder().decode(e.slice(v,r-1))}let n=s();if(!n.startsWith("ply"))throw new Error("Not a valid PLY file");n=s();const o=n.includes("ascii");function c(v){if(v==="char"||v==="uchar"||v==="int8"||v==="uint8")return 1;if(v==="short"||v==="ushort"||v==="int16"||v==="uint16")return 2;if(v==="int"||v==="uint"||v==="int32"||v==="uint32"||v==="float"||v==="float32")return 4;if(v==="double")return 8;throw new Error("Unknown data type: "+v)}const l=n.includes("binary_little_endian");let h=0,d=!1,f=0,u=0,m=0,p=0,g=0,b=0,A=0;for(;r<t&&!n.startsWith("end_header");){if(n=s(),n.startsWith("comment"))continue;let v=n.split(/\s/);if(n.startsWith("element vertex"))for(h=parseInt(v[v.length-1]),n=s(),v=n.split(/\s/);n.startsWith("property");){const M=v[1];v[2]==="x"&&M.startsWith("double")?d=!0:v[2]==="x"&&!M.startsWith("float")&&V.error("Error: expect ply xyz to be float or double: "+n),f+=c(M),n=s(),v=n.split(/\s/)}if(n.startsWith("element face"))for(A=parseInt(v[v.length-1]),n=s(),v=n.split(/\s/);n.startsWith("property");){if(v[1]==="list")m=c(v[2]),p=c(v[3]),u+=m+3*p;else{const M=c(v[1]);u+=M,p===0&&(g+=M,b++)}n=s(),v=n.split(/\s/)}}if(o){A<1&&V.error(`Malformed ply format: faces ${A} `);const v=new Float32Array(h*3);let M=0;for(let S=0;S<h;S++){n=s();const k=n.split(/\s/);v[M]=parseFloat(k[0]),v[M+1]=parseFloat(k[1]),v[M+2]=parseFloat(k[2]),M+=3}let C=new Uint32Array(A*3),D=0;for(let S=0;S<A;S++){n=s();const k=n.split(/\s/),F=parseInt(k[b])-2;if(F<1)break;if(D+F*3>C.length){const L=new Uint32Array(C.length+C.length);L.set(C),C=L.slice()}const B=parseInt(k[b+1]);let O=parseInt(k[b+2]);for(let L=0;L<F;L++){const _=parseInt(k[b+3+L]);C[D+0]=B,C[D+1]=O,C[D+2]=_,O=_,D+=3}}return C.length!==D&&(C=C.slice(0,D)),{positions:v,indices:C}}(f<12||m<1||p<1||A<1)&&V.warn(`Malformed ply format: stride ${f} count ${m} iBytes ${p} iStrideBytes ${u} iPadBytes ${g} faces ${A}`);const y=new DataView(e);let x;if(r%4===0&&f===12&&l)x=new Float32Array(e,r,h*3),r+=h*f;else{x=new Float32Array(h*3);let v=0;for(let M=0;M<h;M++)d?(x[v]=y.getFloat64(r,l),x[v+1]=y.getFloat64(r+8,l),x[v+2]=y.getFloat64(r+16,l)):(x[v]=y.getFloat32(r,l),x[v+1]=y.getFloat32(r+4,l),x[v+2]=y.getFloat32(r+8,l)),v+=3,r+=f}const E=new Uint32Array(A*3);let I=!0,w=0;if(m===1&&p===4&&u===13)for(let v=0;v<A;v++){const M=y.getUint8(r);r+=m,M!==3&&(I=!1),E[w]=y.getUint32(r,l),r+=4,E[w+1]=y.getUint32(r,l),r+=4,E[w+2]=y.getUint32(r,l),r+=4,w+=3}else{let v=r;for(let M=0;M<A;M++){r=v+g;let C=0;m===1?C=y.getUint8(r):m===2?C=y.getUint16(r,l):m===4&&(C=y.getUint32(r,l)),r+=m,C!==3&&(I=!1);for(let D=0;D<3;D++)p===1?E[w]=y.getUint8(r):p===2?E[w]=y.getUint16(r,l):p===4&&(E[w]=y.getUint32(r,l)),w++,r+=p;v+=u}}return I||V.warn("Only able to read PLY meshes limited to triangles."),{positions:x,indices:E}}static readICO(e){const r=new TextDecoder("utf-8").decode(e).split(`
`);let s=r[0].trim().split(/\s+/);s.length>1&&V.warn("This is not a valid FreeSurfer ICO/TRI mesh.");const n=parseInt(s[0]),o=new Float32Array(n*3);let c=1;for(let d=0;d<n;d++){const f=r[c].trim().split(/\s+/);c++;let u=parseInt(f[0])-1;const m=parseFloat(f[1]),p=parseFloat(f[2]),g=parseFloat(f[3]);if(u<0||u>=n){V.error("ICO vertices corrupted");break}u*=3,o[u]=m,o[u+1]=p,o[u+2]=g}s=r[c].trim().split(/\s+/),c++;const l=parseInt(s[0]),h=new Uint32Array(l*3);for(let d=0;d<l;d++){const f=r[c].trim().split(/\s+/);c++;let u=parseInt(f[0])-1;const m=parseInt(f[1])-1,p=parseInt(f[2])-1,g=parseInt(f[3])-1;if(u<0||u>=l){V.error("ICO indices corrupted");break}u*=3,h[u]=m,h[u+1]=p,h[u+2]=g}for(let d=0;d<h.length;d+=3){const f=h[d];h[d]=h[d+1],h[d+1]=f}return{positions:o,indices:h}}static readGEO(e,t=!1){const s=new TextDecoder("utf-8").decode(e).split(`
`),n=s[0].trim().split(/\s+/),o=parseInt(n[0]);let c=parseInt(n[1]),l=parseInt(n[2]);const h=parseInt(n[3]);(o>1||h!==l*3)&&V.warn("Multi-part BYU/GEO header or not a triangular mesh.");const d=[];c*=3;let f=0,u=2;for(;f<c;){const A=s[u].trim().split(/\s+/);u++;for(let y=0;y<A.length&&(d.push(parseFloat(A[y])),f++,!(f>=c));y++);}const m=[];l*=3;let p=0;for(;p<l;){const A=s[u].trim().split(/\s+/);u++;for(let y=0;y<A.length&&(m.push(Math.abs(parseInt(A[y]))-1),p++,!(p>=l));y++);}if(t)for(let A=0;A<m.length;A+=3){const y=m[A];m[A]=m[A+1],m[A+1]=y}const g=new Float32Array(d),b=new Uint32Array(m);return{positions:g,indices:b}}static readOFF(e){const r=new TextDecoder("utf-8").decode(e).split(`
`),s=[],n=[];let o=0;r[o].includes("OFF")?o++:V.warn("File does not start with OFF");let c=r[o].trim().split(/\s+/);const l=parseInt(c[0]),h=parseInt(c[1]);o++;for(let u=0;u<l;u++)c=r[o].trim().split(/\s+/),s.push(parseFloat(c[0])),s.push(parseFloat(c[1])),s.push(parseFloat(c[2])),o++;for(let u=0;u<h;u++)c=r[o].trim().split(/\s+/),parseInt(c[0])!==3&&V.warn("Only able to read OFF files with triangular meshes"),n.push(parseInt(c[1])),n.push(parseInt(c[2])),n.push(parseInt(c[3])),o++;const d=new Float32Array(s),f=new Uint32Array(n);return{positions:d,indices:f}}static readOBJMNI(e){const r=new TextDecoder("utf-8").decode(e).trim().split(/\s*,\s*|\s+/);(r.length<1||r[0]!=="P")&&V.warn("This is not a valid MNI OBJ mesh.");let s=6;const n=parseInt(r[s++]),o=n*3,c=new Float32Array(o);for(let m=0;m<o;m++)c[m]=parseFloat(r[s++]);s+=o;const l=parseInt(r[s++]),h=parseInt(r[s++]);(l<1||h<0||h>2)&&V.warn("This is not a valid MNI OBJ mesh.");let d=1;h===1?d=l:h===1&&(d=n),s+=d*4,s+=l;const f=l*3,u=new Uint32Array(f);for(let m=0;m<f;m++)u[m]=parseInt(r[s++]);return{positions:c,indices:u}}static async readOBJ(e){const t=new Uint8Array(e,0,2);t[0]===31&&t[1]===139&&(e=await ce.decompressToBuffer(new Uint8Array(e)));const r=new TextDecoder("utf-8").decode(e);if(r[0]==="P")return this.readOBJMNI(e);const s=r.split(`
`),n=s.length,o=[],c=[];for(let u=0;u<n;u++){const m=s[u];if(m[0]==="v"&&m[1]===" "){const p=m.trim().split(/\s+/);o.push(parseFloat(p[1])),o.push(parseFloat(p[2])),o.push(parseFloat(p[3]))}if(m[0]==="f"){const p=m.trim().split(/\s+/),g=p.length-3;if(g<1)break;let b=p[1].split("/");const A=parseInt(b[0])-1;b=p[2].split("/");let y=parseInt(b[0])-1;for(let x=0;x<g;x++){b=p[3+x].split("/");const E=parseInt(b[0])-1;c.push(A),c.push(y),c.push(E),y=E}}}const l=new Float32Array(o),h=new Uint32Array(c);let d=h[0],f=h[0];for(let u=1;u<h.length;u++)h[u]<d&&(d=h[u]),h[u]>f&&(f=h[u]);if(f-d+1>l.length/3)throw new Error("Not a valid OBJ file");for(let u=0;u<h.length;u++)h[u]-=d;return{positions:l,indices:h}}static readFreeSurfer(e){const t=new Uint8Array(e);if(t[0]===35&&t[1]===33&&t[2]===97)return qe.readASC(e);const i=new DataView(e),r=i.getUint32(0,!1),s=i.getUint32(4,!1);(r!==4294966883||s!==1919246708)&&Wr.debug("Unable to recognize file type: does not appear to be FreeSurfer format.");let n=0;for(;i.getUint8(n)!==10;)n++;n+=2;let o=i.getUint32(n,!1);n+=4;let c=i.getUint32(n,!1);n+=4,o*=3;const l=new Float32Array(o);for(let u=0;u<o;u++)l[u]=i.getFloat32(n,!1),n+=4;c*=3;const h=new Uint32Array(c);for(let u=0;u<c;u++)h[u]=i.getUint32(n,!1),n+=4;const d=i.getUint32(n,!1);n+=4;let f=d===20;if(!f){const u=i.getUint32(n,!1);n+=4;const m=i.getUint32(n,!1);n+=4,f=d===2&&u===0&&m===20}if(!f)V.warn("Unknown FreeSurfer Mesh extension code.");else{const m=new TextDecoder().decode(e.slice(n)).trim().split(`
`);for(let p=0;p<m.length;p++){if(!m[p].startsWith("cras"))continue;const b=m[p].split("=")[1].trim().split(" ").map(Number),A=Math.floor(l.length/3);let y=0;for(let x=0;x<A;x++)l[y]+=b[0],y++,l[y]+=b[1],y++,l[y]+=b[2],y++}}return{positions:l,indices:h}}static async readSRF(e){const t=new Uint8Array(e);if(t[0]===35&&t[1]===33&&t[2]===97)return qe.readASC(e);t[0]===31&&t[1]===139&&(e=(await ce.decompress(new Uint8Array(e))).buffer);const i=new DataView(e),r=i.getFloat32(0,!0),s=i.getUint32(8,!0),n=i.getUint32(12,!0),o=i.getFloat32(16,!0),c=i.getFloat32(20,!0),l=i.getFloat32(24,!0),h=new Float32Array(s*3);let d=28,f=1;for(let I=0;I<s;I++)h[f]=-i.getFloat32(d,!0)+o,f+=3,d+=4;f=2;for(let I=0;I<s;I++)h[f]=-i.getFloat32(d,!0)+c,f+=3,d+=4;f=0;for(let I=0;I<s;I++)h[f]=-i.getFloat32(d,!0)+l,f+=3,d+=4;d=28+24*s;const u=i.getFloat32(d,!0),m=i.getFloat32(d+4,!0),p=i.getFloat32(d+8,!0),g=i.getFloat32(d+16,!0),b=i.getFloat32(d+20,!0),A=i.getFloat32(d+24,!0);d+=32;const y=new Float32Array(s*3),x=new Uint32Array(e,d,s);f=0;for(let I=0;I<s;I++){const w=x[I];w>1056964608&&(y[f+0]=(w>>16&255)/255,y[f+1]=(w>>8&255)/255,y[f+2]=(w&255)/255),w===0&&(y[f+0]=u,y[f+1]=m,y[f+2]=p),w===1&&(y[f+0]=g,y[f+1]=b,y[f+2]=A),f+=3}d+=s*4;for(let I=0;I<s;I++){const w=i.getUint32(d,!0);d+=4+4*w}const E=new Uint32Array(n*3);for(let I=0;I<n*3;I++)E[I]=i.getInt32(d,!0),d+=4;return r!==4&&V.warn("Not valid SRF"),{positions:h,indices:E,colors:y}}static readTxtSTL(e){const r=new TextDecoder("utf-8").decode(e).split(`
`);if(!r[0].startsWith("solid"))throw new Error("Not a valid STL file");const s=[];for(let l=1;l<r.length;l++){if(!r[l].includes("vertex"))continue;const h=r[l].trim().split(/\s+/);for(let d=1;d<h.length;d++)s.push(parseFloat(h[d]))}const n=Math.floor(s.length/3);if(n*3!==s.length)throw new Error("Unable to parse ASCII STL file.");const o=new Float32Array(s),c=new Uint32Array(n);for(let l=0;l<n;l++)c[l]=l;return{positions:o,indices:c}}static readSTL(e){if(e.byteLength<134)throw new Error("File too small to be STL: bytes = "+e.byteLength);const t=new DataView(e);if(t.getUint32(0,!0)===1768714099)return qe.readTxtSTL(e);const r=t.getUint32(80,!0),s=3*r;if(e.byteLength<84+r*50)throw new Error("STL file too small to store triangles = "+r);const n=new Uint32Array(s),o=new Float32Array(s*3);let c=96,l=0;for(let h=0;h<r;h++){for(let d=0;d<9;d++)o[l]=t.getFloat32(c,!0),l+=1,c+=4;c+=14}for(let h=0;h<s;h++)n[h]=h;return{positions:o,indices:n}}static decimateLayerVertices(e,t){if(e%t===0)return e;const i=12,r=Math.round(Math.log((e-2)/(i-2))/Math.log(4)),s=Math.round(Math.log((t-2)/(i-2))/Math.log(4)),n=Math.pow(4,r)*(i-2)+2,o=Math.pow(4,s)*(i-2)+2;return n!==e||o!==t?e:t}static async readNII2(e,t=0,i=""){let r=new Float32Array;const s=e.byteLength;let n=!0;const o=new DataView(e);let c=o.getUint16(0,n);if(c===469893120&&(n=!1,c=o.getUint16(0,n)),c!==540)throw new Error("Not a valid NIfTI-2 dataset");const l=Number(o.getBigInt64(168,n)),h=o.getFloat64(176,n),d=o.getFloat64(184,n);(h!==1||d!==0)&&V.warn("ignoring scale slope and intercept");const f=o.getUint32(504,n),u=o.getUint16(12,n);if(u!==2&&u!==4&&u!==8&&u!==16)throw new Error("Unsupported NIfTI datatype "+u);let m=1;const p=[1,1,1,1,1,1,1,1];for(let g=1;g<8;g++)p[g]=Math.max(Number(o.getBigInt64(16+g*8,n)),1),m*=p[g];if(f>=3e3&&f<=3099&&l>580){let g=function(){for(;M<s&&v[M]===10;)M++;const O=M;for(;M<s&&v[M]!==10;)M++;return M++,M-O<1?"":new TextDecoder().decode(e.slice(O,M-1)).trim()},b=function(){let O=g();if(!O.startsWith("<")||O.endsWith(">"))return O;for(;M<s&&!O.endsWith(">");)O+=g();return O},A=function(O,L=!1){const _=C.indexOf(O);if(_<0)return 1;const q=C.indexOf('"',_)+1,J=C.indexOf('"',q),Z=C.slice(q,J);return L?Z:parseInt(Z)},y=0,x=0,E=0,I="",w=new Uint32Array;const v=new Uint8Array(e);let M=552,C;const D=p[5],S=new Float32Array(t*D);for(;M<s&&(C=b(),!C.includes("</CIFTI>"));)if(C.includes("<BrainModel")){const O=A("SurfaceNumberOfVertices="),L=A("BrainStructure=",!0).toUpperCase();if(O%t!==0)continue;let _=!1;if(i.includes("CORTEX")&&L.includes("CORTEX")&&(_=!0),!_||(_=!1,i.includes("LEFT")&&L.includes("LEFT")&&(_=!0),i.includes("RIGHT")&&L.includes("RIGHT")&&(_=!0),!_))continue;if(E=O,y=A("IndexOffset="),x=A("IndexCount="),I=L,C.includes("<VertexIndices>")||(C=b()),!C.startsWith("<VertexIndices>")||!C.endsWith("</VertexIndices>"))return V.warn("Unable to find CIfTI <VertexIndices>"),S;C=C.slice(15,-16);const q=C.trim().split(/\s+/);q.length<x&&V.error("Error parsing VertexIndices"),w=new Uint32Array(x);for(let J=0;J<x;J++)w[J]=parseInt(q[J])}if(E===0||w.length===0)return V.warn("Unable to find CIfTI structure that matches the mesh."),S;if(u!==16)return V.warn("Only able to read float32 CIfTI (only known datatype)."),S;const k=new Float32Array(x*D),F=l+D*y*4;for(let O=0;O<x*D;O++)k[O]=o.getFloat32(F+O*4,n);let B=0;for(let O=0;O<x;O++)for(let L=0;L<D;L++)S[w[O]+L*t]=k[B],B++;return V.debug("CIfTI diagnostics",E,I,y,x,y,i),S}if(m=this.decimateLayerVertices(m,t),m%t!==0)throw new Error("Vertices in layer ("+m+") is not a multiple of number of vertices ("+t+")");if(n)u===16?r=new Float32Array(e,l,m):u===8?r=new Int32Array(e,l,m):u===4&&(r=new Int16Array(e,l,m));else if(u===16){r=new Float32Array(m);for(let g=0;g<m;g++)r[g]=o.getFloat32(l+g*4,n)}else if(u===8){r=new Int32Array(m);for(let g=0;g<m;g++)r[g]=o.getInt32(l+g*4,n)}else if(u===4){r=new Int16Array(m);for(let g=0;g<m;g++)r[g]=o.getInt16(l+g*2,n)}return u===2&&(r=new Uint8Array(e,l,m)),r}static async readNII(e,t,i=""){const r=t.length/3;let s=new Float32Array,n=!0,o=new DataView(e),c=o.getUint16(0,n);if(c===540||c===469893120)return qe.readNII2(e,r,i);if(c===23553&&(n=!1,c=o.getUint16(0,n)),c!==348){const x=await ce.decompress(new Uint8Array(e));if(o=new DataView(x.buffer),e=x.buffer,c=o.getUint16(0,n),c===540||c===469893120)return qe.readNII2(e,r,i);c===23553&&(n=!1,c=o.getUint16(0,n))}c!==348&&V.error("Not a valid NIfTI image.");const l=o.getFloat32(108,n),h=o.getFloat32(112,n),d=o.getFloat32(116,n),f=o.getUint16(252,n),u=o.getUint16(254,n),m=o.getUint16(70,n);if(m!==2&&m!==4&&m!==8&&m!==16)throw new Error("Unsupported NIfTI datatype "+m);const p=we();for(let x=0;x<12;x++)p[x]=o.getFloat32(280+x*4,n);let g=1;const b=new Array(8);for(let x=0;x<8;x++)b[x]=o.getUint16(40+x*2,n),!(x<1)&&(g*=b[x]||1);let A=!1,y=this.decimateLayerVertices(g,r);if(y%r!==0)if(b[0]>=3&&b[1]>1&&b[2]>1&&b[3]>1)A=!0,y=b[1]*b[2]*b[3];else throw new Error("Voxels in layer ("+g+") is not a multiple of number of vertices ("+r+")");if(g=y,n)m===16?s=new Float32Array(e,l,g):m===8?s=new Int32Array(e,l,g):m===4&&(s=new Int16Array(e,l,g));else if(m===16){s=new Float32Array(g);for(let x=0;x<g;x++)s[x]=o.getFloat32(l+x*4,n)}else if(m===8){s=new Int32Array(g);for(let x=0;x<g;x++)s[x]=o.getInt32(l+x*4,n)}else if(m===4){s=new Int16Array(g);for(let x=0;x<g;x++)s[x]=o.getInt16(l+x*2,n)}if(m===2&&(s=new Uint8Array(e,l,g)),h!==1||d!==0){const x=new Float32Array(g);for(let E=0;E<g;E++)x[E]=s[E]*h+d;s=x}for(let x=0;x<g;x++)isNaN(s[x])&&(s[x]=0);if(A){let x=function(B,O){const L=[0,0,0];return L[0]=O[0]*B[0]+O[1]*B[1]+O[2]*B[2]+O[3],L[1]=O[4]*B[0]+O[5]*B[1]+O[6]*B[2]+O[7],L[2]=O[8]*B[0]+O[9]*B[1]+O[10]*B[2]+O[11],L};const E=new Float32Array(g);V.warn("Sampling voxel intensities at mesh vertices (assumes precise alignment)."),(f>u||u<=0)&&V.warn(`Requires valid sform (sform_code = ${u})`);const I=we();bt(I,p);const w=b[1],v=b[2],M=b[3],C=w*v;let D=0,S=0,k=0;for(;S<r;){const B=[t[D],t[D+1],t[D+2]],O=x(B,I);D+=3,S+=1;const L=Math.floor(O[0]),_=Math.floor(O[1]),q=Math.floor(O[2]),J=Math.ceil(O[0]),Z=Math.ceil(O[1]),Y=Math.ceil(O[2]);if(L<0||J>=w||_<0||Z>=v||q<0||Y>=M)continue;const W=L+_*w+q*C,T=new Float32Array(8);T[0]=s[W],T[1]=s[W+1],T[2]=s[W+w],T[3]=s[W+w+1],T[4]=s[W+C],T[5]=s[W+C+1],T[6]=s[W+C+w],T[7]=s[W+C+w+1];let ne=T[0],le=ne;for(let de=1;de<8;de++)ne=Math.max(ne,T[de]),le=Math.min(le,T[de]);Math.abs(le)>ne&&(ne=le),E[S-1]=ne,k++}const F=k/r;F<.1&&V.warn(`${k} of ${r} vertices in range (${(F*100).toFixed(1)}%)`),s=E}return s}static async readMGH(e,t=0,i=!1){let r=new DataView(e),s=e;if(r.getUint8(0)===31&&r.getUint8(1)===139){const w=await ce.decompress(new Uint8Array(e));s=new ArrayBuffer(w.byteLength),new Uint8Array(s).set(new Uint8Array(w)),r=new DataView(w.buffer)}const n=r.getInt32(0,!1),o=Math.max(1,r.getInt32(4,!1)),c=Math.max(1,r.getInt32(8,!1)),l=Math.max(1,r.getInt32(12,!1)),h=Math.max(1,r.getInt32(16,!1)),d=r.getInt32(20,!1);let f=284;const u=!1;(n!==1||d<0||d>4)&&V.warn("Not a valid MGH file");let m=o*c*l*h,p=[];if(m=this.decimateLayerVertices(m,t),m%t!==0)return V.warn("Vertices in layer ("+m+") is not a multiple of number of vertices ("+t+")"),p;if(d===3){p=new Float32Array(m);for(let w=0;w<m;w++)p[w]=r.getFloat32(f+w*4,u)}else if(d===1){p=new Int32Array(m);for(let w=0;w<m;w++)p[w]=r.getInt32(f+w*4,u)}else if(d===4){p=new Int16Array(m);for(let w=0;w<m;w++)p[w]=r.getInt16(f+w*2,u)}else d===0&&(p=new Uint8Array(e,f,m));if(!i)return p;let g=4;d===4&&(g=2),d===0&&(g=1),f+=g*m,f+=16;const b=1,A=2,y=20,x=30,E=s.byteLength;let I;for(;f<E-8;){const w=r.getInt32(f+=4,u);let v=0;switch(w){case x:v=r.getInt32(f+=4,u)-1;break;case y:case A:v=0;break;case b:v=0;{let M=r.getInt32(f+=4,u);if(M>0)return V.warn("unsupported CTABreadFromBinaryV1"),p;if(M=-M,M!==2)return V.warn("CTABreadFromBinary: unknown version"),p;const C=r.getInt32(f+=4,u);if(C<0)return V.warn("CTABreadFromBinaryV2: nentries was ",C),p;const D=r.getInt32(f+=4,u);f+=D;const S=r.getInt32(f+=4,u);if(S<0)return p;const k={R:[],G:[],B:[],A:[],I:[],labels:[]};for(let F=0;F<S;F++){const B=r.getInt32(f+=4,u),O=r.getInt32(f+=4,u);let L=f+4,_="";for(let W=0;W<O;W++){const T=r.getUint8(L++);if(T===0)break;_+=String.fromCharCode(T)}f+=O;const q=r.getInt32(f+=4,u),J=r.getInt32(f+=4,u),Z=r.getInt32(f+=4,u),Y=255-r.getInt32(f+=4,u);k.I.push(B),k.R.push(q),k.G.push(J),k.B.push(Z),k.A.push(Y),k.labels.push(_)}I=Ie.makeLabelLut(k)}break;default:v=r.getInt32(f+=8,u)}f+=v}return{scalars:p,colormapLabel:I}}static readX3D(e){const t=e.byteLength;if(t<20)throw new Error("File too small to be X3D: bytes = "+t);const i=new Uint8Array(e);let r=0;function s(){for(;r<t&&i[r]!==60;)r++;const y=r;for(;r<t&&i[r]!==62;)r++;const x=r;return new TextDecoder().decode(e.slice(y,x+1)).trim()}let n=s();function o(y){const x=n.indexOf(y+"=");if(x<0)return"";const E=n[x+y.length+1],I=n.indexOf(E,x)+1,w=n.indexOf(E,I);return n.slice(I,w)}function c(y){const x=n.indexOf(y+"=");if(x<0)return 1;const E=n[x+y.length+1],I=n.indexOf(E,x)+1,w=n.indexOf(E,I);let v=n.slice(I,w).trim();v=v.replace(/,\s*$/,"");const M=v.trim().split(/\s*,\s*|\s+/);if(M.length<2)return parseFloat(v);let C=new Array(M.length),D=0;for(let S=0;S<M.length;S++){const k=parseFloat(M[S]);isFinite(k)&&(C[D]=k,D++)}return C=C.slice(0,D),C}n.includes("xml version")||V.warn("Not a X3D image");let l=[],h=[],d=[],f=[],u=[0,0,0,0],m=[0,0,0,0],p=[255,255,255,255],g=[255,255,255,255];const b={};function A(){if(!n.endsWith("/>"))if(n.startsWith("<Appearance>"))for(;r<t&&!n.endsWith("</Appearance>");)n+=s();else for(;r<t&&!n.endsWith("/>");)n+=s();const y=o("USE");if(y.length>1){y in b?p=b[y]:V.warn("Unable to find DEF for "+y);return}const x=c("diffuseColor");if(x.length<3)return;p[0]=Math.round(x[0]*255),p[1]=Math.round(x[1]*255),p[2]=Math.round(x[2]*255);const E=o("DEF");E.length<1||(b[E]=p)}for(;r<t;)if(n=s(),p=g.slice(),n.startsWith("<Transform")&&(u=c("translation"),m=c("rotation")),n.startsWith("<Appearance")&&(A(),g=p.slice()),n.startsWith("<Shape")){let y=1,x=1,E=[],I=[];for(;r<t&&(n=s(),n.startsWith("<Appearance")&&A(),!n.startsWith("</Shape"));){if(n.startsWith("<Sphere")&&(y=c("radius"),x=-1),n.startsWith("<Cylinder")&&(y=c("radius"),x=c("height")),n.startsWith("<IndexedFaceSet")&&(x=-2,E=c("coordIndex")),n.startsWith("<IndexedTriangleSet")&&(x=-7,E=c("index")),n.startsWith("<IndexedTriangleStripSet")&&(x=-3,E=c("index")),n.startsWith("<Coordinate")){I=c("point");const w=I.length%3;w!==0&&(I=I.slice(0,-w))}n.startsWith("<Color")&&(f=c("color")),n.startsWith("<Box")&&(x=-4,V.warn("Unsupported x3d shape: Box")),n.startsWith("<Cone")&&(x=-5,V.warn("Unsupported x3d shape: Cone")),n.startsWith("<ElevationGrid")&&(x=-6,V.warn("Unsupported x3d shape: ElevationGrid"))}if(!(x<-3&&x!==-7))if(x<-1){if(E.length<1||I.length<3||I.length===void 0){V.warn("Indexed mesh must specify indices and points");break}const w=Math.floor(l.length/3);let v=2;if(x===-7)h=[...h,...E];else if(x===-2){let D=0;for(;v<E.length;)E[v]>=0?(h.push(E[D]+w),h.push(E[v-1]+w),h.push(E[v-0]+w),v+=1):(v+=3,D=v-2)}else for(;v<E.length;)E[v]>=0?(h.push(E[v-2]+w),h.push(E[v-1]+w),h.push(E[v-0]+w),v+=1):v+=3;l=[...l,...I];const M=Math.floor(I.length/3),C=Array(M).fill(p).flat();if(f.length===M*3){let D=0,S=0;for(let k=0;k<M;k++){for(let F=0;F<3;F++)C[S]=Math.round(f[D]*255),D++,S++;S++}}d=[...d,...C]}else if(x<0)ja.makeColoredSphere(l,h,d,y,u,p);else{const w=we();sf(w,m[3],[m[0],m[1],m[2]]);const v=Be(0,-x*.5,0,1),M=Be(0,+x*.5,0,1);it(v,v,w),it(M,M,w),Kc(v,v,u),Kc(M,M,u);const C=ee(v[0],v[1],v[2]),D=ee(M[0],M[1],M[2]);ja.makeColoredCylinder(l,h,d,C,D,y,p)}}return{positions:Float32Array.from(l),indices:Uint32Array.from(h),rgba255:Uint8Array.from(d)}}static async readGII(e,t=0){let i=e.byteLength;if(i<20)throw new Error("File too small to be GII: bytes = "+i);let r=new TextDecoder("ascii").decode(e);if(r[0].charCodeAt(0)===31){const S=await ce.decompress(new Uint8Array(e));e=S.buffer,r=new TextDecoder("ascii").decode(S.buffer)}let s=0;function n(){let S=!0,k=s;for(;S;){for(;s<i&&r[s]!=="<";)s++;for(k=s;s<i&&r[s]!==">";)s++;if(S=r[s-1]==="/",k+1<i&&r[k+1]==="/"&&(s+=1,S=!0),s>=i)break}const F=new TextDecoder().decode(e.slice(k+1,s)).trim(),B=F.split(" ")[0].trim(),O=s;let L=s,_=s;if(r[k+1]!=="?"&&r[k+1]!=="!"){const q="</"+B+">";L=r.indexOf(q,O),_=L+q.length-1}return{name:F,startPos:k,contentStartPos:O,contentEndPos:L,endPos:_}}let o=n();if(!o.name.startsWith("?xml"))throw new Error("readGII: Invalid XML file");for(;!o.name.startsWith("GIFTI")&&o.endPos<i;)o=n();if(!o.name.startsWith("GIFTI")||o.contentStartPos===o.contentEndPos)throw new Error("readGII: XML file does not include GIFTI tag");i=o.contentEndPos;let c=new Float32Array,l=new Uint32Array,h=new Float32Array,d="",f=!1,u=!1,m=!1,p=!1,g=[1,1,1];const b=[0,0,0];let A=0,y=!1,x=!1,E=0,I=!1;o.endPos=o.contentStartPos;let w="";function v(S,k=!1){const F=w.indexOf(S);if(F<0)return 1;const B=w.indexOf('"',F)+1,O=w.indexOf('"',B),L=w.slice(B,O);return k?parseFloat(L):parseInt(L)}function M(S){const k=w.indexOf(S);if(k<0)return"";const F=k+S.length,B=w.indexOf("]",F);return w.slice(F,B)}const C={R:[],G:[],B:[],A:[],I:[],labels:[]};for(;o.endPos<i&&o.name.length>1;){if(o=n(),o.name.startsWith("Label Key")&&(w=o.name,C.I.push(v("Key=")),C.R.push(Math.round(255*v("Red=",!0))),C.G.push(Math.round(255*v("Green=",!0))),C.B.push(Math.round(255*v("Blue=",!0))),C.A.push(Math.round(255*v("Alpha",!0))),w=new TextDecoder().decode(e.slice(o.contentStartPos+1,o.contentEndPos)).trim(),C.labels.push(M("<![CDATA["))),o.name.trim()==="Data"){if(m)continue;w=new TextDecoder().decode(e.slice(o.contentStartPos+1,o.contentEndPos)).trim();let S;if(x){const k=g[0]*g[1]*g[2],F=w.split(/\s+/);if(k!==F.length)throw new Error("Unable to parse ASCII GIfTI");if(A===2&&(A=8),A===32&&(A=16),A===8){S=new Int32Array(k);for(let B=0;B<k;B++)S[B]=parseInt(F[B])}if(A===16){S=new Float32Array(k);for(let B=0;B<k;B++)S[B]=parseFloat(F[B])}}else if(typeof Buffer>"u"){let k=function(F){const B=atob(F),O=B.length,L=new Uint8Array(O);for(let _=0;_<O;_++)L[_]=B.charCodeAt(_);return L};if(y){const F=k(w.slice());S=await ce.decompress(new Uint8Array(F))}else S=k(w.slice())}else if(y){const k=Buffer.from(w.slice(),"base64");S=await ce.decompress(new Uint8Array(k))}else S=Buffer.from(w.slice(),"base64");if(u){if(A!==16&&V.warn("expect positions as FLOAT32"),c=new Float32Array(S.buffer),p){const k=c.slice(),F=k.length/3;let B=0;for(let O=0;O<F;O++)for(let L=0;L<3;L++)c[B]=k[L*F+O],B++}}else if(f){if(A!==8&&V.warn("expect indices as INT32"),l=new Uint32Array(S.buffer),p){const k=l.slice(),F=k.length/3;let B=0;for(let O=0;O<F;O++)for(let L=0;L<3;L++)l[B]=k[L*F+O],B++}}else{let k=function(B,O){const L=B.length,_=new Float32Array(L+O.length);return _.set(B),_.set(O,L),_};E=g[0]*g[1]*g[2],t!==0&&E%t!==0&&V.warn("Number of vertices in scalar overlay ("+E+") does not match mesh ("+t+")");let F;if(A===2){const B=new Uint8Array(S.buffer);F=Float32Array.from(B)}else if(A===8){const B=new Int32Array(S.buffer);F=Float32Array.from(B)}else if(A===16)F=new Float32Array(S.buffer);else if(A===32){const B=new Float64Array(S.buffer);F=Float32Array.from(B)}else throw new Error(`Invalid dataType: ${A}`);h=k(h,F)}continue}if(o.name.trim()==="DataSpace"&&(w=new TextDecoder().decode(e.slice(o.contentStartPos+1,o.contentEndPos)).trim(),w.includes("NIFTI_XFORM_SCANNER_ANAT")&&(I=!0)),o.name.trim()==="MD"&&(w=new TextDecoder().decode(e.slice(o.contentStartPos+1,o.contentEndPos)).trim(),w.includes("AnatomicalStructurePrimary")&&w.includes("CDATA[")&&(d=M("<Value><![CDATA[").toUpperCase()),w.includes("VolGeom")&&w.includes("CDATA["))){let S=-1;if(w.includes("VolGeomC_R")&&(S=0),w.includes("VolGeomC_A")&&(S=1),w.includes("VolGeomC_S")&&(S=2),S<0)continue;b[S]=parseFloat(M("<Value><![CDATA["))}o.name.startsWith("DataArray")&&(w=o.name,g=[1,1,1],y=w.includes('Encoding="GZipBase64Binary"'),x=w.includes('Encoding="ASCII"'),f=w.includes('Intent="NIFTI_INTENT_TRIANGLE"'),u=w.includes('Intent="NIFTI_INTENT_POINTSET"'),m=w.includes('Intent="NIFTI_INTENT_VECTOR"'),p=w.includes('ArrayIndexingOrder="ColumnMajorOrder"'),w.includes('DataType="NIFTI_TYPE_UINT8"')&&(A=2),w.includes('DataType="NIFTI_TYPE_INT32"')&&(A=8),w.includes('DataType="NIFTI_TYPE_FLOAT32"')&&(A=16),w.includes('DataType="NIFTI_TYPE_FLOAT64"')&&(A=32),g[0]=v("Dim0="),g[1]=v("Dim1="),g[2]=v("Dim2="))}let D;if(C.I.length>1&&(C.A.some(k=>k>0)||C.A.fill(255),D=Ie.makeLabelLut(C)),t>0)return{scalars:h,colormapLabel:D,anatomicalStructurePrimary:d};if(c.length>2&&!I&&(b[0]!==0||b[1]!==0||b[2]!==0)){E=Math.floor(c.length/3);let S=0;for(let k=0;k<E;k++)c[S]+=b[0],S++,c[S]+=b[1],S++,c[S]+=b[2],S++}return{positions:c,indices:l,scalars:h,colormapLabel:D,anatomicalStructurePrimary:d}}},jo=class{constructor(a,e,t,i,r){U(this,"text"),U(this,"style"),U(this,"points"),U(this,"anchor"),U(this,"onClick"),this.text=a,this.style=e,this.points=t,this.anchor=i||0,this.onClick=r}},co=()=>{const a=new ArrayBuffer(2);return new DataView(a).setInt16(0,256,!0),new Int16Array(a)[0]===256},Fh=(a=>(a[a.UNKNOWN=0]="UNKNOWN",a[a.NII=1]="NII",a[a.DCM=2]="DCM",a[a.DCM_MANIFEST=3]="DCM_MANIFEST",a[a.MIH=4]="MIH",a[a.MIF=5]="MIF",a[a.NHDR=6]="NHDR",a[a.NRRD=7]="NRRD",a[a.MHD=8]="MHD",a[a.MHA=9]="MHA",a[a.MGH=10]="MGH",a[a.MGZ=11]="MGZ",a[a.V=12]="V",a[a.V16=13]="V16",a[a.VMR=14]="VMR",a[a.HEAD=15]="HEAD",a[a.DCM_FOLDER=16]="DCM_FOLDER",a[a.SRC=17]="SRC",a[a.FIB=18]="FIB",a[a.BMP=19]="BMP",a[a.ZARR=20]="ZARR",a[a.NPY=21]="NPY",a[a.NPZ=22]="NPZ",a[a.HDR=23]="HDR",a))(Fh||{}),ue=Object.freeze({...Fh,parse:a=>{let e=0;switch(a.toUpperCase()){case"":case"DCM":e=2;break;case"TXT":e=3;break;case"FZ":case"GQI":case"QSDR":case"FIB":e=18;break;case"HDR":case"NII":e=1;break;case"MIH":e=4;break;case"MIF":e=5;break;case"NHDR":e=6;break;case"NRRD":e=7;break;case"MHD":e=8;break;case"MHA":e=9;break;case"MGH":e=10;break;case"MGZ":e=11;break;case"NPY":e=21;break;case"NPZ":e=22;break;case"SRC":e=17;break;case"V":e=12;break;case"V16":e=13;break;case"VMR":e=14;break;case"HEAD":e=15;break;case"PNG":case"BMP":case"GIF":case"JPG":case"JPEG":e=19;break;case"ZARR":e=20;break}return e}}),nn=(a,e="",t="",i="gray",r=1,s=NaN,n=NaN,o=!0,c=.02,l=!1,h=!1,d="",f=0,u=ue.UNKNOWN,m=NaN,p=NaN,g=!0,b=!1,A=null)=>({url:a,urlImageData:e,name:t,colormap:i,colorMap:i,opacity:r,cal_min:s,cal_max:n,trustCalMinMax:o,percentileFrac:c,ignoreZeroVoxels:l,useQFormNotSForm:h,colormapNegative:d,imageType:u,cal_minNeg:m,cal_maxNeg:p,colorbarVisible:g,frame4D:f,alphaThreshold:b,colormapLabel:A});function dl(a,e=80){a=a.replace(/[`$]/g,"");const t=[],i=Math.min(e,a.length);for(let r=0;r<i;r++){const s=a.charCodeAt(r);t.push(s&255)}return t}function pn(a,e=!1,t=!1){let s=!0;t&&(s=a.littleEndian);const n=new Uint8Array(348),o=new DataView(n.buffer);o.setInt32(0,348,s),o.setUint8(38,114),o.setUint8(39,a.dim_info);for(let l=0;l<8;l++)o.setUint16(40+2*l,a.dims[l],s);o.setFloat32(56,a.intent_p1,s),o.setFloat32(60,a.intent_p2,s),o.setFloat32(64,a.intent_p3,s),o.setInt16(68,a.intent_code,s),e?(o.setInt16(70,2,s),o.setInt16(72,8,s)):(o.setInt16(70,a.datatypeCode,s),o.setInt16(72,a.numBitsPerVoxel,s)),o.setInt16(74,a.slice_start,s);for(let l=0;l<8;l++)o.setFloat32(76+4*l,a.pixDims[l],s);e?(o.setFloat32(108,352,s),o.setFloat32(112,1,s),o.setFloat32(116,0,s)):(o.setFloat32(108,a.vox_offset,s),o.setFloat32(112,a.scl_slope,s),o.setFloat32(116,a.scl_inter,s)),o.setInt16(120,a.slice_end,s),o.setUint8(122,a.slice_code),a.xyzt_units===0?o.setUint8(123,10):o.setUint8(123,a.xyzt_units),e?(o.setFloat32(124,0,s),o.setFloat32(128,0,s)):(o.setFloat32(124,a.cal_max,s),o.setFloat32(128,a.cal_min,s)),o.setFloat32(132,a.slice_duration,s),o.setFloat32(136,a.toffset,s),n.set(dl(a.description),148),n.set(dl(a.aux_file),228),o.setInt16(252,a.qform_code,s),a.sform_code<1||a.sform_code<1?o.setInt16(254,1,s):o.setInt16(254,a.sform_code,s),o.setFloat32(256,a.quatern_b,s),o.setFloat32(260,a.quatern_c,s),o.setFloat32(264,a.quatern_d,s),o.setFloat32(268,a.qoffset_x,s),o.setFloat32(272,a.qoffset_y,s),o.setFloat32(276,a.qoffset_z,s);const c=a.affine.flat();for(let l=0;l<12;l++)o.setFloat32(280+4*l,c[l],s);return o.setInt32(344,3222382,!0),n}function pp(a,e=!0){const t=Math.round(a.length/3),i=ee(0,0,0),r=Ce(),s=Ce();let n=0,o=1;e&&(o=2);for(let d=0;d<o;d++){n=0;for(let u=0;u<t;u++){const m=ee(a[u*3],a[u*3+1],a[u*3+2]);u===0&&(Lc(r,m),Lc(s,m)),xo(r,r,m),wo(s,s,m),Fe(m,m,i);const p=fs(m);n=Math.max(n,p)}if(d+1>=o)break;let f=!0;for(let u=0;u<3;++u)r[u]>i[u]&&(f=!1),s[u]<i[u]&&(f=!1);if(f)break;ff(i,r,s,.5),V.debug("origin moved inside volume: ",i)}const c=[r[0],r[1],r[2]],l=[s[0],s[1],s[2]];return{min:c,max:l,furthestVertexFromOrigin:n,origin:i}}function fl(a){const e=[!1,!1,!1,!1],t=[!1,!1,!1,!1];for(let i=0;i<4;i++)for(let r=0;r<4;r++)if(isNaN(a[i][r]))return!1;for(let i=0;i<3;i++)for(let r=0;r<3;r++)a[i][r]!==0&&(e[i]=!0,t[r]=!0);for(let i=0;i<3;i++)if(!e[i]||!t[i])return!1;return!0}async function Un(a){const e=a.getReader(),{done:t,value:i}=await e.read();if(t)return e.releaseLock(),new ReadableStream({start(n){n.close()}});if(!i||i.length<2)return e.releaseLock(),new ReadableStream({start(n){i&&n.enqueue(i),n.close()}});const r=i[0]===31&&i[1]===139,s=new ReadableStream({async start(n){try{for(n.enqueue(i);;){const{done:o,value:c}=await e.read();if(o){n.close(),e.releaseLock();break}n.enqueue(c)}}catch(o){n.error(o),e.releaseLock()}}});return r?s.pipeThrough(new DecompressionStream("gzip")):s}function Rh(a=[256,256,256],e=[1,1,1],t=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],i=2){const r=new pe;r.littleEndian=!0,r.dims=[3,1,1,1,0,0,0,0],r.dims[0]=Math.max(3,a.length);for(let n=0;n<a.length;n++)r.dims[n+1]=a[n];r.pixDims=[1,1,1,1,1,0,0,0];for(let n=0;n<a.length;n++)r.pixDims[n+1]=e[n];if(t.length===16){let n=0;for(let o=0;o<4;o++)for(let c=0;c<4;c++)r.affine[o][c]=t[n],n++}let s=8;return i===256||i===2?s=8:i===512||i===4?s=16:i===16||i===768||i===8||i===2304?s=32:i===64?s=64:V.warn("Unsupported NIfTI datatypeCode for header creation: "+i),r.datatypeCode=i,r.numBitsPerVoxel=s,r.scl_inter=0,r.scl_slope=1,r.sform_code=2,r.magic="n+1",r.vox_offset=352,r}function mp(a=[256,256,256],e=[1,1,1],t=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],i=2,r=new Uint8Array){const s=Rh(a,e,t,i),n=pn(s,!1);s.vox_offset=Math.max(352,n.length);const o=pn(s,!1);if(r.length<1)return o;const c=Math.max(0,s.vox_offset-o.length),l=new Uint8Array(c),h=new Uint8Array(r.buffer,r.byteOffset,r.byteLength),d=s.vox_offset+h.length,f=new Uint8Array(d);return f.set(o,0),f.set(l,o.length),f.set(h,s.vox_offset),f}function Nh(a,e=null){if(!a.hdr)throw new Error("NVImage header is not defined for toUint8Array");if(!a.img&&e===null)throw new Error("NVImage image data is not defined for toUint8Array");const t=e!==null,i=JSON.parse(JSON.stringify(a.hdr)),r=a.extensions&&a.extensions.length>0,s=new Uint8Array(4);s[0]=r?1:0;let n=new Uint8Array(0);if(r){const g=[];let b=0;for(const y of a.extensions){const x=new Uint8Array(y.edata),E=new Uint8Array(8+x.length),I=new DataView(E.buffer);I.setInt32(0,y.esize,!0),I.setInt32(4,y.ecode,!0),E.set(x,8),g.push(E),b+=E.length}n=new Uint8Array(b);let A=0;for(const y of g)n.set(y,A),A+=y.length}const o=348;i.vox_offset=Math.max(352,o+s.length+n.length),t&&(i.datatypeCode=2,i.numBitsPerVoxel=8,i.scl_slope=1,i.scl_inter=0);const c=pn(i,t);let l;if(t){const g=e,b=a.permRAS;if(b&&(b[0]!==1||b[1]!==2||b[2]!==3)){V.debug("Reorienting drawing bytes back to native space for saving...");const A=a.hdr.dims,y=A[1]*A[2]*A[3],x=a.dimsRAS?a.dimsRAS[1]*a.dimsRAS[2]*a.dimsRAS[3]:y;if(g.length!==x)console.warn(`Drawing length (${g.length}) does not match expected RAS voxel count (${x}). Cannot reorient drawing reliably.`),l=g;else if(!a.img2RASstep||!a.img2RASstart||!a.dimsRAS)console.warn("Missing RAS transformation info (img2RASstep, img2RASstart, dimsRAS). Cannot reorient drawing reliably."),l=g;else{const E=a.img2RASstep,I=a.img2RASstart,w=a.dimsRAS,v=new Uint8Array(y);v.fill(0);const M=g;let C=0;for(let D=0;D<w[3];D++){const S=I[2]+D*E[2];for(let k=0;k<w[2];k++){const F=I[1]+k*E[1];for(let B=0;B<w[1];B++){const L=I[0]+B*E[0]+F+S;L>=0&&L<y?v[L]=M[C]:C<M.length&&console.warn(`Calculated native index ${L} is out of bounds [0..${y-1}] during drawing reorientation.`),C++}}}l=v}}else l=g}else{if(!a.img)throw new Error("NVImage image data is null when trying to save non-drawing.");l=new Uint8Array(a.img.buffer,a.img.byteOffset,a.img.byteLength)}const h=c.length+s.length+n.length,d=Math.max(0,i.vox_offset-h),f=new Uint8Array(d),u=i.vox_offset+l.length,m=new Uint8Array(u);let p=0;return m.set(c,p),p+=c.length,m.set(s,p),p+=s.length,m.set(n,p),p+=n.length,m.set(f,p),p+=f.length,m.set(l,i.vox_offset),m}async function kh(a,e,t=null){const i=Nh(a,t);if(e.toLowerCase().endsWith(".gz"))try{const s=await ce.compress(i,"gzip");return new Uint8Array(s)}catch(s){return V.error("Compression failed:",s),V.warn("Returning uncompressed data due to compression error."),i}else return i}async function gp(a,e="",t=null){const i=await kh(a,e,t);if(!e)return V.debug("saveToDisk: empty file name, returning data as Uint8Array rather than triggering download"),i;try{const r=new Blob([i.buffer],{type:"application/octet-stream"}),s=URL.createObjectURL(r),n=document.createElement("a");n.setAttribute("href",s),n.setAttribute("download",e),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n),setTimeout(()=>URL.revokeObjectURL(s),100)}catch(r){V.error("Failed to trigger download:",r)}return i}function Uh(a,e,t,i,r=0,s=!1){if(!a.hdr)throw new Error("getValue: NVImage header is not defined.");if(!s&&!a.img)throw new Error("getValue: NVImage image data is not defined.");if(s&&!a.imaginary)return V.warn("getValue: Attempted to read imaginary data, but none exists."),[0];const n=a.hdr.dims[1],o=a.hdr.dims[2],c=a.hdr.dims[3],l=a.permRAS.slice();if(l[0]!==1||l[1]!==2||l[2]!==3){const A=Be(e,t,i,1);it(A,A,a.toRASvox),e=A[0],t=A[1],i=A[2]}e=Math.max(0,Math.min(Math.round(e),n-1)),t=Math.max(0,Math.min(Math.round(t),o-1)),i=Math.max(0,Math.min(Math.round(i),c-1)),r=Math.max(0,r);let h=e+t*n+i*n*o;if(a.hdr.datatypeCode===2304)return a.img?(h*=4,h+3>=a.img.length?(V.warn(`getValue: Calculated index ${h} out of bounds for RGBA data.`),[0]):[a.img[h],a.img[h+1],a.img[h+2],a.img[h+3]]):[0];if(a.hdr.datatypeCode===128)return a.img?(h*=3,h+2>=a.img.length?(V.warn(`getValue: Calculated index ${h} out of bounds for RGB data.`),[0]):[a.img[h],a.img[h+1],a.img[h+2]]):[0];const d=n*o*c,f=r*d,u=h+f,m=s?a.imaginary:a.img;if(u<0||u>=m.length)return[0];const p=m[u],g=isNaN(a.hdr.scl_slope)||a.hdr.scl_slope===0?1:a.hdr.scl_slope,b=isNaN(a.hdr.scl_inter)?0:a.hdr.scl_inter;return[g*p+b]}function Ap(a,e,t,i,r=0,s=!1){const n=Uh(a,e,t,i,r,s);return n.length<3?n[0]:n[0]*.2126+n[1]*.7152+n[2]*.0722}function yp(a,e=[-1,0,0],t=[0,0,0],i="same"){const r=[new Uint8Array,[0,0,0]];if(!a.hdr||!a.img||!a.dimsRAS||!a.img2RASstep||!a.img2RASstart)return V.error("getVolumeData: Missing required NVImage properties (hdr, img, dimsRAS, img2RASstep/start)."),r;if(e=e.slice(0,3),t=t.slice(0,3),Math.min(...e)<0||Math.min(...t)<0)return V.warn("getVolumeData: Invalid start or end coordinates provided."),r;const s=a.dimsRAS.slice(1,4);for(let g=0;g<3;g++)if(e[g]=Math.max(0,Math.min(Math.round(e[g]),s[g]-1)),t[g]=Math.max(0,Math.min(Math.round(t[g]),s[g]-1)),t[g]<e[g]){const b=t[g];t[g]=e[g],e[g]=b}const n=[t[0]-e[0]+1,t[1]-e[1]+1,t[2]-e[2]+1],o=n[0]*n[1]*n[2];if(o<=0)return V.warn("getVolumeData: Calculated slab size is zero or negative."),r;let c=a.img.constructor;i==="uint8"?c=Uint8Array:i==="int16"?c=Int16Array:i==="uint16"?c=Uint16Array:i==="float32"||i==="scaled"||i==="normalized"||i==="windowed"?c=Float32Array:i==="float64"?c=Float64Array:i!=="same"&&V.warn(`getVolumeData: Unsupported dataType '${i}'. Using 'same'.`);let l;try{l=new c(o)}catch(g){return V.error(`getVolumeData: Failed to create output array for dataType '${i}'.`,g),r}const h=a.img2RASstep,d=a.img2RASstart,f=a.img;let u=0;for(let g=e[2];g<=t[2];g++){const b=d[2]+g*h[2];for(let A=e[1];A<=t[1];A++){const y=d[1]+A*h[1];for(let x=e[0];x<=t[0];x++){const I=d[0]+x*h[0]+y+b;let w=0;I>=0&&I<f.length&&(w=f[I]),l[u++]=w}}}const m=isNaN(a.hdr.scl_slope)||a.hdr.scl_slope===0?1:a.hdr.scl_slope,p=isNaN(a.hdr.scl_inter)?0:a.hdr.scl_inter;if(i==="scaled"||i==="normalized"||i==="windowed"){l instanceof Float32Array||(V.warn(`getVolumeData: Converting output to Float32 for scaling type '${i}'.`),l=Float32Array.from(l));for(let g=0;g<l.length;g++)l[g]=l[g]*m+p}if(i==="normalized"||i==="windowed"){let g=a.cal_min,b=a.cal_max;i==="normalized"&&(g=a.global_min,b=a.global_max);const A=b-g,y=A===0?0:1/A;for(let x=0;x<l.length;x++)l[x]=(l[x]-g)*y,l[x]=Math.max(0,Math.min(l[x],1))}return[l,n]}function xp(a,e=[-1,0,0],t=[0,0,0],i=new Uint8Array){if(!a.hdr||!a.img||!a.dimsRAS||!a.img2RASstep||!a.img2RASstart){V.error("setVolumeData: Missing required NVImage properties (hdr, img, dimsRAS, img2RASstep/start).");return}if(i.length<1){V.warn("setVolumeData: Input slabData is empty.");return}if(e=e.slice(0,3),t=t.slice(0,3),Math.min(...e)<0||Math.min(...t)<0){V.warn("setVolumeData: Invalid start or end coordinates provided.");return}const r=a.dimsRAS.slice(1,4);for(let d=0;d<3;d++)if(e[d]=Math.max(0,Math.min(Math.round(e[d]),r[d]-1)),t[d]=Math.max(0,Math.min(Math.round(t[d]),r[d]-1)),t[d]<e[d]){const f=t[d];t[d]=e[d],e[d]=f}const s=[t[0]-e[0]+1,t[1]-e[1]+1,t[2]-e[2]+1],n=s[0]*s[1]*s[2];if(n<=0){V.warn("setVolumeData: Calculated slab size is zero or negative.");return}if(i.length<n){V.error(`setVolumeData: Input slabData length (${i.length}) is less than the calculated slab size (${n}).`);return}const o=a.img2RASstep,c=a.img2RASstart,l=a.img;let h=0;for(let d=e[2];d<=t[2];d++){const f=c[2]+d*o[2];for(let u=e[1];u<=t[1];u++){const m=c[1]+u*o[1];for(let p=e[0];p<=t[0];p++){const b=c[0]+p*o[0]+m+f;b>=0&&b<l.length&&(l[b]=i[h]),h++}}}}var jh={};En(jh,{isFreeSurferLabelImage:()=>Ph,optimizeFreeSurferLabels:()=>Bh,readMgh:()=>wp});function ul(a,e,t,i=1){const r=e+t;let s=e;const n=[];for(;s+12<=r;){const o=a.getInt32(s,!1),c=a.getInt32(s+8,!1);if(s+=12,c<=0||s+c>r)break;if(o!==i){s+=c;continue}let l=c,h=s;if(i===1){if(s+4>r)break;l=a.getInt32(s,!1),h+=4}if(l>1&&h+l<=r){const d=new Uint8Array(a.buffer,h,l),f=new TextDecoder("utf-8").decode(d.slice(0,-1));n.push(f)}s+=c}return n.join(`

`)}function Bh(a,e){if(a.intent_code=1002,a.datatypeCode!==16&&a.datatypeCode!==8)return e;let t=new Float32Array(e);if(a.datatypeCode===8&&(t=new Int32Array(e)),co()){const n=new Uint32Array(e);for(let o=0;o<n.length;o++){const c=n[o];n[o]=(c&255)<<24|(c&65280)<<8|(c&16711680)>>>8|(c&4278190080)>>>24}}a.littleEndian=co();let i=!0,r=1/0,s=-1/0;for(let n=0;n<t.length;n++){const o=t[n];Number.isFinite(o)&&(Number.isInteger(o)||(i=!1),o<r&&(r=o),o>s&&(s=o))}if(!i||r<0||s>2147483647)return V.warn(`FreeSurfer Labels must be integers in INT32 range. range ${r}..${s}`),e;if(s>32767){a.datatypeCode=8;const n=new Int32Array(t.length);for(let o=0;o<t.length;o++)n[o]=Math.trunc(t[o]);return n.buffer}else if(s>255){a.datatypeCode=4,a.numBitsPerVoxel=16;const n=new Int16Array(t.length);for(let o=0;o<t.length;o++)n[o]=Math.trunc(t[o]);return n.buffer}else{a.datatypeCode=2,a.numBitsPerVoxel=8;const n=new Uint8Array(t.length);for(let o=0;o<t.length;o++)n[o]=Math.trunc(t[o]);return n.buffer}}function Ph(a,e,t){const i=a.byteLength-e.vox_offset;if(i<t)return V.error(`MGH image data size mismatch: expected ${t}, found ${i}`),!1;if(i===t)return!1;const r=e.vox_offset+t+20,s=a.byteLength-r;return s<=12?!1:ul(new DataView(a),r,s).toLowerCase().endsWith("lut.txt")?!0:ul(new DataView(a),r,s,3).includes("mri_label2vol")}async function wp(a,e){a.hdr||(V.debug("readMgh called before nvImage.hdr was initialized. Creating default."),a.hdr=new pe);const t=a.hdr;t.littleEndian=!1;let i=e,r=new DataView(i);if(i.byteLength>=2&&r.getUint8(0)===31&&r.getUint8(1)===139)try{i=await ce.decompressToBuffer(new Uint8Array(e)),r=new DataView(i)}catch(L){return V.error("Failed to decompress MGZ file.",L),null}if(i.byteLength<284)return V.error("File too small to be a valid MGH/MGZ header."),null;const s=r.getInt32(0,!1),n=r.getInt32(4,!1),o=r.getInt32(8,!1),c=r.getInt32(12,!1),l=r.getInt32(16,!1),h=r.getInt32(20,!1),d=r.getFloat32(30,!1),f=r.getFloat32(34,!1),u=r.getFloat32(38,!1),m=r.getFloat32(42,!1),p=r.getFloat32(46,!1),g=r.getFloat32(50,!1),b=r.getFloat32(54,!1),A=r.getFloat32(58,!1),y=r.getFloat32(62,!1),x=r.getFloat32(66,!1),E=r.getFloat32(70,!1),I=r.getFloat32(74,!1),w=r.getFloat32(78,!1),v=r.getFloat32(82,!1),M=r.getFloat32(86,!1);if(s!==1&&V.warn(`Unexpected MGH version: ${s}.`),n<=0||o<=0||c<=0)return V.error(`Invalid MGH dimensions: ${n}x${o}x${c}`),null;switch(h){case 0:t.numBitsPerVoxel=8,t.datatypeCode=2;break;case 4:t.numBitsPerVoxel=16,t.datatypeCode=4;break;case 1:t.numBitsPerVoxel=32,t.datatypeCode=8;break;case 3:t.numBitsPerVoxel=32,t.datatypeCode=16;break;default:return V.error(`Unsupported MGH data type: ${h}`),null}t.dims[1]=n,t.dims[2]=o,t.dims[3]=c,t.dims[4]=Math.max(1,l),t.dims[0]=t.dims[4]>1?4:3,t.pixDims[1]=Math.abs(d),t.pixDims[2]=Math.abs(f),t.pixDims[3]=Math.abs(u),t.pixDims[4]=0,t.sform_code=1,t.qform_code=0,t.sform_code=1;const C=Ct(m*t.pixDims[1],b*t.pixDims[2],x*t.pixDims[3],0,p*t.pixDims[1],A*t.pixDims[2],E*t.pixDims[3],0,g*t.pixDims[1],y*t.pixDims[2],I*t.pixDims[3],0,0,0,0,1),D=[t.dims[1]/2,t.dims[2]/2,t.dims[3]/2,1],S=[0,0,0,0];for(let L=0;L<3;L++){S[L]=0;for(let _=0;_<3;_++)S[L]=S[L]+C[_+L*4]*D[_]}t.affine=[[C[0],C[1],C[2],w-S[0]],[C[4],C[5],C[6],v-S[1]],[C[8],C[9],C[10],M-S[2]],[0,0,0,1]],t.vox_offset=284,t.magic="n+1";const k=t.numBitsPerVoxel/8,B=n*o*c*t.dims[4]*k,O=i.slice(t.vox_offset,t.vox_offset+B);return Ph(i,t,B)?Bh(t,O):O}var Oh={};En(Oh,{readNifti:()=>vp});async function vp(a,e,t){let i=e,r=null;try{if(Mo(i)&&(V.debug(`Decompressing NIfTI file: ${a.name}`),i=await Qf(i),V.debug(`Decompression complete for: ${a.name}`)),!i||i.byteLength===0)throw new Error("Buffer became invalid after decompression attempt.");if(a.hdr=await $r(i,t!=null),Zf(a.hdr)&&(a.extensions=a.hdr.extensions),a.hdr===null)throw new Error(`Failed to read NIfTI header: ${a.name}`);if(a.hdr.cal_min===0&&a.hdr.cal_max===255&&a.hdr.datatypeCode!==2&&(V.debug(`Resetting suspicious cal_min/max (0/255) for non-uint8 NIfTI: ${a.name}`),a.hdr.cal_min=0,a.hdr.cal_max=0),r=t?Qc(a.hdr,t):Qc(a.hdr,i),r===null)throw new Error(`nifti-reader-js readImage returned null for ${a.name}`);return r}catch(s){return V.error(`Error processing NIfTI file ${a.name}:`,s),a.hdr=null,null}}var Vh={};En(Vh,{readNrrd:()=>Ep});async function Ep(a,e,t=null){a.hdr||(V.warn("readNrrd called before nvImage.hdr was initialized. Creating default."),a.hdr=new pe);const i=a.hdr;i.pixDims=[1,1,1,1,1,0,0,0];const r=e.byteLength;let s=null;const n=new Uint8Array(e);for(let I=1;I<r;I++)if(n[I-1]===10&&n[I]===10){const w=e.slice(0,I-1);s=new TextDecoder().decode(w),i.vox_offset=I+1;break}if(s===null)return V.error("readNrrd: could not extract txt"),null;const o=s.split(`
`);if(!o[0].startsWith("NRRD"))return V.error("Invalid NRRD image (magic signature missing)"),null;const c=o.length;let l=!1,h=!1,d=!1;const f=pa(NaN,0,0,0,1,0,0,0,1),u=ee(0,0,0);let m=Zn();for(let I=1;I<c;I++){let w=o[I];if((w.length===0||w[0]==="#")&&(w.startsWith("#")||w.trim().length===0))continue;w=w.toLowerCase();const v=w.split(":");if(v.length<2)continue;const M=v[0].trim();let C=v[1].trim();switch(C=C.replaceAll(")"," "),C=C.replaceAll("("," "),C=C.trim(),M){case"data file":d=!0;break;case"encoding":if(C.includes("raw"))l=!1;else if(C.includes("gz"))l=!0;else return V.error("Unsupported NRRD encoding"),null;break;case"type":switch(C){case"uchar":case"unsigned char":case"uint8":case"uint8_t":i.numBitsPerVoxel=8,i.datatypeCode=2;break;case"signed char":case"int8":case"int8_t":i.numBitsPerVoxel=8,i.datatypeCode=256;break;case"short":case"short int":case"signed short":case"signed short int":case"int16":case"int16_t":i.numBitsPerVoxel=16,i.datatypeCode=4;break;case"ushort":case"unsigned short":case"unsigned short int":case"uint16":case"uint16_t":i.numBitsPerVoxel=16,i.datatypeCode=512;break;case"int":case"signed int":case"int32":case"int32_t":i.numBitsPerVoxel=32,i.datatypeCode=8;break;case"uint":case"unsigned int":case"uint32":case"uint32_t":i.numBitsPerVoxel=32,i.datatypeCode=768;break;case"float":i.numBitsPerVoxel=32,i.datatypeCode=16;break;case"double":i.numBitsPerVoxel=64,i.datatypeCode=64;break;default:return V.error("Unsupported NRRD data type: "+C),null}break;case"spacings":{const D=C.split(/[ ,]+/);for(let S=0;S<D.length;S++)i.pixDims[S+1]=parseFloat(D[S])}break;case"sizes":{const D=C.split(/[ ,]+/);i.dims[0]=D.length;for(let S=0;S<D.length;S++)i.dims[S+1]=parseInt(D[S])}break;case"endian":C.includes("little")?i.littleEndian=!0:C.includes("big")&&(i.littleEndian=!1);break;case"space directions":{const D=C.split(/[ ,]+/);if(D.length===9)for(let S=0;S<9;S++)f[S]=parseFloat(D[S])}break;case"space origin":{const D=C.split(/[ ,]+/);D.length===3&&(u[0]=parseFloat(D[0]),u[1]=parseFloat(D[1]),u[2]=parseFloat(D[2]))}break;case"space units":C.includes("microns")&&(h=!0);break;case"space":C.includes("right-anterior-superior")||C.includes("ras")?m=pa(1,0,0,0,1,0,0,0,1):C.includes("left-anterior-superior")||C.includes("las")?m=pa(-1,0,0,0,1,0,0,0,1):C.includes("left-posterior-superior")||C.includes("lps")?m=pa(-1,0,0,0,-1,0,0,0,1):V.warn("Unsupported NRRD space value:",C);break;default:V.warn("Unknown:",M);break}}if(!isNaN(f[0])){i.sform_code=2,h&&(of(f,f,.001),u[0]*=.001,u[1]*=.001,u[2]*=.001),m[0]<0&&(u[0]=-u[0]),m[4]<0&&(u[1]=-u[1]),m[8]<0&&(u[2]=-u[2]),ih(f,m,f);const I=Ct(f[0],f[3],f[6],u[0],f[1],f[4],f[7],u[1],f[2],f[5],f[8],u[2],0,0,0,1);if(!a.vox2mm)return null;const w=a.vox2mm([0,0,0],I),v=a.vox2mm([1,0,0],I);Fe(v,v,w);const M=a.vox2mm([0,1,0],I);Fe(M,M,w);const C=a.vox2mm([0,0,1],I);Fe(C,C,w),i.pixDims[1]=ya(v),i.pixDims[2]=ya(M),i.pixDims[3]=ya(C),i.affine=[[I[0],I[1],I[2],I[3]],[I[4],I[5],I[6],I[7]],[I[8],I[9],I[10],I[11]],[0,0,0,1]]}let p=null;const g=d?t:e,b=d?0:i.vox_offset;if(d&&!g)return V.warn("Missing data: NRRD header describes detached data file but only one URL provided"),null;if(!g||b>=g.byteLength)return V.error(`NRRD data offset (${b}) invalid for buffer length (${(g==null?void 0:g.byteLength)??0})`),null;let A=g.slice(b);if(l)try{V.debug("Decompressing NRRD data..."),A=await ce.decompressToBuffer(new Uint8Array(A)),V.debug("Decompression complete.")}catch(I){return V.error("Failed to decompress NRRD data.",I),null}const y=i.numBitsPerVoxel/8,E=i.dims.slice(1,i.dims[0]+1).reduce((I,w)=>I*Math.max(1,w),1)*y;return A.byteLength<E?(V.error(`NRRD image data size mismatch: expected ${E}, found ${A.byteLength}`),null):(A.byteLength>E&&(V.warn(`NRRD has extra ${A.byteLength-E} bytes after expected image data. Truncating.`),A=A.slice(0,E)),p=A,i.datatypeCode?i.numBitsPerVoxel?p:(V.error("NRRD parsing failed to set numBitsPerVoxel."),null):(V.error("NRRD parsing failed to set datatypeCode."),null))}var st=class on{constructor(e=null,t="",i="gray",r=1,s=null,n=NaN,o=NaN,c=!0,l=.02,h=!1,d=!1,f="",u=0,m=ue.UNKNOWN,p=NaN,g=NaN,b=!0,A=null,y=0){U(this,"name"),U(this,"id"),U(this,"url"),U(this,"headers"),U(this,"_colormap"),U(this,"_opacity"),U(this,"percentileFrac"),U(this,"ignoreZeroVoxels"),U(this,"trustCalMinMax"),U(this,"colormapNegative"),U(this,"colormapLabel"),U(this,"colormapInvert"),U(this,"nFrame4D"),U(this,"frame4D"),U(this,"nTotalFrame4D"),U(this,"cal_minNeg"),U(this,"cal_maxNeg"),U(this,"colorbarVisible",!0),U(this,"modulationImage",null),U(this,"modulateAlpha",0),U(this,"series",[]),U(this,"nVox3D"),U(this,"oblique_angle"),U(this,"maxShearDeg"),U(this,"useQFormNotSForm"),U(this,"colormapType"),U(this,"pixDims"),U(this,"matRAS"),U(this,"pixDimsRAS"),U(this,"obliqueRAS"),U(this,"dimsRAS"),U(this,"permRAS"),U(this,"img2RASstep"),U(this,"img2RASstart"),U(this,"toRAS"),U(this,"toRASvox"),U(this,"frac2mm"),U(this,"frac2mmOrtho"),U(this,"extentsMinOrtho"),U(this,"extentsMaxOrtho"),U(this,"mm2ortho"),U(this,"hdr",null),U(this,"extensions"),U(this,"imageType"),U(this,"img"),U(this,"imaginary"),U(this,"v1"),U(this,"fileObject"),U(this,"dims"),U(this,"onColormapChange",()=>{}),U(this,"onOpacityChange",()=>{}),U(this,"mm000"),U(this,"mm100"),U(this,"mm010"),U(this,"mm001"),U(this,"cal_min"),U(this,"cal_max"),U(this,"robust_min"),U(this,"robust_max"),U(this,"global_min"),U(this,"global_max"),U(this,"urlImgData"),U(this,"isManifest"),U(this,"limitFrames4D"),this.init(e,t,i,r,s,n,o,c,l,h,d,f,u,m,p,g,b,A,y)}init(e=null,t="",i="",r=1,s=null,n=NaN,o=NaN,c=!0,l=.02,h=!1,d=!1,f="",u=0,m=ue.UNKNOWN,p=NaN,g=NaN,b=!0,A=null,y=0,x=null){const E=i==="";if(E&&(i="gray"),this.name=t,this.imageType=m,this.id=$n(),this._colormap=i,this._opacity=r>1?1:r,this.percentileFrac=l,this.ignoreZeroVoxels=h,this.trustCalMinMax=c,this.colormapNegative=f,this.colormapLabel=A,this.frame4D=u,this.cal_minNeg=p,this.cal_maxNeg=g,this.colorbarVisible=b,this.colormapType=y,this.useQFormNotSForm=d,!e)return;if(E&&this.hdr&&this.hdr.intent_code===1002&&(i="random",this._colormap=i),this.hdr&&typeof this.hdr.magic=="number"&&(this.hdr.magic="n+1"),this.nFrame4D=1,this.hdr)for(let M=4;M<7;M++)this.hdr.dims[M]>1&&(this.nFrame4D*=this.hdr.dims[M]);if(this.frame4D=Math.min(this.frame4D,this.nFrame4D-1),this.nTotalFrame4D=this.nFrame4D,!this.hdr||!x)return;this.nVox3D=this.hdr.dims[1]*this.hdr.dims[2]*this.hdr.dims[3];const I=this.nVox3D*(this.hdr.numBitsPerVoxel/8),w=x.byteLength/I;w!==this.nFrame4D&&(w>0&&w*I===x.byteLength?V.debug("Loading the first "+w+" of "+this.nFrame4D+" volumes"):V.warn("This header does not match voxel data",this.hdr,x.byteLength),this.nFrame4D=w),(this.hdr.intent_code===1007||this.hdr.intent_code===2003)&&this.nFrame4D===3&&this.hdr.datatypeCode===16&&(x=this.float32V1asRGBA(new Float32Array(x)).buffer),(this.hdr.pixDims[1]===0||this.hdr.pixDims[2]===0||this.hdr.pixDims[3]===0)&&V.error("pixDims not plausible",this.hdr),(isNaN(this.hdr.scl_slope)||this.hdr.scl_slope===0)&&(this.hdr.scl_slope=1),isNaN(this.hdr.scl_inter)&&(this.hdr.scl_inter=0);let v=fl(this.hdr.affine);if(d||!v||this.hdr.qform_code>this.hdr.sform_code){V.debug("spatial transform based on QForm");const M=this.hdr.quatern_b,C=this.hdr.quatern_c,D=this.hdr.quatern_d,S=Math.sqrt(1-(Math.pow(M,2)+Math.pow(C,2)+Math.pow(D,2))),k=this.hdr.pixDims[0]===0?1:this.hdr.pixDims[0],F=[[S*S+M*M-C*C-D*D,2*M*C-2*S*D,2*M*D+2*S*C],[2*M*C+2*S*D,S*S+C*C-M*M-D*D,2*C*D-2*S*M],[2*M*D-2*S*C,2*C*D+2*S*M,S*S+D*D-C*C-M*M]],B=this.hdr.affine;for(let O=0;O<3;O+=1)for(let L=0;L<3;L+=1)B[O][L]=F[O][L]*this.hdr.pixDims[L+1],L===2&&(B[O][L]*=k);B[0][3]=this.hdr.qoffset_x,B[1][3]=this.hdr.qoffset_y,B[2][3]=this.hdr.qoffset_z,this.hdr.affine=B}if(v=fl(this.hdr.affine),!v){V.debug("Defective NIfTI: spatial transform does not make sense");let M=this.hdr.pixDims[1],C=this.hdr.pixDims[2],D=this.hdr.pixDims[3];(isNaN(M)||M===0)&&(M=1),(isNaN(C)||C===0)&&(C=1),(isNaN(D)||D===0)&&(D=1),this.hdr.pixDims[1]=M,this.hdr.pixDims[2]=C,this.hdr.pixDims[3]=D;const S=[[M,0,0,0],[0,C,0,0],[0,0,D,0],[0,0,0,1]];this.hdr.affine=S}if(this.hdr.datatypeCode!==128&&this.hdr.datatypeCode!==2304&&this.hdr.littleEndian!==co()&&this.hdr.numBitsPerVoxel>8){if(this.hdr.numBitsPerVoxel===16){const M=new Uint16Array(x);for(let C=0;C<M.length;C++){const D=M[C];M[C]=((D&255)<<8|D>>8&255)<<16>>16}}else if(this.hdr.numBitsPerVoxel===32){const M=new Uint32Array(x);for(let C=0;C<M.length;C++){const D=M[C];M[C]=(D&255)<<24|(D&65280)<<8|D>>8&65280|D>>24&255}}else if(this.hdr.numBitsPerVoxel===64){const M=this.hdr.numBitsPerVoxel/8,C=new Uint8Array(x);for(let D=0;D<C.length;D+=M){let S=M-1;for(let k=0;k<S;k++){const F=C[D+k];C[D+k]=C[D+S],C[D+S]=F,S--}}}}switch(this.hdr.datatypeCode){case 2:this.img=new Uint8Array(x);break;case 4:this.img=new Int16Array(x);break;case 16:this.img=new Float32Array(x);break;case 64:this.img=new Float64Array(x);break;case 128:this.img=new Uint8Array(x);break;case 512:this.img=new Uint16Array(x);break;case 2304:this.img=new Uint8Array(x);break;case 256:{const M=new Int8Array(x),C=M.length;this.img=new Int16Array(C);for(let D=0;D<C;D++)this.img[D]=M[D];this.hdr.datatypeCode=4,this.hdr.numBitsPerVoxel=16;break}case 1:{const M=this.hdr.dims[1]*this.hdr.dims[2]*Math.max(1,this.hdr.dims[3])*Math.max(1,this.hdr.dims[4]),C=new Uint8Array(x);this.img=new Uint8Array(M);const D=new Uint8Array(8);for(let k=0;k<8;k++)D[k]=Math.pow(2,k);let S=-1;for(let k=0;k<M;k++){const F=k%8;F===0&&S++,(C[S]&D[F])!==0&&(this.img[k]=1)}this.hdr.datatypeCode=2,this.hdr.numBitsPerVoxel=8;break}case 768:{const M=new Uint32Array(x),C=M.length;this.img=new Float64Array(C);for(let D=0;D<C-1;D++)this.img[D]=M[D];this.hdr.datatypeCode=64;break}case 8:{const M=new Int32Array(x),C=M.length;this.img=new Float64Array(C);for(let D=0;D<C-1;D++)this.img[D]=M[D];this.hdr.datatypeCode=64;break}case 1024:{const M=new BigInt64Array(x),C=M.length;this.img=new Float64Array(C);for(let D=0;D<C-1;D++)this.img[D]=Number(M[D]);this.hdr.datatypeCode=64;break}case 32:{const M=new Float32Array(x),C=Math.floor(M.length/2);this.imaginary=new Float32Array(C),this.img=new Float32Array(C);let D=0;for(let S=0;S<C-1;S++)this.img[S]=M[D],this.imaginary[S]=M[D+1],D+=2;this.hdr.datatypeCode=16;break}default:throw new Error("datatype "+this.hdr.datatypeCode+" not supported")}this.calculateRAS(),isNaN(n)||(this.hdr.cal_min=n),isNaN(o)||(this.hdr.cal_max=o),this.calMinMax()}static async new(e=null,t="",i="",r=1,s=null,n=NaN,o=NaN,c=!0,l=.02,h=!1,d=!1,f="",u=0,m=ue.UNKNOWN,p=NaN,g=NaN,b=!0,A=null,y=0,x){const E=new on,I=/(?:\.([^.]+))?$/;let w=I.exec(t)[1]||"";w=w.toUpperCase(),w==="GZ"&&(w=I.exec(t.slice(0,-3))[1],w=w.toUpperCase());let v=null;if(m===ue.UNKNOWN&&(m=ue.parse(w)),e instanceof ArrayBuffer&&e.byteLength>=2&&m===ue.DCM){const M=new Uint8Array(e);(M[0]===92&&M[1]===1||M[1]===92&&M[0]===1)&&(m=ue.NII)}switch(E.imageType=m,m){case ue.DCM_FOLDER:case ue.DCM_MANIFEST:case ue.DCM:return;case ue.FIB:[v,E.v1]=await E.readFIB(e);break;case ue.MIH:case ue.MIF:v=await E.readMIF(e,s);break;case ue.NHDR:case ue.NRRD:if(v=await Vh.readNrrd(E,e),v===null)throw new Error(`Failed to parse NHDR/NRRD file ${t}`);break;case ue.MHD:case ue.MHA:v=await E.readMHA(e,s);break;case ue.MGH:case ue.MGZ:if(v=await jh.readMgh(E,e),v===null)throw new Error(`Failed to parse MGH/MGZ file ${t}`);break;case ue.SRC:v=await E.readSRC(e);break;case ue.V:v=E.readECAT(e);break;case ue.V16:v=E.readV16(e);break;case ue.VMR:v=E.readVMR(e);break;case ue.HEAD:v=await E.readHEAD(e,s);break;case ue.BMP:v=await E.readBMP(e);break;case ue.NPY:v=await E.readNPY(e);break;case ue.NPZ:v=await E.readNPZ(e);break;case ue.ZARR:v=await E.readZARR(e,x);break;case ue.NII:if(v=await Oh.readNifti(E,e,s),v===null)throw new Error(`Failed to parse NIfTI file ${t}.`);break;default:throw new Error("Image type not supported")}return E.init(e,t,i,r,s,n,o,c,l,h,d,f,u,m,p,g,b,A,y,v),E}computeObliqueAngle(e){const t=Ke(e);xt(t,e);const i=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]),r=Math.max(Math.max(Math.abs(t[0]),Math.abs(t[1])),Math.abs(t[2]))/i,s=Math.sqrt(t[4]*t[4]+t[5]*t[5]+t[6]*t[6]),n=Math.max(Math.max(Math.abs(t[4]),Math.abs(t[5])),Math.abs(t[6]))/s,o=Math.sqrt(t[8]*t[8]+t[9]*t[9]+t[10]*t[10]),c=Math.max(Math.max(Math.abs(t[8]),Math.abs(t[9])),Math.abs(t[10]))/o,l=Math.min(Math.min(r,n),c);let h=Math.abs(Math.acos(l)*180/3.141592653);return h>.01?V.warn("Warning voxels not aligned with world space: "+h+` degrees from plumb.
`):h=0,h}float32V1asRGBA(e){e.length!==this.nVox3D*3&&V.warn("float32V1asRGBA() expects "+this.nVox3D*3+"voxels, got ",+e.length);const t=e.slice();this.hdr.datatypeCode=2304,this.nFrame4D=1;for(let c=4;c<7;c++)this.hdr.dims[c]=1;this.hdr.dims[0]=3;const i=new Uint8Array(this.nVox3D*4);let r=1;for(let c=0;c<this.nVox3D*3;c++)isNaN(t[c])||(r=Math.max(r,Math.abs(t[c])));const s=255/r,n=this.nVox3D*2;let o=0;for(let c=0;c<this.nVox3D;c++){const l=t[c],h=t[c+this.nVox3D],d=t[c+n];i[o]=Math.abs(l*s),i[o+1]=Math.abs(h*s),i[o+2]=Math.abs(d*s);const f=+(l>0)*1,u=+(h>0)*2,m=+(d>0)*4;let p=248+f+u+m;Math.abs(l)+Math.abs(h)+Math.abs(d)<.1&&(p=0),i[o+3]=p,o+=4}return i}loadImgV1(e=!1,t=!1,i=!1){let r=this.v1;if(!r&&this.nFrame4D===3&&this.img.constructor===Float32Array&&(r=this.img.slice()),!r)return V.warn("Image does not have V1 data"),!1;if(e)for(let s=0;s<this.nVox3D;s++)r[s]=-r[s];if(t)for(let s=this.nVox3D;s<2*this.nVox3D;s++)r[s]=-r[s];if(i)for(let s=2*this.nVox3D;s<3*this.nVox3D;s++)r[s]=-r[s];return this.img=this.float32V1asRGBA(r),!0}calculateOblique(){if(!this.matRAS)throw new Error("matRAS not defined");if(this.pixDimsRAS===void 0)throw new Error("pixDimsRAS not defined");if(!this.dimsRAS)throw new Error("dimsRAS not defined");this.oblique_angle=this.computeObliqueAngle(this.matRAS);const e=this.vox2mm([0,0,0],this.matRAS),t=this.vox2mm([1/this.pixDimsRAS[1],0,0],this.matRAS),i=this.vox2mm([0,1/this.pixDimsRAS[2],0],this.matRAS),r=this.vox2mm([0,0,1/this.pixDimsRAS[3]],this.matRAS);Fe(t,t,e),Fe(i,i,e),Fe(r,r,e);const s=Ct(t[0],t[1],t[2],0,i[0],i[1],i[2],0,r[0],r[1],r[2],0,0,0,0,1);this.obliqueRAS=Ke(s);const n=Math.abs(90-_n(t,i)*(180/Math.PI)),o=Math.abs(90-_n(t,r)*(180/Math.PI)),c=Math.abs(90-_n(i,r)*(180/Math.PI));this.maxShearDeg=Math.max(Math.max(n,o),c),this.maxShearDeg>.1&&V.warn("Warning: voxels are rhomboidal, maximum shear is %f degrees.",this.maxShearDeg);const l=Be(this.dimsRAS[1],this.dimsRAS[2],this.dimsRAS[3],1),h=Ke(this.matRAS);xt(h,h);const d=Be(-.5,-.5,-.5,0);qa(h,h,ee(d[0],d[1],d[2])),h[0]*=l[0],h[1]*=l[0],h[2]*=l[0],h[4]*=l[1],h[5]*=l[1],h[6]*=l[1],h[8]*=l[2],h[9]*=l[2],h[10]*=l[2],this.frac2mm=Ke(h);const f=this.pixDimsRAS[1],u=this.pixDimsRAS[2],m=this.pixDimsRAS[3],p=Ke(h);p[0]=f*l[0],p[1]=0,p[2]=0,p[4]=0,p[5]=u*l[1],p[6]=0,p[8]=0,p[9]=0,p[10]=m*l[2];const g=this.mm2vox([0,0,0],!0);p[12]=(-g[0]-.5)*f,p[13]=(-g[1]-.5)*u,p[14]=(-g[2]-.5)*m,this.frac2mmOrtho=Ke(p),this.extentsMinOrtho=[p[12],p[13],p[14]],this.extentsMaxOrtho=[p[0]+p[12],p[5]+p[13],p[10]+p[14]],this.mm2ortho=we(),bt(this.mm2ortho,s)}THD_daxes_to_NIFTI(e,t,i){const r=this.hdr;if(r===null)throw new Error("HDR is not set");r.sform_code=2;const s="xxyyzzg";let n=-1,o=-1,c=-1;const l=["x","y","z"];l[0]=s[i[0]],l[1]=s[i[1]],l[2]=s[i[2]];const h=e.slice(0,3),d=t.slice(0,3);for(let f=0;f<3;f++)l[f]==="x"?n=f:l[f]==="y"?o=f:c=f;n<0||o<0||c<0||n===o||n===c||o===c||(r.pixDims[1]=Math.abs(h[0]),r.pixDims[2]=Math.abs(h[1]),r.pixDims[3]=Math.abs(h[2]),r.affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],r.affine[0][n]=-h[n],r.affine[1][o]=-h[o],r.affine[2][c]=h[c],r.affine[0][3]=-d[n],r.affine[1][3]=-d[o],r.affine[2][3]=d[c])}SetPixDimFromSForm(){if(!this.hdr)throw new Error("hdr not defined");const e=this.hdr.affine,t=Ct(e[0][0],e[0][1],e[0][2],e[0][3],e[1][0],e[1][1],e[1][2],e[1][3],e[2][0],e[2][1],e[2][2],e[2][3],e[3][0],e[3][1],e[3][2],e[3][3]),i=this.vox2mm([0,0,0],t),r=this.vox2mm([1,0,0],t);Fe(r,r,i);const s=this.vox2mm([0,1,0],t);Fe(s,s,i);const n=this.vox2mm([0,0,1],t);Fe(n,n,i),this.hdr.pixDims[1]=ya(r),this.hdr.pixDims[2]=ya(s),this.hdr.pixDims[3]=ya(n)}readECAT(e){this.hdr=new pe;const t=this.hdr;t.dims=[3,1,1,1,0,0,0,0],t.pixDims=[1,1,1,1,1,0,0,0];const i=new DataView(e),r=i.getInt32(0,!1),s=i.getInt16(50,!1);if(r!==1296127058||s<1||s>14)throw new Error("Not a valid ECAT file");let n=512,o=0;const c=[];let l=new Float32Array;for(;;){const h=i.getInt32(n,!1),d=i.getInt32(n+12,!1);if(h+d!==31)break;let f=n+20,u=0,m=0;for(;u<31&&(m=i.getInt32(f,!1),f+=16,m!==0);){u++;let p=m*512;const g=p-512,b=i.getUint16(g,!1);t.dims[1]=i.getUint16(g+4,!1),t.dims[2]=i.getUint16(g+6,!1),t.dims[3]=i.getUint16(g+8,!1);const A=i.getFloat32(g+26,!1);t.pixDims[1]=i.getFloat32(g+34,!1)*10,t.pixDims[2]=i.getFloat32(g+38,!1)*10,t.pixDims[3]=i.getFloat32(g+42,!1)*10,t.pixDims[4]=i.getUint32(g+46,!1)/1e3,c.push(t.pixDims[4]);const y=t.dims[1]*t.dims[2]*t.dims[3],x=new Float32Array(y);if(b===1)for(let I=0;I<y;I++)x[I]=i.getUint8(p)*A,p++;else if(b===6)for(let I=0;I<y;I++)x[I]=i.getUint16(p,!1)*A,p+=2;else if(b===7)for(let I=0;I<y;I++)x[I]=i.getUint32(p,!1)*A,p+=4;else V.warn("Unknown ECAT data type "+b);const E=l.slice(0);l=new Float32Array(E.length+x.length),l.set(E),l.set(x,E.length),o++}if(m===0)break;n+=512}if(t.dims[4]=o,t.pixDims[4]=c[0],o>1){t.dims[0]=4;let h=!1;for(let d=0;d<o;d++)c[d]!==c[0]&&(h=!0);h&&V.warn("Frame durations vary")}return t.sform_code=1,t.affine=[[-t.pixDims[1],0,0,(t.dims[1]-2)*.5*t.pixDims[1]],[0,-t.pixDims[2],0,(t.dims[2]-2)*.5*t.pixDims[2]],[0,0,-t.pixDims[3],(t.dims[3]-2)*.5*t.pixDims[3]],[0,0,0,1]],t.numBitsPerVoxel=32,t.datatypeCode=16,l.buffer}readV16(e){this.hdr=new pe;const t=this.hdr;t.dims=[3,1,1,1,0,0,0,0],t.pixDims=[1,1,1,1,1,0,0,0];const i=new DataView(e);return t.dims[1]=i.getUint16(0,!0),t.dims[2]=i.getUint16(2,!0),t.dims[3]=i.getUint16(4,!0),2*t.dims[1]*t.dims[2]*t.dims[3]+6!==e.byteLength&&V.warn("This does not look like a valid BrainVoyager V16 file"),t.numBitsPerVoxel=16,t.datatypeCode=512,V.warn("Warning: V16 files have no spatial transforms"),t.affine=[[0,0,-t.pixDims[1],(t.dims[1]-2)*.5*t.pixDims[1]],[-t.pixDims[2],0,0,(t.dims[2]-2)*.5*t.pixDims[2]],[0,-t.pixDims[3],0,(t.dims[3]-2)*.5*t.pixDims[3]],[0,0,0,1]],t.littleEndian=!0,e.slice(6)}async readNPY(e){function t(x){return{"|b1":1,"<i1":1,"<u1":1,"<i2":2,"<u2":2,"<i4":4,"<u4":4,"<f4":4,"<f8":8}[x]??1}function i(x){return{"|b1":2,"<i1":256,"<u1":2,"<i2":4,"<u2":512,"<i4":8,"<u4":768,"<f4":16,"<f8":64}[x]??16}const r=new DataView(e),s=[r.getUint8(0),r.getUint8(1),r.getUint8(2),r.getUint8(3),r.getUint8(4),r.getUint8(5)],n=[147,78,85,77,80,89];if(!s.every((x,E)=>x===n[E]))throw new Error("Not a valid NPY file: Magic number mismatch");const o=r.getUint16(8,!0),c=new TextDecoder("utf-8").decode(e.slice(10,10+o)),l=c.match(/'shape': \((.*?)\)/);if(!l)throw new Error("Invalid NPY header: Shape not found");const h=l[1].split(",").map(x=>x.trim()).filter(x=>x!=="").map(Number),d=c.match(/'descr': '([^']+)'/);if(!d)throw new Error("Invalid NPY header: Data type not found");const f=d[1],u=h.reduce((x,E)=>x*E,1),m=10+o,p=e.slice(m,m+u*t(f)),g=h.length>0?h[h.length-1]:1,b=h.length>1?h[h.length-2]:1,A=h.length>2?h[h.length-3]:1;this.hdr=new pe;const y=this.hdr;return y.dims=[3,g,b,A,0,0,0,0],y.pixDims=[1,1,1,1,1,0,0,0],y.affine=[[y.pixDims[1],0,0,-(y.dims[1]-2)*.5*y.pixDims[1]],[0,-y.pixDims[2],0,(y.dims[2]-2)*.5*y.pixDims[2]],[0,0,-y.pixDims[3],(y.dims[3]-2)*.5*y.pixDims[3]],[0,0,0,1]],y.numBitsPerVoxel=t(f)*8,y.datatypeCode=i(f),p}async readNPZ(e){const t=new Sh(e);for(let i=0;i<t.entries.length;i++){const r=t.entries[i];if(r.fileName.toLowerCase().endsWith(".npy")){const s=await r.extract();return await this.readNPY(s.buffer)}}}async imageDataFromArrayBuffer(e){return new Promise((t,i)=>{const r=new Blob([e]),s=URL.createObjectURL(r),n=new Image;n.crossOrigin="Anonymous",n.src=s,n.onload=()=>{URL.revokeObjectURL(s);const o=document.createElement("canvas");o.width=n.width,o.height=n.height;const c=o.getContext("2d");if(!c){i(new Error("Failed to get 2D context"));return}c.drawImage(n,0,0),t(c.getImageData(0,0,n.width,n.height))},n.onerror=o=>{URL.revokeObjectURL(s),i(o)}})}async readBMP(e){const t=await this.imageDataFromArrayBuffer(e),{width:i,height:r,data:s}=t;this.hdr=new pe;const n=this.hdr;n.dims=[3,i,r,1,0,0,0,0],n.pixDims=[1,1,1,1,1,0,0,0],n.affine=[[n.pixDims[1],0,0,-(n.dims[1]-2)*.5*n.pixDims[1]],[0,-n.pixDims[2],0,(n.dims[2]-2)*.5*n.pixDims[2]],[0,0,-n.pixDims[3],(n.dims[3]-2)*.5*n.pixDims[3]],[0,0,0,1]],n.numBitsPerVoxel=8,n.datatypeCode=2304;let o=!0;for(let c=0;c<s.length;c+=4)if(s[c]!==s[c+1]||s[c]!==s[c+2]){o=!1;break}if(o){n.datatypeCode=2;const c=new Uint8Array(i*r);for(let l=0,h=0;l<s.length;l+=4,h++)c[h]=s[l];return c.buffer}return s.buffer}async readZARR(e,t){let{width:i,height:r,depth:s=1,data:n}=t??{},o=i*r*s*3,c=o===n.length;if(c||(o=i*r*s,s===3&&(c=!0,s=1)),o!==n.length)throw new Error(`Expected RGB ${i}${r}${s}3 =  ${o}, but ZARR length ${n.length}`);this.hdr=new pe;const l=this.hdr;if(l.dims=[3,i,r,s,1,1,1,1],l.pixDims=[1,1,1,1,0,0,0,0],l.affine=[[l.pixDims[1],0,0,-(l.dims[1]-2)*.5*l.pixDims[1]],[0,-l.pixDims[2],0,(l.dims[2]-2)*.5*l.pixDims[2]],[0,0,-l.pixDims[3],(l.dims[3]-2)*.5*l.pixDims[3]],[0,0,0,1]],!c){if(l.numBitsPerVoxel=8,l.datatypeCode=2,n instanceof Uint8Array){const m=new ArrayBuffer(n.length);return new Uint8Array(m).set(n),m}return n}l.numBitsPerVoxel=24,l.datatypeCode=128;function h(m,p,g,b){const A=p*g,y=new Uint8Array(A*b*3),x=new Array(b);for(let w=0;w<b;w++)x[w]=A*3*w;let E=0,I=0;for(let w=0;w<A;w++){for(let v=0;v<b;v++)y[x[v]+I]=m[E++],y[x[v]+I+1]=m[E++],y[x[v]+I+2]=m[E++];I+=3}return y}const d=h(n,l.dims[1],l.dims[2],l.dims[3]),f=new ArrayBuffer(d.length);return new Uint8Array(f).set(d),f}readVMR(e){this.hdr=new pe;const t=this.hdr;t.dims=[3,1,1,1,0,0,0,0],t.pixDims=[1,1,1,1,1,0,0,0];const i=new DataView(e),r=i.getUint16(0,!0);r!==4&&V.warn("Not a valid version 4 VMR image"),t.dims[1]=i.getUint16(2,!0),t.dims[2]=i.getUint16(4,!0),t.dims[3]=i.getUint16(6,!0);const s=t.dims[1]*t.dims[2]*t.dims[3];if(r>=4){let n=8+s;const o=i.getUint32(n+88,!0);if(n=n+92,o>0){const c=e.byteLength;for(let l=0;l<o;l++){for(;n<c&&i.getUint8(n)!==0;)n++;for(n++,n+=4;n<c&&i.getUint8(n)!==0;)n++;n++;const h=i.getUint32(n,!0);n+=4;for(let d=0;d<h;d++)n+=4}}t.pixDims[1]=i.getFloat32(n+2,!0),t.pixDims[2]=i.getFloat32(n+6,!0),t.pixDims[3]=i.getFloat32(n+10,!0)}return V.warn("Warning: VMR spatial transform not implemented"),t.affine=[[0,0,-t.pixDims[1],(t.dims[1]-2)*.5*t.pixDims[1]],[-t.pixDims[2],0,0,(t.dims[2]-2)*.5*t.pixDims[2]],[0,-t.pixDims[3],0,(t.dims[3]-2)*.5*t.pixDims[3]],[0,0,0,1]],V.debug(t),t.numBitsPerVoxel=8,t.datatypeCode=2,e.slice(8,8+s)}async readFIB(e){this.hdr=new pe;const t=this.hdr;t.littleEndian=!1,t.dims=[3,1,1,1,0,0,0,0],t.pixDims=[1,1,1,1,1,0,0,0];const i=await ce.readMatV4(e,!0);if(!("dimension"in i)||!("dti_fa"in i))throw new Error("Not a valid DSIstudio FIB file");const r="index0"in i&&"index1"in i&&"index2"in i&&"odf_vertices"in i;t.numBitsPerVoxel=32,t.datatypeCode=16,t.dims[1]=i.dimension[0],t.dims[2]=i.dimension[1],t.dims[3]=i.dimension[2],t.dims[4]=1,t.pixDims[1]=i.voxel_size[0],t.pixDims[2]=i.voxel_size[1],t.pixDims[3]=i.voxel_size[2],t.sform_code=1;const s=(t.dims[1]-1)*.5*t.pixDims[1],n=(t.dims[2]-1)*.5*t.pixDims[2],o=(t.dims[3]-1)*.5*t.pixDims[3];t.affine=[[t.pixDims[1],0,0,-s],[0,-t.pixDims[2],0,n],[0,0,t.pixDims[2],-o],[0,0,0,1]],t.littleEndian=!0;const c=t.dims[1]*t.dims[2]*t.dims[3],l=c*Math.ceil(t.numBitsPerVoxel/8),h=l*t.dims[4],d=new Uint8Array(new ArrayBuffer(c*4*3));if(r){const p=t.dims[1]*t.dims[2]*t.dims[3],g=new Float32Array(p),b=new Float32Array(p),A=new Float32Array(p),y=i.index0,x=i.odf_vertices;for(let E=0;E<p;E++){const I=y[E]*3;g[E]=x[I+0],b[E]=x[I+1],A[E]=-x[I+2]}d.set(new Uint8Array(g.buffer,g.byteOffset,g.byteLength),0*l),d.set(new Uint8Array(b.buffer,b.byteOffset,b.byteLength),1*l),d.set(new Uint8Array(A.buffer,A.byteOffset,A.byteLength),2*l)}"report"in i&&(t.description=new TextDecoder().decode(i.report.subarray(0,Math.min(79,i.report.byteLength))));const f=new Uint8Array(new ArrayBuffer(h)),u=Float32Array.from(i.dti_fa);if("mask"in i){let p=1;"dti_fa_slope"in i&&(p=i.dti_fa_slope[0]);let g=1;"dti_fa_inter"in i&&(g=i.dti_fa_inter[0]);const b=t.dims[1]*t.dims[2]*t.dims[3],A=i.mask,y=new Float32Array(b);let x=0;for(let E=0;E<b;E++)A[E]!==0&&(y[E]=u[x]*p+g,x++);return[y.buffer,new Float32Array(d.buffer)]}const m=new Uint8Array(u.buffer,u.byteOffset,u.byteLength);return f.set(m,0),[f.buffer,new Float32Array(d.buffer)]}async readSRC(e){this.hdr=new pe;const t=this.hdr;t.littleEndian=!1,t.dims=[3,1,1,1,0,0,0,0],t.pixDims=[1,1,1,1,1,0,0,0];const i=await ce.readMatV4(e);if(!("dimension"in i)||!("image0"in i))throw new Error("Not a valid DSIstudio SRC file");let r=0,s=0;for(const[u,m]of Object.entries(i))if(u.startsWith("image")){if(r===0?s=m.length:s!==m.length&&(s=-1),m.constructor!==Uint16Array)throw new Error("DSIstudio SRC files always use Uint16 datatype");r++}if(s<1||r<1)throw new Error("SRC file not valid DSI Studio data. The image(s) should have the same length");t.numBitsPerVoxel=16,t.datatypeCode=512,t.dims[1]=i.dimension[0],t.dims[2]=i.dimension[1],t.dims[3]=i.dimension[2],t.dims[4]=r,t.dims[4]>1&&(t.dims[0]=4),t.pixDims[1]=i.voxel_size[0],t.pixDims[2]=i.voxel_size[1],t.pixDims[3]=i.voxel_size[2],t.sform_code=1;const n=(t.dims[1]-1)*.5*t.pixDims[1],o=(t.dims[2]-1)*.5*t.pixDims[2],c=(t.dims[3]-1)*.5*t.pixDims[3];t.affine=[[t.pixDims[1],0,0,-n],[0,-t.pixDims[2],0,o],[0,0,t.pixDims[2],-c],[0,0,0,1]],t.littleEndian=!0;const l=t.dims[1]*t.dims[2]*t.dims[3]*(t.numBitsPerVoxel/8),h=l*t.dims[4],d=new Uint8Array(new ArrayBuffer(h));let f=0;for(let u=0;u<r;u++){const m=i[`image${u}`],p=new Uint8Array(m.buffer,m.byteOffset,m.byteLength);d.set(p,f),f+=l}return"report"in i&&(t.description=new TextDecoder().decode(i.report.subarray(0,Math.min(79,i.report.byteLength)))),d.buffer}async readHEAD(e,t){this.hdr=new pe;const i=this.hdr;i.dims[0]=3,i.pixDims=[1,1,1,1,1,0,0,0];let r=[0,0,0],s=[0,0,0],n=[1,1,1];const c=new TextDecoder().decode(e).split(/\r?\n/),l=(e.byteLength+8)%16,h=e.byteLength+(16-l);V.debug(e.byteLength,"len",h);const d=new ArrayBuffer(h);new Uint8Array(d).set(new Uint8Array(e));const f=new Ah(h+8,42,d,!0);i.addExtension(f),i.extensionCode=42,i.extensionFlag[0]=1,i.extensionSize=h+8;const u=c.length;let m=0,p=!1;for(;m<u;){let b=c[m];if(m++,!b.startsWith("type"))continue;const A=b.includes("integer-attribute"),y=b.includes("float-attribute");if(b=c[m],m++,!b.startsWith("name"))continue;let x=b.split("= ");const E=x[1];b=c[m],m++,x=b.split("= ");let I=parseInt(x[1]);if(!(I<1)){if(b=c[m],m++,x=b.trim().split(/\s+/),y||A){for(;x.length<I;){b=c[m],m++;const w=b.trim().split(/\s+/);x.push(...w)}for(let w=0;w<I;w++)x[w]=parseFloat(x[w])}switch(E){case"BYTEORDER_STRING":x[0].includes("LSB_FIRST")?i.littleEndian=!0:x[0].includes("MSB_FIRST")&&(i.littleEndian=!1);break;case"BRICK_TYPES":{i.dims[4]=I;const w=parseInt(x[0]);w===0?(i.numBitsPerVoxel=8,i.datatypeCode=2):w===1?(i.numBitsPerVoxel=16,i.datatypeCode=4):w===3?(i.numBitsPerVoxel=32,i.datatypeCode=16):V.warn("Unknown BRICK_TYPES ",w)}break;case"IJK_TO_DICOM_REAL":if(I<12)break;p=!0,i.sform_code=2,i.affine=[[-x[0],-x[1],-x[2],-x[3]],[-x[4],-x[5],-x[6],-x[7]],[x[8],x[9],x[10],x[11]],[0,0,0,1]];break;case"DATASET_DIMENSIONS":I=Math.max(I,3);for(let w=0;w<I;w++)i.dims[w+1]=x[w];break;case"ORIENT_SPECIFIC":r=x;break;case"ORIGIN":s=x;break;case"DELTA":n=x;break;case"TAXIS_FLOATS":i.pixDims[4]=x[0];break;default:V.warn("Unknown:",E)}}}p?this.SetPixDimFromSForm():this.THD_daxes_to_NIFTI(n,s,r);const g=i.numBitsPerVoxel/8*i.dims[1]*i.dims[2]*i.dims[3]*i.dims[4];if(!t)throw new Error("pairedImgData not set");return t.byteLength<g?await ce.decompressToBuffer(new Uint8Array(t)):t.slice(0)}async readMHA(e,t){const i=e.byteLength;if(i<20)throw new Error("File too small to be VTK: bytes = "+e.byteLength);const r=new Uint8Array(e);let s=0;function n(p){return p===10||p===13}function o(){for(;s<i&&n(r[s]);)s++;const p=s;for(;s<i&&!n(r[s]);)s++;return s-p<2?"":new TextDecoder().decode(e.slice(p,s))}let c=o();this.hdr=new pe;const l=this.hdr;l.pixDims=[1,1,1,1,1,0,0,0],l.dims=[1,1,1,1,1,1,1,1],l.littleEndian=!0;let h=!1,d=!1;const f=pa(NaN,0,0,0,1,0,0,0,1),u=ee(0,0,0);for(;c!=="";){let p=c.split(" ");if(p.length>2&&(p=p.slice(2)),c.startsWith("BinaryDataByteOrderMSB")&&p[0].includes("False")&&(l.littleEndian=!0),c.startsWith("BinaryDataByteOrderMSB")&&p[0].includes("True")&&(l.littleEndian=!1),c.startsWith("CompressedData")&&p[0].includes("True")&&(h=!0),c.startsWith("TransformMatrix"))for(let g=0;g<9;g++)f[g]=parseFloat(p[g]);if(c.startsWith("Offset"))for(let g=0;g<Math.min(p.length,3);g++)u[g]=parseFloat(p[g]);if(c.startsWith("ElementSpacing"))for(let g=0;g<p.length;g++)l.pixDims[g+1]=parseFloat(p[g]);if(c.startsWith("DimSize")){l.dims[0]=p.length;for(let g=0;g<p.length;g++)l.dims[g+1]=parseInt(p[g])}if(c.startsWith("ElementType"))switch(p[0]){case"MET_UCHAR":l.numBitsPerVoxel=8,l.datatypeCode=2;break;case"MET_CHAR":l.numBitsPerVoxel=8,l.datatypeCode=256;break;case"MET_SHORT":l.numBitsPerVoxel=16,l.datatypeCode=4;break;case"MET_USHORT":l.numBitsPerVoxel=16,l.datatypeCode=512;break;case"MET_INT":l.numBitsPerVoxel=32,l.datatypeCode=8;break;case"MET_UINT":l.numBitsPerVoxel=32,l.datatypeCode=768;break;case"MET_FLOAT":l.numBitsPerVoxel=32,l.datatypeCode=16;break;case"MET_DOUBLE":l.numBitsPerVoxel=64,l.datatypeCode=64;break;default:throw new Error("Unsupported MHA data type: "+p[0])}if(c.startsWith("ObjectType")&&!p[0].includes("Image")&&V.warn("Only able to read ObjectType = Image, not "+c),c.startsWith("ElementDataFile")){p[0]!=="LOCAL"&&(d=!0);break}c=o()}const m=pa(l.pixDims[1],0,0,0,l.pixDims[2],0,0,0,l.pixDims[3]);for(ih(f,f,m),l.affine=[[-f[0],-f[3],-f[6],-u[0]],[-f[1],-f[4],-f[7],-u[1]],[f[2],f[5],f[8],u[2]],[0,0,0,1]];r[s]===10;)s++;return l.vox_offset=s,d&&t?h?await ce.decompressToBuffer(new Uint8Array(t.slice(0))):t.slice(0):h?await ce.decompressToBuffer(new Uint8Array(e.slice(l.vox_offset))):e.slice(l.vox_offset)}async readMIF(e,t){this.hdr=new pe;const i=this.hdr;i.pixDims=[1,1,1,1,1,0,0,0],i.dims=[1,1,1,1,1,1,1,1];let r=e.byteLength;if(r<20)throw new Error("File too small to be MIF: bytes = "+r);let s=new Uint8Array(e);s[0]===31&&s[1]===139&&(V.debug("MIF with GZ decompression"),e=await ce.decompressToBuffer(new Uint8Array(e)),r=e.byteLength,s=new Uint8Array(e));let n=0;function o(){for(;n<r&&s[n]===10;)n++;const S=n;for(;n<r&&s[n]!==10;)n++;return n++,n-S<1?"":new TextDecoder().decode(e.slice(S,n-1))}let c=o();if(!c.startsWith("mrtrix image"))throw new Error("Not a valid MIF file");const l=[];let h=!1,d=0,f=0,u=!1;for(c=o();n<r&&!c.startsWith("END");){let S=c.split(":");if(c=o(),S.length<2)break;const k=S[0];S=S[1].split(",");for(let F=0;F<S.length;F++)S[F]=S[F].trim();switch(k){case"dim":i.dims[0]=S.length;for(let F=0;F<S.length;F++)i.dims[F+1]=parseInt(S[F]);break;case"vox":for(let F=0;F<S.length;F++)i.pixDims[F+1]=parseFloat(S[F]),isNaN(i.pixDims[F+1])&&(i.pixDims[F+1]=0);break;case"layout":for(let F=0;F<S.length;F++)l.push(parseInt(S[F]));break;case"datatype":{const F=S[0];F.startsWith("Bit")?(h=!0,i.datatypeCode=2):F.startsWith("Int8")?i.datatypeCode=256:F.startsWith("UInt8")?i.datatypeCode=2:F.startsWith("Int16")?i.datatypeCode=4:F.startsWith("UInt16")?i.datatypeCode=512:F.startsWith("Int32")?i.datatypeCode=8:F.startsWith("UInt32")?i.datatypeCode=768:F.startsWith("Float32")?i.datatypeCode=16:F.startsWith("Float64")?i.datatypeCode=64:V.warn("Unsupported datatype "+F),F.includes("8")?i.numBitsPerVoxel=8:F.includes("16")?i.numBitsPerVoxel=16:F.includes("32")?i.numBitsPerVoxel=32:F.includes("64")&&(i.numBitsPerVoxel=64),i.littleEndian=!0,F.endsWith("LE")&&(i.littleEndian=!0),F.endsWith("BE")&&(i.littleEndian=!1)}break;case"transform":if(d>2||S.length!==4)break;i.affine[d][0]=parseFloat(S[0]),i.affine[d][1]=parseFloat(S[1]),i.affine[d][2]=parseFloat(S[2]),i.affine[d][3]=parseFloat(S[3]),d++;break;case"comments":i.description=S[0].substring(0,Math.min(79,S[0].length));break;case"RepetitionTime":f=parseFloat(S[0]);break;case"file":u=!S[0].startsWith(". "),u||(S=S[0].split(" "),i.vox_offset=parseInt(S[1]));break}}const m=i.dims[0];m>5&&V.warn("reader only designed for a maximum of 5 dimensions (XYZTD)");let p=1;for(let S=0;S<m;S++)p*=Math.max(i.dims[S+1],1);for(let S=0;S<3;S++)for(let k=0;k<3;k++)i.affine[S][k]*=i.pixDims[k+1];V.debug("mif affine:"+i.affine[0]),f>0&&(i.pixDims[4]=f),u&&!t&&V.warn("MIH header provided without paired image data");let g;if(t&&u)g=t.slice(0);else if(h){i.numBitsPerVoxel=8;const S=new Uint8Array(p),k=e.slice(i.vox_offset,i.vox_offset+Math.ceil(p/8)),F=new Uint8Array(k);let B=0;for(let O=0;O<p;O++){const L=O%8;S[O]=F[B]>>7-L&1,L===7&&B++}g=S.buffer}else g=e.slice(i.vox_offset,i.vox_offset+p*(i.numBitsPerVoxel/8));l.length!==i.dims[0]&&V.warn("dims does not match layout");let b=1;const A=[1,1,1,1,1],y=[!1,!1,!1,!1,!1];for(let S=0;S<l.length;S++)for(let k=0;k<l.length;k++)Math.abs(l[k])===S&&(A[k]=b,(l[k]<0||Object.is(l[k],-0))&&(y[k]=!0),b*=i.dims[k+1]);let x=ce.range(0,i.dims[1]-1,1);y[0]&&(x=ce.range(i.dims[1]-1,0,-1));for(let S=0;S<i.dims[1];S++)x[S]*=A[0];let E=ce.range(0,i.dims[2]-1,1);y[1]&&(E=ce.range(i.dims[2]-1,0,-1));for(let S=0;S<i.dims[2];S++)E[S]*=A[1];let I=ce.range(0,i.dims[3]-1,1);y[2]&&(I=ce.range(i.dims[3]-1,0,-1));for(let S=0;S<i.dims[3];S++)I[S]*=A[2];let w=ce.range(0,i.dims[4]-1,1);y[3]&&(w=ce.range(i.dims[4]-1,0,-1));for(let S=0;S<i.dims[4];S++)w[S]*=A[3];let v=ce.range(0,i.dims[5]-1,1);y[4]&&(v=ce.range(i.dims[5]-1,0,-1));for(let S=0;S<i.dims[5];S++)v[S]*=A[4];let M=0,C,D;switch(i.datatypeCode){case 256:C=new Int8Array(g),D=new Int8Array(p);break;case 2:C=new Uint8Array(g),D=new Uint8Array(p);break;case 4:C=new Int16Array(g),D=new Int16Array(p);break;case 512:C=new Uint16Array(g),D=new Uint16Array(p);break;case 8:C=new Int32Array(g),D=new Int32Array(p);break;case 768:C=new Uint32Array(g),D=new Uint32Array(p);break;case 16:C=new Float32Array(g),D=new Float32Array(p);break;case 64:C=new Float64Array(g),D=new Float64Array(p);break;default:throw new Error("unknown datatypeCode")}for(let S=0;S<i.dims[5];S++)for(let k=0;k<i.dims[4];k++)for(let F=0;F<i.dims[3];F++)for(let B=0;B<i.dims[2];B++)for(let O=0;O<i.dims[1];O++)D[M]=C[x[O]+E[B]+I[F]+w[k]+v[S]],M++;return D.buffer}calculateRAS(){if(!this.hdr)throw new Error("hdr not set");const e=this.hdr.affine,t=this.hdr,i=pa(Math.abs(e[0][0]),Math.abs(e[0][1]),Math.abs(e[0][2]),Math.abs(e[1][0]),Math.abs(e[1][1]),Math.abs(e[1][2]),Math.abs(e[2][0]),Math.abs(e[2][1]),Math.abs(e[2][2])),r=[1,1,1];i[3]>i[0]&&(r[0]=2),i[6]>i[0]&&i[6]>i[3]&&(r[0]=3),r[1]=1,r[0]===1?i[4]>i[7]?r[1]=2:r[1]=3:r[0]===2?i[1]>i[7]?r[1]=1:r[1]=3:i[1]>i[4]?r[1]=1:r[1]=2,r[2]=6-r[1]-r[0];let s=[1,2,3];s[r[0]-1]=1,s[r[1]-1]=2,s[r[2]-1]=3;let n=Ct(e[0][0],e[0][1],e[0][2],e[0][3],e[1][0],e[1][1],e[1][2],e[1][3],e[2][0],e[2][1],e[2][2],e[2][3],0,0,0,1);this.mm000=this.vox2mm([-.5,-.5,-.5],n),this.mm100=this.vox2mm([t.dims[1]-.5,-.5,-.5],n),this.mm010=this.vox2mm([-.5,t.dims[2]-.5,-.5],n),this.mm001=this.vox2mm([-.5,-.5,t.dims[3]-.5],n);const o=we();rf(o,n);for(let g=0;g<3;g++)for(let b=0;b<3;b++)o[g*4+b]=n[g*4+s[b]-1];const c=[0,0,0];o[0]<0&&(c[0]=1),o[5]<0&&(c[1]=1),o[10]<0&&(c[2]=1),this.dimsRAS=[t.dims[0],t.dims[s[0]],t.dims[s[1]],t.dims[s[2]]],this.pixDimsRAS=[t.pixDims[0],t.pixDims[s[0]],t.pixDims[s[1]],t.pixDims[s[2]]],this.permRAS=s.slice();for(let g=0;g<3;g++)c[g]===1&&(this.permRAS[g]=-this.permRAS[g]);if(this.arrayEquals(s,[1,2,3])&&this.arrayEquals(c,[0,0,0])){this.toRAS=we(),this.matRAS=Ke(n),this.calculateOblique(),this.img2RASstep=[1,this.dimsRAS[1],this.dimsRAS[1]*this.dimsRAS[2]],this.img2RASstart=[0,0,0];return}rh(n),n[0]=1-c[0]*2,n[5]=1-c[1]*2,n[10]=1-c[2]*2,n[3]=(t.dims[s[0]]-1)*c[0],n[7]=(t.dims[s[1]]-1)*c[1],n[11]=(t.dims[s[2]]-1)*c[2];const l=we();bt(l,n),Da(l,l,o),this.matRAS=Ke(l),n=Ct(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1),n[s[0]-1+0]=-c[0]*2+1,n[s[1]-1+4]=-c[1]*2+1,n[s[2]-1+8]=-c[2]*2+1,n[3]=c[0],n[7]=c[1],n[11]=c[2],this.toRAS=Ke(n),n[3]=0,n[7]=0,n[11]=0,n[12]=0,(this.permRAS[0]===-1||this.permRAS[1]===-1||this.permRAS[2]===-1)&&(n[12]=t.dims[1]-1),n[13]=0,(this.permRAS[0]===-2||this.permRAS[1]===-2||this.permRAS[2]===-2)&&(n[13]=t.dims[2]-1),n[14]=0,(this.permRAS[0]===-3||this.permRAS[1]===-3||this.permRAS[2]===-3)&&(n[14]=t.dims[3]-1),this.toRASvox=Ke(n),V.debug(this.hdr.dims),V.debug(this.dimsRAS);const h=this.hdr;s=this.permRAS;const d=[Math.abs(s[0]),Math.abs(s[1]),Math.abs(s[2])],f=[h.dims[d[0]],h.dims[d[1]],h.dims[d[2]]],u=[1,h.dims[1],h.dims[1]*h.dims[2]],m=[u[d[0]-1],u[d[1]-1],u[d[2]-1]],p=[0,0,0];for(let g=0;g<3;g++)s[g]<0&&(p[g]=m[g]*(f[g]-1),m[g]=-m[g]);this.img2RASstep=m,this.img2RASstart=p,this.calculateOblique()}async hdr2RAS(e=1){if(!this.permRAS)throw new Error("permRAS undefined");if(!this.hdr)throw new Error("hdr undefined");const t=pn({...this.hdr,vox_offset:352},!1),i=await $r(t.buffer,!0);e===1?(i.dims[0]=3,i.dims[4]=1):e>1&&(i.dims[0]=4,i.dims[4]=e);const r=this.permRAS.slice();if(r[0]===1&&r[1]===2&&r[2]===3)return i;i.qform_code=0;for(let n=1;n<4;n++)i.dims[n]=this.dimsRAS[n];for(let n=0;n<this.pixDimsRAS.length;n++)i.pixDims[n]=this.pixDimsRAS[n];let s=0;for(let n=0;n<4;n++)for(let o=0;o<4;o++)i.affine[n][o]=this.matRAS[s],s++;return i}img2RAS(e=0){if(!this.permRAS)throw new Error("permRAS undefined");if(!this.img)throw new Error("img undefined");if(!this.hdr)throw new Error("hdr undefined");const t=this.permRAS.slice();if(t[0]===1&&t[1]===2&&t[2]===3)return this.img;const i=this.hdr,r=i.dims[1]*i.dims[2]*i.dims[3];let s=e*r;(s+r>this.img.length||s<0)&&(s=0,V.warn(`img2RAS nVolume (${e}) out of bounds (${e}+1)${r} > ${this.img.length}`));const n=this.img.slice(0,r),o=[Math.abs(t[0]),Math.abs(t[1]),Math.abs(t[2])],c=[i.dims[o[0]],i.dims[o[1]],i.dims[o[2]]],l=[1,i.dims[1],i.dims[1]*i.dims[2]],h=[l[o[0]-1],l[o[1]-1],l[o[2]-1]],d=[0,0,0];for(let u=0;u<3;u++)t[u]<0&&(d[u]=h[u]*(c[u]-1),h[u]=-h[u]);let f=0;for(let u=0;u<c[2];u++){const m=d[2]+u*h[2];for(let p=0;p<c[1];p++){const g=d[1]+p*h[1];for(let b=0;b<c[0];b++){const A=d[0]+b*h[0];n[f]=this.img[A+g+m+s],f++}}}return n}vox2mm(e,t){const i=Ke(t);xt(i,i);const r=Be(e[0],e[1],e[2],1);return it(r,r,i),ee(r[0],r[1],r[2])}mm2vox(e,t=!1){if(!this.matRAS)throw new Error("matRAS undefined");const i=Ke(this.matRAS),r=Ke(i);xt(r,i),bt(r,r);const s=Be(e[0],e[1],e[2],1);it(s,s,r);const n=ee(s[0],s[1],s[2]);return t?n:[Math.round(n[0]),Math.round(n[1]),Math.round(n[2])]}arrayEquals(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((i,r)=>i===t[r])}setColormap(e){this._colormap=e,this.calMinMax(),this.onColormapChange&&this.onColormapChange(this)}setColormapLabel(e){this.colormapLabel=Ie.makeLabelLut(e)}async setColormapLabelFromUrl(e){this.colormapLabel=await Ie.makeLabelLutFromUrl(e)}get colormap(){return this._colormap}get colorMap(){return this._colormap}set colormap(e){this.setColormap(e)}set colorMap(e){this.setColormap(e)}get opacity(){return this._opacity}set opacity(e){this._opacity=e,this.onOpacityChange&&this.onOpacityChange(this)}calMinMax(e=Number.POSITIVE_INFINITY,t=!0){if(!this.hdr)throw new Error("hdr undefined");if(!this.img)throw new Error("img undefined");let i=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,s=0,n=0,o=this.hdr.dims[1]*this.hdr.dims[2]*this.hdr.dims[3];const c=Math.floor(this.img.length/o);e>=c&&(e=this.frame4D),e=Math.min(e,c-1);const l=e*o;let h=[];if(t){const k=[Math.floor(.25*this.hdr.dims[1]),Math.floor(.25*this.hdr.dims[2]),Math.floor(.25*this.hdr.dims[3])],F=[this.hdr.dims[1]-2*k[0],this.hdr.dims[2]-2*k[1],this.hdr.dims[3]-2*k[2]],B=[F[0]+k[0],F[1]+k[1],F[2]+k[2]];o=F[0]*F[1]*F[2],h=new this.img.constructor(o);let O=-1,L=0;for(let _=0;_<this.hdr.dims[3];_++)for(let q=0;q<this.hdr.dims[2];q++)for(let J=0;J<this.hdr.dims[1];J++)O++,!(J<k[0]||q<k[1]||_<k[2])&&(J>=B[0]||q>=B[1]||_>=B[2]||(h[L]=this.img[O+l],L++))}else{h=new this.img.constructor(o);for(let S=0;S<o;S++)h[S]=this.img[S+l]}const d=h.constructor!==Float64Array&&h.constructor!==Float32Array&&this.ignoreZeroVoxels;if(d)for(let S=0;S<o;S++)i=Math.min(h[S],i),r=Math.max(h[S],r),h[S]===0&&s++;else for(let S=0;S<o;S++){if(isNaN(h[S])){n++;continue}h[S]===0&&(s++,this.ignoreZeroVoxels)||(i=Math.min(h[S],i),r=Math.max(h[S],r))}this.ignoreZeroVoxels&&i===r&&s>0&&(i=0);const f=this.intensityRaw2Scaled(i),u=this.intensityRaw2Scaled(r),m=Ie.colormapFromKey(this._colormap);let p=0,g=0;if(m.min!==void 0&&(p=m.min),m.max!==void 0&&(g=m.max),p===g&&this.trustCalMinMax&&isFinite(this.hdr.cal_min)&&isFinite(this.hdr.cal_max)&&this.hdr.cal_max>this.hdr.cal_min)return this.cal_min=this.hdr.cal_min,this.cal_max=this.hdr.cal_max,this.robust_min=this.cal_min,this.robust_max=this.cal_max,this.global_min=f,this.global_max=u,[this.hdr.cal_min,this.hdr.cal_max,this.hdr.cal_min,this.hdr.cal_max];if(p!==g)return this.cal_min=p,this.cal_max=g,this.robust_min=this.cal_min,this.robust_max=this.cal_max,[p,g,p,g];const b=100*s/(o-0);let A=!1;b>60&&!this.ignoreZeroVoxels&&(V.warn(`${Math.round(b)}% of voxels are zero: ignoring zeros for cal_max`),A=!0,this.ignoreZeroVoxels=!0),this.ignoreZeroVoxels||(s=0),s+=n;const y=Math.round((o-0-s)*this.percentileFrac);if(y<1||i===r)return t?this.calMinMax(e,!1):(V.debug("no variability in image intensity?"),this.cal_min=f,this.cal_max=u,this.robust_min=this.cal_min,this.robust_max=this.cal_max,this.global_min=f,this.global_max=u,[f,u,f,u]);const x=1001,E=(x-1)/(r-i),I=new Array(x);for(let S=0;S<x;S++)I[S]=0;if(d)for(let S=0;S<o;S++)I[Math.round((h[S]-i)*E)]++;else if(this.ignoreZeroVoxels)for(let S=0;S<o;S++)h[S]!==0&&(isNaN(h[S])||I[Math.round((h[S]-i)*E)]++);else for(let S=0;S<o;S++)isNaN(h[S])||I[Math.round((h[S]-i)*E)]++;let w=0,v=0;for(;w<y;)w+=I[v],v++;v--,w=0;let M=x;for(;w<y;)M--,w+=I[M];if(v===M){let S=-1;for(;S!==0;)v>0&&(v--,I[v]>0&&(S=0)),S!==0&&M<x-1&&(M++,I[M]>0&&(S=0)),v===0&&M===x-1&&(S=0)}let C=this.intensityRaw2Scaled(v/E+i),D=this.intensityRaw2Scaled(M/E+i);return this.hdr.cal_min<this.hdr.cal_max&&this.hdr.cal_min>=f&&this.hdr.cal_max<=u&&(C=this.hdr.cal_min,D=this.hdr.cal_max),A&&(C=Math.min(C,0)),this.cal_min=C,this.cal_max=D,this.hdr.intent_code===1002&&(this.cal_min=f,this.cal_max=u),this.robust_min=this.cal_min,this.robust_max=this.cal_max,this.global_min=f,this.global_max=u,[C,D,f,u]}intensityRaw2Scaled(e){if(!this.hdr)throw new Error("hdr undefined");return this.hdr.scl_slope===0&&(this.hdr.scl_slope=1),e*this.hdr.scl_slope+this.hdr.scl_inter}intensityScaled2Raw(e){if(!this.hdr)throw new Error("hdr undefined");return this.hdr.scl_slope===0&&(this.hdr.scl_slope=1),(e-this.hdr.scl_inter)/this.hdr.scl_slope}async saveToUint8Array(e,t=null){return kh(this,e,t)}async saveToDisk(e="",t=null){return gp(this,e,t)}static async fetchDicomData(e,t={}){if(e==="")throw Error("url must not be empty");let r=/^(?:[a-z+]+:)?\/\//i.test(e)?e:new URL(e,window.location.href);/(?:.([^.]+))?$/.exec(r.pathname)||(r=new URL("niivue-manifest.txt",e));let o=await fetch(r,{headers:t});if(!o.ok)throw Error(o.statusText);const l=(await o.text()).split(`
`),d=/(.*\/).*/.exec(r)[0],f=[];for(const u of l){const m=new URL(u,d);if(o=await fetch(m,{headers:t}),!o.ok)throw Error(o.statusText);const p=await o.arrayBuffer();f.push({name:u,data:p})}return f}static async readFirstDecompressedBytes(e,t){const i=e.getReader(),r=new Lf,s=[];let n=0,o=!1,c,l;const h=new Promise((f,u)=>{c=f,l=u});function d(){const f=new Uint8Array(n);let u=0;for(const m of s)f.set(m,u),u+=m.length;c(f)}return r.ondata=f=>{s.push(f),n+=f.length,n>=t&&(o=!0,i.cancel().catch(()=>{}),d())},(async()=>{try{for(;!o;){const{done:f,value:u}=await i.read();if(f){o=!0,r.push(new Uint8Array,!0);return}r.push(u,!1)}}catch(f){l(f)}})().catch(()=>{}),h}static extractFilenameFromUrl(e){const i=new URL(e).searchParams.get("response-content-disposition");if(i){const r=i.match(/filename\*?=(?:UTF-8'')?"?([^";]+)"?/);if(r)return decodeURIComponent(r[1])}return e.split("/").pop().split("?")[0]}static async loadInitialVolumesGz(e="",t={},i=NaN){if(isNaN(i))return null;const r=await fetch(e,{headers:t,cache:"force-cache"});let s=352,n=await this.readFirstDecompressedBytes(r.body,s);const o=new DataView(n.buffer,n.byteOffset,n.byteLength),c=o.getUint16(0,!0),l=c===348;if(!l&&!(c===23553)||(n.length>111&&(s=o.getFloat32(108,l)),s>n.length&&(n=await this.readFirstDecompressedBytes(r.body,s)),!(n[0]===92&&n[1]===1||n[1]===92&&n[0]===1)))return null;const f=await $r(n.buffer);if(!f)throw new Error("Could not read NIfTI header");const u=f.numBitsPerVoxel/8,m=[1,2,3].reduce((x,E)=>x*(f.dims[E]>1?f.dims[E]:1),1),p=[4,5,6].reduce((x,E)=>x*(f.dims[E]>1?f.dims[E]:1),1),g=Math.max(Math.min(i,p),1),b=f.vox_offset+g*m*u;if(g===p)return null;const A=await fetch(e,{headers:t,cache:"force-cache"});return(await this.readFirstDecompressedBytes(A.body,b)).buffer.slice(0,b)}static async loadInitialVolumes(e="",t={},i=NaN){if(isNaN(i))return null;const s=(await fetch(e,{headers:t,cache:"force-cache"})).body.getReader(),{value:n,done:o}=await s.read();let c=n;if(o||!c||c.length<2)throw new Error("Not enough data to determine compression");const l=new DataView(c.buffer,c.byteOffset,c.byteLength),h=l.getUint16(0,!0);if(h===35615)return await s.cancel(),this.loadInitialVolumesGz(e,t,i);const f=h===348;if(!f&&!(h===23553))return await s.cancel(),null;let m=352;for(c.length>111&&(m=l.getFloat32(108,f));c.length<m;){let v=function(D,S){const k=new Uint8Array(D.length+S.length);return k.set(D,0),k.set(S,D.length),k};const{value:M,done:C}=await s.read();if(C||!M)break;c=v(c,M)}const p=await $r(c.buffer);if(!p)throw new Error("Could not read NIfTI header");const g=p.numBitsPerVoxel/8,b=[1,2,3].reduce((v,M)=>v*(p.dims[M]>1?p.dims[M]:1),1),A=[4,5,6].reduce((v,M)=>v*(p.dims[M]>1?p.dims[M]:1),1),y=Math.max(Math.min(i,A),1),x=p.vox_offset+y*b*g,E=new Uint8Array(x),I=Math.min(c.length,x);E.set(c.subarray(0,I),0);let w=I;for(;w<x;){const{value:v,done:M}=await s.read();if(M||!v)return await s.cancel(),null;const C=Math.min(v.length,x-w);E.set(v.subarray(0,C),w),w+=C}return await s.cancel(),E.buffer}static async loadFromUrl({url:e="",urlImgData:t="",headers:i={},name:r="",colormap:s="",opacity:n=1,cal_min:o=NaN,cal_max:c=NaN,trustCalMinMax:l=!0,percentileFrac:h=.02,ignoreZeroVoxels:d=!1,useQFormNotSForm:f=!1,colormapNegative:u="",frame4D:m=0,isManifest:p=!1,limitFrames4D:g=NaN,imageType:b=ue.UNKNOWN,colorbarVisible:A=!0,buffer:y=new ArrayBuffer(0)}={}){if(e==="")throw Error("url must not be empty");let x=null,E=null,I=null;if(e instanceof Uint8Array&&(e=e.slice().buffer),y.byteLength>0&&(e=y),e instanceof ArrayBuffer)if(E=e,r!=="")e=r;else{const D=new Uint8Array(E);e=D[0]===31&&D[1]===139?"array.nii.gz":"array.nii"}function w(D){const S=D.match(/\.([^.]+)(?:\.gz|\.bz2|\.xz)?$/);return S?S[1]:""}let v="";if(r===""?v=w(e):v=w(r),b===ue.UNKNOWN&&(b=ue.parse(v)),b===ue.UNKNOWN&&typeof e=="string"){const D=await fetch(e,{});if(D.redirected){const S=this.extractFilenameFromUrl(D.url);S&&S.length>0&&r===""&&(r=S,v=w(r),b=ue.parse(v))}}if(b===ue.ZARR){const D=new URL(e).searchParams,S=D.get("z"),k=D.get("y"),F=D.get("x"),B=S?ls(parseInt(S),parseInt(S)+1):null,O=k?ls(parseInt(k),parseInt(k)+1):null,L=F?ls(parseInt(F),parseInt(F)+1):null,_=e.split("?")[0],q=new tu(_),J=wu(q);let Z;try{Z=await ga(J.resolve(e),{kind:"array"})}catch{Z=await ga(J,{kind:"array"})}let Y;if(Z.shape.length===4){const Me=Z.shape[2],Ne=Z.shape[1],ge=Z.shape[0];B&&B[0]>=Me&&(B[0]=Me-1),O&&O[0]>=Ne&&(O[0]=Ne-1),L&&L[0]>=ge&&(L[0]=ge-1),Y=await cl(Z,[L,O,B,null])}else Y=await cl(Z,[L,O,B]);E=Y.data;const[W,T,ne,le]=Y.shape;I={data:E,width:T,height:W,depth:ne,channels:le}}const M=b===ue.DCM||ue.NII;if(!E&&M&&(E=await this.loadInitialVolumes(e,i,g)),!E)if(p)E=await on.fetchDicomData(e,i),b=ue.DCM_MANIFEST;else{const D=await fetch(e,{headers:i});if(!D.ok)throw Error(D.statusText);if(!D.body)throw new Error("No readable stream available");const S=await Un(D.body),k=[],F=S.getReader();for(;;){const{done:_,value:q}=await F.read();if(_)break;k.push(q)}const B=k.reduce((_,q)=>_+q.length,0);E=new ArrayBuffer(B);const O=new Uint8Array(E);let L=0;for(const _ of k)O.set(_,L),L+=_.length}v.toUpperCase()==="HEAD"&&t===""&&(t=e.substring(0,e.lastIndexOf("HEAD"))+"BRIK"),v.toUpperCase()==="HDR"&&t===""&&(t=e.substring(0,e.lastIndexOf("HDR"))+"IMG");let C=null;if(t)try{let D=await fetch(t,{headers:i});if(D.status===404&&(t.includes("BRIK")||t.includes("IMG"))&&(D=await fetch(`${t}.gz`,{headers:i})),D.ok&&D.body){const S=await Un(D.body),k=[],F=S.getReader();for(;;){const{done:_,value:q}=await F.read();if(_)break;k.push(q)}const B=k.reduce((_,q)=>_+q.length,0);C=new ArrayBuffer(B);const O=new Uint8Array(C);let L=0;for(const _ of k)O.set(_,L),L+=_.length}}catch(D){console.error("Error loading paired image data:",D)}if(!E)throw new Error("Unable to load buffer properly from volume");if(!r){let D;try{D=new URL(e).pathname.split("/")}catch{D=e.split("/")}r=D.slice(-1)[0],r.indexOf("?")>-1&&(r=r.slice(0,r.indexOf("?")))}return x=await this.new(E,r,s,n,C,o,c,l,h,d,f,u,m,b,NaN,NaN,!0,null,0,I),x.url=e,x.colorbarVisible=A,x}static async readFileAsync(e,t=NaN){let i=e.stream();if(!isNaN(t)){let d=0;const f=new TransformStream({transform(u,m){if(d>=t){m.terminate();return}const p=t-d;u.length>p?(m.enqueue(u.slice(0,p)),m.terminate()):m.enqueue(u),d+=u.length}});i=i.pipeThrough(f)}const r=await Un(i),s=[],n=r.getReader();for(;;){const{done:d,value:f}=await n.read();if(d)break;s.push(f)}const o=s.reduce((d,f)=>d+f.length,0),c=new ArrayBuffer(o),l=new Uint8Array(c);let h=0;for(const d of s)l.set(d,h),h+=d.length;return c}static async loadFromFile({file:e,name:t="",colormap:i="",opacity:r=1,urlImgData:s=null,cal_min:n=NaN,cal_max:o=NaN,trustCalMinMax:c=!0,percentileFrac:l=.02,ignoreZeroVoxels:h=!1,useQFormNotSForm:d=!1,colormapNegative:f="",frame4D:u=0,limitFrames4D:m=NaN,imageType:p=ue.UNKNOWN}){let g=null,b=[];try{if(Array.isArray(e))b=await Promise.all(e.map(y=>this.readFileAsync(y)));else{if(isNaN(m))b=await this.readFileAsync(e);else{const y=await this.readFileAsync(e,512),x=new Uint8Array(y);if(!(x[0]===92&&x[1]===1||x[1]===92&&x[0]===1))b=await this.readFileAsync(e);else{const I=await $r(y);if(!I)throw new Error("could not read nifti header");const w=I.numBitsPerVoxel/8,v=[1,2,3].reduce((S,k)=>S*(I.dims[k]>1?I.dims[k]:1),1),M=[4,5,6].reduce((S,k)=>S*(I.dims[k]>1?I.dims[k]:1),1),C=Math.max(Math.min(m,M),1),D=I.vox_offset+C*v*w;b=await this.readFileAsync(e,D)}}t=e.name}let A=null;s&&(A=await this.readFileAsync(s)),g=await this.new(b,t,i,r,A,n,o,c,l,h,d,f,u,p,NaN,NaN,!0,null,0,null),g.fileObject=e}catch(A){throw V.error(A),new Error("could not build NVImage")}if(g===null)throw new Error("could not build NVImage");return g}static createNiftiArray(e=[256,256,256],t=[1,1,1],i=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],r=2,s=new Uint8Array){return mp(e,t,i,r,s)}static createNiftiHeader(e=[256,256,256],t=[1,1,1],i=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],r=2){return Rh(e,t,i,r)}getVolumeData(e=[-1,0,0],t=[0,0,0],i="same"){return yp(this,e,t,i)}setVolumeData(e=[-1,0,0],t=[0,0,0],i=new Uint8Array){xp(this,e,t,i)}static async loadFromBase64({base64:e,name:t="",colormap:i="",opacity:r=1,cal_min:s=NaN,cal_max:n=NaN,trustCalMinMax:o=!0,percentileFrac:c=.02,ignoreZeroVoxels:l=!1,useQFormNotSForm:h=!1,colormapNegative:d="",frame4D:f=0,imageType:u=ue.UNKNOWN,cal_minNeg:m=NaN,cal_maxNeg:p=NaN,colorbarVisible:g=!0,colormapLabel:b=null}){function A(x){const E=window.atob(x),I=E.length,w=new Uint8Array(I);for(let v=0;v<I;v++)w[v]=E.charCodeAt(v);return w.buffer}let y=null;try{const x=A(e);y=await this.new(x,t,i,r,null,s,n,o,c,l,h,d,f,u,m,p,g,b,0,null)}catch(x){V.debug(x)}if(y===null)throw new Error("could not load NVImage");return y}clone(){const e=new on;return e.id=$n(),e.hdr=Object.assign({},this.hdr),e.img=this.img.slice(),e.calculateRAS(),e.calMinMax(),e}zeroImage(){this.img.fill(0)}getImageMetadata(){if(!this.hdr)throw new Error("hdr undefined");const e=this.id,t=this.hdr.datatypeCode,i=this.hdr.dims,r=i[1],s=i[2],n=i[3],o=Math.max(1,i[4]),c=this.hdr.pixDims,l=c[1],h=c[2],d=c[3],f=c[4],u=Math.floor(this.hdr.numBitsPerVoxel/8);return{id:e,datatypeCode:t,nx:r,ny:s,nz:n,nt:o,dx:l,dy:h,dz:d,dt:f,bpv:u}}static zerosLike(e,t="same"){const i=e.clone();return i.zeroImage(),t==="uint8"&&(i.img=Uint8Array.from(i.img),i.hdr.datatypeCode=2,i.hdr.numBitsPerVoxel=8),t==="float32"&&(i.img=Float32Array.from(i.img),i.hdr.datatypeCode=16,i.hdr.numBitsPerVoxel=32),i}getValue(e,t,i,r=0,s=!1){return Ap(this,e,t,i,r,s)}getValues(e,t,i,r=0,s=!1){return Uh(this,e,t,i,r,s)}applyOptionsUpdate(e){this.hdr.cal_min=e.cal_min,this.hdr.cal_max=e.cal_max,Object.assign(this,e)}getImageOptions(){return nn("","",this.name,this._colormap,this.opacity,this.hdr.cal_min,this.hdr.cal_max,this.trustCalMinMax,this.percentileFrac,this.ignoreZeroVoxels,this.useQFormNotSForm,this.colormapNegative,this.frame4D,this.imageType,this.colormapType)}toUint8Array(e=null){return Nh(this,e)}convertVox2Frac(e){return ee((e[0]+.5)/this.dimsRAS[1],(e[1]+.5)/this.dimsRAS[2],(e[2]+.5)/this.dimsRAS[3])}convertFrac2Vox(e){return ee(Math.round(e[0]*this.dims[1]-.5),Math.round(e[1]*this.dims[2]-.5),Math.round(e[2]*this.dims[3]-.5))}convertFrac2MM(e,t=!1){const i=Be(e[0],e[1],e[2],1);return t?it(i,i,this.frac2mm):it(i,i,this.frac2mmOrtho),i}convertMM2Frac(e,t=!1){const i=Be(e[0],e[1],e[2],1),r=this.dimsRAS,s=ee(0,0,0);if(typeof r>"u")return s;if(!t){const o=Ke(this.frac2mmOrtho);return bt(o,o),it(i,i,o),s[0]=i[0],s[1]=i[1],s[2]=i[2],s}if(r[1]<1||r[2]<1||r[3]<1)return s;const n=Ke(this.matRAS);return bt(n,n),xt(n,n),it(i,i,n),s[0]=(i[0]+.5)/r[1],s[1]=(i[1]+.5)/r[2],s[2]=(i[2]+.5)/r[3],s}},Lh=(a=>(a[a.none=0]="none",a[a.contrast=1]="contrast",a[a.measurement=2]="measurement",a[a.pan=3]="pan",a[a.slicer3D=4]="slicer3D",a[a.callbackOnly=5]="callbackOnly",a[a.roiSelection=6]="roiSelection",a[a.angle=7]="angle",a[a.crosshair=8]="crosshair",a[a.windowing=9]="windowing",a))(Lh||{}),Rt={textHeight:-1,fontSizeScaling:.4,fontMinPx:13,colorbarHeight:.05,colorbarWidth:-1,showColorbarBorder:!0,crosshairWidth:1,crosshairWidthUnit:"voxels",crosshairGap:0,rulerWidth:4,show3Dcrosshair:!1,backColor:[0,0,0,1],crosshairColor:[1,0,0,1],fontColor:[.5,.5,.5,1],selectionBoxColor:[1,1,1,.5],clipPlaneColor:[.7,0,.7,.5],isClipPlanesCutaway:!1,paqdUniforms:[.3,.5,.5,1],rulerColor:[1,0,0,.8],colorbarMargin:.05,trustCalMinMax:!0,clipPlaneHotKey:"KeyC",cycleClipPlaneHotKey:"KeyP",viewModeHotKey:"KeyV",doubleTouchTimeout:500,longTouchTimeout:1e3,keyDebounceTime:50,isNearestInterpolation:!1,isResizeCanvas:!0,atlasOutline:0,atlasActiveIndex:0,isRuler:!1,isColorbar:!1,isOrientCube:!1,tileMargin:0,multiplanarPadPixels:0,multiplanarForceRender:!1,multiplanarEqualSize:!1,multiplanarShowRender:2,isRadiologicalConvention:!1,meshThicknessOn2D:1/0,dragMode:1,dragModePrimary:8,mouseEventConfig:void 0,touchEventConfig:void 0,yoke3Dto2DZoom:!1,isDepthPickMesh:!1,isCornerOrientationText:!1,isOrientationTextVisible:!0,showAllOrientationMarkers:!1,heroImageFraction:0,heroSliceType:4,sagittalNoseLeft:!1,isSliceMM:!1,isV1SliceShader:!1,forceDevicePixelRatio:0,logLevel:"info",loadingText:"loading ...",isForceMouseClickToVoxelCenters:!1,dragAndDropEnabled:!0,drawingEnabled:!1,penValue:1,penType:0,floodFillNeighbors:6,isFilledPen:!1,thumbnail:"",maxDrawUndoBitmaps:8,sliceType:3,meshXRay:0,isAntiAlias:null,limitFrames4D:NaN,isAdditiveBlend:!1,showLegend:!0,legendBackgroundColor:[.3,.3,.3,.5],legendTextColor:[1,1,1,1],multiplanarLayout:0,renderOverlayBlend:1,sliceMosaicString:"",centerMosaic:!1,penSize:1,interactive:!0,clickToSegment:!1,clickToSegmentRadius:3,clickToSegmentBright:!0,clickToSegmentAutoIntensity:!1,clickToSegmentIntensityMax:NaN,clickToSegmentIntensityMin:NaN,clickToSegmentPercent:0,clickToSegmentMaxDistanceMM:Number.POSITIVE_INFINITY,clickToSegmentIs2D:!1,selectionBoxLineThickness:4,selectionBoxIsOutline:!1,scrollRequiresFocus:!1,showMeasureUnits:!0,measureTextJustify:"center",measureTextColor:[1,0,0,1],measureLineColor:[1,0,0,1],measureTextHeight:.06,isAlphaClipDark:!1,gradientOrder:1,gradientOpacity:0,renderSilhouette:0,gradientAmount:0,invertScrollDirection:!1,is2DSliceShader:!1,bounds:null,showBoundsBorder:!1,boundsBorderColor:[1,1,1,1]},as={gamma:1,azimuth:110,elevation:10,crosshairPos:ee(.5,.5,.5),clipPlanes:[[0,0,0,0]],clipPlaneDepthAziElevs:[[2,0,0]],volScaleMultiplier:1,pan2Dxyzmm:Be(0,0,0,1)};function Tp(a,e){const t={};for(const i in a){const r=a[i],s=e[i],n=Array.isArray(r)&&Array.isArray(s);(n&&r.some((o,c)=>o!==s[c])||!n&&r!==s)&&(t[i]=r)}return t}var jn=class da{constructor(){U(this,"data",{title:"Untitled document",imageOptionsArray:[],meshOptionsArray:[],opts:{...Rt},previewImageDataURL:"",labels:[],encodedImageBlobs:[],encodedDrawingBlob:""}),U(this,"scene"),U(this,"volumes",[]),U(this,"meshDataObjects"),U(this,"meshes",[]),U(this,"drawBitmap",null),U(this,"imageOptionsMap",new Map),U(this,"meshOptionsMap",new Map),U(this,"completedMeasurements",[]),U(this,"completedAngles",[]),U(this,"_optsProxy",null),U(this,"_optsChangeCallback",null),this.scene={onAzimuthElevationChange:()=>{},onZoom3DChange:()=>{},sceneData:{...as,pan2Dxyzmm:Be(0,0,0,1),crosshairPos:ee(.5,.5,.5)},get renderAzimuth(){return this.sceneData.azimuth},set renderAzimuth(e){this.sceneData.azimuth=e,this.onAzimuthElevationChange&&this.onAzimuthElevationChange(this.sceneData.azimuth,this.sceneData.elevation)},get renderElevation(){return this.sceneData.elevation},set renderElevation(e){this.sceneData.elevation=e,this.onAzimuthElevationChange&&this.onAzimuthElevationChange(this.sceneData.azimuth,this.sceneData.elevation)},get volScaleMultiplier(){return this.sceneData.volScaleMultiplier},set volScaleMultiplier(e){this.sceneData.volScaleMultiplier=e,this.onZoom3DChange(e)},get crosshairPos(){return this.sceneData.crosshairPos},set crosshairPos(e){this.sceneData.crosshairPos=e},get clipPlane(){return this.sceneData.clipPlanes[0]??[]},set clipPlane(e){this.sceneData.clipPlanes[0]=e},get clipPlanes(){return this.sceneData.clipPlanes},set clipPlanes(e){this.sceneData.clipPlanes=e},get clipPlaneDepthAziElevs(){return this.sceneData.clipPlaneDepthAziElevs},set clipPlaneDepthAziElevs(e){this.sceneData.clipPlaneDepthAziElevs=e},get pan2Dxyzmm(){return this.sceneData.pan2Dxyzmm},set pan2Dxyzmm(e){this.sceneData.pan2Dxyzmm=e},get gamma(){return this.sceneData.gamma},set gamma(e){this.sceneData.gamma=e}}}get title(){return this.data.title}get previewImageDataURL(){return this.data.previewImageDataURL}set previewImageDataURL(e){this.data.previewImageDataURL=e}set title(e){this.data.title=e}get imageOptionsArray(){return this.data.imageOptionsArray}get encodedImageBlobs(){return this.data.encodedImageBlobs}get encodedDrawingBlob(){return this.data.encodedDrawingBlob}get opts(){return this._optsProxy||this._createOptsProxy(),this._optsProxy}set opts(e){this.data.opts={...e},this._optsProxy=null}get labels(){return this.data.labels}set labels(e){this.data.labels=e}get customData(){return this.data.customData}set customData(e){this.data.customData=e}hasImage(e){return this.volumes.find(t=>t.id===e.id)!==void 0}hasImageFromUrl(e){return this.data.imageOptionsArray.find(t=>t.url===e)!==void 0}addImageOptions(e,t){if(!this.hasImage(e)&&!t.name)if(t.url){const r=/^(?:[a-z+]+:)?\/\//i.test(t.url)?new URL(t.url):new URL(t.url,window.location.href);t.name=r.pathname.split("/").pop(),t.name.toLowerCase().endsWith(".gz")&&(t.name=t.name.slice(0,-3)),t.name.toLowerCase().endsWith(".nii")||(t.name+=".nii")}else t.name="untitled.nii";t.imageType=ue.NII,this.data.imageOptionsArray.push(t),this.imageOptionsMap.set(e.id,this.data.imageOptionsArray.length-1)}removeImage(e){if(this.imageOptionsMap.has(e.id)){const t=this.imageOptionsMap.get(e.id);this.data.imageOptionsArray.length>t&&this.data.imageOptionsArray.splice(t,1),this.imageOptionsMap.delete(e.id)}this.volumes=this.volumes.filter(t=>t.id!==e.id)}async fetchLinkedData(){var e;if(this.data.encodedImageBlobs=[],!!((e=this.imageOptionsArray)!=null&&e.length)){for(const t of this.imageOptionsArray)if(t.url)try{const i=await fetch(t.url);if(!i.ok){console.warn("Failed to fetch image:",t.url);continue}const r=await i.arrayBuffer(),s=new Uint8Array(r),n=ce.uint8tob64(s);this.data.encodedImageBlobs.push(n),console.info("fetch linked data fetched from ",t.url)}catch(i){console.warn(`Failed to fetch/encode image from ${t.url}:`,i)}}}getImageOptions(e){return this.imageOptionsMap.has(e.id)?this.data.imageOptionsArray[this.imageOptionsMap.get(e.id)]:null}json(e=!0,t=!0){const i={encodedImageBlobs:[],previewImageDataURL:this.data.previewImageDataURL,imageOptionsMap:new Map},r=[];i.sceneData={...this.scene.sceneData},delete i.sceneData.clipPlane,delete i.sceneData.clipPlaneDepthAziElev,delete i.sceneData.clipThick,delete i.sceneData.clipVolumeLow,delete i.sceneData.clipVolumeHigh,i.opts=Tp(this.opts,Rt),this.opts.meshThicknessOn2D===1/0&&(i.opts.meshThicknessOn2D="infinity"),this.opts.meshThicknessOn2D===1/0&&(i.opts.meshThicknessOn2D="infinity"),i.labels=[...this.data.labels];for(const n of i.labels)delete n.onClick;if(i.customData=this.customData,i.completedMeasurements=[...this.completedMeasurements],i.completedAngles=[...this.completedAngles],this.volumes.length)for(let n=0;n<this.volumes.length;n++){const o=this.volumes[n];let c=this.getImageOptions(o);if(c===null?(V.warn("no options found for image, using options from the volume directly"),c={name:(o==null?void 0:o.name)??"",colormap:(o==null?void 0:o._colormap)??"gray",opacity:(o==null?void 0:o._opacity)??1,pairedImgData:null,cal_min:(o==null?void 0:o.cal_min)??NaN,cal_max:(o==null?void 0:o.cal_max)??NaN,trustCalMinMax:(o==null?void 0:o.trustCalMinMax)??!0,percentileFrac:(o==null?void 0:o.percentileFrac)??.02,ignoreZeroVoxels:(o==null?void 0:o.ignoreZeroVoxels)??!1,useQFormNotSForm:(o==null?void 0:o.useQFormNotSForm)??!1,colormapNegative:(o==null?void 0:o.colormapNegative)??"",colormapLabel:(o==null?void 0:o.colormapLabel)??null,imageType:(o==null?void 0:o.imageType)??ue.NII,frame4D:(o==null?void 0:o.frame4D)??0,limitFrames4D:(o==null?void 0:o.limitFrames4D)??NaN,url:(o==null?void 0:o.url)??"",urlImageData:(o==null?void 0:o.urlImgData)??"",alphaThreshold:!1,cal_minNeg:(o==null?void 0:o.cal_minNeg)??NaN,cal_maxNeg:(o==null?void 0:o.cal_maxNeg)??NaN,colorbarVisible:(o==null?void 0:o.colorbarVisible)??!0}):"imageType"in c||(c.imageType=ue.NII),c.colormap=o.colormap,c.colormapLabel=o.colormapLabel,c.opacity=o.opacity,c.cal_max=o.cal_max??NaN,c.cal_min=o.cal_min??NaN,r.push(c),e){const l=ce.uint8tob64(o.toUint8Array());i.encodedImageBlobs.push(l)}i.imageOptionsMap.set(o.id,n)}i.imageOptionsArray=[...r];const s=[];i.connectomes=[];for(const n of this.meshes){if(n.type==="connectome"){i.connectomes.push(JSON.stringify(n.json()));continue}const o={pts:n.pts,tris:n.tris,name:n.name,rgba255:Uint8Array.from(n.rgba255),opacity:n.opacity,connectome:n.connectome,dpg:n.dpg,dps:n.dps,dpv:n.dpv,meshShaderIndex:n.meshShaderIndex,layers:n.layers.map(c=>({values:c.values,nFrame4D:c.nFrame4D,frame4D:0,outlineBorder:c.outlineBorder,global_min:c.global_min,global_max:c.global_max,cal_min:c.cal_min,cal_max:c.cal_max,opacity:c.opacity,colormap:c.colormap,colormapNegative:c.colormapNegative,colormapLabel:c.colormapLabel,useNegativeCmap:c.useNegativeCmap})),hasConnectome:n.hasConnectome,edgeColormap:n.edgeColormap,edgeColormapNegative:n.edgeColormapNegative,edgeMax:n.edgeMax,edgeMin:n.edgeMin,edges:n.edges&&Array.isArray(n.edges)?[...n.edges]:[],extentsMax:n.extentsMax,extentsMin:n.extentsMin,furthestVertexFromOrigin:n.furthestVertexFromOrigin,nodeColormap:n.nodeColormap,nodeColormapNegative:n.nodeColormapNegative,nodeMaxColor:n.nodeMaxColor,nodeMinColor:n.nodeMinColor,nodeScale:n.nodeScale,legendLineThickness:n.legendLineThickness,offsetPt0:n.offsetPt0,nodes:n.nodes};n.offsetPt0&&n.offsetPt0.length>0&&(o.offsetPt0=n.offsetPt0,o.fiberGroupColormap=n.fiberGroupColormap,o.fiberColor=n.fiberColor,o.fiberDither=n.fiberDither,o.fiberRadius=n.fiberRadius,o.colormap=n.colormap),s.push(o)}return i.meshesString=JSON.stringify(Df(s)),t&&this.drawBitmap&&(i.encodedDrawingBlob=ce.uint8tob64(this.drawBitmap)),i}async download(e,t,i={embedImages:!0}){const r=this.json(i.embedImages),s=JSON.stringify(r),n=t?"application/gzip":"application/json",o=t?await ce.compressStringToArrayBuffer(s):s;ce.download(o,e,n)}static deserializeMeshDataObjects(e){if(!e.data.meshesString||e.data.meshesString==="[]"){e.meshDataObjects=[];return}if(e.data.meshesString){e.meshDataObjects=Tf(JSON.parse(e.data.meshesString));for(const t of e.meshDataObjects)for(const i of t.layers)"colorMap"in i&&(i.colormap=i.colorMap,delete i.colorMap),"colorMapNegative"in i&&(i.colormapNegative=i.colorMapNegative,delete i.colorMapNegative)}}static async loadFromUrl(e){const i=await(await fetch(e)).arrayBuffer();let r;if(ce.isArrayBufferCompressed(i)){const s=await ce.decompressArrayBuffer(i);r=JSON.parse(s)}else{const s=new TextDecoder;r=JSON.parse(s.decode(i))}return da.loadFromJSON(r)}static async loadFromFile(e){const t=await ce.readFileAsync(e);let i;const r=new da;return ce.isArrayBufferCompressed(t)?i=await ce.decompressArrayBuffer(t):i=new TextDecoder().decode(t),r.data=JSON.parse(i),r.data.opts.meshThicknessOn2D==="infinity"&&(r.data.opts.meshThicknessOn2D=1/0),r.scene.sceneData={...as,...r.data.sceneData},da.deserializeMeshDataObjects(r),r}static loadFromJSON(e){const t=new da;Object.assign(t.data,{...e,imageOptionsArray:e.imageOptionsArray??[],encodedImageBlobs:e.encodedImageBlobs??[],labels:e.labels??[],meshOptionsArray:e.meshOptionsArray??[],connectomes:e.connectomes??[],encodedDrawingBlob:e.encodedDrawingBlob??"",previewImageDataURL:e.previewImageDataURL??"",customData:e.customData??"",title:e.title??"untitled"}),t.data.opts={...Rt,...e.opts||{}},t.data.opts.meshThicknessOn2D==="infinity"&&(t.data.opts.meshThicknessOn2D=1/0),t.scene.sceneData={...as,...e.sceneData||{}};const i=e.sceneData||{};return i.clipPlane&&!i.clipPlanes&&(t.scene.sceneData.clipPlanes=[i.clipPlane]),i.clipPlaneDepthAziElev&&!i.clipPlaneDepthAziElevs&&(t.scene.sceneData.clipPlaneDepthAziElevs=[i.clipPlaneDepthAziElev]),e.completedMeasurements&&(t.completedMeasurements=e.completedMeasurements.map(r=>({...r,startMM:Nt(r.startMM),endMM:Nt(r.endMM)}))),e.completedAngles&&(t.completedAngles=e.completedAngles.map(r=>({...r,firstLineMM:{start:Nt(r.firstLineMM.start),end:Nt(r.firstLineMM.end)},secondLineMM:{start:Nt(r.secondLineMM.start),end:Nt(r.secondLineMM.end)}}))),t.data.meshesString&&da.deserializeMeshDataObjects(t),t}static oldloadFromJSON(e){const t=new da;return t.data=e,t.data.opts.meshThicknessOn2D==="infinity"&&(t.data.opts.meshThicknessOn2D=1/0),t.scene.sceneData={...as,...e.sceneData},da.deserializeMeshDataObjects(t),t}setOptsChangeCallback(e){this._optsChangeCallback=e,this._optsProxy=null}removeOptsChangeCallback(){this._optsChangeCallback=null,this._optsProxy=null}_createOptsProxy(){const e=this.data.opts;this._optsProxy=new Proxy(e,{set:(t,i,r)=>{const s=t[i];return s!==r&&(t[i]=r,this._optsChangeCallback&&typeof i=="string"&&i in Rt&&this._optsChangeCallback(i,r,s)),!0},get:(t,i)=>t[i]})}},Ip={colormap:"gray",opacity:0,nFrame4D:0,frame4D:0,outlineBorder:0,cal_min:0,cal_max:0,cal_minNeg:0,cal_maxNeg:0,colormapType:0,values:new Array,useNegativeCmap:!1,showLegend:!0},Xa=class Bt{constructor(e,t,i="",r=new Uint8Array([255,255,255,255]),s=1,n=!0,o,c=null,l=null,h=null,d=null,f=null,u=!0,m=""){U(this,"id"),U(this,"name"),U(this,"anatomicalStructurePrimary"),U(this,"colorbarVisible"),U(this,"furthestVertexFromOrigin"),U(this,"extentsMin"),U(this,"extentsMax"),U(this,"opacity"),U(this,"visible"),U(this,"meshShaderIndex",0),U(this,"offsetPt0",null),U(this,"colormapInvert",!1),U(this,"fiberGroupColormap",null),U(this,"indexBuffer"),U(this,"vertexBuffer"),U(this,"vao"),U(this,"vaoFiber"),U(this,"pts"),U(this,"tris"),U(this,"layers"),U(this,"type","mesh"),U(this,"data_type"),U(this,"rgba255"),U(this,"fiberLength"),U(this,"fiberLengths"),U(this,"fiberDensity"),U(this,"fiberDither",.1),U(this,"fiberColor","Global"),U(this,"fiberDecimationStride",1),U(this,"fiberSides",5),U(this,"fiberRadius",0),U(this,"fiberOcclusion",0),U(this,"f32PerVertex",5),U(this,"dpsThreshold",NaN),U(this,"fiberMask"),U(this,"colormap"),U(this,"dpg"),U(this,"dps"),U(this,"dpv"),U(this,"groups"),U(this,"hasConnectome",!1),U(this,"connectome"),U(this,"indexCount"),U(this,"vertexCount",1),U(this,"nodeScale",4),U(this,"edgeScale",1),U(this,"legendLineThickness",0),U(this,"showLegend",!0),U(this,"nodeColormap","warm"),U(this,"edgeColormap","warm"),U(this,"nodeColormapNegative"),U(this,"edgeColormapNegative"),U(this,"nodeMinColor"),U(this,"nodeMaxColor"),U(this,"edgeMin"),U(this,"edgeMax"),U(this,"nodes"),U(this,"edges"),U(this,"points"),this.anatomicalStructurePrimary=m,this.name=i,this.colorbarVisible=u,this.id=$n();const p=_a.getExtents(e);if(this.furthestVertexFromOrigin=p.mxDx,this.extentsMin=p.extentsMin,this.extentsMax=p.extentsMax,this.opacity=s>1?1:s,this.visible=n,this.meshShaderIndex=0,this.indexBuffer=o.createBuffer(),this.vertexBuffer=o.createBuffer(),this.vao=o.createVertexArray(),o.bindVertexArray(this.vao),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,this.indexBuffer),o.bindBuffer(o.ARRAY_BUFFER,this.vertexBuffer),o.enableVertexAttribArray(0),o.enableVertexAttribArray(1),this.f32PerVertex!==7?(o.vertexAttribPointer(0,3,o.FLOAT,!1,20,0),o.vertexAttribPointer(1,4,o.BYTE,!0,20,12),o.enableVertexAttribArray(2),o.vertexAttribPointer(2,4,o.UNSIGNED_BYTE,!0,20,16)):(o.vertexAttribPointer(0,3,o.FLOAT,!1,28,0),o.vertexAttribPointer(1,3,o.FLOAT,!1,28,12),o.enableVertexAttribArray(2),o.vertexAttribPointer(2,4,o.UNSIGNED_BYTE,!0,28,24)),o.bindVertexArray(null),this.vaoFiber=o.createVertexArray(),this.offsetPt0=null,this.hasConnectome=!1,this.colormapInvert=!1,this.fiberGroupColormap=null,this.pts=e,this.layers=[],this.type="mesh",this.tris=t,r[3]<1){this.rgba255=r,this.fiberLength=2,this.fiberDither=.1,this.fiberColor="Global",this.fiberDecimationStride=1,this.fiberMask=[],this.colormap=c,this.dpg=l,this.dps=h,this.dpv=d,this.groups=f,l&&this.initValuesArray(l),h&&this.initValuesArray(h),d&&this.initValuesArray(d),f&&this.initValuesArray(f),this.offsetPt0=new Uint32Array(t),this.tris=new Uint32Array(0),this.updateFibers(o),o.bindVertexArray(this.vaoFiber),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,this.indexBuffer),o.bindBuffer(o.ARRAY_BUFFER,this.vertexBuffer),o.enableVertexAttribArray(0),o.vertexAttribPointer(0,3,o.FLOAT,!1,16,0),o.enableVertexAttribArray(1),o.vertexAttribPointer(1,4,o.UNSIGNED_BYTE,!0,16,12),o.bindVertexArray(null);return}if(c){this.connectome=c,this.hasConnectome=!0;const b=Object.keys(c);for(let A=0,y=b.length;A<y;A++)this[b[A]]=c[b[A]]}this.rgba255=r,this.updateMesh(o)}initValuesArray(e){for(let t=0;t<e.length;t++){const i=e[t].vals.reduce((s,n)=>Math.min(s,n)),r=e[t].vals.reduce((s,n)=>Math.max(s,n));e[t].global_min=i,e[t].global_max=r,e[t].cal_min=i,e[t].cal_max=r}return e}linesToCylinders(e,t,i){function r(M){return ee(M[0],M[1],M[2])}const s=Math.pow(2,32)-1,n=i.length;let o=0,c=0;for(let M=0;M<n;M++){if(i[M]===s){c++;continue}o++}const l=this.fiberSides,h=l*o,d=this.f32PerVertex;if(d!==5)throw Error("fiberSides > 1 requires f32PerVertex == 5");const f=new Float32Array(h*d),u=new Uint8Array(f.buffer);let m=0,p=aa(),g=aa(),b=aa();const A=Ce();let y=Ce(),x=0;const E=this.fiberRadius;for(let M=0;M<n;M++){const C=i[M]===s;if(C&&x<1)continue;let D=i[M]*4;if(x++,x<=1){p=Be(t[D+0],t[D+1],t[D+2],t[D+3]),g=ma(p),M+1<n&&i[M+1]!==s&&(D=i[M+1]*4,b=Be(t[D+0],t[D+1],t[D+2],t[D+3]),Fe(A,r(p),r(b)),It(A,A),y=ja.getFirstPerpVector(A));continue}C?b=ma(g):b=Be(t[D+0],t[D+1],t[D+2],t[D+3]),Fe(A,r(p),r(b)),It(A,A);const S=Ce();$s(S,y,A);const k=Ce();$s(k,A,S),y=Nt(y);const F=Ce();$s(F,A,k),It(F,F);const B=Ce();for(let O=0;O<l;O++){const L=Math.cos(O/l*2*Math.PI),_=Math.sin(O/l*2*Math.PI);B[0]=E*(L*k[0]+_*F[0]),B[1]=E*(L*k[1]+_*F[1]),B[2]=E*(L*k[2]+_*F[2]),ka(B,r(g),B);const q=m*d;f[q+0]=B[0],f[q+1]=B[1],f[q+2]=B[2];const J=Ce();Fe(J,B,r(g)),It(J,J);const Z=(q+3)*4;u[Z+0]=J[0]*127,u[Z+1]=J[1]*127,u[Z+2]=J[2]*127,f[q+4]=g[3],m++}p=ma(g),g=ma(b),C&&(x=0)}const I=(o-c)*l*2*3,w=new Uint32Array(I);let v=0;m=0;for(let M=1;M<n;M++){if(i[M]===s){m+=l;continue}if(i[M-1]===s)continue;let C=m,D=m+l;const S=D,k=D+l;for(let F=0;F<l;F++)w[v++]=C,w[v++]=D++,D===k&&(D=k-l),w[v++]=D,w[v++]=C++,C===S&&(C=S-l),w[v++]=D,w[v++]=C;m+=l}e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,Uint32Array.from(w),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,u,e.STATIC_DRAW),this.indexCount=I}createFiberDensityMap(){if(this.fiberDensity)return;const e=this.pts,t=e.length/3;let i=0;for(let A=0;A<3;A++){const y=this.extentsMax[A]-this.extentsMin[A];i=Math.max(i,y)}if(this.fiberDensity=new Float32Array(t),i===0)return;const r=64,n=i/(r-1)/2,o=(r-1)/i;let c=new Float32Array(r*r*r);const l=[this.extentsMin[0]-n,this.extentsMin[1]-n,this.extentsMin[2]-n],h=[0,0,0],d=-1,f=r*r;let u=0;for(let A=0;A<t;A++){h[0]=Math.round((e[u++]-l[0])*o),h[1]=Math.round((e[u++]-l[1])*o),h[2]=Math.round((e[u++]-l[2])*o);const y=h[0]+h[1]*r+h[2]*f;y!==d&&c[y]++}function m(A,y){let x=A.slice(),E=-1;const I=y-1;for(let v=0;v<y;v++)for(let M=0;M<y;M++)for(let C=0;C<y;C++)E++,!(C<1||C>=I)&&(A[E]=x[E-1]+x[E]+x[E]+x[E+1]);E=-1,x=A.slice();for(let v=0;v<y;v++)for(let M=0;M<y;M++)for(let C=0;C<y;C++)E++,!(M<1||M>=I)&&(A[E]=x[E-y]+x[E]+x[E]+x[E+y]);const w=y*y;E=-1,x=A.slice();for(let v=0;v<y;v++)for(let M=0;M<y;M++)for(let C=0;C<y;C++)E++,!(v<1||v>=I)&&(A[E]=x[E-w]+x[E]+x[E]+x[w]);return A}c=m(c,r),c=m(c,r);let p=0,g=1/0;const b=r*r*r;for(let A=0;A<b;A++)c[A]<=0||(p=Math.max(p,c[A]),g=Math.min(g,c[A]));if(!(p<=1||p<=g)){u=0;for(let A=0;A<b;A++)c[A]=Math.max(0,c[A]-g);p-=g;for(let A=0;A<t;A++){h[0]=Math.round((e[u++]-l[0])*o),h[1]=Math.round((e[u++]-l[1])*o),h[2]=Math.round((e[u++]-l[2])*o);const y=h[0]+h[1]*r+h[2]*f;this.fiberDensity[A]=c[y]/p}}}updateFibers(e){if(!this.offsetPt0||!this.fiberLength)return;const t=this.pts,i=this.offsetPt0,r=i.length-1,s=t.length/3;if(!this.fiberLengths){this.fiberLengths=new Uint32Array(r);for(let I=0;I<r;I++){const w=i[I]*3,v=(i[I+1]-1)*3;let M=0;for(let C=w;C<v;C+=3){const D=ee(t[C+0]-t[C+3],t[C+1]-t[C+4],t[C+2]-t[C+5]);M+=fs(D)}this.fiberLengths[I]=M}}const n=new Float32Array(s*4),o=new Uint32Array(n.buffer);let c=0,l=0;for(let I=0;I<s;I++)n[l+0]=t[c+0],n[l+1]=t[c+1],n[l+2]=t[c+2],c+=3,l+=4;const h=this.fiberDither,d=h*.5;function f(I,w,v){const C=255*(h*Math.random()-d);return I=Math.max(Math.min(I+C,255),0),w=Math.max(Math.min(w+C,255),0),v=Math.max(Math.min(v+C,255),0),I+(w<<8)+(v<<16)}function u(I,w,v,M,C,D,S){const k=ee(Math.abs(I-M),Math.abs(w-C),Math.abs(v-D));It(k,k);const F=S-d;for(let B=0;B<3;B++)k[B]=255*Math.max(Math.min(Math.abs(k[B])+F,1),0);return k[0]+(k[1]<<8)+(k[2]<<16)}const m=this.fiberColor.toLowerCase();let p=null,g=null;if(m.startsWith("dps")&&this.dps&&this.dps.length>0){const I=parseInt(m.substring(3));I<this.dps.length&&this.dps[I].vals.length===r&&(p=this.dps[I].vals)}if(m.startsWith("dpv")&&this.dpv&&this.dpv.length>0){const I=parseInt(m.substring(3));I<this.dpv.length&&this.dpv[I].vals.length===s&&(g=this.dpv[I])}const b=new Int16Array(r);if(this.groups&&this.fiberGroupColormap!==null||m.startsWith("dpg")&&this.dpg.length>0){const I=new Uint8ClampedArray(this.groups.length*4),w=new Array(this.groups.length).fill(!1);if(this.fiberGroupColormap){const v=this.fiberGroupColormap;v.A===void 0&&(v.A=Array.from(new Uint8ClampedArray(v.I.length).fill(255)));for(let M=0;M<v.I.length;M++){let C=v.I[M];C<0||C>=this.groups.length||v.A[M]<1||(w[C]=!0,C*=4,I[C]=v.R[M],I[C+1]=v.G[M],I[C+2]=v.B[M],I[C+3]=255)}}else if(m.startsWith("dpg")&&this.dpg.length>0){const v=parseInt(m.substring(3)),M=v<this.dpg.length?this.dpg[v]:this.dpg[0],C=Ie.colormap(this.colormap,this.colormapInvert),D=M.cal_min,S=M.cal_max,k=this.groups.length;for(let F=0;F<k;F++){const B=M.vals[F];if(B<D)continue;let O=Math.round(255*Math.min(Math.max((B-D)/(S-D),0),1));w[F]=!0;const L=F*4;O*=4,I[L]=C[O+0],I[L+1]=C[O+1],I[L+2]=C[O+2],I[L+3]=255}}b.fill(-1);for(let v=0;v<this.groups.length;v++)if(w[v])for(let M=0;M<this.groups[v].vals.length;M++)b[this.groups[v].vals[M]]=v;for(let v=0;v<r;v++){if(b[v]<0)continue;const M=b[v]%256*4,C=f(I[M],I[M+1],I[M+2]),D=i[v],S=i[v+1]-1,k=D*4+3,F=S*4+3;for(let B=k;B<=F;B+=4)o[B]=C}}else if(g){const I=Ie.colormap(this.colormap,this.colormapInvert),w=g.cal_min,v=g.cal_max;let M=3;for(let C=0;C<s;C++){let D=Math.min(Math.max((g.vals[C]-w)/(v-w),0),1);D=Math.round(Math.max(Math.min(255,D*255)))*4;const S=I[D]+(I[D+1]<<8)+(I[D+2]<<16);o[M]=S,M+=4}}else if(p){const I=Ie.colormap(this.colormap,this.colormapInvert);let w=p[0],v=p[0];for(let M=0;M<r;M++)w=Math.min(w,p[M]),v=Math.max(v,p[M]);v===w&&(w-=1);for(let M=0;M<r;M++){let C=(p[M]-w)/(v-w);C=Math.round(Math.max(Math.min(255,C*255)))*4;const D=I[C]+(I[C+1]<<8)+(I[C+2]<<16),S=i[M],k=i[M+1]-1,F=S*4+3,B=k*4+3;for(let O=F;O<=B;O+=4)o[O]=D}}else if(m.includes("fixed"))if(h===0){const I=this.rgba255[0]+(this.rgba255[1]<<8)+(this.rgba255[2]<<16);let w=3;for(let v=0;v<s;v++)o[w]=I,w+=4}else for(let I=0;I<r;I++){const w=f(this.rgba255[0],this.rgba255[1],this.rgba255[2]),v=i[I],M=i[I+1]-1,C=v*4+3,D=M*4+3;for(let S=C;S<=D;S+=4)o[S]=w}else if(m.includes("local"))for(let I=0;I<r;I++){const w=i[I],v=i[I+1]-1;let M=w*3;const C=v*3,D=h*Math.random();let S=u(t[M],t[M+1],t[M+2],t[M+4],t[M+5],t[M+6],D),k=w*4+3;for(;M<C;)o[k]=S,k+=4,M+=3,S=u(t[M-3],t[M-2],t[M-1],t[M+3],t[M+4],t[M+5],D);o[k]=o[k-4]}else for(let I=0;I<r;I++){const w=i[I],v=i[I+1]-1,M=w*3,C=v*3,D=u(t[M],t[M+1],t[M+2],t[C],t[C+1],t[C+2],h*Math.random()),S=w*4+3,k=v*4+3;for(let F=S;F<=k;F+=4)o[F]=D}if(this.fiberOcclusion>0){let I=function(w,v){const M=v*(w&255),C=v*(w>>8&255),D=v*(w>>16&255);return M+(C<<8)+(D<<16)};this.createFiberDensityMap();for(let w=0;w<r;w++){const v=i[w],M=i[w+1]-1,C=v*4+3,D=M*4+3;let S=v;const k=Math.min(this.fiberOcclusion,.99);for(let F=C;F<=D;F+=4){let B=this.fiberDensity[S++];if(B<=0)continue;B=B/((1/k-2)*(1-B)+1);const O=1-Math.min(B,.9);let L=o[F];L=I(L,O),o[F]=L}}}if(Number.isFinite(this.dpsThreshold)&&this.dps&&(p||this.dps[0].vals.length===r&&(p=this.dps[0].vals),p))for(let I=0;I<r;I++)p[I]<this.dpsThreshold&&(b[I]=-1);const A=this.fiberLength,y=Math.pow(2,32)-1,x=[];let E=-1;for(let I=0;I<r;I++)if(!(b[I]<0)&&!(this.fiberLengths[I]<A)&&(E++,E%this.fiberDecimationStride===0)){for(let w=i[I];w<i[I+1];w++)x.push(w);x.push(y)}this.fiberSides>2&&this.fiberRadius>0?this.linesToCylinders(e,n,x):(this.indexCount=x.length,e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,Uint32Array.from(o),e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,Uint32Array.from(x),e.STATIC_DRAW))}indexNearestXYZmm(e,t,i){const r=this.pts,s=this.pts.length/3;let n=0,o=1/0,c=0;for(let l=0;l<s;l++){const h=Math.pow(r[n]-e,2)+Math.pow(r[n+1]-t,2)+Math.pow(r[n+2]-i,2);h<o&&(o=h,c=l),n+=3}return o=Math.sqrt(o),[c,o]}unloadMesh(e){if(e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindVertexArray(null),e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.indexBuffer),e.deleteVertexArray(this.vao),e.deleteVertexArray(this.vaoFiber),this.offsetPt0=null,this.tris=null,this.pts=null,this.layers&&this.layers.length>0)for(let t=0;t<this.layers.length;t++)this.layers[t].values=null;if(this.dpg&&this.dpg.length>0)for(let t=0;t<this.dpg.length;t++)this.dpg[t].vals=null;if(this.dps&&this.dps.length>0)for(let t=0;t<this.dps.length;t++)this.dps[t].vals=null}scalars2RGBA(e,t,i,r=!1){const s=i.length;if(4*s<e.length)return V.error(`colormap2RGBA incorrectly specified ${s}*4 != ${e.length}`),e;const n=Math.round(t.opacity*255);let o=t.cal_min,c=t.cal_max,l=Ie.colormap(t.colormap,this.colormapInvert),h=1;if(r){if(!t.useNegativeCmap)return e;h=-1,l=Ie.colormap(t.colormapNegative,t.colormapInvert),o=t.cal_min,c=t.cal_max,isFinite(t.cal_minNeg)&&isFinite(t.cal_minNeg)&&(o=-t.cal_minNeg,c=-t.cal_maxNeg)}let d=o;t.isTransparentBelowCalMin||(d=Number.NEGATIVE_INFINITY);const f=t.colormapType===2;t.colormapType!==0&&(o=Math.min(o,0));const u=255/(c-o);for(let m=0;m<s;m++){let p=i[m]*h;if(isNaN(p))continue;let g=n;if(p<d)if(p>0&&f)g=Math.round(t.opacity*255*Math.pow(p/d,2));else continue;if(p=(p-o)*u,p<0&&t.isTransparentBelowCalMin)continue;p=Math.min(255,Math.max(0,Math.round(p)))*4;const b=m*4;e[b+0]=l[p+0],e[b+1]=l[p+1],e[b+2]=l[p+2],e[b+3]=g}return e}blendColormap(e,t,i,r,s,n,o=!1){const c=this.pts.length/3,l=Math.min(i.opacity,1);function h(y,x,E){return y*(1-E)+x*E}function d(y,x){return Math.min(y+x,255)}const f=o?-1:1,u=Math.min(Math.max(i.frame4D,0),i.nFrame4D-1),m=c*u;let p=r;i.isTransparentBelowCalMin||(p=Number.NEGATIVE_INFINITY),i.colormapType!==0&&(r=Math.min(r,0));const g=255/(s-r);let b=new Array(c).fill(!1);if(i.outlineBorder!==0){const y=new Uint8Array(c).fill(0);for(let x=0;x<c;x++)f*i.values[x+m]>=p&&(y[x]=1);b=_a.getClusterBoundaryU8(y,this.tris);for(let x=0;x<c;x++)f*i.values[x+m]<p&&(b[x]=!1)}const A=new Float32Array(256).fill(l);if(p>r&&i.colormapType===2){let y=Math.round((p-r)*g);y=Math.max(y,1);for(let x=1;x<y;x++)A[x]=l*Math.pow(x/y,2);A[0]=0,p=r+Number.EPSILON}for(let y=0;y<c;y++){const x=f*i.values[y+m];if(x<p)continue;let E=Math.round((x-r)*g);if(E<0&&i.isTransparentBelowCalMin)continue;E=Math.max(0,E),E=Math.min(255,E);let I=A[E];E*=4;let w=y*28+24;if(this.f32PerVertex!==7&&(w=y*20+16),i.isAdditiveBlend){const v=y*4;t[v+0]=d(t[v+0],n[E+0]),t[v+1]=d(t[v+1],n[E+1]),t[v+2]=d(t[v+2],n[E+2]),t[v+3]=d(t[v+3],255)}else{if(b[y]&&(I=i.outlineBorder,i.outlineBorder<0)){e[w+0]=0,e[w+1]=0,e[w+2]=0;continue}e[w+0]=h(e[w+0],n[E+0],I),e[w+1]=h(e[w+1],n[E+1],I),e[w+2]=h(e[w+2],n[E+2],I)}}}updateMesh(e){if(this.offsetPt0){this.updateFibers(e);return}if(this.hasConnectome)return;if(!this.pts||!this.tris||!this.rgba255){V.warn("underspecified mesh");return}function t(l,h,d){return l*(1-d)+h*d}const i=this.generatePosNormClr(this.pts,this.tris,this.rgba255),r=this.pts.length/3,s=new Uint8Array(i.buffer);let n=0;const o=new Uint8Array(r*4);let c=this.tris;if(this.layers&&this.layers.length>0)for(let l=0;l<this.layers.length;l++){const h=this.layers[l],d=h.opacity;if(d<=0||h.cal_min>h.cal_max)continue;if(h.outlineBorder===void 0&&(h.outlineBorder=0),h.isAdditiveBlend===void 0&&(h.isAdditiveBlend=!1),h.colormapLabel&&h.colormapLabel.R&&!h.colormapLabel.lut&&(h.colormapLabel=Ie.makeLabelLut(h.colormapLabel,255,h.global_max)),h.colormapLabel&&h.colormapLabel.lut){const u=h.colormapLabel;let m=0;h.colormapLabel.min&&(m=h.colormapLabel.min);let p=u.lut;const g=Math.floor(p.length/4);if(h.atlasValues&&g>0&&g===h.atlasValues.length&&h.colormap){const I=h.atlasValues;let w=!1,v=!0;for(let M=0;M<g;M++)isNaN(I[M])?w=!0:v=!1;if(v){V.debug("invisible mesh: all atlasValues are NaN.");return}if(w){V.debug("some vertices have NaN atlasValues (mesh will be decimated).");const M=new Array(r).fill(!1);for(let F=0;F<r;F++){const B=Math.round(h.values[F])-m;isNaN(I[B])&&(M[F]=!0)}const C=new Array(c.length).fill(!1);for(let F=0;F<c.length;F++)M[c[F]]&&(C[F]=!0);const D=this.tris;let S=0;for(let F=0;F<D.length;F+=3)!C[F]&&!C[F+1]&&!C[F+2]&&S++;S===0&&V.debug("invisible mesh: all triangles of a vertex with a NaN atlasValue."),c=new Uint32Array(S*3);let k=0;for(let F=0;F<D.length;F+=3)!C[F]&&!C[F+1]&&!C[F+2]&&(c[k++]=D[F],c[k++]=D[F+1],c[k++]=D[F+2])}p.fill(0),p=this.scalars2RGBA(p,h,I),h.useNegativeCmap&&(p=this.scalars2RGBA(p,h,I,!0))}else h.atlasValues&&V.warn(`Expected ${g} atlasValues but got ${h.atlasValues.length} for mesh layer`);if(h.showLegend&&g===h.colormapLabel.labels.length){h.labels=[];for(let I=0;I<g;I++){const w=Array.from(p.slice(I*4,I*4+4)).map(S=>S/255),v=h.colormapLabel.labels[I],M=[0,0,0];let C=0;for(let S=0;S<r;S++)if(h.values[S]===I){const k=S*3;M[0]+=this.pts[k],M[1]+=this.pts[k+1],M[2]+=this.pts[k+2],C++}if(C>0&&(M[0]/=C,M[1]/=C,M[2]/=C),w[3]===0||!v||v.startsWith("_"))continue;w[3]=1;const D=new jo(v,{textColor:w,bulletScale:1,bulletColor:w,lineWidth:0,lineColor:w,textScale:1,textAlignment:"left",lineTerminator:"none"},M);h.labels.push(D),V.debug("label for mesh layer:",D)}}else delete h.labels;const b=Math.min(Math.max(h.frame4D,0),h.nFrame4D-1),A=r*b,y=new Uint8Array(r*4);let x=0;for(let I=0;I<r;I++){const w=h.values[I+A]-m,v=4*Math.min(Math.max(w,0),g-1);y[x+0]=p[v+0],y[x+1]=p[v+1],y[x+2]=p[v+2],y[x+3]=Math.round(p[v+3]/255*h.opacity*255),x+=4}let E=new Array(r).fill(!1);h.outlineBorder!==0&&(E=_a.getClusterBoundary(y,this.tris)),x=0;for(let I=0;I<r;I++){let w=I*28+24;this.f32PerVertex!==7&&(w=I*20+16);let v=y[x+3]/255;if(E[I]&&(v=h.outlineBorder,h.outlineBorder<0)){s[w+0]=0,s[w+1]=0,s[w+2]=0,x+=4;continue}s[w+0]=t(s[w+0],y[x+0],v),s[w+1]=t(s[w+1],y[x+1],v),s[w+2]=t(s[w+2],y[x+2],v),x+=4}continue}if(h.values instanceof Uint8Array){const u=new Uint8Array(h.values.buffer);let m=new Array(r).fill(!0);h.outlineBorder!==0&&(m=_a.getClusterBoundary(u,this.tris));let p=0;for(let g=0;g<h.values.length;g++){let b=g*28+24;this.f32PerVertex!==7&&(b=g*20+16);let A=d;if(m[g]&&(A=h.outlineBorder,h.outlineBorder<0)){s[b+0]=0,s[b+1]=0,s[b+2]=0,p+=4;continue}s[b+0]=t(s[b+0],u[p+0],A),s[b+1]=t(s[b+1],u[p+1],A),s[b+2]=t(s[b+2],u[p+2],A),p+=4}continue}h.useNegativeCmap&&(h.cal_min=Math.max(Number.EPSILON,h.cal_min),h.cal_max=Math.max(h.cal_min+1e-6,h.cal_max)),h.isTransparentBelowCalMin===void 0&&(h.isTransparentBelowCalMin=!0);const f=Ie.colormap(h.colormap,h.colormapInvert);if(h.isAdditiveBlend&&n++,this.blendColormap(s,o,h,h.cal_min,h.cal_max,f),h.useNegativeCmap){const u=Ie.colormap(h.colormapNegative,h.colormapInvert);let m=h.cal_min,p=h.cal_max;isFinite(h.cal_minNeg)&&isFinite(h.cal_minNeg)&&(m=-h.cal_minNeg,p=-h.cal_maxNeg),this.blendColormap(s,o,h,m,p,u,!0)}}if(n>0)for(let l=0;l<r;l++){let h=function(m,p){return Math.min(m*p*.00392156862745098,255)},d=l*28+24;this.f32PerVertex!==7&&(d=l*20+16);const f=l*4,u=Math.min(n,o[f+3]/255);u<=0||(s[d+0]=h(s[d+0],o[f+0]),s[d+1]=h(s[d+1],o[f+1]),s[d+2]=h(s[d+2],o[f+2]),s[d+0]=t(s[d+0],o[f+0],u),s[d+1]=t(s[d+1],o[f+1],u),s[d+2]=t(s[d+2],o[f+2],u))}e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,Uint32Array.from(c),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,s,e.STATIC_DRAW),this.indexCount=c.length,this.vertexCount=this.pts.length}reverseFaces(e){if(this.offsetPt0||this.hasConnectome)return;const t=this.tris||[];for(let i=0;i<t.length;i+=3){const r=t[i];t[i]=t[i+1],t[i+1]=r}this.updateMesh(e)}hierarchicalOrder(){const i=this.tris.length/3,r=Math.log(i/20)/Math.log(4);if(i!==Math.pow(4,r)*20)return NaN;if(this.pts.length/3!==Math.pow(4,r)*10+2)return NaN;for(let n=0;n<15;n+=3)if(this.tris[n]!==0)return NaN;for(let n=15;n<24;n+=3)if(this.tris[n]!==3)return NaN;for(let n=24;n<30;n+=3)if(this.tris[n]!==4)return NaN;return r}decimateFaces(e,t){let i=this.tris;const r=12,s=20;for(let n=e-1;n>=t;n--){const o=Math.pow(4,n+1)*(r-2)+2,c=Math.pow(4,n)*(r-2)+2,l=i.length/3,h=Math.pow(4,n)*s;V.info(`order ${n+1} -> ${n} vertices ${o} -> ${c} faces ${l} -> ${h}`);const d=Array.from({length:o},(u,m)=>m+1);for(let u=0;u<l;u++){const m=i[3*u],p=i[3*u+1],g=i[3*u+2];d[m-1]=Math.min(d[m-1],p,g)}const f=new Uint32Array(h*3);for(let u=0;u<h;u++)f[3*u]=d[i[3*u]-1],f[3*u+1]=d[i[3*u+1]-1],f[3*u+2]=d[i[3*u+2]-1];i=f}this.tris=new Uint32Array(i)}decimateHierarchicalMesh(e,t=4){const i=this.hierarchicalOrder();if(isNaN(i))return V.warn("Unable to decimate mesh: it does not have a hierarchical structure"),!1;if(t>=i)return V.warn(`Unable to decimate mesh: input order (${i}) must be larger than downsampled order (${t})`),!1;const r=this.pts.length/3,n=Math.pow(4,t)*(12-2)+2;if(this.pts=new Float32Array(this.pts.slice(0,n*3)),this.decimateFaces(i,t),this.layers&&this.layers.length>0)for(let o=0;o<this.layers.length;o++){const c=this.layers[o];c.values instanceof Float32Array||c.values.length!==r?c.values=new Float32Array(c.values.slice(0,n)):V.warn("decimation logic needs to be updated")}return this.updateMesh(e),!0}async setLayerProperty(e,t,i,r){const s=this.layers[e];if(!s||!(t in s)){V.warn("mesh does not have property ",t," for layer ",s);return}if(t==="colormapLabel")if(typeof i=="object")s[t]=Ie.makeLabelLut(i,255,s.global_max);else if(typeof i=="string"){const n=await Ie.makeLabelLutFromUrl(i);s[t]=n,this.updateMesh(r);return}else V.error("colormapLabel requires a string or object");else s[t]=i;this.updateMesh(r)}setProperty(e,t,i){if(!(e in this)){console.warn("Mesh does not have property:",e,this);return}this[e]=t,this.updateMesh(i)}generatePosNormClr(e,t,i){(e.length<3||i.length<4)&&(V.error("Catastrophic failure generatePosNormClr()"),V.debug("this",this),V.debug("pts",e),V.debug("rgba",i));const r=_a.generateNormals(e,t),s=e.length/3,n=s===i.length/4,o=this.f32PerVertex,c=new Float32Array(s*o),l=new Uint8Array(c.buffer);let h=0,d=0,f=0,u=(o-1)*4;for(let m=0;m<s;m++)c[f+0]=e[h+0],c[f+1]=e[h+1],c[f+2]=e[h+2],o!==7?(l[u-4]=r[h+0]*127,l[u-3]=r[h+1]*127,l[u-2]=r[h+2]*127):(c[f+3]=r[h+0],c[f+4]=r[h+1],c[f+5]=r[h+2]),l[u]=i[d+0],l[u+1]=i[d+1],l[u+2]=i[d+2],l[u+3]=i[d+3],n&&(d+=4),h+=3,f+=o,u+=o*4;return c}static async readMesh(e,t,i,r=1,s=new Uint8Array([255,255,255,255]),n=!0){let o=new Uint32Array([]),c=new Float32Array([]),l="",h;const d=/(?:\.([^.]+))?$/;let f=d.exec(t)[1];if(f=f.toUpperCase(),f==="GZ"&&(f=d.exec(t.slice(0,-3))[1],f=f.toUpperCase()),f==="JCON"&&V.error("you should never see this message: load using nvconnectome not nvmesh"),f==="JSON"&&V.error("you should never see this message: load using nvconnectome not nvmesh"),s[3]=Math.max(1,s[3]),f==="TCK"||f==="TRK"||f==="TT"||f==="TRX"||f==="TRACT"){if(f==="TCK"?h=je.readTCK(e):f==="TRACT"?h=je.readTRACT(e):f==="TT"?h=await je.readTT(e):f==="TRX"?h=await je.readTRX(e):h=await je.readTRK(e),typeof h>"u"){const g=new Float32Array([0,0,0,0,0,0]),b=new Uint32Array([0]);h={pts:g,offsetPt0:b},V.error("Creating empty tracts")}return s[3]=0,new Bt(h.pts,h.offsetPt0,t,s,r,n,i,"inferno",h.dpg||null,h.dps||null,h.dpv||null,h.groups)}if(f==="GII")h=await je.readGII(e);else if(f==="MZ3")h=await je.readMZ3(e),"positions"in h||V.warn("MZ3 does not have positions (statistical overlay?)");else if(f==="ASC")h=je.readASC(e);else if(f==="DFS")h=je.readDFS(e);else if(f==="BYU"||f==="G")h=je.readGEO(e);else if(f==="GEO")h=je.readGEO(e,!0);else if(f==="ICO"||f==="TRI")h=je.readICO(e);else if(f==="OFF")h=je.readOFF(e);else if(f==="NV")h=je.readNV(e);else if(f==="OBJ")h=await je.readOBJ(e);else if(f==="PLY")h=je.readPLY(e);else if(f==="WRL")h=je.readWRL(e);else if(f==="X3D")h=je.readX3D(e);else if(f==="FIB"||f==="VTK"){if(h=je.readVTK(e),"offsetPt0"in h)return s[3]=0,new Bt(h.pts,h.offsetPt0,t,s,r,n,i,"inferno")}else f==="SRF"?h=await je.readSRF(e):f==="STL"?h=je.readSTL(e):h=je.readFreeSurfer(e);if(h.anatomicalStructurePrimary&&(l=h.anatomicalStructurePrimary),h instanceof Float32Array)throw new Error("fatal: unknown mesh type loaded");if(!("positions"in h))throw new Error("positions not loaded");if(!h.indices)throw new Error("indices not loaded");if(c=h.positions,o=h.indices,"rgba255"in h&&h.rgba255.length>0&&(s=h.rgba255),"colors"in h&&h.colors&&h.colors.length===c.length){const g=c.length/3;s=new Uint8Array(g*4);let b=0,A=0;for(let y=0;y<g;y++)s[A++]=h.colors[b]*255,s[A++]=h.colors[b+1]*255,s[A++]=h.colors[b+2]*255,s[A++]=255,b+=3}const u=c.length/3;if(o.length/3<1||u<3)throw new Error("Mesh should have at least one triangle and three vertices");s[3]=Math.max(1,s[3]);const p=new Bt(c,o,t,s,r,n,i,null,null,null,null,null,!0,l);if("scalars"in h&&h.scalars.length>0){const g=await je.readLayer(t,e,p,r,"gray");typeof g>"u"?V.warn("readLayer() failed to convert scalars"):(p.layers.push(g),p.updateMesh(i))}return p}static async loadLayer(e,t){let i=new Uint8Array().buffer;function r(m){const p=window.atob(m),g=p.length,b=new Uint8Array(g);for(let A=0;A<g;A++)b[A]=p.charCodeAt(A);return b.buffer}if(e.base64!==void 0)i=r(e.base64);else{if(!e.url)throw new Error("layer: missing url");const m=await fetch(e.url,{headers:e.headers});if(!m.ok)throw Error(m.statusText);i=await m.arrayBuffer()}let s,n=[];if(e.name&&e.name!=="")s=e.name;else{if(!e.url)throw new Error("layer: missing url");try{n=new URL(e.url).pathname.split("/")}catch{n=e.url.split("/")}finally{s=n.slice(-1)[0]}}s.indexOf("?")>-1&&(s=s.slice(0,s.indexOf("?")));let o=.5;"opacity"in e&&(o=e.opacity);let c="warm";"colormap"in e&&(c=e.colormap);let l="winter";"colormapNegative"in e&&(l=e.colormapNegative);let h=!1;"useNegativeCmap"in e&&(h=e.useNegativeCmap);let d=null;"cal_min"in e&&(d=e.cal_min);let f=null;"cal_max"in e&&(f=e.cal_max);const u=await je.readLayer(s,i,t,o,c,l,h,d,f);u&&t.layers.push(u)}static async loadFromUrl({url:e="",headers:t={},gl:i,name:r="",opacity:s=1,rgba255:n=[255,255,255,255],visible:o=!0,layers:c=[],buffer:l=new ArrayBuffer(0)}={}){let h=e.split("/");if(r===""){try{h=new URL(e).pathname.split("/")}catch{h=e.split("/")}r=h.slice(-1)[0],r.indexOf("?")>-1&&(r=r.slice(0,r.indexOf("?")))}if(e==="")throw Error("url must not be empty");if(!i)throw Error("gl context is null");let d;if(l.byteLength>0)d=l;else{const u=await fetch(e,{headers:t});if(!u.ok)throw Error(u.statusText);d=await u.arrayBuffer()}const f=await this.readMesh(d,r,i,s,new Uint8Array(n),o);if(!c||c.length<1)return f;for(let u=0;u<c.length;u++)await Bt.loadLayer(c[u],f);return f.updateMesh(i),f}static async readFileAsync(e){return new Promise((t,i)=>{const r=new FileReader;r.onload=()=>{t(r.result)},r.onerror=i,r.readAsArrayBuffer(e)})}static async loadFromFile({file:e,gl:t,name:i="",opacity:r=1,rgba255:s=[255,255,255,255],visible:n=!0,layers:o=[]}={}){if(!e)throw new Error("file must be set");if(!t)throw new Error("rendering context must be set");const c=await Bt.readFileAsync(e),l=await Bt.readMesh(c,i,t,r,new Uint8Array(s),n);if(!o||o.length<1)return l;for(let h=0;h<o.length;h++)await Bt.loadLayer(o[h],l);return l.updateMesh(t),l}async loadFromBase64({base64:e,gl:t,name:i="",opacity:r=1,rgba255:s=[255,255,255,255],visible:n=!0,layers:o=[]}={}){if(!e)throw new Error("base64 must bet set");if(!t)throw new Error("rendering context must be set");function c(d){const f=window.atob(d),u=f.length,m=new Uint8Array(u);for(let p=0;p<u;p++)m[p]=f.charCodeAt(p);return m.buffer}const l=c(e),h=await Bt.readMesh(l,i,t,r,new Uint8Array(s),n);if(!o||o.length<1)return h;for(let d=0;d<o.length;d++)await Bt.loadLayer(o[d],h);return h.updateMesh(t),h}},Mp="data:image/jpeg;base64,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ZwAAAAAAAAALY3JvcFJlY3RUb3Bsb25nAAAAAAA4QklNA+0AAAAAABAASAAAAAEAAQBIAAAAAQABOEJJTQQmAAAAAAAOAAAAAAAAAAAAAD+AAAA4QklNBA0AAAAAAAQAAAAeOEJJTQQZAAAAAAAEAAAAHjhCSU0D8wAAAAAACQAAAAAAAAAAAQA4QklNJxAAAAAAAAoAAQAAAAAAAAABOEJJTQP1AAAAAABIAC9mZgABAGxmZgAGAAAAAAABAC9mZgABAKGZmgAGAAAAAAABADIAAAABAFoAAAAGAAAAAAABADUAAAABAC0AAAAGAAAAAAABOEJJTQP4AAAAAABwAAD/////////////////////////////A+gAAAAA/////////////////////////////wPoAAAAAP////////////////////////////8D6AAAAAD/////////////////////////////A+gAADhCSU0EAAAAAAAAAgAAOEJJTQQCAAAAAAACAAA4QklNBDAAAAAAAAEBADhCSU0ELQAAAAAABgABAAAAMjhCSU0ECAAAAAAAEAAAAAEAAAJAAAACQAAAAAA4QklNBB4AAAAAAAQAAAAAOEJJTQQaAAAAAAM9AAAABgAAAAAAAAAAAAACAAAAAgAAAAAEAG0AYwA2ADEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAABudWxsAAAAAgAAAAZib3VuZHNPYmpjAAAAAQAAAAAAAFJjdDEAAAAEAAAAAFRvcCBsb25nAAAAAAAAAABMZWZ0bG9uZwAAAAAAAAAAQnRvbWxvbmcAAAIAAAAAAFJnaHRsb25nAAACAAAAAAZzbGljZXNWbExzAAAAAU9iamMAAAABAAAAAAAFc2xpY2UAAAASAAAAB3NsaWNlSURsb25nAAAAAAAAAAdncm91cElEbG9uZwAAAAAAAAAGb3JpZ2luZW51bQAAAAxFU2xpY2VPcmlnaW4AAAANYXV0b0dlbmVyYXRlZAAAAABUeXBlZW51bQAAAApFU2xpY2VUeXBlAAAAAEltZyAAAAAGYm91bmRzT2JqYwAAAAEAAAAAAABSY3QxAAAABAAA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bnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTgtMDctMTJUMjA6MDc6NDcrMDE6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE4LTA3LTEzVDE3OjU0OjI3KzAxOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE4LTA3LTEzVDE3OjU0OjI3KzAxOjAwIiBkYzpmb3JtYXQ9ImltYWdlL2pwZWciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3MmVhYjVmZS02NDZkLWVhNDMtODQyNC0xNWQzZTgwOWExNDQiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo0OGNjMGI3YS1iYTJkLWZmNDAtYmNkNC1jNGQzMzIyZjBiNzQiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDphYzFjM2NhNS1hYTg4LWI5NGMtOGE4MS05YmU4MjA3ZGZiODciPiA8cGhvdG9zaG9wOkRvY3VtZW50QW5jZXN0b3JzPiA8cmRmOkJhZz4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6YThjMGNhZTYtODNjYy1hYzQ4LWI2YzAtN2FiODNlOWJkMGM3PC9yZGY6bGk+IDwvcmRmOkJhZz4gPC9waG90b3Nob3A6RG9jdW1lbnRBbmNlc3RvcnM+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6YWMxYzNjYTUtYWE4OC1iOTRjLThhODEtOWJlODIwN2RmYjg3IiBzdEV2dDp3aGVuPSIyMDE4LTA3LTEyVDIwOjA3OjQ3KzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpjYmI3MzZlZC0zOTRhLTM2NDgtYThiOC02Mzk1MmY0NDcxMjIiIHN0RXZ0OndoZW49IjIwMTgtMDctMTNUMTY6MTM6NTgrMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjQ2YjNkYTI3LWI4YjEtYmU0Yi1hYTQ4LTExZGM5NmZkNTIyZiIgc3RFdnQ6d2hlbj0iMjAxOC0wNy0xM1QxNzo1NDoyNyswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvanBlZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iZGVyaXZlZCIgc3RFdnQ6cGFyYW1ldGVycz0iY29udmVydGVkIGZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9qcGVnIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MmVhYjVmZS02NDZkLWVhNDMtODQyNC0xNWQzZTgwOWExNDQiIHN0RXZ0OndoZW49IjIwMTgtMDctMTNUMTc6NTQ6MjcrMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjQ2YjNkYTI3LWI4YjEtYmU0Yi1hYTQ4LTExZGM5NmZkNTIyZiIgc3RSZWY6ZG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjg3NjM1NDk5LWZiMTItYWU0MC04NWEzLThkMWFiN2NkZGVhOSIgc3RSZWY6b3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOmFjMWMzY2E1LWFhODgtYjk0Yy04YTgxLTliZTgyMDdkZmI4NyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8P3hwYWNrZXQgZW5kPSJ3Ij8+/+IMWElDQ19QUk9GSUxFAAEBAAAMSExpbm8CEAAAbW50clJHQiBYWVogB84AAgAJAAYAMQAAYWNzcE1TRlQAAAAASUVDIHNSR0IAAAAAAAAAAAAAAAEAAPbWAAEAAAAA0y1IUCAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARY3BydAAAAVAAAAAzZGVzYwAAAYQAAABsd3RwdAAAAfAAAAAUYmtwdAAAAgQAAAAUclhZWgAAAhgAAAAUZ1hZWgAAAiwAAAAUYlhZWgAAAkAAAAAUZG1uZAAAAlQAAABwZG1kZAAAAsQAAACIdnVlZAAAA0wAAACGdmlldwAAA9QAAAAkbHVtaQAAA/gAAAAUbWVhcwAABAwAAAAkdGVjaAAABDAAAAAMclRSQwAABDwAAAgMZ1RSQwAABDwAAAgMYlRSQwAABDwAAAgMdGV4dAAAAABDb3B5cmlnaHQgKGMpIDE5OTggSGV3bGV0dC1QYWNrYXJkIENvbXBhbnkAAGRlc2MAAAAAAAAAEnNSR0IgSUVDNjE5NjYtMi4xAAAAAAAAAAAAAAASc1JHQiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFhZWiAAAAAAAADzUQABAAAAARbMWFlaIAAAAAAAAAAAAAAAAAAAAABYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9kZXNjAAAAAAAAABZJRUMgaHR0cDovL3d3dy5pZWMuY2gAAAAAAAAAAAAAABZJRUMgaHR0cDovL3d3dy5pZWMuY2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZGVzYwAAAAAAAAAuSUVDIDYxOTY2LTIuMSBEZWZhdWx0IFJHQiBjb2xvdXIgc3BhY2UgLSBzUkdCAAAAAAAAAAAAAAAuSUVDIDYxOTY2LTIuMSBEZWZhdWx0IFJHQiBjb2xvdXIgc3BhY2UgLSBzUkdCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGRlc2MAAAAAAAAALFJlZmVyZW5jZSBWaWV3aW5nIENvbmRpdGlvbiBpbiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAACxSZWZlcmVuY2UgVmlld2luZyBDb25kaXRpb24gaW4gSUVDNjE5NjYtMi4xAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB2aWV3AAAAAAATpP4AFF8uABDPFAAD7cwABBMLAANcngAAAAFYWVogAAAAAABMCVYAUAAAAFcf521lYXMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAKPAAAAAnNpZyAAAAAAQ1JUIGN1cnYAAAAAAAAEAAAAAAUACgAPABQAGQAeACMAKAAtADIANwA7AEAARQBKAE8AVABZAF4AYwBoAG0AcgB3AHwAgQCGAIsAkACVAJoAnwCkAKkArgCyALcAvADBAMYAywDQANUA2wDgAOUA6wDwAPYA+wEBAQcBDQETARkBHwElASsBMgE4AT4BRQFMAVIBWQFgAWcBbgF1AXwBgwGLAZIBmgGhAakBsQG5AcEByQHRAdkB4QHpAfIB+gIDAgwCFAIdAiYCLwI4AkECSwJUAl0CZwJxAnoChAKOApgCogKsArYCwQLLAtUC4ALrAvUDAAMLAxYDIQMtAzgDQwNPA1oDZgNyA34DigOWA6IDrgO6A8cD0wPgA+wD+QQGBBMEIAQtBDsESARVBGMEcQR+BIwEmgSoBLYExATTBOEE8AT+BQ0FHAUrBToFSQVYBWcFdwWGBZYFpgW1BcUF1QXlBfYGBgYWBicGNwZIBlkGagZ7BowGnQavBsAG0QbjBvUHBwcZBysHPQdPB2EHdAeGB5kHrAe/B9IH5Qf4CAsIHwgyCEYIWghuCIIIlgiqCL4I0gjnCPsJEAklCToJTwlkCXkJjwmkCboJzwnlCfsKEQonCj0KVApqCoEKmAquCsUK3ArzCwsLIgs5C1ELaQuAC5gLsAvIC+EL+QwSDCoMQwxcDHUMjgynDMAM2QzzDQ0NJg1ADVoNdA2ODakNww3eDfgOEw4uDkkOZA5/DpsOtg7SDu4PCQ8lD0EPXg96D5YPsw/PD+wQCRAmEEMQYRB+EJsQuRDXEPURExExEU8RbRGMEaoRyRHoEgcSJhJFEmQShBKjEsMS4xMDEyMTQxNjE4MTpBPFE+UUBhQnFEkUahSLFK0UzhTwFRIVNBVWFXgVmxW9FeAWAxYmFkkWbBaPFrIW1hb6Fx0XQRdlF4kXrhfSF/cYGxhAGGUYihivGNUY+hkgGUUZaxmRGbcZ3RoEGioaURp3Gp4axRrsGxQbOxtjG4obshvaHAIcKhxSHHscoxzMHPUdHh1HHXAdmR3DHeweFh5AHmoelB6+HukfEx8+H2kflB+/H+ogFSBBIGwgmCDEIPAhHCFIIXUhoSHOIfsiJyJVIoIiryLdIwojOCNmI5QjwiPwJB8kTSR8JKsk2iUJJTglaCWXJccl9yYnJlcmhya3JugnGCdJJ3onqyfcKA0oPyhxKKIo1CkGKTgpaymdKdAqAio1KmgqmyrPKwIrNitpK50r0SwFLDksbiyiLNctDC1BLXYtqy3hLhYuTC6CLrcu7i8kL1ovkS/HL/4wNTBsMKQw2zESMUoxgjG6MfIyKjJjMpsy1DMNM0YzfzO4M/E0KzRlNJ402DUTNU01hzXCNf02NzZyNq426TckN2A3nDfXOBQ4UDiMOMg5BTlCOX85vDn5OjY6dDqyOu87LTtrO6o76DwnPGU8pDzjPSI9YT2hPeA+ID5gPqA+4D8hP2E/oj/iQCNAZECmQOdBKUFqQaxB7kIwQnJCtUL3QzpDfUPARANER0SKRM5FEkVVRZpF3kYiRmdGq0bwRzVHe0fASAVIS0iRSNdJHUljSalJ8Eo3Sn1KxEsMS1NLmkviTCpMcky6TQJNSk2TTdxOJU5uTrdPAE9JT5NP3VAnUHFQu1EGUVBRm1HmUjFSfFLHUxNTX1OqU/ZUQlSPVNtVKFV1VcJWD1ZcVqlW91dEV5JX4FgvWH1Yy1kaWWlZuFoHWlZaplr1W0VblVvlXDVchlzWXSddeF3JXhpebF69Xw9fYV+zYAVgV2CqYPxhT2GiYfViSWKcYvBjQ2OXY+tkQGSUZOllPWWSZedmPWaSZuhnPWeTZ+loP2iWaOxpQ2maafFqSGqfavdrT2una/9sV2yvbQhtYG25bhJua27Ebx5veG/RcCtwhnDgcTpxlXHwcktypnMBc11zuHQUdHB0zHUodYV14XY+dpt2+HdWd7N4EXhueMx5KnmJeed6RnqlewR7Y3vCfCF8gXzhfUF9oX4BfmJ+wn8jf4R/5YBHgKiBCoFrgc2CMIKSgvSDV4O6hB2EgITjhUeFq4YOhnKG14c7h5+IBIhpiM6JM4mZif6KZIrKizCLlov8jGOMyo0xjZiN/45mjs6PNo+ekAaQbpDWkT+RqJIRknqS45NNk7aUIJSKlPSVX5XJljSWn5cKl3WX4JhMmLiZJJmQmfyaaJrVm0Kbr5wcnImc951kndKeQJ6unx2fi5/6oGmg2KFHobaiJqKWowajdqPmpFakx6U4pammGqaLpv2nbqfgqFKoxKk3qamqHKqPqwKrdavprFys0K1ErbiuLa6hrxavi7AAsHWw6rFgsdayS7LCszizrrQltJy1E7WKtgG2ebbwt2i34LhZuNG5SrnCuju6tbsuu6e8IbybvRW9j74KvoS+/796v/XAcMDswWfB48JfwtvDWMPUxFHEzsVLxcjGRsbDx0HHv8g9yLzJOsm5yjjKt8s2y7bMNcy1zTXNtc42zrbPN8+40DnQutE80b7SP9LB00TTxtRJ1MvVTtXR1lXW2Ndc1+DYZNjo2WzZ8dp22vvbgNwF3IrdEN2W3hzeot8p36/gNuC94UThzOJT4tvjY+Pr5HPk/OWE5g3mlucf56noMui86Ubp0Opb6uXrcOv77IbtEe2c7ijutO9A78zwWPDl8XLx//KM8xnzp/Q09ML1UPXe9m32+/eK+Bn4qPk4+cf6V/rn+3f8B/yY/Sn9uv5L/tz/bf///+4ADkFkb2JlAGRAAAAAAf/bAIQAAgICAgICAgICAgMCAgIDBAMCAgMEBQQEBAQEBQYFBQUFBQUGBgcHCAcHBgkJCgoJCQwMDAwMDAwMDAwMDAwMDAEDAwMFBAUJBgYJDQoJCg0PDg4ODg8PDAwMDAwPDwwMDAwMDA8MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwM/8AAEQgCAAIAAwERAAIRAQMRAf/dAAQAQP/EAaIAAAAHAQEBAQEAAAAAAAAAAAQFAwIGAQAHCAkKCwEAAgIDAQEBAQEAAAAAAAAAAQACAwQFBgcICQoLEAACAQMDAgQCBgcDBAIGAnMBAgMRBAAFIRIxQVEGE2EicYEUMpGhBxWxQiPBUtHhMxZi8CRygvElQzRTkqKyY3PCNUQnk6OzNhdUZHTD0uIIJoMJChgZhJRFRqS0VtNVKBry4/PE1OT0ZXWFlaW1xdXl9WZ2hpamtsbW5vY3R1dnd4eXp7fH1+f3OEhYaHiImKi4yNjo+Ck5SVlpeYmZqbnJ2en5KjpKWmp6ipqqusra6voRAAICAQIDBQUEBQYECAMDbQEAAhEDBCESMUEFURNhIgZxgZEyobHwFMHR4SNCFVJicvEzJDRDghaSUyWiY7LCB3PSNeJEgxdUkwgJChgZJjZFGidkdFU38qOzwygp0+PzhJSktMTU5PRldYWVpbXF1eX1RlZmdoaWprbG1ub2R1dnd4eXp7fH1+f3OEhYaHiImKi4yNjo+DlJWWl5iZmpucnZ6fkqOkpaanqKmqq6ytrq+v/aAAwDAQACEQMRAD8A7B9HTNg4bWKteOKVp7/jgVYcVUmxSpN92FVFvuxVSNNzUbb0Nd9+m2FVBvDFVP8Ajiq3FLYHfFV4FcWSqFwJVVXAlXVTkUqoWv8AA4GSqqCu/htgSvCYErgntilv09/DFXenXFLXo4obW1dzREZz7AnCqKj0W9l+zAVB7tthpFhHR+V7px+8dU+QJyVMbR8fk9f92SufECgw0i0dH5Ps/wBpGbxJJw0i0YnlPT1p/ooNO5FcKFceWNPH/Hon/AjChf8A4bsB/wAeyf8AAjFWj5asD1tU/wCBGFFKLeVtNYb2kf8AwIxWkJJ5O0tq/wCioPkKH8MKKS+XyNp7fZRl9wxxWkpn8hJv6U8in3oRihJbjyTfx1MUiyexBGFUjuPLuqQFudqXA7oQfwxQk8lpLESJYnjPcMpH68VQ5jPzGFVnE4oa47bjCq0rv0xQtK/7WKrSuKrSu+KrKVO2KGqDbck0qa/PArWKt/wxVcMVXg++BVQHwxSqV967DAq8Hpiq4H+3FK8HfFVQHAq8HFV4PTtiq6uBW69PxOKurir/AP/Q7D8++bBw2v1UxVaT1xSt+jAqkcVUzilSJ64VUGOKqJ/HxwqpnFVn+ZxVrqfc4pX0HvilVVT1oaeOBKsq9TTftgZK6rgSrqmRZKyodsCVVU+/AlVEdcCV4jxSi4bCeb7CEjxO2NLabQaBK5Blag7qv9ckIseJkeneU3upY4LWylvLh9kjRGkYn2UVyYgxM3q2ifkr5z1NY2TRWsIXpSW7IgoPHi3xU+jEmI5kMbt6dpf/ADjpdsFbVtdgtqqCY7WNpSDXcVcoOnfIHNAcrK1Jndh+QflC2Rfrd1fX0gHxNzWJSd9+IUkdfHInUdw/H2LwHvZPD+UnkS3UBNESQgg8pXdzsa+Pvg/MnuDGWM9Cwjznp3lfyjGhTStKMr7JbrvKOIqpZSNv45nYc0SLI+wNJxyvm8UvvM1pNyFvpNtEDuKIOvjkjlHQMxjPexS5uvrJJ9FI69eIAyoytmIoHgPDAmmigxWnen7YoWmMb7UwqtMQxQpmAHthVRa2U9sUIWSxRhuoOFUtuNGt5QQ8SmvYiuKKYve+TbCapWH0yejJt+GFFMSvfJdxHU28vLwVxT8Rihi11pF7akia3YAbcwKj8MKpYY8VWGMiuKrCv0YoWFcVWFfbFVnH+zArQ2IJHIA7qehxVr5Yq33xVf8AhgVeDQ9e+Krh+GKqimhB8PH+hxVcDgVcDvXqfHFV4NMVXg/7eKV4OBVwbFV307Yq3Xv098Cv/9HsP0ZsHDa64qtOKVpGKqZ+7FVE4qot/t4pUSfDFVJv8zhVTOKtH8e+KXAYpVFHhgSrKvbAlEKvSmBKJRP9vAyRCr/tZFkrrH+GBKISEueKKWPYDAlN7bR55aF/gU9u+ERQZUyzSvKtxdzRw2dlLeXEhARI0LsSfAAHJiDEze6+WvyF8y6okc+omLQ7YkVFwGM1O9IgNv8AZEYJTjHr8mO5e5aD+R/k3SQkl8k2t3C9TO3pxV8RGhB+9jlRznoKTw971Sw0nS9KRk0zTrawVvti3iWOtOleIFcqlOUuZZCICOd0jRpJGCIgLO7GgAG5JJ6ZHmlh2rfmD5Q0bmt1rUMkydYLeszV8KpVQR3BOWDFIo4nmOsfnxYxFo9E0iS4NPguLtggrTesaVOx/wArLBhHUot5Zrf5s+cdYEkQ1D9HWzkn0LNRFQGopz3cih6cssjCIV5zPdT3MjSzyvNI27O7FiT7k5O0Uh61wq39OKuwodTbFW6YUOp7Yq1xwq6gxQt44oWlK4VUzGMKFBoQe2KoSS2Vq7YoSy402OQEFQa9dsKKYnqHlSzueTCLg/8AOu2FFMHv/Kt5b8mh/fIO3Q4qxea3khYpJG0bDsRTFUOyfhgVTK4qplfDFCmRTpiq3FXdNsVbH+2cVbr7YFXg4q3Xriq8H3xVcCd8VXg/hgVcDiqoDilcDgVfWuKr6mgqa06Yq//S7DmwcN34jwxVYa9t/HFVhxSpsKd698CqJ6YUqTHFVFsVUjhVTNDtirqU+ZxSuAPzrilWVelR8sCUQijbAyRKpkUopE/zOBkiooXchVXk3amRSyKx0Kacjmp36KMIjamT2Tyl+UnmPzAFew01o7atHvJv3cXavxN1pUGgqcmQI8zTDiJ5Pozy3+QWh2HpTa9evqUy0LWkH7uGoPQufjYH245VLOOgTwl7XpOh6RoVv9V0jToNPhO7LEoBY+LN1Y/M5TKcpcyyEQEykljhRpZpFijQVeRyFUD3J2yIBOwSTTzvXvzT8o6GHQXv6SuUqPQtfiFR4uaL91ctGA9dmPF3PGta/PTW7l2XR7WDTIQTxdgJpCKdyw4/8LlgxxHmu7ynVfNmvay7NqOq3N1y/YeRio9gtaAbnpk7XhY+0zNUkknG00sqTirf04Vb264q39GFDdRiruXhhQ3WuKt1wobBwq3ihvY4VdxB3xQ0VHX78VWlMKFhX/axVTKe3TChQaIHtiqFkgB7YUJdNZhgajFDHNQ0K2ugRLEDXvTCimAaj5VlhLPankOvpt/A4qxCa2lhYpKhjYeOBUMV6AjpsO3viqky138MVUiuxB+jFC2m5xVr8cVdTFV2Kt/574FX1FcVXBiCGBII6YquB8Diq4HbFVwOBV4OKVQHAq8H7sVf/9PsPvvmwcNrfFWjTFVh8PHrilSP+ZxVSOKqBxSpHfvhVSNKbfaqamu1NqYqs7YpbA6e2KVRR4/RgSrquBIRSL09sDJFohJAAqe2RSn1hpM90y0UgHtTEBN0928jfk/rnmMpJBafV7IMBLfTDhGOlaE7k+wBOSNR5sOInk+s/Kn5Q+V/LaJJc266zfqa+vOg9Nf9WKpH31+jKZZz/DsyEO96qAFAVQFVRRVGwAGY5Ns0u1TWNL0W3Nzql9FZRAEgyNQtTrxXqx+QyUYGXJBkA8O8yfnnZ2/q2/l6yM70ol9cGig+Ij7/AEnL44YjnuxsnyeDa/568w+YnLalqLyp+zEtEQD2VaDLAaFDZIixBpmY7kn54LZUt5VxTTYOKrq4q3X3wobrirfLFWwcKG64VXDFDYwquGFC6mKt0+nChdTFDgMKrqYobphVqgxQsKV/jhVYY/bbFCi0XXbriqg8PthQgpIAdvwxVLJ7NWB+HChjGpaJBcqweIH3pvih55qfly4tS0kNZIxU8e4xVi7xlSQRxI2IwKh2XFVMin0YqtIxQ10FPlirQ2xVd32Fa4q2MVdXAq4HFWwdjviqoD1xVeG8MCr1Ndu5wJVAcVf/1OxZsHDapirR/V2xVYcUqZ+7FVBvnilSIb4qVpT4qdKVxVQOFVMj+3FVoH3YpX8eJYEiqmlAaj6CNsCVRR74pRCCu9MiyR8EDysqqCa4EvSfKvkrUdau4LWztHurmZqJGgJr3yQigyp9reRfyO0vRUhvPMIS+u6VFgv92hI/aYH4iPAbe5yqecDaPzUQJ5vfI4o4Y0ihjWKKMcY40AVVA7ADYZjEk7ltApqWaKCN5ppFiijFZJHICgeJJxAJ2Ck08T85/m5a6aslnoPGefcNesPhH+ovf5nMiGIDcsCSXzDrnmbUdZuXub+8kuZW6vIxPTYZYSkRYy8xbqcjbOlnKpwKuDffileGwq3yxVdXxxVcDhQuGKrhhVcPuxQuGFV4GFC4DwwoXgeHTFVwFBhQupihfTvhVsDChvjirfH6cUN8cKtFfbFDXH6cKrSgxQpNED0wqh3i9vpxQhJIR1piqXy2wbthQktzYhgQVG+KGEav5diuAzovCQdGGKvPL6wuLRysybV2em3+e2BUtK+2KqRWlcULKYq1T78VdirsVbrtSv0Yq2PmBtWpr2wK30ANeo2/zGKrgd9vuxVeO1cCVSo23Ne/tiqoCDTYCg3O+/fAr//V7EM2Dhu/hirXGor0xSsI/DFVI4qpN398UqLbinhv9+KqJB/28VUiMKXU9sVXKMCVdRXAyTKztJLhwiLXfc+GBL6D/LP8ptU813MZjhaCwjI+t6g6/Agr0FaVO/Qb4TURckWTsH3f5T8m6L5PsktdMt19coFur9gPUlNa706CvQD6anfMTJlM/c2RiAyzK2TGvMPmvSPLcDSX1wpmAqlqhBc/PwGWQxmXuYmVPlnzt+aeoa4z28UhtrMH4LeM0HzPicyABHkgC+bxi51CSZmZmJJwEswEAZST1wMmw3jiq8NgSuDYqvBwqqA1+WKrhhVePliheMKrwMKFQDCq8DFC8DCheB7YVXgbYoXgdMKFwH4YqvphQ3xwoXBeuKt8a4UN8cVdxxQ1x3wq0V+nFC3h1wqsKfj3xQoPDXtiqFkh26YVQEtvWtBihKbm0BB2xQxbUdJjnVldAa4q8x1XQ5bRmeJS8f8AL4YqxtlofDAqmRiq3buae/Xftihbt8sVdirWKu2p716Yq2PnQYFbr/t4qvBwJXg4qqKcCv8A/9bsfTNg4bsVaxSsI+nAqmR1/HFVIjrhSpMPvxVRYHscUqZHbFXU38ffFK4L/bilMrGzku3AjU8K7t4/LIpfWn5Rfklda+ttrGsxtY6CrAx1FHueJ3CA7gduRHyrglMQ58+5QCX3Bp2m2Gk2kNhptpHZWkACxQRLQCgpU+J8SdzmJKRkbLaAByX3t9aadbyXd9cJa20Qq8shoPl7n2GMYmRoKSBzeAecvzpgtxLZ6Bt1BvW+0f8AVHbMmOIR57lrsy8nzPrHmi91OaSW4uHkZzVmYk1JwmTMRpi73LOSSa5ElnSl6hOBK8N+GBKoGwpVAcVVAcVVBiqqMKqi4oVAMKqij6cKFQDCqoAMUKgGFC8DCq8DphQvAGKF9P7MKrguKF4HjuMKF1DhVdTFDfHChcBirVPuxVun04UNU/2sVa41xQsK4VWMvfFCiyDviqGkh+7ChASQddsVSue2BqKYoY7e6csgYFa4q811ry+VZ5YFo1akdjirCXjZGKsvFl2IPXAqiQBXFVtMVap79cULcCu+eKuOKuHfAleCemKrwe2BV4P+3il//9fslDvTem5zYOG7FXHAlYRiqwivviqkR49sUqTDwxVSZcKVOn0Yq6lASSABuSemBKJsrWS9kVVU+kSKCm7HBbIB9v8A5M/kWssNt5k83WskFuCsmmaO44NKBuHmBFQh7DqevTrCeTg5c/uUDi9z7HRFjVURQiIAqIooABsAAMxSb3LcxLzd520PybZNc6pcKbl0LWmnqf3spG3+xFf2jtk8eIy9zGUqfFfnX80NY803TtNcGK0QkW1mmyID7dyfE5lWIiosRG9y8umv5JSSzEk98rJbAEL61T1wWypcHrgSqhtv1YpVVauKaVVOKqymuKqynFVYYVVlGKqqjChVAwoVQNsKr6YUKgGKFQDCq8DCheBT28cKF4GKF4GFVwGKF4FcKF1MKrwMUN0/swquptihwGKup1wodT/axVqmKGiu+FVpXFCkV7YqpMnXCqGePrt2xQgpIevfFUsnt+opihILyxVgarXFXm+uaAG5SRrxcVII/UcUPP5onido5AVZe2BKhT6MVWEeH3Yqt6++BWsVa2wK3/mcVXDx+7Aq4YpVAcCv/9DstM2DhuxVxH9MCVv44qtI/txVTI2JxSpsPamKqRUeGKVNqKCxNAN2Y7DFKlbxvfyqqqfRqOC93PiciSyAfe35IfkUdOFr5p85WQScBZdJ0SUAlagMss69iOyHev2vDITycGw5/d+37vfyMRxe59d5itrxH8xvzm0XylHcadpM0Wp66F4/CwaGAmu7EVDMP5fv8MyIYa3l8mBlfJ8Q+YPNmp+YL+41DUrt7q6uGq8rmp8APYAbAdhtlhkkRY2bgseuQtmA4S++BlSor1wJV1b3xSrK3TFVdTilEriqIXCquoxVEKP7cKFVRhVWXFCqBhVUGFCpTFVQDCheB/tYULwMKFQDFC8DCq+mFC7FC8DCq4DFC6mFV1PbFDYGFC6mKuphV1MUNUpXbbFXFcKFpGKrSuKFMr+PbCqiyfR74oQzx1xVByRVxVLJ4K9sUJBeWYdSOOKvONe0EOrPGtGWtGAxV51LHJEzRupQ9GXxGBVAjv8AjgVYR44qtpirXTw26YFbGKrh88CW8CqgxV//0ey07ZsHDbpirqClO+BLjU7mpJ7nFVpHcYqsp3xSpkYpU2UAVJoBuT4Yqk5dr+ZUjr6ANAB1c5Am2YD7x/5x/wDyQaz+o+d/NdrwkUCXQdIlUE7j4biVWBpTqg61+LwrGc+DYc/u/b93v5EDi9z7Id0iR5JHWOONS0kjEBVUCpJJ6AZigW2vjn82/wA+TJJdeXfKNzwtVrFe6qho0vZljPZffvmXGAx+Z+5r3l7nyTcajLcOzyOXZjUsTXAZW2AIYTV75C2QCoslSN8FpV1fFkiFbFUQrVxSiUJ2OKopMUotMKohcUIlcKqw98Kqy4oVhhVVGFCoPvwqqAYoVFwoXj5YUKgFP44ULwMKrwMULwMKF4xVcBhQvA2woXAYquA2xQ3T+uFW8UOp2wq3Tpt1xQ6mKuI/swoW0xVaRihaRiqky/jhVSKYoQrpWuKoOSIeGKEsmhBriqQXtmHDAiuKvMfMOhV5SxrRl3GBXnroyMVZaFTuMCqXYj8cVaIpvgVbTc/hirf44Et0/swKuAPhXFK4YFf/0uzUzYOG332O3yxVvAl1PDFWiBT3xStpgVYVxSx2/u/rEn1WFqxqaTOP2iOw9siSzAfXP/OOf5KjXZLbzt5jg46NYThtKsJF/wB6pYqMHYEbxqf+CO3jglLgHmeX6/1Jri26P0AkeOGN5ZXWKKJS0kjEKqqoqSSdgAMxQLbOT4Z/O/8APM6s1z5V8q3LR6UjFL/UEJDXJHVVPUIPx65kxiMfv+5j9XufJj3LOSSanIktgDQlr3yNsqV1fFKIRsCUUjVxSikOKoxDilFphVFp/tYqi0wqiUxVELhVXXChWXFVVcKFVcKFUdsKqgxQvGFCqB/tYULwMKrxhQvGKF4HTthQvGKrwMKF1MVXAYULgMUN0wquoPuxQ6mFW/xxV1MUOoMVaOFC2hxVaRihYV+/Cqky9sUKLLiqGdf9rFUFLH+PfFCVzw1rt8sVY7fWYdWBFa4q8l8w6K0LNPEvT7QHhgVhZFKjAlaRgV1O2BXUr1wKupilunt0wK3TFX//0+z5sHDbwK2MUt70xV1PbAlqnjiqQ6xf/V1+qwt+/kHxkdVX+pyMiziLeo/kV+VM/wCY/mSNLpXi8u6XSbWbpdmK78Y0J7uRT2G+AbDiKTfIc36sWlpbWFrb2VnAltaWsaxW8EYCqiKKAADMaUjI2W2IoUHxl/zkL+dixG58keV7yoo8Ov3se1W6GFGr07NmRGPhjf6vu/aw+s+T4ia5Z2JJqT1yBLaA2svvkWVK6v74pRSP9+Bki0OKoyPFKNTClGxj2xVGxjpiqMTCqKTt2wqiV7YoV1wqrrhVXX8cUKwwoVFwqqjChUA/28UKgHthQqDCqoBhQuAwoVB+IxQvFa+OFV4xQvA6fqwoXU/HCq4dcUL6Yq4d8KF1P9vFXU+nCh2Kt98UOp+GKtUwoW/L5Yq0Riq0jFCmR7YVUyK1xQoMvhviqFkTFUBLHWuKEquIag4qxbUrBZkZWWoIOBXjet6W1lOzKp9NjufDAlIadsCt0PhTArYBwJbCA1qQB1qa9t+1cCruIpgS3TFX/9Ts4zYOGu/28CV330xVsYq3Tv1wJQOoXkdjbvO27dIk/mbtgJpIFsa8uaNqfmzXrHSrCJrnUNVnWKNF8XPvkIx4i2E8IfsP+XHkTTfy78q6f5esFDSxKJNRu+81wwHqPv0Feg7DKsuTiO3IcmUI0LPMvHv+chfzkj8kaY/ljRJ1bzHqsJ9eZG+K0heoDDj+01D16D55PFHg9R59P1/qQfUaHLq/Nee9kuZZJpnMkkrFndjUkk1J+nIk23ALVk98iypEI+KUWjdMUoyNsUo6PtiqPj7YpR0f+1iqOTCqMTtviqMTthVFJ2wqiV7fjiquuFVdcKFdcVVRhQrDChVGFCqMKr1xQqAYULxhQqAYoVAP7MKF4GFV4H9uKF1MKF48PuxVumFC7viq7Chun+3irdDhQ3Tr7Yq1irsUOrhQtpirWKrT/tYoWkdMKqZGKFJlqMVQ7L/ZiqEdOuKEvmj9sVSe4hBrt9OKsJ1vS1uIpFKgmhwK8furV7WZ4mHQ/CcglD8e2BK4DAq4LilcF9sCt8Pb6cCv/9XtGbBw12/9mBK7FWxgVskKGZiAAKlj2GKXmur6idQuzwP7iL4YV8fE/TlUjbbEP0A/5xN/K79HadJ+YGr2/wDpl+pi0RGG6RdGk6/tdqjpQ5LIeCFdZfd+1A9UvIfe+hfzb/MvT/y08rXOqTSK+qXCmLSbPu0hH2qUOy+/emVYsYPqlyH4plOW/COb8jfMHmPUfMmrX2sapcvdXt/K808rkklmNT1+eM5cRbYxoJQsm/XIM6RSP0xSi0b3xSjYz0xSj4zilMIsVTGLCqOjxSjo8KoxO2KotMKopMVRK4VRC4UK64VV1xQrDChVUdMKFYYUKijCqqMUKgHTbChUH6sKF9MKF4xVUGFC8YoXAb4VXU8NsKF4BxVunbFC6n31woboMVdSpxQ3TCru3TbFWqYodhVrFC0jFWiMULCOuKrD12xVYwwoUGH44qhnXFUHIuKEumjrXFUivIAwO3zwK8z8yaTzUyotGXfIlLAAhB36jIpXBPHAlcE9sCrwvt88CruBpX7hil//1u09c2Dhrhsa+GBK4D+wYq2P9vArFvM+p/VYBZxNSW4H7wjsn9uQmWcRa38r/KM/njzjpGhxIXhmmVrxgNhEpq1fnTDhhxS35MskuGNv2InvtE8h+WIkJS2sNHtQkUdQAFjXuT403ORjjlnmTyH6GoZRCIA3L8mPzi/M++/MbzVdXzzOdNtWaLToDsAgP2qe/wDTHNkB9MeQcjFjoWeZeSrLXvlDfSJR8CUZG9aYpR8ZxSmMR6YpTGLthVMYu2KphFhSjo8VRsfbCqNTFUWmFUUm2KolPDCqJXChXWu2Kq6/LChWXChXX3wqqinbChUBxQqg/wC3hQvGFC8dcKFUVxQvFf6YVXj9WFC8E4ULhiq8YULx7YquAxQuGFV1K/0xQ6nXFXf5nChr+mKupihrt1wq12+eKrfpxQ0f1YqsOKFp+7xxVYevthVRYdcUKLD8cVQrrviqBlTFCVXEda4qxnUbUSKwp2yJS8m1awNtcMQPgY5ApCWhBQUBrT4vfftkUrxH+HfAlf6ft0wK7h7Yq//X7SM2DhrhgSupiqncTx2sEs8ppHEpY/RgKQ8Y1G/kvbqWdzvI1QPAdhlBNt8RT7o/5xZ0CDQ9NvfNl6irc3g4WzsN1jHWlfE5sdNguB83D1MrNMY/5yR/OKbUpG8qaXdFY611B0NDQHZMr1OQY48Efi2abDfqL4xEpJzWW59K6SYskbG+KUfEemKUyiPTFUyhwqmcXQYpTCPthVMIziqPjwpRsZxVGRnwwqi0NcKotP8AMYoRK4VRKnFVdcKEQpwoVlwqqjthQrDFCoMKFQdsKFUYUKg8MKF4xVeMKF4/VhQvFMVVAMKFy7YoXjfCqoBiheB9OFV4Xtihvh7fRhVoqfDFC2lP4Yqtp44q1iho+GFVvz7YoW/Riq04oWHFVp9u2KqZxQpMK4VQzjFUJIvXFUvmSvbFUluoq12rgVgut2AljY8antkSEhgRiKMQdqZUyXiP2pgVcEwJbEZxV//Q7V29/HNg4a4D+3Ald0264qwTzlqgRE0+Ntz8c/8AxqP45VM9GyAefWMf1y+trb/f0iqT7E5XEWabuQfZGs/mBbeSvJkFhZyKtwkASKNTSrUp2zazzDHBw44+OT4xv9UuNSvLi9uZDJPcuXkY+JNc005GRsuxjGgoLJU9ciyRkb1wJTCJumFKZwnpiqZxHphVNIuuFKZRHFUxiOFUfFilHx9sKo2M4qjEOFUWh3xVFofxwqiVPhhVEKcUIlThQrqfbCqspwoV1xQqLhQrLhQqLhQqjChUGFCoMVXj3woXj/MYULxiq8frwoXjxxVUG+FCsqk/PChEpESdhiqMjtHbYLhQrnT5KbqcUWh5LR16riqCeMjFVIinXFVOmKrT74ULTiq2njihafliq3FCw4qsOKqRA+WKFBh9HvhVDOteuKoGUdf14qlk6dTgVjt9AGUimAq861G09OZmAoD2yqQZBACPp+GQZL+FeuBW/TxV/9HtXhme4a4YpU57hbWGW4duKwqXJ6dN9sBUPBtW1B7y6nuJD8UrFqeHgPozHkXIiELpl+tlew3Tf7pPJfmMEZUbZkWFXXfMd1rdwJJnPpx7RpXYe+DJlMiyhDhSRZK5TbaAiUeuKUfE3TFKaQnphVNYThVNYsKpnEcVTKM9MKplGcUo+M4VR0Z6YVRqHocVRiHCqMQ4qikOFUShxVEqcKEQvbCqIU4oV1woVlwoVl/HChWGFCoMKFQfrwoVB22wqqDFC8H6cKFQHCheOmKrxhQvHt44qqqN8KEZClSNsKGU6Xpb3TqqoSSemGmJL2HRfIXqRrJc0jUjYHr92VTzRhtzQASyj/A2l8OPI17mgyr815MvDLFtY8gFUeS2pKoBNB2y6GeMvJgQYvItU0aW0dlZCtDlxCgsWliKEjAlCMMCVh/2sULcKrTiq04oWnFVhxQsOKqZxVSYYoQzqDXbFUJIOuKpfMvXFUmuY6g4qwzVbXkGoPfISCQxj06bfeMpLNeE6e2BWym2BL//0u1D/M5sHDXAYEsJ86al9Xs47JGo9yeUlP5V7fScrmWcA8YnmqSa5jkuQAlzze+QJbAFP1d8hbMBWSTBaUbE+FKaQGtMVTaE9MKpvCemFU0hOFU0iOFKYxHCqYxGmKo+M4VRyHFKNQ9MKo1DiqLQ74VRSHviqKQ98KEUhwqiVOKFdcKEQpwoVhhVWBwoVVwoVRhYqowqqD9WFC8eGKFQfPChePvwoXDFV4/DChVGKqyb/wBcKE2so+Tr+vJBBe++QdGSQi5kSqRitexPbK88+CPmWAFl7B02GwHQZrm92KuxVjet+WbHWInqohuCDxlA2J9xmTi1Jhsdw1Sx9z5y8y+X7nSbmWKaIrueJ8R2NR45n2JCxyYAsGkUg0yKUOa7YEqZwoW1xVbihadsVWHFC0++KqZ+jFVI9cUKDjriqGcYqgpR13xVKp12I8MVY5fw1VqjIlLDJouEhHSuUyDILeOQZO4Yq//T7UKZnuG2TQe2KXhXmrU/ruo3Dq1Y0Ppxf6q7fjmPM7t8AwOabc75SS3AJeZanrlZLYA4SZG2YCKjetMCaTGFumFU3gPTJKnEJ6eOFU2hPTCqawnCqZxHphVMojiqYRHphVHxnClHRnFUbGem+FUYhxVGIfDCqLQ9MVRSHChEocVRKnChEqcKFdThVXBwoVlPTChWB3wsVVd8KFQHCqoMUKg/DChUGFC8YVXDFCoDhQvBxVEIenthQyLSV5TR96kADJxDEvrLy1Yix0i1Ugc5VEjU3FD0pT2zB1M+KddycY2tP8x2x2KuxV2KsB/MLTILvRzdsi+taGgk2B4t2r86ZmaOe5i1ZB1fLl2tJH8K/RmWWIS1silTP+3ihYT198KtVxVZihbXFVhxQsOKqZxVRYe2KEO+KoOQYql0y9fbFUluo6hv1YFYdfRcXr4ZXMMgguPTKWbuOKv/1O1jM9xEm16+Fhpd3ODRynCP/WfYfdkZGgmIsvnS9nLM1T1zFkXJiGPzy7nfKiW0BBGXfKyW0Bej++RtlSOibphSmsBwoTiA9MkFTiA9MkhNoT0wqmsJwqmcRxVMojhVHxn+3ClHxnFUdGcKo2M4qjEPTCqMQ4qjEPQ4VRSHFUUhwoRKHChEocKq6nFCupySFcHChVXthQqqcKFVThQqg/2YoVBX+3ChcMKF4PXChUBxVeDhQuB8fwxVXQ7jvhQn+lTiKeNidgQd8nFjJ9gaBex3+kWFxEaj0lRh4FQBvmv1EeGZ892UDYTjKWbsVdirsVee/mJqiWukGzVh6l0auvcKPb3OZujhzk1ZD0fL944Z2I7k0zKLEJY33nIpUycVW1/DFCwnFVp64ULa4qtP68ULD/mMVWHFVFu5xQoP8sVQj/LFUDKMVSm4WoIwKxfUItj45EpCRgdu42zHLY6nhir/AP/V7X0B9sz3DeZ+f7/hFa2at15SyD8F/jlWQtuMPEbuWpO+Ysi5EQkcsm+VSLcAhvUyslsAV42wWypMYj03yQVN4D0yQQnMB6ZJCcQnphVNoW6fhhQmkLdMKUziOFUxiOFUwiPTFUfG3TCqOjbFUbG1cKo1GxVFo2FUYh6YqikOFUUjdMKEUh6YqiVOFCIU4UK6nChWU4WKupwqqg4UKgOFCqDhQvBwoVAcKFwOFV4OKFQHxwoXVNfpxVVVsKEbBKVYEYQh6p5Q863GjMIi3qW7kerCTUH5b7HfthlCOQVJhuNw9307zXo2oqClyIHO3pykDtXqDT76Zhz0s48t/czGQdU/SeCSvCZHp14sD+rKDCQ5hlxDvUJtQsrdS011GgXr8QJ+4VOSjhnLkFMwOrENZ886bYxuto4nn6Bjso+XjmTj0h5zazkvk+f9f12bU55JZpCxYmpPzzMJHIMQGGSyVJ365WWSFY/Tiqw998VWE1xQtriq0nFVtcULSf8AMYVWkjFCmcVUmOKqLYoQz98CoKQbYVSyYdcCWP3sfJW8MBVjDCjkU65TMMw0e/68gl//1u0OdqeOZ7iPAfOl/wDWdVuqNVIT6Sf7Db9eY2Q7t8Bs8zuZeormPIuREJRJJU5QS2xCkGyFtoCKjbEFKZQnpkwhOYD0yQQnNua0yQYpvC3TJKm0J6YVTSI4VTOJsKpjE3TCqPjbpiqPjbClHRtiqNjbpvhVGo2KEYjYqjEb6cKopGxVFo3TChFI2FCJQ++FCIU4VV1PTChXU4UKynChWU4UKgPbChVBwoVAfwwoXA9MKF4OKrwcKF9cULwfwwquB3xVWV6EGuFCLinKEEGnvhBRScW+qzRdHI965MSY0nEfmS7QcVnYClDvkuMo4VsvmO8kqWnY1G9TtjxleFJp9RkkLFnqT75ElNJZJMWrU5FKGZ64qpk4qsJ/HFC0nxxVonr44oWHFVpJxQtJ+7wxVaThQswKpMfwxVSbCqGem+BCEk/HFUvlxSkt0tQcBVid2vCSvvlcwyCHr/acqZP/1+v3s4t7e4nOwhjZz9ArmeXED5c1W5aSaV2NWZix+ZzDmXKiGJXEm5/HMeRb4hLGapyiRbohteuQttpFxYQUJnCemWBBTeA9MkGKc27dMmEJvC2FU1hbphQmkLYVTKJsKplE3TCqPjbphSj426Yqjo2wqjY2xVGo2FUZG3TFUZG39uKEWjdPfCqKRsKEUjYUIlWwoRCNhQiFbChXU4UKyt03woVlNcKFUHChUB6YVVA2FCoDiheDhQuDfjhVeDihcGwquBxVeG98UKgany7YVXiSg2OKqgmPjhQ36p8cbVaZK9ScVWF8VW8sULeVaEnFVpOFC2p/28Var+OKGq/7eKrK4oaJ/DFVte+KFOv04qsOKqLHt2xVDtihCydMVQMo64pSi4Gx74FYtqCdTkCyCUhtgTlTJ//Qn/nC7+raHeEGhmKxD6Tv+AzNmdnGiN3zLfy1ZvnmFMuVEMbnepzHkW+IQo3OY8i3xCuo6ZC2ykRH1GTCCmMJ6ZYGJTaBumTDEpxA3TJoTeFumSQmsLYVTSJumFUyibphQmMbdMKUfG3TFUfG2FUdG2Ko2NsKo2NsVRkbf2YUIxGxVFocKotDhQikbFCJVum9MKESpySEQrYUK6nChWVu+FCsp/28KFVWwoVAcKqoPbCheD+GFC/lihdXCq4HFC+uFV3LFV3LFC4NhVdy/DFV3L3xV3P3pirfLChrlvirRP4Yoa5eGKtVxVbyG+FDuX4YoWkjFVpOKFpOKrSfpxVaTihSJriqmx64qoN/biqFf9WKoKTeuKpXONjgVjl+tVORKWMlqEivQ5UWb//RPPzHuvTsLO3BoZZGcj/VFB+vMrKdnHxjd88XstS2YUy5cQkcjVOY0y5EQ2i7V8Mxyd3IiESF26ZG2dL1FDlkSxIRsR6ZaGBTWFumWBim8DdN8kGKbQtklTWFsKE0ibpklTKJumFUwibFUwjbphVHxtiqOjbCqNjbFUajbfqwqjI2xQjUYbYVRaNhQi0bviqKRsKESrYUIhWwoRKt0ySFdWwoV1bChWDHChVU4UKgbCqoGwoVA3XFC8HCheDhVdyBxQu5bYVXcsVXcsVb5YoXBvf5YVb5Yq7l9GKu5e+KHcvpxVvkO+FWuVffFDVffFWq4oW1/swoarirRI8aYoariqytOmKrSa/1xQsJxVSY4qoMTiqHf8fDFUFJ39++KpdN3wKkF4oo2RKWH3B4ysPHKyyf/9JP8zbn/TLWAHaKCp+bMf6ZkZi043hd29Scwply4hLNycxZlyYBMooeSj3pmKZbuSIolo6DpgBZkKBFMuiWshERmlMuDWUxhbplgYlNoG6ZIMU2hbpkkJrC3TJKmcTYUJlE/TCqYxN0wqj43xVHxt0wqjo2wqjUbpiqNjfFUajdMKEYjYqi0bChFo3TChFK2FUUjffhQiEbthQiFbChEK2SQrhsKFZWwoVVbFCqGySqgbFCoGwoXhvuwoXBsKrw23XFC7liq7lhVsHFVwbpihvl92Krg2FXcu/jirfLFDuX+YxV3Lb+OFWqjFDXLwOKur74oar1woaLe+Kra4q1WpxQ1WnU4qsJpihaTiqkx+7FVFjiqGc4qhJOnbAqXTHriqSXXQ98iUsK1D4ZAe5qMrLJ/9OO/mPcc9cuVrtEiLT/AGIP8cuzHdrx8nj1w25zBmXLgFGFeTDMTIXKgGT29uaLtmHKTmRivmhoMYySQlki0OZMS0yDk2y4FrKPiO+WBgU1hbpkwxTSFumSQmsLdMkhM4m6YVTKJsKpjG3TCqPjfCqPjbFCOjf3wqjo2wqjI3xVGo2FCMRvHFUWjDChGI3TChEo3vhQikbCqIV8KESrYUIhW74UKythQrhskhVVvffwxQrBsKr1bChUDeGFC8N2wqvDYoXBsKF3LFV4bFW+WFV3LFDfLpirYbCruWKt8sUO5Yq3Wnzwq6vvihqvvirg3fFDXLan3YUNE4q4HcYoW8j/AExVqv4YqsJ/sxQtJxVSY9cVUWO36sCodztiqEkOKpfKfuxVJ7k7HIlLCtV2IPgeuQKX/9SB+e5i+u6ma1pMy/8AA7ZZmO7DHyeYzGrHMGZcuARliheRPc5g5S5uMM8trTZdu2YEpOfGKldW5AO2ThJZRY5OnE5lQLjSCGHXMiJaSEXEemWhgUyhbpkwxTWFumSCE3hIFK5MMUxjalPDCqYRP0wqmMb4qmEb4VR8b9MKo6NsKEbG+Ko2N8KEbG/TFUWjYUI2N6YVRSPthQikb3woRKNhQiUbChEq39mFUQrYUK6sO2FCsrYUKwb3woVQ2FCoG6YVVA2FC8NhQvDYqvDeOFV3LpihcG6Yq3ywq2G6/jihdyxVdy9+uKu5dcKu5e+Ktg4odyp7DFW+Xv0wocW64oa5Yq6v9mFDVcVar0xVrlihsEYqtY4oUicVU2OBVFj4Yqh3OKoSQ4qgJT74EpRcdD2wFWG6vTifnkCl/9XmHnGXnrOpt43Mv/Ejks3NGPkwBzVswMhcuDINGi53EQ981+eWzn4RZesW1gaCq1+EHNXLI7aGNL9QtOAbvt4ZbjkwyQphV7Fxb6czsZcKYSphQ5kxLjyCohy4FrKYRN75YGKZwtuMkGKcwN0ywITFW6YqjYn6YVTGNsKEwifp+rCqOjf3+jFUfG+FCNjbCqNjbFCMjf78Ko2N+mFCMR8KopHwoRSP74UIlHwoRKPhQilbChXVsKohXO2FCsrYUK6thQqBsKFUNhVUDfLCheGxQvDYVXA/TXFV4bChdy+nFVwbCrfLFDYbFW+W+Kt8u+FV3L6Tih3Lr2xVwbfFW+WFDuXh1xV3LFDXLFXE98KGq/7eBXE4ULgcVWsdsUKBOBVhP+1iqgxr7Yqh3P3YqhZDiqAlP6sCUquDsd8BVh2r/YbIFk//1uSebHrquo7/APHxL/xI4c3NGPkwmtXzX5HMxsz8tx8723Xrvms1J9Jdnphcg+hLLSiwI4V/divcjoeuaGWV6LHgtj2sWBXkSpFR4UzKw5HGzY6eZ6nBxbNnik6zLFjkqUJzLiXFkFNdjl4LUQi42ywMCmcDbjJhiU4hbplgYpgr7D8cKo2J+mKpjE/TCqPjfphVHxvhQjo2woR0b/R74qjY26YUIxHwqjEetMUIyN8KEYj++FUSj++FCJR8khFI2FCIV8KESj4UK6thVXVsKFZWwoVVc9cKFUPhVUD++FCoG98VXhsKF4b32xVcG/DChdyxVvliq7lhVsNihdy+jFXcvxwqu5YodyxVvl3xVuuFDq4odyp9OKu5Yody/HFWicKtVxQvBxVpjtihQLYFU2Pjiqix/DFUM7fTiqFkbr3xVASHAlK7hutcCsQ1U/A++QLJ/9fj/m001fUh4XMo/wCGOHNzXHyYYm75rsrm43oXlBQ2p2g8WzU6s+gu10Y9YfY+kaLzQ0UgCAbU4khyaHfp065yGXPR+L3mm0lj4MM8zaYY2kpRupB3+zuRSu+bDS5bdZrcHCXiet2xV+n7WbvBJ0GeO7C7mOhOZ0C4Uwl5FDmREtBCqhy0FrKYwNuPfLAxITiFu5ywMEaH3AwrSNifFUxifChMI36YVR8b9MKEbG/9mFUdG/vhQjY3+7CqMR8UIyN8KEaj9MKEWj4UIpH98KESr5JCKR/xwqiUfbrhQiFf3woV1bCqIV8KFZWwoVVbChVD9MKqgfFCoGwoXhsKrg39uKrw2FC4Niq8NirfLChvliq4N1xVvl1/XirfLthQ3yxVvl9OKHA+/XCrfLfFDfLFXV674q1XFDuXj9GKtcsUKgOw98KrXagxQhycCqZbFVFmxVDu2KoSRuuBKBlbriqUztsfbIlWJaoaqcgWT//Q5B50X09c1VT2upf+JnDn5lGLkwmM/GPnmtyudjekeTX46tY7dZAKD/M5qdYPQXb6L6w/RjQLNI7a3kXZZbZSFrWik1Ph3/zGec55kyI831nBAQgCO4ME86aVEEeSPbnViKUHTp9ObPQZjyLq+1NOKsPmnzJaem1eJB5jY9d86jTTt4vVQovPL2Clds2MJOunFIZFoT2zKiXGkFNdjlwLUQi42pTLAWBTWKbYZYCwpGRyVPzw2qYRPSmFUwifp+rChMI36ZJCPjfFUdG+FCOjfphQjUfCqNjfphQjI3woRkb4UItHwoKKR8KEUj5JCJR/owqikfp74UIhX98KEQr4VVlbChXD4UKwfCqqr++KFQNhQqBsKrw2FC8Niq8NihcG+nCq4Niq7lX2woXcsVb5Yq3yxV3LChdyxVvl70xVcD9+KHct+uFDfLFXcv8AbxV3LwxQ1yxV3LFC5XAG+FVjPX5YFUi2KqbNihRZsVQrtgVCyNilAyt1xVKLhtvfIlLFNQarBfcDIFL/AP/R5T+YcfpeY9WXcVnZv+C3/jk9QN2OHk8+jPxfTmsyOfjZ75YmMWo2UgJqsqEU+YzV6oXEu00pqYL9NfKpSfTtLZeQMtvtzBB5bUrUGoqD888y1O05e99YjO8MT0oIfzNYrNBL8PPjViqn/MHrlulyUWU4+Jiovlfzlp/oiUgA8GB+HoKHOu0WS3ie0MPDbyi/tqBjTx7ZtscnS5IsQuYqE7ZmQLhyigCKZkRLSQqI2WgtZRkbdMmGJTCN8kEJhE+SCExifChHxvkkI+N+mFCPjfphQjY3woRsb1phVGo+KEYj9MKEbG/vkkItH6YUIpHwoRSNhQiUfChEo+FUSrbdcKEQr4VRCv0ySFYPihVD++FVZWwoVA3vhQqhvuwqvDe+KF4fCq8Nihfy998Kth/emKrw3vihsNhVcGxV3LfFV3LFDYauFVwbFDuWKruXvthQ3yxV3L/bxV1cUO5fdirXLFWq4oWluuKrC2KqTMfHFVFmPY4FQzNiqEkb/axVASt92BUouX2OApYvdNymjXr8Qyspf//S55+a8HpeZbtqUEyRv96Afwy3Ujdhh5PJ4zRs1eRz8bLtGl9OeFq04spG/gc12YWC7HAaIfpl+XN8t3oOhzJuUUIxqak71ALe1M8z7Rhw5ZB9V0shk0kT5M11WIPGQVBLj4h2oNq/cBtmNiLkaYvnTz3pQMFyyxhQwalDtyAr4eGdL2dm3DpO2NPQJeB3dsHiD02IBr886GMqLyk42GD31uVLbdMzccnByRSCRKH+GZUS4sgpDbLgWshEI2WAtZCNjfJhCYRvkghHxv0woTCN8khHxv0woR0b++FCOjfChGxvhQjY398KEWj++FCOjf3woRiP0ySEUj4UIpHrTChEo+FUSj+9MKESr4UIhXwqiFb8MKFZXwoVlfphVWD4UKobChUV8VVA+FCoHwquDYoXBqYVXhsVXcsULg344quDV+jCruXXFW+XviheG74VcG6YoXVxVvlirfL8MKG+WKu5e/yxQ7l/tYq1yPjirXLFC0tiqwtgVSZvfFVB2xVDO2KoORvE1wKl8zbHfFUnuX2ORKWO19S8QeFTkCl//9OMfnNbcNRsbmm09rxJ90Y/1zI1IasJeDqaNmpyB2GNkWnSUZT4ZgZA52Iv0D/JXWTc+X4LfkGaAowQbsexqDWu9O39M8/7aw8OW+99N7By+LpuE9Hvd3Kso7PQDm21TWm1ATTuc0sBTscUTF5b5rsVmgkNN2DJv3FK1qR1oM2ujyUU6/EJ47fMdxa0E8RX4oHdGB6ijGg+7wzrBLke94SUKsdzB9SteLMKeOZmObgZYMOuYuJO2ZsJOFOKXMKHMiJaSHKctBayEVG9MmCwR0b9MkEI+N+m+SQmEcmSDFHxvhQjo5MKEbG/TChHRydMKEaj5JCLR+mFUbG+EMUaj4UIpHySEUj++FCJR/fCqKR8KESr4UIhXwqiFfChXV+mFCsH6YVVg+FCoHwoVQ2KqgfCheHxVUDeGFVwfwxQvDf7WFVwb3xVeGxQu5YVdyxVdy/DFDfLFV3LChcG/DFW+WKt8sUO5YVb5Yoa5e+Ku5Yqt5f24oW8sCqbN4YqpM3XFUOz4qh3fFUFI/XAqXzPQHfbAlJLqTY79MBSlFiPUupGpsqn8crUv//Ub+ctkZNK06747wyvE23aRQw/4jmXqB6XHwnd8v1o2anIHYwKcWT0IzAyBzcZfXX5F64sAFvIRxEoWhrvXem3bOR7dwXuHufZnU1cT1fXzyF0/nDdKb0Dd6nOSD2QjRY7q6iS1lDASFxzUdAtAaEGntXMrCakGWWIMCHzdrNn9X1i7jOwlAkHIbmvwnpt92dVgnxYwXh9Vi4MxDB9Vs/iai1/z+WZ2Kbrs2NgF9bFS23Xpmfjk67JFjk0ZBO2ZUZOLKKFO2XxLUQqo1MsBayEXG/SmSDFHRvkwgo+N/fCGKOjfJIR8b4UI6N+m+SQjY398KEYj4UI2OTChGxyYWKNR8khFo+FCJR8khFI+FCKV/fCqIV+mFCJV8Kq6vXChXV8Kq6vhQrK/TChVDYqqh8KFQPhQvDYqqBsKrw+KF3LCqoGxVdzxQu5YVdy8cVX8sVbDYoXBsKruWKGw2Kt8vwxQ3yxV3Lpih3LFWuWFVpbAhaWxVSLYqps3XFUOz4qhHf3wKg5H64qls0nXfAlILyWgNciUrNGXkJ5T3IUfRvkFL//1ZV+ZFj9e8p6kAKvalbhf9gaH8Ccz8ouLi4zRfGU3wyt7HNRlDscZRtpJQjMHIHMxl7V+WWrmx1ZVEnDnQg1p7HcexzSdp4uODv+yM/h5X3bp2qx3en20xowZaP86DYr1APhnCZMRjIh9Rw5RkgJd7VzdRs8iLUEKHaOh+KpoKnfb4qdNhk4RLKUwDTxvznAIr21vIxWPkYpaCgAbx2I6jN/oJXExLyfasOGYkOXJhWo2wkj5hOorXM7HKi6vLCxbz7UbTdts2GObrMsGG3UFCfbMyEnCnFJ5EocyIlokFIGhy4FqIV0amTBYEIyN8mGJRscmSYo+OTpkkI6OTChHRv03yQYo2OT3woRscnvhQjI5MkhHRSe+FCNST3ySEYj4UIlHwoRSPhQiVfpkkIpXGFUQj4UIhHwoV1f3woV1fFVYPhQqq/TCqqHwoVQ/wBOKrw2FCpzwqu5e+KFQP8ATiq4NhVeGxVeHxQ4NhVeGxQu5Yqu5YquD4UN8sVbDHxxQ3yxV3LFDuXj9+KtcsVWlsULC2KqZbFVBnxVDuxwKhHfrviqBkfbrilLJ5OuBWOX8tFYVyBSE50iPhZRk7GQlq/hkVL/AP/W6zqlot7Y3tmwqt1BJEf9kpGbIi3CD4M1SB7e7nhccWjdlYHsQaHNTli7HGVG3ehGYGQOZAsz0C+NpfWs3LiFcciPA5gaiHFEh2GnycMgX2d5P1xfqixk8mbiRIOJYEdDv40p93XOO1mDe30HszVgRpnf19pl5NL8DgiKMsSabE1INT4VzCGOnb+PxDnt0Yl5hiF9YzIn2ioZBT4hQChr47Zn6WXBIOp10fEgQGARObm2UsPiX4G+amhGbOQ4ZOlieKLGdRtQedFp361zJxzcTLBg19bbmgzOxycDJBjFxDQnbMqMnElFLmWhy+JaCGlOWgsCEQjdMmCwIRkb5IFjSOjkyYYo2OTJMUdHJhQjUkySEbHJ92FCNR8KEdFJv1yQYo6N8KEWknvkkIpJMKEUj/7eFCJR8KESr4VRKvhQiEfpvkkIhXxVXV8KFZXwoVVc4VVVfChVD4qqB8KF4fFV4f8AtwqvD4oXhsVVA2FV3LwxQuDYquDYVXBsULg2Krg22KFwb3xVvn2wody964q3y98Va5Yoa54q0WxVTLYoUmfFVBnpXAqGd/fFUHI+KoCWTrgSlM8uxwKxm8kLuqDfkwFMgWQZzAnowRRfyIFP0DAxf//X7O42r4Zs3CfGf5n6WdN806kAnGO5f6xF7iUcj+NRmv1Ed3Mwy2edxNQ5rcgc6BTy1loVIO4O2Ykw5cC+hvJetk21uTJTjRWX3Gc/rMO5el0Go2G72qDUhJGrq3w8eJBHYb7n3H+ffNOcdF6OOexbct36sfpF2oAahutWA33PTbJxhRtEsnEKYKpNrqNxbnaKerxk/wAw6/1zZfVAHudP9GQjoVK+iVq0G3Sm2HGVyxthl/b9dvfMzHJwMkGH3lvQnbMyEnCnFIJoiCcyYycaUUGRTLgWkhcrUywFrIRCP75YCwIRkb075JijY5PfJBijo5OmSQUbHJ0yQQjY5OmFiUaknvkkI2KTcb4Qgo+OTJMUYj4UIpJOmSQilfChEo/TfChEo+FUUj9MKESknTChXV/fCqur4UKyvhQrK+FVZXxQqh8Krw+KF4fCq/niq8PhVUDYoVA2FV/LbY4oXBuvhiq4N2xVcHwoX8vpxVsNihdyxVvlhV3PFDfP3xVrnihotTFVpbFVJnwKpM+KFBnxVCO/hiqDkk64EpdLJ13xVJbqbY75EpSiwX61qkKdVQ8m+Q3yCWf8sLF//9DtLbjxzZuC+fvzt0kvBpuron2eVtOw/wCCT+OY2ojYtvwnenzTXi2avIHYQKZW8lKZhzDlwL0jyhqbQTtByID/ABL8xmt1eOxbtNHl4TT3XTdUZkUFgGAoBTx7+2aXJiehw5k7S+q6/s+1d69um22V8DkDJulGsEkx3SUMkJDIOhIXqNvbbMjT9x6uNqf5w5hr1xPGsgaqspP0dO+S4aNI4uIWkt3HyBY+5Nfvy6BaJhid5APi2zLhJwpxYvdQ0J2zKhJxZxSeRKHL4lx5BD5cC0kL1amWAsCESj5MMCEXHJ0yYYlGxyZIMSjUkyTEo1H98KEbHJkkI6KTfrhDFHxyZJCMR8kEItJMLFFI5ySopHwoRKPhQilfChXR8KESsnvhVEq+FCur++FCsr4VVVfFCoHwqqB8VXh/DChUDdMVXh8KqgbFCqGwqv5YoXBvoxVdyxVdyOKF3LcYVb5YquDYob5Yq7lih3PFWue2KtF/HFCwviqkz9cVUWfFUO7/AI4oQjydd8CUDLJt1xVK5pRvgVIL2egY1yJSi/LERZrm7Pf4EP4nIhSy4thYv//R7TXNm4LEfO2jjWvLeqWQXlKIjNb+PqR/EAPnSmQnGwziaL4aukMUrqRQg5qskXYQLcD0IzDmHLgWQ6fdNBNHKpoVIzEyRsU5eOVG3tWlaiHjidW2YVHtXfNNkhu7zDk2ZTHf0IblU0qa9Mo4HLGRWa6DoQB1oNunfCI0kzsJdZ3vpSSWrmij4oj7N1p8svnGxbRjnwnhV5pgeQO/+1kIhslJI7ojcDMiLjzY5dIDXMiBcaYSCdKVOZMS40glrihy6JaJBTr75aC1EKqvlgLAhEo+TDAhGRydMmGJRscmSDFGJJhQjY5K5JiUfFJkggo9JPfJMUWkmFCMSTpkkItJMKEWj5JCLR8KESj4UIhXwoRKt0wqiVauFCurbjfChWV8KqivihUD4VXh8VVA/wDt4UKoY4qvD9MVVQ2FCqre/wBOKr+W38MKFwbFV4bFV3LvXFDuWKruW+FW+eKG+WKt88UNc8VaL7YoWF8VWs/bFVFn74qoO+KoZ5NsVQckmBUvll64qlNxNsflkSli1/PWqg/aNBkSkM70iH6rYW8Z2Zhzf5tviGJTPnhQ/wD/0u0Zs3BWsARQ9+oxS+KvzI0I6J5kv4ETjbyt69r4cJNwB8jUZr88KLmYZWHnqNQ5gTi5sCmkElKZiSDkxL0Hy9qJKegzbp9n3Ga/UY97dlpsm1M4iu6jrSo/jmIYudGaKS9I6k+wwcDMTQ11cEMsyH4kNfmO4y2A6Nc5dVYXwkQMCKHfr44OCiyGS1CWflU1G/XJAIMkrmcNloailE4Brl0S0yCVSr1y+JaJBCN1y2JaiGgafRloLUQrI+TBYEIpH98mGJRccnvkwwKNjkyQQjY5OmSDEphHJt1yQYo5JOmFCMST3yQYoxJOmFCNjevXJIRaP0woRSPkkIpXwoRKPTCqIWTChErJhQrLIcKFdZMVVRJhVUD4oXh8Kqiviqqr4UKofFVQNhQrK2KqgbFDfLCq8Niq7nihxb3xVwfFV3P3wodzxV3P+3FDueKrS+KrS/f8MUKZf3xVRaTFUO0nXfAqFeTFUDLLt1xVLZptjvgSkd1Psd8iVSexjN/qcMX2kVucnyGR5lJelhwBTsBk2tvmCetK9W8MVf/T7PmzcF2KvFfzl8v/AF7SINZhSs2nN6dxQbmJzsT8m/XlGeNi27FKi+T3UoxHhmsnFz4FEQyUOYk4uVAp9Y3RglRwaU6+4zGyRsOVjnRZ7Beh0VlNajbMAwp2EZ2jBd7bHvg4WfGvN1yFK1wiK8ShHdFGKV+E7r7HuMsMbYiVIgXPYnI8LLiUXl9+uSAQShJGrkwwKAly0FrkEC+2WgtRCgTloLUQuVssBayFdX75MMCEUknTfJhiUZHJ0yYYlMInyQYFHJJkghGxv0yTFGxvkkI+NsIQjUkyTFEo/TChFK/vhQikfJIRKP74VRCvhQiFf3woV1fFCusnvhVWD4VVA/vihUD4VVQ+KFVXwqqhsVVVb3woVg3hiqoGxQu5e+FXcx44oXh8VXFqjFVvLFW+eKHc/cjFXc8UNc8KrS9fbFVhfAhSaTFVBpMVQzyYqhJJffFUvll264FSmeelcCWOX11QNv0yJSnPle3Kwy3rj4pzxjr/ACjr95wxDGRZaHyTBvmveoO9T1+WKv8A/9TspObRwXYFQWoWcOo2V1Y3K8oLyJopB7MKYkWkbPhLzLpE+i6re6fOtJLWVkJ7EdiPYjfNZlhRc7HKwkCkg5hzi5cJJhDJmLIOTEsi0+8KERk7Hp7ZjZIdXKxTpPFuD45TTfxKy3HvhpPE08vIdaEb4QFJXJc1FO464TFRJV9eo640ytTMlcNItRZ65MMShXyYYFDk75aC1kLOWWAtZC9XywFrIRKPU5MMCjompTJhgUYkmTDFHRyZIIR0bV75IMSj426ZIMUakmFCLSTJIRaPhYotJPfCqJR8LFEo+FUQr4UIhXwoRCvhVXV/fChVWTbCqqr4oVVf33wqrK344oVlbCqqrYoVQ+KqobChUD4qvD4q3WuFDfP36YquD4qtL4oa54q7n74q1zxQ0ZMVWl8VU2k98VUWkxQh3kxVCvLiqCkm674FSyabqcCUlurild8BVjUhe8uorWPdpWAGR5p5PULeNLaGKCPZIlCr9GWNRV+fvhV3P8emKH//1exV/HNo4LVdvn4Yq6uBL5//ADo8terHb+YraOpWlvqFB/wDn9X3Zj54WLbsMq2fNLDic104udAqkb0OYk4uVApjFIRQg5SQ3Ap7Bdc1AJ+IbHMeUaLkxlaJE243wUytUE3vjSbd6tDUdckEWqrN740y4l/q1740m2i9R1w0i1NmyQQVFjkwxKiTlgay2G3ywNZRKGmWBrKLRz2yYYFGRtkwxKPjbpXfJBiUfG9Kb5MMUZHJ74WJRiSZJCMSTChFpJkkIpX98KEUsmFCJSTChEpJhQiFk74UK6v0wqrLJhQqiTFVZZPfChXV8VVlcYUK4bCqqH7YoVQ+KqgfbChUD4qvD4qvD1wodyxVvnirueKFL1MVdzxVr1MVW+pihYZPfFVJpMVUGl+nFUM8uKEHJNgVASzbYEpTPcdd8CsbvbviCa5EpTLyraF2l1KVdt0t6/8ADH+GSgGEyzjl75Ywdy/sxVvlTFD/AP/W67Xv4ZtHBdU4qtJxSgNTsbfVdPutPukD295G0cg8K9CPcdcBFhQafDnmTRbjQtWvdMuRSS2cqGpsyndWHzGa7LCi52Odhj1aHMKcXKgUVFJXvmLIU5UTaOilKkUOQItmDSYpPyHXfvlZjTcJWrCX3wUm14k98K2uElP44aTaosuNJtf6mNJtxf3wgItYXyQCCplssDAr1y0BrKurZMNZRKE+O2TDAo2N6UpkwxKMjfbrkgxKMR/uyQYlGJJkkItJPfChGJJ0yTFFpL03+WFCLR8KEUj9MkhEo/vhQiVf3woRCvhVXV/ffChVWTFVVX98KFZZMUK6ydMKqyy4UK6ydN8VV1fChWD4qqB8KFQP9GKrw+Krw+KG+eFWueKHc++KqbPQ1xVZ6nviq0yUwKsMtO+FCmZPfAqk0vvXFUO83viqEkm2PtiqBlmFOuBUsmuKV3xVI7q6pXfIlLHf3uo3kVnDu0rAH2Hcn5DfABZUmnrFrBHaW8VvEPghUKPo7n55cA0kokNT+mKHcuu+FXcq7dcVf//X6wW6ZtHBW8sVcWxVaWxV4z+bnlQ6npo8wWcRN1pi8bwKPtQmpqfddz8q5TmhYbcU6L5cdfDNbOLnxkpBihp2zEnFyoSRqSe+UENwKJSUjocSLZA0iVlyumwFVEmNJtU9T3w0trhJ74aW14kxpNr/AFMIC21z98mAxJXqfpyYDElVFTkwGBKqu2TDAq6t75MMSiUfJBBRaOMLEotH98kGKLSTJMUYkmSQi0kwoRaPkmKLSTChFJJ74UIpJMKESj4VRCvhQrLJhQrK+FVZX6YUKofFVYPhQrK+KolH98KEQr4UKofFVQPihUD4VX88ULg+KrhJ774q3zwoWc8VWs+3XfAqgZMVWGTauKqZlxQpNLiqg02KoZ5vA4qg5J/fAqXTXHv9GKpNcXNK74FY1e3lAd9+2RKWXeUtMaGBtRnX99cikIPZPH6f1ZZAU1zLMq9cmwbrirq4obrir//Q6kXLGrMSQAKnegAoB9AGbVwVpbFVvKlMVWluorilSkCSI8cih0kUq6kbEHYgjAr4/wDzA8rN5Y1uRIkP6MviZbB+wH7UdfFf1ZhZ8dOXinbz91zBnFy4yaRyKDMWUXJhJFK+VNqsr4atbpWWTBwshJUEmNJtfzOEBeJUDHCIrxKgY9MmAx4ldQMkIoMlUGmSpja4H3wqqK2SQrK2FirK2SCCiUfJBiUUj5IIKKSTJMUYknvhQjEk6ZJiikkwoRaSZJCKSTChFI+FCJSTChEpJ74UK6v3woV1bCqsr4oVQ/bCqqr4oRCNhQiFamFVYSe+KFUPhVVEnviheHxVd6mFC8SYq36nv88Vb9TbFDRf3xVZ6la9sVQ7SbkVxVQaXFVIzYqotN74oQ7z++BUG8/viqAluMCpVPc9d8bSkF3eUB3+nIkqoaHpz63qIVq/VIPjuH9uy/M4YiyiRp7IiqiqqgKqgBVHQAbAZc0rq7U7DpihrCrf0Yq7v74q/wD/0elcv9rNq4LXKn8cVcW8cVWFq9ehxVaWxVi3m3y7beaNHuNOmASahezuKbxygfCfl2ORlHiFMoyovji8s7nT7u4sL2Iw3do5jmjPiP4HNdlhRc6E7CXutNxmJOLkwk5Xp1zFlGnJjJEK/wDt5FmrK+SDFWVslS2qgjDS2qKSTQYQFJRSCg98mAxtUFe2GltUDf7WKqgOFVwwqvDYoVlb/aySFZX98kEIlXwsUUj++SCEWj98kxRSSYUItJOmSYopJMKEUknvhQikkwoRSSdMkhEpJ74oRCvhVWWSmFCssmFVUSf2YoV0fChEpJhVEB/fFCqJPfChUEmKqgfCheJMVX+r74oXCTFW/UphVv1PfFDvUxVTeSm+KoWSTcGuKoV5cCqDTDxxVQefrviqEknp3xVAy3HXfAqWTXVK70wKkd1eUrvgVIazX9zHbW6mSSZgqqO5OAbpJp7boulRaRYx2yCsh+K4lH7Tnr9A6DLwKaCbTamFDqYocRTCrdMVdTevXxxV/9LowYdCSOtKZtXBWcvfFWq+HfFVpOKrSdqV2wqtrgV5B+aHks6xanXdMirqlin+kRKN54h/xsvbKsuPiDbjnwl82CjrXv3HvmunGnOjJDupU7ZjTg3xk5X98xjFyQVZWwBKIR8sDFEJVumSAQSjEFPn45MBiSrA5JFqgOK2v2ONJtcMaW14OKr+Qp1wqvXxwhVZThQrq1MkhXV8LFFI+SQikfpkmKJST3woRaSdMKEUkmSQiUkwoRSSdMKEUknvhQrrJhQrrJihXVsKqyvhQrq+FCJWTCqsJPfFCqJPfFVUSYULxJ74qu9TsMUNhziqoJfvwobEle+2Kt+phQtMuKrDL4nFUJNJQV7YFQLzdd8VQrT9d8CoZ7j3xVAyXFK74ql011Su+BUluLyld8CWPXN20jcVNScir1byZ5d+owDUryOl5cL+5RhvGh/icuhGmqUrZ5TJsG6fq3xV1D1xQu4t2HQEkdcKuHQ7VqNj4Yq4Lir/AP/Tn/LNs4LVaDFWiduo+WKtvI0js7sZHclndjUknckn3xVSr9J98VW1/wBrFWifpr1xV84/mX5HbTLiXzHpENbCduWpWyD+6c9ZAP5T38Mxs2K93IxZK2LyIgOtRuDmvlFzIyQjoVPt45jzg3xk0rUOUEU3goqLfc9MnEIJTGMgZaGsopThVUHb9eFVVcVXjCtrxiq/FNtUIII3xpbVFPjiFVRWlRhQqqckhVVumFCIR8KEQr9N8khEJJhQiUkwsUUknvkkIlJPfChFJL74UIpZemFCusnvhQiUk+/CqIWTChXWT364UK6yYqrLJhQrCTFCqJPfCqoJMUKgk71wqvEgxQu9TFW/UHWuFDfq4q0Zvf6MVWmXvXFCm0w8cVQ00tVO+KpVJPTauBUFJce+KUFJde+BUuluvfFUouLyld8FqkNxdljQb16DIpZ55I8sNdyJq9/H/o6GtrE3+7GH7W/YdvHLIRa5y6PYwO2WtS6ncb+2Kup3riq7jt1+eKHcRTata9KYq3Tx7YVdxBqa7joPH2xV/9Sd1zbOC1X8MVarirWKramvWmKuYr+ySRQdRTem/c98VWE/RXFVKaKK4ikgmjEsMqlJI2FQVIoQRir5c89+SZvK1219Yo0ug3bfARubdz+w3t4H6MxM2LqHKxZOhYAyhhUbjtmDKLlxkhhGAx8cpMG0SVlNMjTO0TG2KotHySESpwoVRhW1QYVXjFK8YqqDCq7FXUI6Y0tqisSNxiFVVJySFQNhQqhqYVV1c4WKuslMkhEpJ74UIpJcKESkvvhQiVkwoRCy++FCJWSnfChELJhQrrL74VV1lwoVlk264oVRL4YVVRJ74oVRJhQqCX3xVcJcKF3q++Kt+tiq31sUNet74qsM3XChRaf3xVCS3HwnfAqVzT1B3xSlUtzStTgVLprrrvgVKJ72ld8CUlnuyxoDX2wKzHyf5Vl1ucXl4pXTYW+M9PVI/YX28Tk4xthKVPe4okiRI41CJGAERRQADoBlrSrcfHthVsD3xVvj4d8VXcfbFW+JxQ3xHhU9sVdTFX//1Zx/mBm2cFon/bxVqtcVaqMVaJxVafHFWtzXfp1xVaT+GKqF3a29/bzWl5CtxbXClJYXFQwO2ClD5d86eSrrypdtcW6tcaFcv/o9x1MJP+65PD2PfMTLircOXiyXswdkB3H0HMOUXKEnGPao3ysxZiSwEg5CmdohHxSjUfpkkIlTXChVGKrwcKqgxVeMKrxiq8YVXDfGlXiuFV4PTthVeDiheGwqqq2FCur4UK6vvhQiFkwsUSr4VRCye/04UK6ye+FCIWTChXWTChXWXChXWX3wqrrNihUEvvhQqCXFV/q++FDfrgbVxtWxPXFDXre+Ktet74VWGf3xQptP74qh3uPfFUDPc/D1wKlUt113wKk91dd64pSOe+675G00lMl0ZGoNz4YFZp5Q8pXGvTi4uA0WmxNSaYbFz/In8TlkY21ylT6HtraG1git7aIRQwqFjjUUAAy1qRagE9Nj70+WFDYHhiq4Dviq/jUk+PbFVwXtirYXw+7FXccVb4Yq/wD/1prXx75tnBapTFXYq1iq36MVaPXxPcYq11qa0p098UNVr/XFLeKqN1a299by2l3Cs9tcKUlicVBBwFIfNHnTyHdeWZXvLFXutEkOz9WgJP2X9vA5iZcVbhyceW9iwJdtxup7ZiEOUC5ogw5LkDFkJKBVhUbjwOVkNgKtG5Gx6jviEo6N8khFKcKF1cKr1cd8UqykHChVGKrhhVeBiq4YVXYquHtihuuFV4OFCoGwqqq2FCssmFCusmFCusmFCIWTChWWU+OFVdZffFCssvvhQrrL74UKwmG2+KqgmwoXib3xQ361R1pirYlA6b++FW/W98UNev74ULTP74qpNce+KqD3HvihCvddcVSy5vKCld8CUkmvOu+BUlu77Y/Fv2wWlKDLJM23TuT0wK9E8m+Sp9bkW7u1aDS0O7nZpiOy+3icsjC2uU6fRFrawWkEVvbRLDDEAscaigAGXNKLA6YqvA/DFVwX78CrwtcVX8dvniq8LhVvjgVsKNwRXwwq7jgV/9eZ+PfNs4Lv1YVaJJ3PbbbbArX4VxVr9WFDgSOlO43oeuBVvz2xVqvv1xS4YqqDpt08MCtSRRzxPDNGssUqlZI3FVIPYg4EvAvOn5ay6cZdU8vxNNY7tcaeKs8XiU8V9uozGyYuocjHl6F5KCVNafNTmKY05QKpwWQVHXuMgQyBpQMbL0yBizBXqSPowJRaPklV61GKFhJGKVyyEfxxSiEl8cKEQr1woVA4wqvDDtiq8HthVfhQu2OKupiq7cYULwcVXq2FCqrYUKofCqsJPffChVWQ7YUKyy4oVRLhVWWX3woVRNihUE3vhVcJsULvWwq362KGjN74ULDP74qptcU74qoNc9d8UISS6HSvzxVBS3fEHfArHrq/AJJagwWlIZtQaQlUOC00poGl+0Kljt4/LDSCXr3k78v5Lv0tR1mMw2go0Fkdmk8C3gPbLYwapT7nu8EMcMaRRIsccYCpGoAAA6ADLWpEqMCqlPpxVeBiq8DfAqoF+7FV4Xpiq/gR1B7H6DirfHFW+O/tiruIr88Vf//QmebdwWuu2Ku698CrThQt69sVar/birifbbFWvlgVvf2xSvFaVptWhNMCqi4pVV/28CXl/nD8tbXV/V1HRVSz1E1aW36RTH/jVj45TkxiTdDIQ+fLyxvNNuZLa8ge2uYTSSJxQj+ozElGnJEgViMr7HZvDIUytcYa9MBiyBWemQfDI0ytUUkbHFVXYjFVhWmNMrcDiqsrHxxVVBOFCqrEYVVlbChWVsVVRhQuwq3ihcMKtgYqu+nChcCcVXhj44UKgY4UKgY+OFVQOfHFCoH98KqgkxQvEuFC71vfCh3re+KtGfFC0z074VUmuPfFUPJddgcUIN7v3xVAyXXU1+7AqT3l8wU0PyGAlNJG5kmNXNAei4ptH6fp1zfTx21nbvPPKaKiCp/2skIsDJ795S/L620v077VQt1fijJD1jiP/GxGXRhTRKdvU0WlKdu2WMFcDAqqB0xSvA2wKqAYqvA2/DAqqB4bYqvAxVcB+PfFV1PbFW6AEivKh6jv9+Kupir/AP/RmObdwHH54q4nffFVpoaU603+/FVte/4Yq7riq3FXeG9TgVd0J6YquXrvt3rgSqLilWGBKuvf374EpD5g8r6V5lt/Rv4aTKP3F4m0iH2PcexyEogs4yIfOnmjyHq/lxmmKG70+vwX0QNAP8sfs/qzFnjIcmGQFhqSMnwvuPHK2aLUK48RgpNuMXfqMFJtr06f0wUm3FCMaTawrgpNtgHFbVlOFVdCp6/fhQq8QemGltcEI6YraqtcKFQA4qvAOFC6mFW8VbxQ2MKrhiq4HChcDirYbChcHwq36mKHer74Va9U4oW+t7/Tiq0z074oUmuPfFULJcnoD8ziqDkuTTr8xihBvcHuaDFUvlumaoT/AILsMVQgDOdtyf2jhAQSzTy35K1PXWWUKbWyr8d3IDQ/6g/aOWRhbXKdPoDQfLem6BAIrKH96w/e3L7yP8z4ewy4RppMrZOgp/DCxVgOnh44pVQMVVAPxwKqAHAlUG3XFVQDFVQDpgVeBiq+mKtgYqupirXhir//0ph3zbuA3XYigoTX329+vfFVvtTFWhU1+VdzToPfFVpxVr8MVa2264q7FV3ttgVeDvilUX9eBKsv+YwJVlOBKqvbAleyJKjRyIHjccWVhUEHqKYEvKvM/wCVlhqPqXeiMun3RqTan+5Y+38v6sqliB5NschHN4Pqmh6roVw0F/ayWzj7JYfCw8VbocxzEhvEgULFcCtH+E+PbIpRgCP/AJJPfthpbcYyOo28cjSbW8AeoxpNrDF4YKTbXpnFbXAHCqqvIYqqhj4YUKob2wqqA4qv8MKHVOKrq4q3XCrdcUN1wq7FW64UNcvvxVrlirRb3woWl8VWGSmKFJpdsVUWmOKoZ5j41woQzSk4qhmYnFUO4Lmgq3thpFpjpmh6hq0ywWVs87d+IoqjxJ6DJCNsDKns/l38ubKx4XGqlby4FCLcf3Sn3/m/Vl0YNMp29PihjjCoqiNFAAVRsAPAbZY1ogCmKqoxVVH6sVVRv17YEqq1+XvgVVQlSCpoV3BGxB9sVXr/AJjAqoPbFKoMVXjFVw7YFbxVugxVvFX/05eM27gNVpirjirVe/h2xVaeuKtdsVdtirX8MVXdsCrxv02xSqL9/vgVWXAlWXx8MDJWGBKqMCqg8emKUJf6dY6nbtbahax3ULdUkWtPceH0YCAUg08b8w/lIrGS48v3AFan6jMfwR/65TLF3Nscve8fv9J1XRZjBfWstq46K6mh+R6H6MpMSG4EFRiugCA23semBUavpSDrxJ+7GltzQsN6VHYjGk2t4jBSbdxGGltsLitrgBiq8KMVXAYVX4odirdcKt4q3XChquKurirRNMKreQ8a4oWlvbFVhY4qpl/fChSZ/pxVRZ/DFVAsxxQpkE4VW8SdhucNItHWOjX+pSiK1t5J3P7KDYfM9B9OSEbYGVPUNE/LRV4TaxLWm/1SI/8AEn/p9+Wxg1ym9Ss9OtLCJYbO3S3iX9hAB9J8csAaiUcFp9GFC7CheDTvSvXFV4xSqjAqoMVVh49PfAqqu1MCVQYqvGKqnjgVd1IxSv8Ao+eKt1xVv+OKrq16Cmw2xV//1Jea/LwzbuAtOKte+Kur7U98VWn6B8sVa26djirq70xV2Ktg/wC3iq8d/brgSqDtgVVT78Uqy4Eqy4Eqo+7AlVGBK4dvfFV2BKEvLGz1CFoL61ju4W6pIob7q9MSLUF5brf5T6ZdF5dHuDYSk7W8lXi+g/aH45VLEDybBlI5vKdV8leYtDLNPZPJAv8Ax8Q/vI6eJpuPpGVGBDaJgseS5liNGU7df9rIskYtxFJ1Ar92KFTgp+y30HGk216bDtjS26mKupireKt4VbxV1cVdXFWq++FXVxQ1XCqw0PXfFVtadBQYqsLYULCTiqw1xpCziT2wra0pT+mGkWuWF3NFTDSLZHpnk/WNTKmK1ZYm/wB3SfAlPp6/RkhC2BmA9I0n8uLG34yajKbqQUPop8KfSepywQazN6Ba6dbWUYhtYEgjXYKgAGTAYEov0wO2SQ0V+7FC04UNf5jFVwxVeP8AM4qqDqMVVh1/jgSqDFVUdh08TgVUBxVf74Ergdq4quriq+v0YqvWpBIp8Iqd/wBWBWwcVbxV/9WXfx7Zt3Aa98Va7dfkPbFWj/mMVa+7FVpxV23TFW8Vd+FDgVeNziqoMCVdeND41G3anev+1ilUBwJVl+W2BKqMCVQHwwJVAabjcj6cVdX6MCrsVdt9OKXca1Boa9RirGdV8n+XtX5Nd6dGsrf7vhHpv86r1+nImALISIec6n+USnk+k6lTwhuV/wCN1/plZxdzMZe9gl/5G806YWLafJPGP92QfvVP0Lv+GQMCGwTBY4zXVuxSaFkYbMrAqR9ByKVy3KnZgRitKgkibowriq/4exwq3T3xW2uOK24jFbW0OK21TFDW+Fba4nFba4k4UW1wONLbXDxOGltrgPnjSLVI7aaUhYoixPQAVP4ZIBFsisvJmu3tCLN4kP7UvwD7jvkhAsTMM00/8tFHFr+7+ccI/wCNm/pkxjYHIznTvK2j6dxMFkhkH+7ZPjb7z/DJiIDAyLIVgAHTbJMVT0gPkMULSoH0YVU2Hf8ADFCkcKqRxQ1irYp4b4quHbFVZcVVR0xVVB8cCV4xVUU03G3bAq4E/P5Yquriq6vTFK+v+ZwKvG5UAipNBvT8TirdcVXVxV//1pd+vNu4C35YVargVrt8sVa8fbFDX+dcVcf9vFWv1eGKV2+Krh2wKqDx+84pVQe+BKspwJVl+WBKqO3vgVUHf2xSvr/bgSuGKt4q2MVbGKrhirdB1pvgS1wO9DiqDudNsr0cLyyhulPaSNW/WMaW2KXv5eeVryrCwa0Y/tQOy/8ACmo/DImALMTLF7v8pLB97PVZYf8AJmQOPvHHInEEjKWP3H5TazHU21/a3A7VLof1H9eROIsvFCTzfl35tgrxsxMB3jlQ/rIweGU+IEtl8o+a4ah9IuTTqVTl/wARwcEk8cUG+h+Yo9n0i6Hzgf8ApjwleIKJ0vWx10u5H/PF/wCmPCVsNjS9ZP8A0q7k/wDPJ/6Y8JWwrJoevSbJpF0T/wAYn/ph4SjiCNi8qeZpacdInH+snH9dMlwFHGEzi8geZ5acrNYa93kQfqJw+GWJyBNoPyy1Vt7i8t4h3ALMfwAyQxI8ROrb8sbNKG61CSXxWNAv4ktkhjDE5GQ2nkfQLah+qG4YdDKxP4CgyQgGJmWR2+mWlqAttaxQAf77QL+oZKmNo4QAdsKFQRAdsVXhBirqAdsULCMVUmwqotihQbCqytOmxxQsxVv6aYquHthVUGBVRcVVlNfliq8H+zFV4NP64FXV74pXV3xVuuBV/LFVwOKr64pXA4Ff/9k=",bl="data:image/png;base64,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",pl={atlas:{type:"msdf",distanceRange:2,size:59.65625,width:512,height:256,yOrigin:"bottom"},metrics:{emSize:1,lineHeight:1.171875,ascender:.927734375,descender:-.244140625,underlineY:-.09765625,underlineThickness:.048828125},glyphs:[{unicode:32,advance:.24755859375},{unicode:33,advance:.25732421875,planeBounds:{left:.056159633438645884,bottom:-.02437761405677056,right:.20702396031135412,top:.7299440203067705},atlasBounds:{left:488.5,bottom:145.5,right:497.5,top:190.5}},{unicode:34,advance:.31982421875,planeBounds:{left:.049409125974004715,bottom:.48691155587022,right:.2840869677759953,top:.77187750662978},atlasBounds:{left:486.5,bottom:213.5,right:500.5,top:230.5}},{unicode:35,advance:.61572265625,planeBounds:{left:.037219103997511785,bottom:-.02169206718177056,right:.6239137085024882,top:.7326295671817705},atlasBounds:{left:66.5,bottom:51.5,right:101.5,top:96.5}},{unicode:36,advance:.5615234375,planeBounds:{left:.02956531458715296,bottom:-.12381369908983761,right:.5324464041628472,top:.8484230740898377},atlasBounds:{left:109.5,bottom:197.5,right:139.5,top:255.5}},{unicode:37,advance:.732421875,planeBounds:{left:.026481776289942378,bottom:-.030073418674698794,right:.7137525987100576,top:.7410109186746989},atlasBounds:{left:88.5,bottom:144.5,right:129.5,top:190.5}},{unicode:38,advance:.62158203125,planeBounds:{left:.03225572125458355,bottom:-.030073418674698794,right:.6357130287454166,top:.7410109186746989},atlasBounds:{left:130.5,bottom:144.5,right:166.5,top:190.5}},{unicode:39,advance:.17431640625,planeBounds:{left:.028244602049502358,bottom:.49895501673814824,right:.14558352295049765,top:.7671582645118518},atlasBounds:{left:498.5,bottom:62.5,right:505.5,top:78.5}},{unicode:40,advance:.341796875,planeBounds:{left:.042983329377291775,bottom:-.250029542422407,right:.34471198312270823,top:.8227834486724072},atlasBounds:{left:.5,bottom:191.5,right:18.5,top:255.5}},{unicode:41,advance:.34765625,planeBounds:{left:-.003159248747708225,bottom:-.250029542422407,right:.29856940499770823,top:.8227834486724072},atlasBounds:{left:19.5,bottom:191.5,right:37.5,top:255.5}},{unicode:42,advance:.4306640625,planeBounds:{left:-.011208599684062338,bottom:.27785390031593765,right:.44138438093406235,top:.7304468809340623},atlasBounds:{left:449.5,bottom:23.5,right:476.5,top:50.5}},{unicode:43,advance:.56689453125,planeBounds:{left:.01353503347629649,bottom:.053493525733368255,right:.5499415290237036,top:.6066627242666317},atlasBounds:{left:361.5,bottom:17.5,right:393.5,top:50.5}},{unicode:44,advance:.1962890625,planeBounds:{left:-.009919475797210583,bottom:-.15981695975478,right:.1744702570472106,top:.12514899100478},atlasBounds:{left:498.5,bottom:79.5,right:509.5,top:96.5}},{unicode:45,advance:.27587890625,planeBounds:{left:-.00527594412977999,bottom:.24333249267450235,right:.27969000662978,top:.36067141357549765},atlasBounds:{left:52.5,bottom:7.5,right:69.5,top:14.5}},{unicode:46,advance:.26318359375,planeBounds:{left:.051032680313645884,bottom:-.027092319686354116,right:.20189700718635412,top:.12377200718635412},atlasBounds:{left:501.5,bottom:221.5,right:510.5,top:230.5}},{unicode:47,advance:.412109375,planeBounds:{left:-.013733006073205867,bottom:-.08573505127848349,right:.4053345685732059,top:.7356373950284835},atlasBounds:{left:252.5,bottom:206.5,right:277.5,top:255.5}},{unicode:48,advance:.5615234375,planeBounds:{left:.037458384830081196,bottom:-.030073418674698794,right:.5235767714199189,top:.7410109186746989},atlasBounds:{left:167.5,bottom:144.5,right:196.5,top:190.5}},{unicode:49,advance:.5615234375,planeBounds:{left:.06023674350936354,bottom:-.01998308280677056,right:.37872810024063647,top:.7343385515567705},atlasBounds:{left:488.5,bottom:97.5,right:507.5,top:142.5}},{unicode:50,advance:.5615234375,planeBounds:{left:.025334353719224725,bottom:-.01680925468177056,right:.5449781462807752,top:.7375123796817705},atlasBounds:{left:278.5,bottom:51.5,right:309.5,top:96.5}},{unicode:51,advance:.5615234375,planeBounds:{left:.028181041080081196,bottom:-.030073418674698794,right:.5142994276699189,top:.7410109186746989},atlasBounds:{left:197.5,bottom:144.5,right:226.5,top:190.5}},{unicode:52,advance:.5615234375,planeBounds:{left:.005886103858368255,bottom:-.02169206718177056,right:.5590553023916317,top:.7326295671817705},atlasBounds:{left:310.5,bottom:51.5,right:343.5,top:96.5}},{unicode:53,advance:.5615234375,planeBounds:{left:.055524791080081196,bottom:-.02657487968177056,right:.5416431776699189,top:.7277467546817705},atlasBounds:{left:344.5,bottom:51.5,right:373.5,top:96.5}},{unicode:54,advance:.5615234375,planeBounds:{left:.046003306705081196,bottom:-.034712090549698794,right:.5321216932949189,top:.7363722467996989},atlasBounds:{left:227.5,bottom:144.5,right:256.5,top:190.5}},{unicode:55,advance:.5615234375,planeBounds:{left:.018010134969224725,bottom:-.02169206718177056,right:.5376539275307752,top:.7326295671817705},atlasBounds:{left:374.5,bottom:51.5,right:405.5,top:96.5}},{unicode:56,advance:.5615234375,planeBounds:{left:.037702525455081196,bottom:-.030073418674698794,right:.5238209120449189,top:.7410109186746989},atlasBounds:{left:257.5,bottom:144.5,right:286.5,top:190.5}},{unicode:57,advance:.5615234375,planeBounds:{left:.029401744205081196,bottom:-.025434746799698794,right:.5155201307949189,top:.7456495905496989},atlasBounds:{left:287.5,bottom:144.5,right:316.5,top:190.5}},{unicode:58,advance:.2421875,planeBounds:{left:.046394008438645884,bottom:-.029431286627488215,right:.19725833531135412,top:.5572633178774882},atlasBounds:{left:439.5,bottom:61.5,right:448.5,top:96.5}},{unicode:59,advance:.21142578125,planeBounds:{left:.001066852327789419,bottom:-.16459733294591408,right:.1854565851722106,top:.556198895445914},atlasBounds:{left:406.5,bottom:53.5,right:417.5,top:96.5}},{unicode:60,advance:.50830078125,planeBounds:{left:.016948142433865897,bottom:.0726146348300812,right:.4527784200661341,top:.5587330214199189},atlasBounds:{left:394.5,bottom:21.5,right:420.5,top:50.5}},{unicode:61,advance:.548828125,planeBounds:{left:.051535540940937666,bottom:.17620354038436353,right:.5041285215590624,top:.49469489711563647},atlasBounds:{left:477.5,bottom:31.5,right:504.5,top:50.5}},{unicode:62,advance:.5224609375,planeBounds:{left:.047629290940937666,bottom:.0731029160800812,right:.5002222715590624,top:.5592213026699189},atlasBounds:{left:421.5,bottom:21.5,right:448.5,top:50.5}},{unicode:63,advance:.47216796875,planeBounds:{left:.016704001808865897,bottom:-.027876153049698794,right:.4525342794411341,top:.7432081842996989},atlasBounds:{left:317.5,bottom:144.5,right:343.5,top:190.5}},{unicode:64,advance:.89794921875,planeBounds:{left:.034064457306783605,bottom:-.23896750384690937,right:.8721996065996072,top:.7165065663469093},atlasBounds:{left:155.5,bottom:198.5,right:205.5,top:255.5}},{unicode:65,advance:.65234375,planeBounds:{left:-.008838044092129387,bottom:-.02169206718177056,right:.6616700753421295,top:.7326295671817705},atlasBounds:{left:237.5,bottom:51.5,right:277.5,top:96.5}},{unicode:66,advance:.62255859375,planeBounds:{left:.06464099434422473,bottom:-.02169206718177056,right:.5842847869057752,top:.7326295671817705},atlasBounds:{left:205.5,bottom:51.5,right:236.5,top:96.5}},{unicode:67,advance:.65087890625,planeBounds:{left:.038439807122511785,bottom:-.030073418674698794,right:.6251344116274882,top:.7410109186746989},atlasBounds:{left:344.5,bottom:144.5,right:379.5,top:190.5}},{unicode:68,advance:.65576171875,planeBounds:{left:.06301501010836826,bottom:-.02169206718177056,right:.6161842086416317,top:.7326295671817705},atlasBounds:{left:162.5,bottom:51.5,right:195.5,top:96.5}},{unicode:69,advance:.568359375,planeBounds:{left:.0652904160800812,bottom:-.02169206718177056,right:.5514088026699189,top:.7326295671817705},atlasBounds:{left:132.5,bottom:51.5,right:161.5,top:96.5}},{unicode:70,advance:.552734375,planeBounds:{left:.059675181705081196,bottom:-.02169206718177056,right:.5457935682949189,top:.7326295671817705},atlasBounds:{left:102.5,bottom:51.5,right:131.5,top:96.5}},{unicode:71,advance:.68115234375,planeBounds:{left:.040148791497511785,bottom:-.030073418674698794,right:.6268433960024882,top:.7410109186746989},atlasBounds:{left:380.5,bottom:144.5,right:415.5,top:190.5}},{unicode:72,advance:.712890625,planeBounds:{left:.062365588372511785,bottom:-.02169206718177056,right:.6490601928774882,top:.7326295671817705},atlasBounds:{left:30.5,bottom:51.5,right:65.5,top:96.5}},{unicode:73,advance:.27197265625,planeBounds:{left:.06917965680657412,bottom:-.02169206718177056,right:.20328128069342588,top:.7326295671817705},atlasBounds:{left:196.5,bottom:51.5,right:204.5,top:96.5}},{unicode:74,advance:.5517578125,planeBounds:{left:.007184947330081194,bottom:-.02657487968177056,right:.4933033339199188,top:.7277467546817705},atlasBounds:{left:.5,bottom:51.5,right:29.5,top:96.5}},{unicode:75,advance:.626953125,planeBounds:{left:.061633166497511785,bottom:-.02169206718177056,right:.6483277710024882,top:.7326295671817705},atlasBounds:{left:452.5,bottom:97.5,right:487.5,top:142.5}},{unicode:76,advance:.5380859375,planeBounds:{left:.06341786132300943,bottom:-.02169206718177056,right:.5327735449269906,top:.7326295671817705},atlasBounds:{left:423.5,bottom:97.5,right:451.5,top:142.5}},{unicode:77,advance:.873046875,planeBounds:{left:.05911847969322944,bottom:-.02169206718177056,right:.8134401140567705,top:.7326295671817705},atlasBounds:{left:377.5,bottom:97.5,right:422.5,top:142.5}},{unicode:78,advance:.712890625,planeBounds:{left:.062365588372511785,bottom:-.02169206718177056,right:.6490601928774882,top:.7326295671817705},atlasBounds:{left:341.5,bottom:97.5,right:376.5,top:142.5}},{unicode:79,advance:.6875,planeBounds:{left:.033395854136655315,bottom:-.030073418674698794,right:.6536158646133446,top:.7410109186746989},atlasBounds:{left:416.5,bottom:144.5,right:453.5,top:190.5}},{unicode:80,advance:.630859375,planeBounds:{left:.061550166358368255,bottom:-.02169206718177056,right:.6147193648916317,top:.7326295671817705},atlasBounds:{left:273.5,bottom:97.5,right:306.5,top:142.5}},{unicode:81,advance:.6875,planeBounds:{left:.030466166636655315,bottom:-.14391866037519643,right:.6506861771133446,top:.7445045978751964},atlasBounds:{left:214.5,bottom:202.5,right:251.5,top:255.5}},{unicode:82,advance:.61572265625,planeBounds:{left:.06350329135836826,bottom:-.02169206718177056,right:.6166724898916317,top:.7326295671817705},atlasBounds:{left:186.5,bottom:97.5,right:219.5,top:142.5}},{unicode:83,advance:.59326171875,planeBounds:{left:.020778681983368255,bottom:-.030073418674698794,right:.5739478805166317,top:.7410109186746989},atlasBounds:{left:454.5,bottom:144.5,right:487.5,top:190.5}},{unicode:84,advance:.5966796875,planeBounds:{left:.005480822747511787,bottom:-.02169206718177056,right:.5921754272524882,top:.7326295671817705},atlasBounds:{left:112.5,bottom:97.5,right:147.5,top:142.5}},{unicode:85,advance:.6484375,planeBounds:{left:.049098994483368255,bottom:-.02657487968177056,right:.6022681930166317,top:.7277467546817705},atlasBounds:{left:78.5,bottom:97.5,right:111.5,top:142.5}},{unicode:86,advance:.63623046875,planeBounds:{left:-.008269192599201152,bottom:-.02169206718177056,right:.6454762238492011,top:.7326295671817705},atlasBounds:{left:38.5,bottom:97.5,right:77.5,top:142.5}},{unicode:87,advance:.88720703125,planeBounds:{left:.011923628617731797,bottom:-.02169206718177056,right:.8835841838822683,top:.7326295671817705},atlasBounds:{left:220.5,bottom:97.5,right:272.5,top:142.5}},{unicode:88,advance:.626953125,planeBounds:{left:.004098979136655316,bottom:-.02169206718177056,right:.6243189896133446,top:.7326295671817705},atlasBounds:{left:.5,bottom:97.5,right:37.5,top:142.5}},{unicode:89,advance:.6005859375,planeBounds:{left:-.010793598988344685,bottom:-.02169206718177056,right:.6094264114883446,top:.7326295671817705},atlasBounds:{left:148.5,bottom:97.5,right:185.5,top:142.5}},{unicode:90,advance:.5986328125,planeBounds:{left:.024196650733368255,bottom:-.02169206718177056,right:.5773658492666317,top:.7326295671817705},atlasBounds:{left:307.5,bottom:97.5,right:340.5,top:142.5}},{unicode:91,advance:.26513671875,planeBounds:{left:.05437250871693295,bottom:-.17280296457569408,right:.27228764753306706,top:.8329592145756942},atlasBounds:{left:59.5,bottom:195.5,right:72.5,top:255.5}},{unicode:92,advance:.41015625,planeBounds:{left:.0014037126767941326,bottom:-.08573505127848349,right:.4204712873232059,top:.7356373950284835},atlasBounds:{left:278.5,bottom:206.5,right:303.5,top:255.5}},{unicode:93,advance:.26513671875,planeBounds:{left:-.020659233400995285,bottom:-.17280296457569408,right:.2140186084009953,top:.8329592145756942},atlasBounds:{left:94.5,bottom:195.5,right:108.5,top:255.5}},{unicode:94,advance:.41796875,planeBounds:{left:.006855376669722368,bottom:.33229482979472236,right:.40916024833027764,top:.7345997014552776},atlasBounds:{left:486.5,bottom:231.5,right:510.5,top:255.5}},{unicode:95,advance:.451171875,planeBounds:{left:-.017473255794918804,bottom:-.09553469482549765,right:.4686451307949188,top:.021804226075497646},atlasBounds:{left:70.5,bottom:7.5,right:99.5,top:14.5}},{unicode:96,advance:.30908203125,planeBounds:{left:.00391839948107648,bottom:.5860277898277895,right:.2553589442689235,top:.7704175226722105},atlasBounds:{left:36.5,bottom:3.5,right:51.5,top:14.5}},{unicode:97,advance:.5439453125,planeBounds:{left:.028181041080081196,bottom:-.029187146002488215,right:.5142994276699189,top:.5575074585024882},atlasBounds:{left:30.5,bottom:15.5,right:59.5,top:50.5}},{unicode:98,advance:.56103515625,planeBounds:{left:.048932994205081196,bottom:-.032187684160555265,right:.5350513807949189,top:.7724220591605554},atlasBounds:{left:304.5,bottom:207.5,right:333.5,top:255.5}},{unicode:99,advance:.5234375,planeBounds:{left:.024518931705081196,bottom:-.029187146002488215,right:.5106373182949189,top:.5575074585024882},atlasBounds:{left:.5,bottom:15.5,right:29.5,top:50.5}},{unicode:100,advance:.56396484375,planeBounds:{left:.026227916080081196,bottom:-.032187684160555265,right:.5123463026699189,top:.7724220591605554},atlasBounds:{left:334.5,bottom:207.5,right:363.5,top:255.5}},{unicode:101,advance:.52978515625,planeBounds:{left:.026472056705081196,bottom:-.029187146002488215,right:.5125904432949189,top:.5575074585024882},atlasBounds:{left:468.5,bottom:61.5,right:497.5,top:96.5}},{unicode:102,advance:.34716796875,planeBounds:{left:.004575110905578838,bottom:-.022177918535555265,right:.3733545765944212,top:.7824318247855554},atlasBounds:{left:364.5,bottom:207.5,right:386.5,top:255.5}},{unicode:103,advance:.56103515625,planeBounds:{left:.026960337955081196,bottom:-.22888445766762702,right:.5130787245449189,top:.558962582667627},atlasBounds:{left:28.5,bottom:143.5,right:57.5,top:190.5}},{unicode:104,advance:.55078125,planeBounds:{left:.049826556565937666,bottom:-.01892352016762703,right:.5024195371840624,top:.768923520167627},atlasBounds:{left:.5,bottom:143.5,right:27.5,top:190.5}},{unicode:105,advance:.24267578125,planeBounds:{left:.046882289688645884,bottom:-.01680925468177056,right:.19774661656135412,top:.7375123796817705},atlasBounds:{left:498.5,bottom:145.5,right:507.5,top:190.5}},{unicode:106,advance:.23876953125,planeBounds:{left:-.048979545900995285,bottom:-.2324562772148376,right:.1856982959009953,top:.7397804959648377},atlasBounds:{left:140.5,bottom:197.5,right:154.5,top:255.5}},{unicode:107,advance:.5068359375,planeBounds:{left:.044294322330081196,bottom:-.01892352016762703,right:.5304127089199189,top:.768923520167627},atlasBounds:{left:58.5,bottom:143.5,right:87.5,top:190.5}},{unicode:108,advance:.24267578125,planeBounds:{left:.05428707868157412,bottom:-.01892352016762703,right:.18838870256842588,top:.768923520167627},atlasBounds:{left:477.5,bottom:208.5,right:485.5,top:255.5}},{unicode:109,advance:.87646484375,planeBounds:{left:.04430890170737297,bottom:-.024304333502488215,right:.832155942042627,top:.5623902710024882},atlasBounds:{left:116.5,bottom:15.5,right:163.5,top:50.5}},{unicode:110,advance:.5517578125,planeBounds:{left:.049826556565937666,bottom:-.024304333502488215,right:.5024195371840624,top:.5623902710024882},atlasBounds:{left:60.5,bottom:15.5,right:87.5,top:50.5}},{unicode:111,advance:.5703125,planeBounds:{left:.025090213094224725,bottom:-.029187146002488215,right:.5447340056557752,top:.5575074585024882},atlasBounds:{left:193.5,bottom:15.5,right:224.5,top:50.5}},{unicode:112,advance:.56103515625,planeBounds:{left:.048444712955081196,bottom:-.22644305141762702,right:.5345630995449189,top:.561403988917627},atlasBounds:{left:447.5,bottom:208.5,right:476.5,top:255.5}},{unicode:113,advance:.568359375,planeBounds:{left:.025983775455081196,bottom:-.22644305141762702,right:.5121021620449189,top:.561403988917627},atlasBounds:{left:417.5,bottom:208.5,right:446.5,top:255.5}},{unicode:114,advance:.33837890625,planeBounds:{left:.045180595002291775,bottom:-.024304333502488215,right:.34690924874770823,top:.5623902710024882},atlasBounds:{left:449.5,bottom:61.5,right:467.5,top:96.5}},{unicode:115,advance:.515625,planeBounds:{left:.021669814448009427,bottom:-.029187146002488215,right:.4910254980519906,top:.5575074585024882},atlasBounds:{left:164.5,bottom:15.5,right:192.5,top:50.5}},{unicode:116,advance:.32666015625,planeBounds:{left:-.019433670483564695,bottom:-.02877457520298586,right:.3158203892335647,top:.675258950202986},atlasBounds:{left:418.5,bottom:54.5,right:438.5,top:96.5}},{unicode:117,advance:.55126953125,planeBounds:{left:.048117572190937666,bottom:-.034069958502488215,right:.5007105528090624,top:.5526246460024882},atlasBounds:{left:88.5,bottom:15.5,right:115.5,top:50.5}},{unicode:118,advance:.484375,planeBounds:{left:-.002092396419918806,bottom:-.02080579450955998,right:.4840259901699188,top:.5491261070095601},atlasBounds:{left:331.5,bottom:16.5,right:360.5,top:50.5}},{unicode:119,advance:.75146484375,planeBounds:{left:-.002649098431770561,bottom:-.02080579450955998,right:.7516725359317705,top:.5491261070095601},atlasBounds:{left:225.5,bottom:16.5,right:270.5,top:50.5}},{unicode:120,advance:.49560546875,planeBounds:{left:-.0046143729128470395,bottom:-.02080579450955998,right:.4982667166628471,top:.5491261070095601},atlasBounds:{left:300.5,bottom:16.5,right:330.5,top:50.5}},{unicode:121,advance:.47314453125,planeBounds:{left:-.007219349544918806,bottom:-.23645281704262702,right:.4788990370449188,top:.551394223292627},atlasBounds:{left:387.5,bottom:208.5,right:416.5,top:255.5}},{unicode:122,advance:.49560546875,planeBounds:{left:.018007705073009427,bottom:-.02080579450955998,right:.4873633886769906,top:.5491261070095601},atlasBounds:{left:271.5,bottom:16.5,right:299.5,top:50.5}},{unicode:123,advance:.33837890625,planeBounds:{left:.011572188891435306,bottom:-.20234398020069408,right:.3468262486085647,top:.8034181989506942},atlasBounds:{left:73.5,bottom:195.5,right:93.5,top:255.5}},{unicode:124,advance:.24365234375,planeBounds:{left:.06315671142450235,bottom:-.15466084787519643,right:.18049563232549765,top:.7337624103751964},atlasBounds:{left:206.5,bottom:202.5,right:213.5,top:255.5}},{unicode:125,advance:.33837890625,planeBounds:{left:-.010156326733564695,bottom:-.20234398020069408,right:.3250977329835647,top:.8034181989506942},atlasBounds:{left:38.5,bottom:195.5,right:58.5,top:255.5}},{unicode:126,advance:.68017578125,planeBounds:{left:.046984728997511785,bottom:.1766063915990047,right:.6336793335024882,top:.4112842334009953},atlasBounds:{left:.5,bottom:.5,right:35.5,top:14.5}}],kerning:[]},Gs={name:"untitled connectome",nodeColormap:"warm",nodeColormapNegative:"winter",nodeMinColor:0,nodeMaxColor:4,nodeScale:3,edgeColormap:"warm",edgeColormapNegative:"winter",edgeMin:2,edgeMax:6,edgeScale:1,legendLineThickness:0,showLegend:!0},zs=class Gh extends Xa{constructor(e,t){super(new Float32Array([]),new Uint32Array([]),t.name,new Uint8Array([]),1,!0,e,t),U(this,"gl"),U(this,"nodesChanged"),this.gl=e,this.type="connectome",this.nodes&&this.updateLabels(),this.nodesChanged=new EventTarget}static convertLegacyConnectome(e){const t={nodes:[],edges:[],...Gs};for(const r in e)if(r in Gs){const s=r;t[s]=e[s]}const i=e.nodes;for(let r=0;r<i.names.length;r++)t.nodes.push({name:i.names[r],x:i.X[r],y:i.Y[r],z:i.Z[r],colorValue:i.Color[r],sizeValue:i.Size[r]});for(let r=0;r<i.names.length-1;r++)for(let s=r+1;s<i.names.length;s++){const n=e.edges[r*i.names.length+s];t.edges.push({first:r,second:s,colorValue:n})}return t}static convertFreeSurferConnectome(e,t="warm"){let i=!0;if("data_type"in e?e.data_type!=="fs_pointset"&&(i=!1):i=!1,"points"in e||(i=!1),!i)throw Error("not a valid FreeSurfer json pointset");const r=e.points.map(n=>({name:Array.isArray(n.comments)&&n.comments.length>0&&"text"in n.comments[0]?n.comments[0].text:"",x:n.coordinates.x,y:n.coordinates.y,z:n.coordinates.z,colorValue:1,sizeValue:1,metadata:n.comments}));return{...Gs,nodeColormap:t,edgeColormap:t,nodes:r,edges:[]}}updateLabels(){const e=this.nodes;if(e&&e.length>0){const t=e.reduce((l,h)=>l.sizeValue>h.sizeValue?l:h).sizeValue;let i,r;if(typeof this.nodeMinColor<"u"&&isFinite(this.nodeMinColor))i=this.nodeMinColor;else{i=e[0].colorValue;for(let l=1;l<e.length;l++)e[l].colorValue<i&&(i=e[l].colorValue)}if(typeof this.nodeMaxColor<"u"&&isFinite(this.nodeMaxColor))r=this.nodeMaxColor;else{r=e[0].colorValue;for(let l=1;l<e.length;l++)e[l].colorValue>r&&(r=e[l].colorValue)}const s=Ie.colormap(this.nodeColormap,this.colormapInvert),n=Ie.colormap(this.nodeColormapNegative,this.colormapInvert),o="nodeColormapNegative"in this;let c=this.legendLineThickness?this.legendLineThickness:0;this.showLegend===!1&&(c=0);for(let l=0;l<e.length;l++){let h=e[l].colorValue,d=!1;if(o&&h<0&&(d=!0,h=-h),i<r){if(h<i){V.warn("color value lower than min");continue}h=(h-i)/(r-i)}else h=1;h=Math.round(Math.max(Math.min(255,h*255)))*4;let f=[s[h],s[h+1],s[h+2],255];d&&(f=[n[h],n[h+1],n[h+2],255]),f=f.map(u=>u/255),V.debug("adding label for ",e[l]),e[l].label=new jo(e[l].name,{textColor:f,bulletScale:e[l].sizeValue/t,bulletColor:f,lineWidth:c,lineColor:f,textScale:1,textAlignment:"left",lineTerminator:"none"},[e[l].x,e[l].y,e[l].z]),V.debug("label for node:",e[l].label)}}}addConnectomeNode(e){if(V.debug("adding node",e),!this.nodes)throw new Error("nodes not defined");this.nodes.push(e),this.updateLabels(),this.nodesChanged.dispatchEvent(new CustomEvent("nodeAdded",{detail:{node:e}}))}deleteConnectomeNode(e){const t=this.nodes.indexOf(e),i=this.edges;i&&(this.edges=i.filter(r=>r.first!==t&&r.second!==t)),this.nodes=this.nodes.filter(r=>r!==e),this.updateLabels(),this.updateConnectome(this.gl),this.nodesChanged.dispatchEvent(new CustomEvent("nodeDeleted",{detail:{node:e}}))}updateConnectomeNodeByIndex(e,t){this.nodes[e]=t,this.updateLabels(),this.updateConnectome(this.gl),this.nodesChanged.dispatchEvent(new CustomEvent("nodeChanged",{detail:{node:t}}))}updateConnectomeNodeByPoint(e,t){const i=this.nodes;if(!i)throw new Error("Node to update does not exist");const r=i.find(n=>ce.arraysAreEqual([n.x,n.y,n.z],e));if(!r)throw new Error(`Node with point ${e} to update does not exist`);const s=i.findIndex(n=>n===r);this.updateConnectomeNodeByIndex(s,t)}addConnectomeEdge(e,t,i){const r=this.edges;let s=r.find(n=>(n.first===e||n.second===e)&&n.first+n.second===e+t);return s||(s={first:e,second:t,colorValue:i},r.push(s),this.updateConnectome(this.gl),s)}deleteConnectomeEdge(e,t){const i=this.edges,r=i.find(s=>(s.first===e||s.first===t)&&s.first+s.second===e+t);if(r)this.edges=i.filter(s=>s!==r);else throw new Error(`edge between ${e} and ${t} not found`);return this.updateConnectome(this.gl),r}findClosestConnectomeNode(e,t){const i=this.nodes;if(!i||i.length===0)return null;const r=i.map((s,n)=>({node:s,distance:Math.sqrt(Math.pow(s.x-e[0],2)+Math.pow(s.y-e[1],2)+Math.pow(s.z-e[2],2)),index:n})).filter(s=>s.distance<t).sort((s,n)=>s.distance-n.distance);return r.length>0?r[0].node:null}updateConnectome(e){const t=[],i=[],r=[];let s=Ie.colormap(this.nodeColormap,this.colormapInvert),n=Ie.colormap(this.nodeColormapNegative,this.colormapInvert),o="nodeColormapNegative"in this;this.nodeMinColor===void 0&&(this.nodeMinColor=NaN),this.nodeMaxColor===void 0&&(this.nodeMaxColor=NaN),this.edgeMin===void 0&&(this.edgeMin=NaN),this.edgeMax===void 0&&(this.edgeMax=NaN);let c=this.nodeMinColor,l=this.nodeMaxColor;if(!isFinite(c)||!isFinite(c)){const b=this.nodes;c=b[0].colorValue,l=b[0].colorValue;for(let A=0;A<b.length;A++)c=Math.min(c,b[A].colorValue),l=Math.max(l,b[A].colorValue)}const h=this.nodes,d=h.length;for(let b=0;b<d;b++){const A=h[b].sizeValue*this.nodeScale;if(A<=0)continue;let y=h[b].colorValue,x=!1;if(o&&y<0&&(x=!0,y=-y),c<l){if(y<c)continue;y=(y-c)/(l-c)}else y=1;y=Math.round(Math.max(Math.min(255,y*255)))*4;let E=[s[y],s[y+1],s[y+2],255];x&&(E=[n[y],n[y+1],n[y+2],255]);const I=ee(h[b].x,h[b].y,h[b].z);ja.makeColoredSphere(i,t,r,A,I,E)}s=Ie.colormap(this.edgeColormap,this.colormapInvert),n=Ie.colormap(this.edgeColormapNegative,this.colormapInvert),o="edgeColormapNegative"in this;const f=this.edges;if(f!==void 0&&f.length>0){if(c=this.edgeMin,l=this.edgeMax,!isFinite(c)||!isFinite(c)){c=f[0].colorValue,l=f[0].colorValue;for(let b=0;b<f.length;b++)c=Math.min(c,f[b].colorValue),l=Math.max(l,f[b].colorValue)}for(const b of f){let A=b.colorValue;const y=o&&A<0;y&&(A=-A);const x=A*this.edgeScale;if(x<=0)continue;if(c<l){if(A<c)continue;A=(A-c)/(l-c)}else A=1;A=Math.round(Math.max(Math.min(255,A*255)))*4;let E=[s[A],s[A+1],s[A+2],255];y&&(E=[n[A],n[A+1],n[A+2],255]);const I=ee(h[b.first].x,h[b.first].y,h[b.first].z),w=ee(h[b.second].x,h[b.second].y,h[b.second].z);ja.makeColoredCylinder(i,t,r,I,w,x,E)}}const u=new Float32Array(i),m=new Uint32Array(t),p=_a.getExtents(u);this.furthestVertexFromOrigin=p.mxDx,this.extentsMin=p.extentsMin,this.extentsMax=p.extentsMax;const g=this.generatePosNormClr(u,m,new Uint8Array(r));e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,Uint32Array.from(m),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,Float32Array.from(g),e.STATIC_DRAW),this.indexCount=t.length}updateMesh(e){this.updateConnectome(e),this.updateLabels()}json(){const e={};for(const t in this)(t in Gs||t==="nodes"||t==="edges")&&(e[t]=this[t]);return e}static async loadConnectomeFromUrl(e,t){const r=await(await fetch(t)).json();return new Gh(e,r)}};function Cp(a,e,t){if(!a.dimsRAS||!a.matRAS||!a.pixDimsRAS||!a.vox2mm)throw new Error("Cannot create NiivueObject3D: Missing required RAS properties or vox2mm access on NVImage.");const i=a.dimsRAS,r=a.matRAS,s=a.pixDimsRAS,n=-.5,o=-.5,c=-.5,l=i[1]-1+.5,h=i[2]-1+.5,d=i[3]-1+.5,f=a.vox2mm,u=f.call(a,[n,o,c],r),m=f.call(a,[n,h,c],r),p=f.call(a,[n,o,d],r),g=f.call(a,[n,h,d],r),b=f.call(a,[l,o,c],r),A=f.call(a,[l,h,c],r),y=f.call(a,[l,o,d],r),x=f.call(a,[l,h,d],r),E=[...p,0,0,1,...y,1,0,1,...x,1,1,1,...g,0,1,1,...u,0,0,0,...m,0,1,0,...A,1,1,0,...b,1,0,0],I=t.createBuffer();if(!I)throw new Error("Failed to create GL index buffer");t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,I);const w=[0,3,2,2,1,0,4,7,6,6,5,4,5,6,2,2,3,5,4,0,1,1,7,4,7,1,2,2,6,7,4,5,3,3,0,4];t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(w),t.STATIC_DRAW);const v=t.createBuffer();if(!v)throw new Error("Failed to create GL vertex buffer");t.bindBuffer(t.ARRAY_BUFFER,v),t.bufferData(t.ARRAY_BUFFER,new Float32Array(E),t.STATIC_DRAW);const M=t.createVertexArray();if(!M)throw new Error("Failed to create GL VAO");t.bindVertexArray(M),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,I),t.bindBuffer(t.ARRAY_BUFFER,v);const C=24;t.enableVertexAttribArray(0),t.vertexAttribPointer(0,3,t.FLOAT,!1,C,0),t.enableVertexAttribArray(1),t.vertexAttribPointer(1,3,t.FLOAT,!1,C,12),t.bindVertexArray(null);const D=new ja(e,v,t.TRIANGLES,w.length,I,M),S=[...p,...y,...x,...g,...u,...m,...A,...b],k=pp(S);return D.extentsMin=k.min.slice(),D.extentsMax=k.max.slice(),D.furthestVertexFromOrigin=k.furthestVertexFromOrigin,D.originNegate=Nt(k.origin),hf(D.originNegate,D.originNegate),D.fieldOfViewDeObliqueMM=[i[1]*s[1],i[2]*s[2],i[3]*s[3]],D}function Dp(a){const e=a.length;let t=0;const i=new Uint8Array(e+Math.ceil(.01*e)),r=new Int8Array(i.buffer);let s=0;for(;t<e;){let n=a[t];t++;let o=1;for(;o<129&&t<e&&a[t]===n;)t++,o++;if(o>1){r[s]=-o+1,s++,i[s]=n,s++;continue}for(;t<e&&!(o>127||t+2<e&&n!==a[t]&&a[t+2]===a[t]&&a[t+1]===a[t]);)n=a[t],t++,o++;i[s]=o-1,s++;for(let c=0;c<o;c++)i[s]=a[t-o+c],s++}return V.debug("PackBits "+e+" -> "+s+" bytes (x"+e/s+")"),i.slice(0,s)}function lo(a,e){const t=new Uint8Array(a.buffer),i=new Int8Array(t.buffer);let r=0;const s=new Uint8Array(e);let n=0;for(;r<t.length;){const o=i[r];if(r++,o<0){const c=i[r];r++;for(let l=0;l<1-o;l++)s[n]=c,n++}else for(let c=0;c<o+1;c++)s[n]=i[r],r++,n++}return s}var _p=({drawUndoBitmaps:a,currentDrawUndoBitmap:e,drawBitmap:t})=>{const i=a.length;if(i<1){V.debug("undo bitmaps not loaded");return}if(e--,e<0&&(e=i-1),e>=i&&(e=0),a[e].length<2){V.debug("drawUndo is misbehaving");return}return t=lo(a[e],t.length),{drawBitmap:t,currentDrawUndoBitmap:e}};function Sp(a,e,t){const{dimX:i,dimY:r,dimZ:s}=t;let n;if(a===0)n=s;else if(a===1)n=r;else if(a===2)n=i;else return null;let o=-1,c=-1;for(let l=0;l<n;l++){let h=!1;if(a===0){const d=l*i*r;for(let f=0;f<i*r;f++)if(e[d+f]>0){h=!0;break}}else if(a===1)for(let d=0;d<s;d++){for(let f=0;f<i;f++){const u=f+l*i+d*i*r;if(e[u]>0){h=!0;break}}if(h)break}else if(a===2)for(let d=0;d<s;d++){for(let f=0;f<r;f++){const u=l+f*i+d*i*r;if(e[u]>0){h=!0;break}}if(h)break}h&&(o===-1&&(o=l),c=l)}return o===-1||c===-1?null:{first:o,last:c}}function Bn(a,e,t,i){const{dimX:r,dimY:s,dimZ:n}=i;let o;if(e===0){o=new Float32Array(r*s);const c=a*r*s;for(let l=0;l<r*s;l++)o[l]=t[c+l]}else if(e===1){o=new Float32Array(r*n);for(let c=0;c<n;c++)for(let l=0;l<r;l++){const h=l+a*r+c*r*s,d=l+c*r;o[d]=t[h]}}else if(e===2){o=new Float32Array(s*n);for(let c=0;c<n;c++)for(let l=0;l<s;l++){const h=a+l*r+c*r*s,d=l+c*s;o[d]=t[h]}}else throw new Error("Invalid slice type");return o}function Pn(a,e,t,i,r){const{dimX:s,dimY:n,dimZ:o}=i;let c;if(e===0){c=new Float32Array(s*n);const l=a*s*n;for(let h=0;h<s*n;h++)c[h]=t[l+h]/r}else if(e===1){c=new Float32Array(s*o);for(let l=0;l<o;l++)for(let h=0;h<s;h++){const d=h+a*s+l*s*n,f=h+l*s;c[f]=t[d]/r}}else if(e===2){c=new Float32Array(n*o);for(let l=0;l<o;l++)for(let h=0;h<n;h++){const d=a+h*s+l*s*n,f=h+l*n;c[f]=t[d]/r}}else throw new Error("Invalid slice type");return c}function Fp(a,e,t,i,r,s,n){const{dimX:o,dimY:c,dimZ:l}=r;if(t===0){const h=e*o*c;for(let d=0;d<a.length;d++)a[d]>=s&&(i[h+d]=n)}else if(t===1)for(let h=0;h<l;h++)for(let d=0;d<o;d++){const f=d+h*o,u=d+e*o+h*o*c;a[f]>=s&&(i[u]=n)}else if(t===2)for(let h=0;h<l;h++)for(let d=0;d<c;d++){const f=d+h*c,u=e+d*o+h*o*c;a[f]>=s&&(i[u]=n)}else throw new Error("Invalid slice type")}function ml(a,e,t){if(e<3||t<3)return;const i=new Float32Array(a.length);for(let r=0;r<t;r++)for(let s=0;s<e;s++){const n=s+r*e;s===0||s===e-1?i[n]=a[n]:i[n]=(a[n-1]+2*a[n]+a[n+1])*.25}for(let r=0;r<t;r++)for(let s=0;s<e;s++){const n=s+r*e;r===0||r===t-1?a[n]=i[n]:a[n]=(i[n-e]+2*i[n]+i[n+e])*.25}}function Rp(a,e,t,i){const r=Math.abs(t-a),s=Math.abs(t-e),n=Math.exp(-r*r/(2*i*i)),o=Math.exp(-s*s/(2*i*i)),c=n+o;return c<1e-6?.5:n/c}function Np(a,e,t,i,r,s){const n=(t-i)/(r-i),o=1-n;for(let c=0;c<a.length;c++)s[c]=a[c]*o+e[c]*n}function kp(a,e,t,i,r,s,n,o,c,l){const h=(t-i)/(r-i),d=1-h;for(let f=0;f<a.length;f++)if(a[f]>0||e[f]>0){const u=Rp(o[f],c[f],l[f],n.intensitySigma),m=n.intensityWeight,p=m*u+(1-m)*d,g=1-p;s[f]=a[f]*p+e[f]*g}else s[f]=a[f]*d+e[f]*h}function Up(a,e,t,i,r,s,n,o){const{dimX:c,dimY:l,dimZ:h}=e,d=n.sliceType??0;let f,u,m;if(d===0)f=c,u=l,m=h-1;else if(d===1)f=c,u=h,m=l-1;else if(d===2)f=l,u=h,m=c-1;else throw new Error("Invalid slice type. Must be AXIAL, CORONAL, or SAGITTAL");const p={intensityWeight:n.intensityWeight??.7,binaryThreshold:n.binaryThreshold??.375,intensitySigma:n.intensitySigma??.1,applySmoothingToSlices:n.applySmoothingToSlices??!0,useIntensityGuided:n.useIntensityGuided??!0};if(r!==void 0&&s!==void 0){if(r>=s)throw new Error("Low slice index must be less than high slice index");if(r<0||s>m)throw new Error(`Slice indices out of bounds [0, ${m}]`)}const g=new Map;for(let b=0;b<=m;b++){const A=Bn(b,d,a,e);for(let y=0;y<A.length;y++){const x=A[y];if(x>0)if(!g.has(x))g.set(x,{min:b,max:b});else{const E=g.get(x);E.min=Math.min(E.min,b),E.max=Math.max(E.max,b)}}}for(const[b,A]of g){const y=r!==void 0?Math.max(r,A.min):A.min,x=s!==void 0?Math.min(s,A.max):A.max;if(y>=x||x-y<2)continue;const E=Bn(y,d,a,e),I=Bn(x,d,a,e),w=new Float32Array(E.length),v=new Float32Array(I.length);for(let M=0;M<E.length;M++)w[M]=E[M]===b?1:0,v[M]=I[M]===b?1:0;p.applySmoothingToSlices&&(ml(w,f,u),ml(v,f,u));for(let M=y+1;M<x;M++){const C=new Float32Array(f*u);if(p.useIntensityGuided&&t){const D=Pn(y,d,t,e,i),S=Pn(x,d,t,e,i),k=Pn(M,d,t,e,i);kp(w,v,M,y,x,C,p,D,S,k)}else Np(w,v,M,y,x,C);Fp(C,M,d,a,e,p.binaryThreshold,b)}}o()}var Yr=`#version 300 es
#line 4
layout(location=0) in vec3 pos;
layout(location=1) in vec3 texCoords;
uniform mat4 mvpMtx;
out vec3 vColor;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
	vColor = texCoords;
}`,Bo=`
	vec4 drawColor(float scalar, float drawOpacity) {
		float nlayer = float(textureSize(colormap, 0).y);
		float layer = (nlayer - 0.5) / nlayer;
		vec4 dcolor = texture(colormap, vec2((scalar * 255.0)/256.0 + 0.5/256.0, layer)).rgba;
		dcolor.a *= drawOpacity;
		return dcolor;
}`,Ns=`vec3 GetBackPosition(vec3 startPositionTex) {
	vec3 startPosition = startPositionTex * volScale;
	vec3 invR = 1.0 / rayDir;
	vec3 tbot = invR * (vec3(0.0)-startPosition);
	vec3 ttop = invR * (volScale-startPosition);
	vec3 tmax = max(ttop, tbot);
	vec2 t = min(tmax.xx, tmax.yz);
	vec3 endPosition = startPosition + (rayDir * min(t.x, t.y));
	//convert world position back to texture position:
	endPosition = endPosition / volScale;
	return endPosition;
}

float distance2Plane(in vec4 samplePos, in vec4 clipPlane) {
	// treat clipPlane.a > 1 as "no clip" sentinel (keeps existing behavior)
	if (clipPlane.a > 1.0) {
			return 1000.0; // sentinel large distance
	}
	vec3 n = clipPlane.xyz;
	const float EPS = 1e-6;
	float nlen = length(n);
	if (nlen < EPS) {
			return 1000.0; // invalid plane normal
	}
	// signed plane value: dot(n, p-0.5) + a
	float signedDist = dot(n, samplePos.xyz - 0.5) + clipPlane.a;
	// perpendicular (Euclidean) distance is |signedDist| / |n|
	return abs(signedDist) / nlen;
}

// see if clip plane trims ray sampling range sampleStartEnd.x..y
void clipSampleRange(in vec3 dir, in vec4 rayStart, in vec4 clipPlane, inout vec2 sampleStartEnd, inout bool hasClip) {
	const float CSR_EPS = 1e-6;
	// quick exit: no clip plane
	if (clipPlane.a > 1.0)
			return;
	hasClip = true;
	// quick exit: empty range
	if ((sampleStartEnd.y - sampleStartEnd.x) <= CSR_EPS)
			return;
	// Which side does the ray start on? (plane eqn: dot(n, p-0.5) + a = 0)
	float sampleSide = dot(clipPlane.xyz, rayStart.xyz - 0.5) + clipPlane.a;
	bool startsFront = (sampleSide < 0.0);
	float dis = - 1.0;
	// plane normal dot ray direction
	float cdot = dot(dir, clipPlane.xyz);
	// avoid division by 0 for near-parallel plne
	if (abs(cdot) >= CSR_EPS)
		dis = (-clipPlane.a - dot(clipPlane.xyz, rayStart.xyz - 0.5)) / cdot;
	if (dis < 0.0 || dis > sampleStartEnd.y + CSR_EPS) {
			if (startsFront)
				sampleStartEnd = vec2(0.0, 0.0);
			return;
	}
	bool frontface = (cdot > 0.0);
	if (frontface)
		sampleStartEnd.x = max(sampleStartEnd.x, dis);
	else
		sampleStartEnd.y = min(sampleStartEnd.y, dis);
	// if nothing remains, mark empty
	if (sampleStartEnd.y - sampleStartEnd.x <= CSR_EPS)
		sampleStartEnd = vec2(0.0, 0.0);
}

bool skipSample (float pos, vec2 sampleRange) {
	return (pos < sampleRange.x || pos > sampleRange.y);
}

float frac2ndc(vec3 frac) {
//https://stackoverflow.com/questions/7777913/how-to-render-depth-linearly-in-modern-opengl-with-gl-fragcoord-z-in-fragment-sh
	vec4 pos = vec4(frac.xyz, 1.0); //fraction
	vec4 dim = vec4(vec3(textureSize(volume, 0)), 1.0);
	pos = pos * dim;
	vec4 shim = vec4(-0.5, -0.5, -0.5, 0.0);
	pos += shim;
	vec4 mm = transpose(matRAS) * pos;
	float z_ndc = (mvpMtx * vec4(mm.xyz, 1.0)).z;
	return (z_ndc + 1.0) / 2.0;
}`+Bo,Po=`void main() {
	if (fColor.x > 2.0) {
		fColor = vec4(1.0, 0.0, 0.0, 0.5);
		return;
	}
	fColor = vec4(0.0,0.0,0.0,0.0);
	vec4 clipPlaneColorX = clipPlaneColor;
	//if (clipPlaneColor.a < 0.0)
	//	clipPlaneColorX.a = - 1.0;
	bool isColorPlaneInVolume = false;
	if (clipPlaneColorX.a < 0.0) {
		isColorPlaneInVolume = true;
		clipPlaneColorX.a = 0.0;
	}
	//fColor = vec4(vColor.rgb, 1.0); return;
	vec3 start = vColor;
	gl_FragDepth = 1.0;
	vec3 backPosition = GetBackPosition(start);
	// fColor = vec4(backPosition, 1.0); return;
	vec3 dir = normalize(backPosition - start);
	//clipVolumeStart(start, backPosition);
	dir = normalize(dir);
	float len = length(backPosition - start);
	float lenVox = length((texVox * start) - (texVox * backPosition));
	if ((lenVox < 0.5) || (len > 3.0)) { //length limit for parallel rays
		return;
	}
	float sliceSize = len / lenVox; //e.g. if ray length is 1.0 and traverses 50 voxels, each voxel is 0.02 in unit cube
	float stepSize = sliceSize; //quality: larger step is faster traversal, but fewer samples
	float opacityCorrection = stepSize/sliceSize;
	vec4 deltaDir = vec4(dir.xyz * stepSize, stepSize);
	vec4 samplePos = vec4(start.xyz, 0.0); //ray position

	vec2 sampleRange = vec2(0.0, len);
	bool hasClip = false;
	for (int i = 0; i < MAX_CLIP_PLANES; i++)
		clipSampleRange(dir, samplePos, clipPlanes[i], sampleRange, hasClip);
	bool isClip = (sampleRange.x > 0.0) || ((sampleRange.y < len) && (sampleRange.y > 0.0));
	float stepSizeFast = sliceSize * 1.9;
	vec4 deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	if ((isClipCutaway) && (sampleRange.x <= 0.0) && (sampleRange.y >= len)) {
		//completely clipped, but ray does not intersect plane
		if (hasClip)
			samplePos.a = len + 1.0;
		else
			sampleRange = vec2(0.0, 0.0);
	}
	if ((!isClipCutaway) && (sampleRange.x >= sampleRange.y))
		samplePos.a = len + 1.0;
	while (samplePos.a <= len) {
		if (skipSample(samplePos.a, sampleRange) ^^ isClipCutaway) {
			samplePos += deltaDirFast;
			continue;
		}
		float val = texture(volume, samplePos.xyz).a;
		if (val > 0.01)
			break;
		samplePos += deltaDirFast; //advance ray position
	}
	float drawOpacityA = renderDrawAmbientOcclusionXY.y;
	if ((samplePos.a >= len) && (((overlays < 1.0) && (drawOpacityA <= 0.0) ) || (backgroundMasksOverlays > 0)))  {
		if (isClip)
			fColor += clipPlaneColorX;
		return;
	}
	fColor = vec4(1.0, 1.0, 1.0, 1.0);
	//gl_FragDepth = frac2ndc(samplePos.xyz); //crude due to fast pass resolution
	if (samplePos.a > deltaDirFast.a )
		samplePos -= deltaDirFast;
	//end: fast pass
	vec4 colAcc = vec4(0.0,0.0,0.0,0.0);
	vec4 firstHit = vec4(0.0,0.0,0.0,2.0 * len);
	const float earlyTermination = 0.95;
	float backNearest = len; //assume no hit
	float ran = fract(sin(gl_FragCoord.x * 12.9898 + gl_FragCoord.y * 78.233) * 43758.5453);
	// clip planes create steep gradients: reduce aliasing with more jitter
	if (isClip)
		samplePos += deltaDir * ran * 1.41; //jitter ray
	else
		samplePos += deltaDir * ran; //jitter ray
`,Tn=`
	if (firstHit.a < len) {
		gl_FragDepth = frac2ndc(firstHit.xyz);
		vec4 paqdSample = texture(paqd, samplePos.xyz);
		if (paqdSample.a > 0.0) {
			//colAcc.rgb = paqdSample.rgb;
			float a = max(abs(paqdUniforms[2]), abs(paqdUniforms[3]));
			colAcc.rgb = mix(colAcc.rgb, paqdSample.rgb, 0.5 * paqdSample.a * a);
		}
		if (isClip) {
			//shade voxels with clip color
			if (clipPlaneColor.a < 0.0) {
					float thresh = 4.0 * sliceSize;
					float firstHit1 = firstHit.a + deltaDir.a;
				if (isClipCutaway) {
					float min1 = abs(firstHit1 - sampleRange.y);
					float dx = samplePos.a - firstHit1;
					if (min1 < thresh)
						colAcc.rgb = mix(colAcc.rgb, clipPlaneColorX.rgb, abs(clipPlaneColor.a));
					else if (( colAcc.a > earlyTermination ) && (dx > thresh)) {
						min1 = abs(firstHit1 - sampleRange.x);
						if (min1 < (thresh * 0.5)) {
							colAcc.rgb = mix(colAcc.rgb , clipPlaneColorX.rgb, abs(clipPlaneColor.a)*0.5);
						}
							
					}
				} else {
					if (abs(firstHit1 - sampleRange.x) < thresh)
						colAcc.rgb = mix(colAcc.rgb, clipPlaneColorX.rgb, abs(clipPlaneColor.a));
				} // clipPlaneColor.a < 0.0
			}
			//ambient occlusion: make creases dark
			float min1 = 1000.0;
			float min2 = 1000.0;
			// find smallest and second-smallest distances
			vec4 firstHit1 = firstHit - deltaDir;
			for (int i = 0; i < MAX_CLIP_PLANES; i++) {
				float d = distance2Plane(firstHit1, clipPlanes[i]);
				if (d < min1) {
						min2 = min1;
						min1 = d;
				} else if (d < min2) {
						min2 = d;
				}
			}
			float thresh = 1.2 * sliceSize;
			if ((isClipCutaway) && (min2 < thresh) && (sampleRange.x > 0.0)) {
				if ((abs(sampleRange.x - firstHit.a) > ( 2.0 * thresh)) && ((abs(sampleRange.y - firstHit.a) > (2.0 * thresh))))
					min2 = thresh; 
			}
			// if second is 0 -> factor 0 (black), if second >= sliceSize -> factor 1 (unchanged)
			const float aoFrac = 0.5;
			float factor = (1.0 - aoFrac) + aoFrac * clamp(min2 / thresh, 0.0, 1.0);
			// linear darkening: multiply color by factor (or use mix(vec3(0), colAcc.rgb, factor))
			colAcc.rgb *= factor;
		}
	}
	colAcc.a = (colAcc.a / earlyTermination) * backOpacity;
	fColor = colAcc;
	float renderDrawAmbientOcclusionX = renderDrawAmbientOcclusionXY.x;
	float drawOpacity = renderDrawAmbientOcclusionXY.y;
	if ((overlays < 1.0) && (drawOpacity <= 0.0))
		return;
	//overlay pass
	samplePos = vec4(start.xyz, 0.0); //ray position
	//start: OPTIONAL fast pass: rapid traversal until first hit
	stepSizeFast = sliceSize * 1.0;
	deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	while (samplePos.a <= len) {
		float val = texture(overlay, samplePos.xyz).a;
		if (drawOpacity > 0.0)
			val = max(val, texture(drawing, samplePos.xyz).r);
		if (val > 0.001)
			break;
		samplePos += deltaDirFast; //advance ray position
	}
	if (samplePos.a >= len) {
		if (isClip && (fColor.a == 0.0))
				fColor += clipPlaneColorX;
			return;
	}
	samplePos -= deltaDirFast;
	if (samplePos.a < 0.0)
		vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	//end: fast pass
	float overFarthest = len;
	colAcc = vec4(0.0, 0.0, 0.0, 0.0);

	samplePos += deltaDir * ran; //jitter ray
	vec4 overFirstHit = vec4(0.0,0.0,0.0,2.0 * len);
	if (backgroundMasksOverlays > 0)
		samplePos = firstHit;
	bool firstDraw = true;
	while (samplePos.a <= len) {
		vec4 colorSample = texture(overlay, samplePos.xyz);
		if ((colorSample.a < 0.01) && (drawOpacity > 0.0)) {
			float val = texture(drawing, samplePos.xyz).r;
			vec4 draw = drawColor(val, drawOpacity);
			if ((draw.a > 0.0) && (firstDraw)) {
				firstDraw = false;
				float sum = 0.0;
				const float mn = 1.0 / 256.0;
				const float sampleRadius = 1.1;
				float dx = sliceSize * sampleRadius;
				vec3 center = samplePos.xyz;
				//six neighbors that share a face
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,0.0,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,0.0,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,+dx,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,-dx,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,0.0,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,0.0,0.0), dir)).r, mn);
				//float proportion = (sum / mn) / 6.0;
				
				//12 neighbors that share an edge
				dx = sliceSize * sampleRadius * sqrt(2.0) * 0.5;
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,+dx,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,0.0,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,+dx,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,-dx,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,0.0,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,-dx,0.0), dir)).r, mn);

				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,+dx,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,0.0,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,-dx,0.0), dir)).r, mn);
				
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,-dx,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,0.0,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,+dx,0.0), dir)).r, mn);
				float proportion = (sum / mn) / 18.0; //proportion of six neighbors is non-zero
				
				//a high proportion of hits means crevice
				//since the AO term adds shadows that darken most voxels, it will result in dark surfaces
				//the term brighten adds a little illumination to balance this
				// without brighten, only the most extreme ridges will not be darker
				const float brighten = 1.2;
				vec3 ao = draw.rgb * (1.0 - proportion) * brighten;
				draw.rgb = mix (draw.rgb, ao , renderDrawAmbientOcclusionX);
			}
			colorSample = draw;
		}
		samplePos += deltaDir; //advance ray position
		if (colorSample.a >= 0.01) {
			if (overFirstHit.a > len)
				overFirstHit = samplePos;
			colorSample.a *= renderOverlayBlend;
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			overFarthest = samplePos.a;
			if ( colAcc.a > earlyTermination )
				break;
		}
	}
	//if (samplePos.a >= len) {
	if (colAcc.a <= 0.0) {
		if (isClip && (fColor.a == 0.0))
			fColor += clipPlaneColorX;
		return;
	}
	if (overFirstHit.a < firstHit.a)
		gl_FragDepth = frac2ndc(overFirstHit.xyz);
	float overMix = colAcc.a;
	float overlayDepth = 0.3;
	if (fColor.a <= 0.0)
		overMix = 1.0;
	else if (((overFarthest) > backNearest)) {
		float dx = (overFarthest - backNearest)/1.73;
		dx = fColor.a * pow(dx, overlayDepth);
		overMix *= 1.0 - dx;
	}
	fColor.rgb = mix(fColor.rgb, colAcc.rgb, overMix);
	fColor.a = max(fColor.a, colAcc.a);
}`,jp=`#version 300 es
#line 215
#define MAX_CLIP_PLANES 6
precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 texVox;
uniform int backgroundMasksOverlays;
uniform vec3 volScale;
uniform vec4 clipPlane;
uniform vec4 clipPlanes[MAX_CLIP_PLANES];
uniform highp sampler3D volume, overlay;
uniform highp sampler3D paqd;
uniform vec4 paqdUniforms;
uniform float overlays;
uniform float backOpacity;
uniform mat4 mvpMtx;
uniform mat4 matRAS;
uniform vec4 clipPlaneColor;
uniform float renderOverlayBlend;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
uniform vec2 renderDrawAmbientOcclusionXY;
in vec3 vColor;
out vec4 fColor;
`+Ns+`
	void main() {
	vec3 start = vColor;
	gl_FragDepth = 1.0;
	vec3 backPosition = GetBackPosition(start);
	vec3 dir = normalize(backPosition - start);
	//clipVolumeStart(start, backPosition);
	float len = length(backPosition - start);
	float lenVox = length((texVox * start) - (texVox * backPosition));
	if ((lenVox < 0.5) || (len > 3.0)) { //length limit for parallel rays
		fColor = vec4(0.0,0.0,0.0,0.0);
		return;
	}
	float sliceSize = len / lenVox; //e.g. if ray length is 1.0 and traverses 50 voxels, each voxel is 0.02 in unit cube
	float stepSize = sliceSize; //quality: larger step is faster traversal, but fewer samples
	float opacityCorrection = stepSize/sliceSize;
	vec4 deltaDir = vec4(dir.xyz * stepSize, stepSize);
	vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	vec4 colAcc = vec4(0.0,0.0,0.0,0.0);
	vec4 firstHit = vec4(0.0,0.0,0.0,2.0 * len);
	const float earlyTermination = 0.95;
	float backNearest = len; //assume no hit
	float dis = len;
	//check if axial plane is closest
	vec4 aClip = vec4(0.0, 0.0, 1.0, (1.0- clipPlane.z) - 0.5);
	float adis = (-aClip.a - dot(aClip.xyz, samplePos.xyz-0.5)) / dot(dir,aClip.xyz);
	if (adis > 0.0)
		dis = min(adis, dis);
	//check of coronal plane is closest
	vec4 cClip = vec4(0.0, 1.0, 0.0, (1.0- clipPlane.y) - 0.5);
	float cdis = (-cClip.a - dot(cClip.xyz, samplePos.xyz-0.5)) / dot(dir,cClip.xyz);
	if (cdis > 0.0)
		dis = min(cdis, dis);
	//check if coronal slice is closest
	vec4 sClip = vec4(1.0, 0.0, 0.0, (1.0- clipPlane.x) - 0.5);
	float sdis = (-sClip.a - dot(sClip.xyz, samplePos.xyz-0.5)) / dot(dir,sClip.xyz);
	if (sdis > 0.0)
		dis = min(sdis, dis);
	if ((dis > 0.0) && (dis < len)) {
		samplePos = vec4(samplePos.xyz+dir * dis, dis);
		colAcc = texture(volume, samplePos.xyz);
		colAcc.a = earlyTermination;
		firstHit = samplePos;
		backNearest = min(backNearest, samplePos.a);
	}
	//the following are only used by overlays
	vec4 clipPlaneColorX = clipPlaneColor;
	bool isColorPlaneInVolume = false;
	bool isClip = false;
	bool isClipCutaway = false;
	vec2 sampleRange;
	// vec4 clipPos = applyClip(dir, samplePos, len, isClip);
	float stepSizeFast = sliceSize * 1.9;
	vec4 deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	if (samplePos.a < 0.0)
		vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	float ran = fract(sin(gl_FragCoord.x * 12.9898 + gl_FragCoord.y * 78.233) * 43758.5453);
	samplePos += deltaDir * ran; //jitter ray
`+Tn,Bp=`#version 300 es
#line 215
#define MAX_CLIP_PLANES 6
precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 texVox;
uniform int backgroundMasksOverlays;
uniform vec3 volScale;
uniform vec4 clipPlane;
uniform vec4 clipPlanes[MAX_CLIP_PLANES];
uniform bool isClipCutaway;
uniform highp sampler3D volume, overlay;
uniform highp sampler3D paqd;
uniform vec4 paqdUniforms;
uniform float overlays;
uniform float backOpacity;
uniform mat4 mvpMtx;
uniform mat4 matRAS;
uniform vec4 clipPlaneColor;
uniform float renderOverlayBlend;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
uniform vec2 renderDrawAmbientOcclusionXY;
in vec3 vColor;
out vec4 fColor;
`+Ns+Po+`while (samplePos.a <= len) {
		if (skipSample(samplePos.a, sampleRange) ^^ isClipCutaway) {
			samplePos += deltaDirFast;
			continue;
		}
		vec4 colorSample = texture(volume, samplePos.xyz);
		samplePos += deltaDir; //advance ray position
		if (colorSample.a >= 0.01) {
			if (firstHit.a > len)
				firstHit = samplePos;
			// backNearest = min(backNearest, samplePos.a);
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			if ( colAcc.a > earlyTermination )
				break;
		}
	}
	if (firstHit.a < len)
		backNearest = firstHit.a;
`+Tn,hs=192,zh=`#version 300 es
#line 215
#define MAX_CLIP_PLANES 6
precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 texVox;
uniform int backgroundMasksOverlays;
uniform vec3 volScale;
uniform vec4 clipPlane;
uniform vec4 clipPlanes[MAX_CLIP_PLANES];
uniform bool isClipCutaway;
uniform highp sampler3D volume, overlay;
uniform highp sampler3D paqd;
uniform vec4 paqdUniforms;
uniform float overlays;
uniform float backOpacity;
uniform mat4 mvpMtx;
uniform mat4 normMtx;
uniform mat4 matRAS;
uniform vec4 clipPlaneColor;
uniform float renderOverlayBlend;
uniform highp sampler3D drawing, gradient;
uniform highp sampler2D colormap;
uniform highp sampler2D matCap;
uniform vec2 renderDrawAmbientOcclusionXY;
uniform float gradientAmount;
uniform float silhouettePower;
uniform float gradientOpacity[${hs}];
in vec3 vColor;
out vec4 fColor;
`,Pp=zh+Ns+Po+`
	float startPos = samplePos.a;
	float clipCloseThresh = 5.0 * deltaDir.a;
	float clipClose = sampleRange.x;
	if (isClipCutaway)
		clipClose = sampleRange.y;
	if (!isClip)
		clipClose = -1.0;
	float brighten = 2.0; //modulating makes average intensity darker 0.5 * 0.5 = 0.25
	//vec4 prevGrad = vec4(0.0);
	float silhouetteThreshold = 1.0 - silhouettePower;
	while (samplePos.a <= len) {
		if (skipSample(samplePos.a, sampleRange) ^^ isClipCutaway) {
			samplePos += deltaDirFast;
			continue;
		}
		vec4 colorSample = texture(volume, samplePos.xyz);
		if (colorSample.a >= 0.0) {
			vec4 grad = texture(gradient, samplePos.xyz);
			grad.rgb = normalize(grad.rgb*2.0 - 1.0);
			//if (grad.a < prevGrad.a)
			//	grad.rgb = prevGrad.rgb;
			//prevGrad = grad;
			vec3 n = mat3(normMtx) * grad.rgb;
			n.y = - n.y;
			vec4 mc = vec4(texture(matCap, n.xy * 0.5 + 0.5).rgb, 1.0) * brighten;
			mc = mix(vec4(1.0), mc, gradientAmount);
			if (abs(samplePos.a - clipClose) > clipCloseThresh)
				colorSample.rgb *= mc.rgb;
			if (firstHit.a > len)
				firstHit = samplePos;
			backNearest = min(backNearest, samplePos.a);
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			int gradIdx = int(grad.a * ${hs}.0);
			colorSample.a *= gradientOpacity[gradIdx];
			float lightNormDot = dot(grad.rgb, rayDir);
			// n.b. "lightNormDor" is cosTheta, "silhouettePower" is Fresnel effect exponent
 			colorSample.a *= pow(1.0 - abs(lightNormDot), silhouettePower);
 			float viewAlign = abs(lightNormDot); // 0 = perpendicular, 1 = aligned
 			// linearly map silhouettePower (0..1) to a threshold range, e.g., [1.0, 0.0]
 			// Cull voxels that are too aligned with the view direction
 			if (viewAlign > silhouetteThreshold)
 				colorSample.a = 0.0;
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			if ( colAcc.a > earlyTermination )
				break;
		}
		samplePos += deltaDir; //advance ray position
	}
`+Tn,Op=zh+Ns+Po+`
	float startPos = samplePos.a;
	//float clipClose = clipPos.a + 3.0 * deltaDir.a; //do not apply gradients near clip plane
	float brighten = 2.0; //modulating makes average intensity darker 0.5 * 0.5 = 0.25
	//vec4 prevGrad = vec4(0.0);
	while (samplePos.a <= len) {
		vec4 colorSample = texture(volume, samplePos.xyz);
		if (colorSample.a >= 0.0) {
			vec4 grad = texture(gradient, samplePos.xyz);
			colorSample.rgb = abs(normalize(grad.rgb*2.0 - 1.0));
			if (firstHit.a > len)
				firstHit = samplePos;
			backNearest = min(backNearest, samplePos.a);
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			if ( colAcc.a > earlyTermination )
				break;
		}
		samplePos += deltaDir; //advance ray position
	}
`+Tn,Ks=`#version 300 es
#line 392
layout(location=0) in vec3 pos;
uniform int axCorSag;
uniform mat4 mvpMtx;
uniform mat4 frac2mm;
uniform float slice;
out vec3 texPos;
void main(void) {
	texPos = vec3(pos.x, pos.y, slice);
	if (axCorSag > 1)
		texPos = vec3(slice, pos.x, pos.y);
	else if (axCorSag > 0)
		texPos = vec3(pos.x, slice, pos.y);
	vec4 mm = frac2mm * vec4(texPos, 1.0);
	gl_Position = mvpMtx * mm;
}`,Kh=`#version 300 es
#line 411
precision highp int;
precision highp float;
uniform highp sampler3D volume, overlay;
uniform highp sampler3D paqd;
uniform vec4 paqdUniforms;
uniform int backgroundMasksOverlays;
uniform float overlayOutlineWidth;
uniform float overlayAlphaShader;
uniform int axCorSag;
uniform float overlays;
uniform float opacity;
uniform float drawOpacity;
uniform float drawRimOpacity;
uniform bool isAlphaClipDark;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
in vec3 texPos;
out vec4 color;
`+Bo+`
vec4 blendRGBA(vec4 foreground, vec4 background) {
  float alphaOut = foreground.a + background.a * (1.0 - foreground.a);
  vec3 colorOut = (foreground.rgb * foreground.a + background.rgb * background.a * (1.0 - foreground.a)) / alphaOut;
  return vec4(colorOut, alphaOut);
}
float paqdEaseAlpha(float alpha) {
  // t are alpha transitions
  // <t0 -> y0
  // t0..t1  -> mix between y0..y1
  // t1..t2 -> mix between y1..y2
  // >t2 -> y2
  float t0 = paqdUniforms[0]; // 0.3;
  float t1 = 0.5 * (paqdUniforms[0] + paqdUniforms[1]); // 0.4;
  float t2 = paqdUniforms[1]; // 0.9;
  float y0 = 0.0;
  float y1 = abs(paqdUniforms[2]); // 1.0;
  float y2 = abs(paqdUniforms[3]); //0.25;
  if (alpha <= t0) {
    return y0;
  } else if (alpha <= t1) {
    return mix(y0, y1, (alpha - t0) / (t1 - t0)); // LERP 0.0  1.0
  } else if (alpha <= t2) {
    return mix(y1, y2, (alpha - t1) / (t2 - t1)); // LERP 1.0  0.2
  } else {
    return y2;
  }
}

void main() {
	//color = vec4(1.0, 0.0, 1.0, 1.0);return;
	vec4 background = texture(volume, texPos);
	color = vec4(background.rgb, opacity);
	if ((isAlphaClipDark) && (background.a == 0.0)) color.a = 0.0; //FSLeyes clipping range
	vec4 ocolor = vec4(0.0);
	float overlayAlpha = overlayAlphaShader;
	if (overlays > 0.0) {
		ocolor = texture(overlay, texPos);
		//dFdx for "boxing" issue 435 has aliasing on some implementations (coarse vs fine)
		//however, this only identifies 50% of the edges due to aliasing effects
		// http://www.aclockworkberry.com/shader-derivative-functions/
		// https://bgolus.medium.com/distinctive-derivative-differences-cce38d36797b
		//if ((ocolor.a >= 1.0) && ((dFdx(ocolor.a) != 0.0) || (dFdy(ocolor.a) != 0.0)  ))
		//	ocolor.rbg = vec3(0.0, 0.0, 0.0);
		bool isOutlineBelowNotAboveThreshold = true;
		if (isOutlineBelowNotAboveThreshold) {
			if ((overlayOutlineWidth > 0.0) && (ocolor.a < 1.0)) { //check voxel neighbors for edge
				vec3 vx = (overlayOutlineWidth ) / vec3(textureSize(overlay, 0));
				//6 voxel neighbors that share a face
				vec3 vxR = vec3(texPos.x+vx.x, texPos.y, texPos.z);
				vec3 vxL = vec3(texPos.x-vx.x, texPos.y, texPos.z);
				vec3 vxA = vec3(texPos.x, texPos.y+vx.y, texPos.z);
				vec3 vxP = vec3(texPos.x, texPos.y-vx.y, texPos.z);
				vec3 vxS = vec3(texPos.x, texPos.y, texPos.z+vx.z);
				vec3 vxI = vec3(texPos.x, texPos.y, texPos.z-vx.z);
				float a = 0.0;
				if (axCorSag != 2) {
					a = max(a, texture(overlay, vxR).a);
					a = max(a, texture(overlay, vxL).a);
				}
				if (axCorSag != 1) {
					a = max(a, texture(overlay, vxA).a);
					a = max(a, texture(overlay, vxP).a);
				}
				if (axCorSag != 0) {
					a = max(a, texture(overlay, vxS).a);
					a = max(a, texture(overlay, vxI).a);
				}
				bool isCheckCorners = true;
				if (isCheckCorners) {
					//12 voxel neighbors that share an edge
					vec3 vxRA = vec3(texPos.x+vx.x, texPos.y+vx.y, texPos.z);
					vec3 vxLA = vec3(texPos.x-vx.x, texPos.y+vx.y, texPos.z);
					vec3 vxRP = vec3(texPos.x+vx.x, texPos.y-vx.y, texPos.z);
					vec3 vxLP = vec3(texPos.x-vx.x, texPos.y-vx.y, texPos.z);
					vec3 vxRS = vec3(texPos.x+vx.x, texPos.y, texPos.z+vx.z);
					vec3 vxLS = vec3(texPos.x-vx.x, texPos.y, texPos.z+vx.z);
					vec3 vxRI = vec3(texPos.x+vx.x, texPos.y, texPos.z-vx.z);
					vec3 vxLI = vec3(texPos.x-vx.x, texPos.y, texPos.z-vx.z);
					vec3 vxAS = vec3(texPos.x, texPos.y+vx.y, texPos.z+vx.z);
					vec3 vxPS = vec3(texPos.x, texPos.y-vx.y, texPos.z+vx.z);
					vec3 vxAI = vec3(texPos.x, texPos.y+vx.y, texPos.z-vx.z);
					vec3 vxPI = vec3(texPos.x, texPos.y-vx.y, texPos.z-vx.z);

					if (axCorSag == 0) { //axial corners
						a = max(a, texture(overlay, vxRA).a);
						a = max(a, texture(overlay, vxLA).a);
						a = max(a, texture(overlay, vxRP).a);
						a = max(a, texture(overlay, vxLP).a);
					}
					if (axCorSag == 1) { //coronal corners
						a = max(a, texture(overlay, vxRS).a);
						a = max(a, texture(overlay, vxLS).a);
						a = max(a, texture(overlay, vxRI).a);
						a = max(a, texture(overlay, vxLI).a);
					}
					if (axCorSag == 2) { //sagittal corners
						a = max(a, texture(overlay, vxAS).a);
						a = max(a, texture(overlay, vxPS).a);
						a = max(a, texture(overlay, vxAI).a);
						a = max(a, texture(overlay, vxPI).a);
					}
				}
				if (a >= 1.0) {
					ocolor = vec4(0.0, 0.0, 0.0, 1.0);
					overlayAlpha = 1.0;
				}
			}

		} else {
			if ((overlayOutlineWidth > 0.0) && (ocolor.a >= 1.0)) { //check voxel neighbors for edge
				vec3 vx = (overlayOutlineWidth ) / vec3(textureSize(overlay, 0));
				vec3 vxR = vec3(texPos.x+vx.x, texPos.y, texPos.z);
				vec3 vxL = vec3(texPos.x-vx.x, texPos.y, texPos.z);
				vec3 vxA = vec3(texPos.x, texPos.y+vx.y, texPos.z);
				vec3 vxP = vec3(texPos.x, texPos.y-vx.y, texPos.z);
				vec3 vxS = vec3(texPos.x, texPos.y, texPos.z+vx.z);
				vec3 vxI = vec3(texPos.x, texPos.y, texPos.z-vx.z);
				float a = 1.0;
				if (axCorSag != 2) {
					a = min(a, texture(overlay, vxR).a);
					a = min(a, texture(overlay, vxL).a);
				}
				if (axCorSag != 1) {
					a = min(a, texture(overlay, vxA).a);
					a = min(a, texture(overlay, vxP).a);
				}
				if (axCorSag != 0) {
					a = min(a, texture(overlay, vxS).a);
					a = min(a, texture(overlay, vxI).a);
				}
				if (a < 1.0) {
					ocolor = vec4(0.0, 0.0, 0.0, 1.0);
					overlayAlpha = 1.0;
				}
			}
		} //outline above threshold
	}

`,Vp=`#version 300 es
#line 411
precision highp int;
precision highp float;
uniform highp sampler2D volume, overlay;
uniform int backgroundMasksOverlays;
uniform float overlayOutlineWidth;
uniform float overlayAlphaShader;
uniform int axCorSag;
uniform float overlays;
uniform float opacity;
uniform float drawOpacity;
uniform bool isAlphaClipDark;
uniform highp sampler2D drawing;
uniform highp sampler2D colormap;
in vec3 texPos;
out vec4 color;`+Bo+`void main() {
	//color = vec4(1.0, 0.0, 1.0, 1.0);return;
	vec4 background = texture(volume, texPos.xy);
	color = vec4(background.rgb, opacity);
	if ((isAlphaClipDark) && (background.a == 0.0)) color.a = 0.0; //FSLeyes clipping range
	vec4 dcolor = drawColor(texture(drawing, texPos.xy).r, drawOpacity);
	if (dcolor.a > 0.0) {
		color.rgb = mix(color.rgb, dcolor.rgb, dcolor.a);
		color.a = max(drawOpacity, color.a);
	}
}`,Hh=`	ocolor.a *= overlayAlpha;
	float drawV = texture(drawing, texPos).r;
	vec4 dcolor = drawColor(drawV, drawOpacity);
	if (dcolor.a > 0.0) {
		if (drawRimOpacity >= 0.0) {
			vec3 vx = 1.0 / vec3(textureSize(drawing, 0));
			//6 voxel neighbors that share a face
			vec3 offsetX = dFdx(texPos); // left-right spacing
			vec3 offsetY = dFdy(texPos); // up-down spacing
			float L = texture(drawing, texPos - offsetX).r;
			float R = texture(drawing, texPos + offsetX).r;
			float T = texture(drawing, texPos - offsetY).r;
			float B = texture(drawing, texPos + offsetY).r;
			if (L != drawV || R != drawV || T != drawV || B != drawV)
				dcolor.a = drawRimOpacity;
		}
		color.rgb = mix(color.rgb, dcolor.rgb, dcolor.a);
		color.a = max(drawOpacity, color.a);
	}
	vec4 pcolor = texture(paqd, texPos);
	if (pcolor.a > 0.0) {
		pcolor.a = paqdEaseAlpha(pcolor.a);
		if (pcolor.a > 0.0) {
			if (paqdUniforms[3] < 0.0)
				ocolor = blendRGBA(pcolor, ocolor);
			else
				ocolor = blendRGBA(ocolor, pcolor);
		}
	}
	if ((backgroundMasksOverlays > 0) && (background.a == 0.0))
		return;
	float a = color.a + ocolor.a * (1.0 - color.a); // premultiplied alpha
	if (a == 0.0) return;
	color.rgb = mix(color.rgb, ocolor.rgb, ocolor.a / a);
	color.a = a;
}`,Lp=Kh+Hh,Gp=Kh+`	if (ocolor.a > 0.0) {
		//https://gamedev.stackexchange.com/questions/102889/is-it-possible-to-convert-vec4-to-int-in-glsl-using-opengl-es
		uint alpha = uint(ocolor.a * 255.0);
		vec3 xyzFlip = vec3(float((uint(1) & alpha) > uint(0)), float((uint(2) & alpha) > uint(0)), float((uint(4) & alpha) > uint(0)));
		//convert from 0 and 1 to -1 and 1
		xyzFlip = (xyzFlip * 2.0) - 1.0;
		//https://math.stackexchange.com/questions/1905533/find-perpendicular-distance-from-point-to-line-in-3d
		//v1 principle direction of tensor for this voxel
		vec3 v1 = ocolor.rgb;
		//flips encode polarity to convert from 0..1 to -1..1 (27 bits vs 24 bit precision)
		v1 = normalize( v1 * xyzFlip);
		vec3 vxl = fract(texPos * vec3(textureSize(volume, 0))) - 0.5;
		//vxl coordinates now -0.5..+0.5 so 0,0,0 is origin
		vxl.x = -vxl.x;
		float t = dot(vxl,v1);
		vec3 P = t * v1;
		float dx = length(P-vxl);
		ocolor.a = 1.0 - smoothstep(0.2,0.25, dx);
		//if modulation was applied, use that to scale alpha not color:
		ocolor.a *= length(ocolor.rgb);
		ocolor.rgb = normalize(ocolor.rgb);
		//compute distance one half voxel closer to viewer:
		float pan = 0.5;
		if (axCorSag == 0)
			vxl.z -= pan;
		if (axCorSag == 1)
			vxl.y -= pan;
		if (axCorSag == 2)
			vxl.x += pan;
		t = dot(vxl,v1);
		P = t * v1;
		float dx2 = length(P-vxl);
		ocolor.rgb += (dx2-dx-(0.5 * pan)) * 1.0;
	}
`+Hh,On=`#version 300 es
#line 480
precision highp int;
precision highp float;
uniform vec4 lineColor;
out vec4 color;
void main() {
	color = lineColor;
}`,zp=`#version 300 es
#line 723
precision highp int;
precision highp float;

uniform vec4 lineColor;
uniform vec4 leftTopWidthHeight;
uniform float thickness; // line thickness in pixels
uniform vec2 canvasWidthHeight;

out vec4 color;

void main() {
    // fragment position in screen coordinates
    vec2 fragCoord = gl_FragCoord.xy;

    // canvas height
    float canvasHeight = canvasWidthHeight.y;

    // 'top' and 'bottom' to match gl_FragCoord.y coordinate system
    float top = canvasHeight - leftTopWidthHeight.y;
    float bottom = top - leftTopWidthHeight.w;

    // left and right edges
    float left = leftTopWidthHeight.x;
    float right = left + leftTopWidthHeight.z;

    bool withinLeft = fragCoord.x >= left && fragCoord.x <= left + thickness;
    bool withinRight = fragCoord.x <= right && fragCoord.x >= right - thickness;
    bool withinTop = fragCoord.y <= top && fragCoord.y >= top - thickness;
    bool withinBottom = fragCoord.y >= bottom && fragCoord.y <= bottom + thickness;

    bool isOutline = withinLeft || withinRight || withinTop || withinBottom;

    if (isOutline) {
        color = lineColor;
    } else {
        discard; 
    }
}`,Kp=`#version 300 es
#line 490
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
out vec2 vColor;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vColor = pos.xy;
}`,Hp=`#version 300 es
#line 506
precision highp int;
precision highp float;
uniform highp sampler2D colormap;
uniform float layer;
in vec2 vColor;
out vec4 color;
void main() {
	float nlayer = float(textureSize(colormap, 0).y);
	float fmap = (0.5 + layer) / nlayer;
	color = vec4(texture(colormap, vec2(vColor.x, fmap)).rgb, 1.0);
}`,gl=`#version 300 es
#line 520
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
}`,qp=`#version 300 es
#line 534
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform float thickness;
uniform vec4 startXYendXY;
void main(void) {
	vec2 posXY = mix(startXYendXY.xy, startXYendXY.zw, pos.x);
	vec2 dir = normalize(startXYendXY.xy - startXYendXY.zw);
	posXY += vec2(-dir.y, dir.x) * thickness * (pos.y - 0.5);
	posXY.x = (posXY.x) / canvasWidthHeight.x; //0..1
	posXY.y = 1.0 - (posXY.y / canvasWidthHeight.y); //1..0
	gl_Position = vec4((posXY * 2.0) - 1.0, 0.0, 1.0);
}`,Wp=`#version 300 es
#line 534
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform float thickness;
uniform vec2 startXY;
uniform vec3 endXYZ; // transformed XYZ point
void main(void) {	
	vec2 posXY = mix(startXY.xy, endXYZ.xy, pos.x);
	vec2 startDiff = endXYZ.xy - startXY.xy;
	float startDistance = length(startDiff);
	vec2 diff = endXYZ.xy - posXY;
	float currentDistance = length(diff);
	vec2 dir = normalize(startXY.xy - endXYZ.xy);
	posXY += vec2(-dir.y, dir.x) * thickness * (pos.y - 0.5);
	posXY.x = (posXY.x) / canvasWidthHeight.x; //0..1
	posXY.y = 1.0 - (posXY.y / canvasWidthHeight.y); //1..0	
	float z = endXYZ.z * ( 1.0 - abs(currentDistance/startDistance)); 
	gl_Position = vec4((posXY * 2.0) - 1.0, z, 1.0);
}`,Yp=`#version 300 es
#line 549
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
out vec2 vUV;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vUV = vec2(pos.x, 1.0 - pos.y);
}`,Xp=`#version 300 es
#line 565
precision highp int;
precision highp float;
uniform highp sampler2D bmpTexture;
in vec2 vUV;
out vec4 color;
void main() {
	color = texture(bmpTexture, vUV);
}`,Qp=`#version 300 es
#line 576
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
uniform vec4 uvLeftTopWidthHeight;
out vec2 vUV;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vUV = vec2(uvLeftTopWidthHeight.x + (pos.x * uvLeftTopWidthHeight.z), uvLeftTopWidthHeight.y  + ((1.0 - pos.y) * uvLeftTopWidthHeight.w) );
}`,Jp=`#version 300 es
#line 593
precision highp int;
precision highp float;
uniform highp sampler2D fontTexture;
uniform vec4 fontColor;
uniform float screenPxRange;
in vec2 vUV;
out vec4 color;
float median(float r, float g, float b) {
	return max(min(r, g), min(max(r, g), b));
}
void main() {
	vec3 msd = texture(fontTexture, vUV).rgb;
	float sd = median(msd.r, msd.g, msd.b);
	float screenPxDistance = screenPxRange*(sd - 0.5);
	float opacity = clamp(screenPxDistance + 0.5, 0.0, 1.0);
	color = vec4(fontColor.rgb , fontColor.a * opacity);
}`,Zp=`#version 300 es
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
uniform vec4 uvLeftTopWidthHeight;
out vec2 vUV;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vUV = pos.xy;
}`,$p=`#version 300 es
precision highp int;
precision highp float;
uniform vec4 circleColor;
uniform float fillPercent;
in vec2 vUV;
out vec4 color;
void main() {
	/* Check if the pixel is inside the circle
		 and color it with a gradient. Otherwise, color it 
		 transparent   */
	float distance = length(vUV-vec2(0.5,0.5));
	if ( distance < 0.5 && distance >= (1.0 - fillPercent) / 2.0){
			color = vec4(circleColor.r,circleColor.g,circleColor.b,circleColor.a) ;			
	}else{
			color = vec4(0.0,0.0,0.0,0.0);
	}
}
`,Ta=`#version 300 es
#line 613
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
	TexCoord = vPos.xy;
	gl_Position = vec4( (vPos.xy-vec2(0.5,0.5)) * 2.0, 0.0, 1.0);
}`,Hs=`#version 300 es
uniform highp usampler3D intensityVol;
`,Al=`#version 300 es
uniform highp isampler3D intensityVol;
`,e0=`#version 300 es
uniform highp sampler3D intensityVol;
`,yl=`#line 1042
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform bool isAdditiveBlend;
uniform float coordZ;
uniform float layer;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform float opacity;
uniform uint activeIndex;
uniform vec4 xyzaFrac;
uniform mat4 mtx;
float textureWidth;
float nlayer;
float layerY;

vec4 scalar2color(uint idx) {
	float fx = (float(idx) + 0.5) / textureWidth;
	vec4 clr = texture(colormap, vec2(fx, layerY)).rgba;
	if (clr.a > 0.0)
		clr.a = 1.0;
	clr.a *= opacity;
	return clr;
}
void main(void) {
	vec4 vx = vec4(TexCoord.x, TexCoord.y, coordZ, 1.0) * mtx;
	uint idx = uint(texture(intensityVol, vx.xyz).r);
	if (idx == uint(0)) {
		if (layer < 1.0) {
			FragColor = vec4(0.0, 0.0, 0.0, 0.0);
			return;
		}
		FragColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
		return;
	}
	textureWidth = float(textureSize(colormap, 0).x);
	nlayer = float(textureSize(colormap, 0).y);
	layerY = ((2.0 * layer) + 1.5) / nlayer;
	//idx = ((idx - uint(1)) % uint(100))+uint(1);
	FragColor = scalar2color(idx);
	bool isBorder = false;
	vx = vec4(TexCoord.x+xyzaFrac.x, TexCoord.y, coordZ, 1.0) * mtx;
	uint R = uint(texture(intensityVol, vx.xyz).r);
	vx = vec4(TexCoord.x-xyzaFrac.x, TexCoord.y, coordZ, 1.0) * mtx;
	uint L = uint(texture(intensityVol, vx.xyz).r);
	vx = vec4(TexCoord.x, TexCoord.y+xyzaFrac.y, coordZ, 1.0) * mtx;
	uint A = uint(texture(intensityVol, vx.xyz).r);
	vx = vec4(TexCoord.x, TexCoord.y-xyzaFrac.y, coordZ, 1.0) * mtx;
	uint P = uint(texture(intensityVol, vx.xyz).r);
	vx = vec4(TexCoord.x, TexCoord.y, coordZ+xyzaFrac.z, 1.0) * mtx;
	uint S = uint(texture(intensityVol, vx.xyz).r);
	vx = vec4(TexCoord.x, TexCoord.y, coordZ-xyzaFrac.z, 1.0) * mtx;
	uint I = uint(texture(intensityVol, vx.xyz).r);
	vec4 centerColor = FragColor;
	FragColor.a += scalar2color(R).a;
	FragColor.a += scalar2color(L).a;
	FragColor.a += scalar2color(A).a;
	FragColor.a += scalar2color(P).a;
	FragColor.a += scalar2color(S).a;
	FragColor.a += scalar2color(I).a;
	FragColor.a /= 7.0;
	if ((!isBorder) &&(idx == activeIndex)) {
		if (centerColor.a > 0.5)
			FragColor.a *= 0.4;
		else
			FragColor.a =0.8;
	}
	if (xyzaFrac.a != 0.0) { //outline
		if ((idx != R) || (idx != L) || (idx != A) || (idx != P) || (idx != S) || (idx != I)) {
			isBorder = true;
			if (xyzaFrac.a > 0.0)
				FragColor.a = xyzaFrac.a;
			else
				FragColor = vec4(0.0, 0.0, 0.0, 1.0);
		}
	}
	if (layer < 1.0) return;
		vec4 prevColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
		// https://en.wikipedia.org/wiki/Alpha_compositing
		float aout = FragColor.a + (1.0 - FragColor.a) * prevColor.a;
		if (aout <= 0.0) return;
		if (isAdditiveBlend)
			FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a)) / aout;
		else
			FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a * (1.0 - FragColor.a))) / aout;
		FragColor.a = aout;
}`,Vn=`#line 691
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float layer;
uniform float scl_slope;
uniform float scl_inter;
uniform float cal_max;
uniform float cal_min;
uniform float cal_maxNeg;
uniform float cal_minNeg;
uniform bool isAlphaThreshold;
uniform bool isColorbarFromZero;
uniform bool isAdditiveBlend;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform int modulation;
uniform highp sampler3D modulationVol;
uniform float opacity;
uniform mat4 mtx;
void main(void) {
	vec4 vx = vec4(TexCoord.xy, coordZ, 1.0) * mtx;
	if ((vx.x < 0.0) || (vx.x > 1.0) || (vx.y < 0.0) || (vx.y > 1.0) || (vx.z < 0.0) || (vx.z > 1.0)) {
		//set transparent if out of range
		//https://webglfundamentals.org/webgl/webgl-3d-textures-repeat-clamp.html
		FragColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
		return;
	}
	float f = (scl_slope * float(texture(intensityVol, vx.xyz).r)) + scl_inter;
	float mn = cal_min;
	float mx = cal_max;
	if ((isAlphaThreshold) || (isColorbarFromZero))
		mn = 0.0;
	float r = max(0.00001, abs(mx - mn));
	mn = min(mn, mx);
	float txl = mix(0.0, 1.0, (f - mn) / r);
	if (f > mn) { //issue1139: survives threshold, so round up to opaque voxel
		txl = max(txl, 2.0/256.0);
	}
	//https://stackoverflow.com/questions/5879403/opengl-texture-coordinates-in-pixel-space
	float nlayer = float(textureSize(colormap, 0).y);
	//each volume has two color maps:
	// (layer*2) = negative and (layer * 2) + 1 = positive
	float y = ((2.0 * layer) + 1.5)/nlayer;
	FragColor = texture(colormap, vec2(txl, y)).rgba;
	//negative colors
	mn = cal_minNeg;
	mx = cal_maxNeg;
	if ((isAlphaThreshold) || (isColorbarFromZero))
		mx = 0.0;
	//if ((!isnan(cal_minNeg)) && ( f < mx)) {
	if ((cal_minNeg < cal_maxNeg) && ( f < mx)) {
		r = max(0.00001, abs(mx - mn));
		mn = min(mn, mx);
		txl = 1.0 - mix(0.0, 1.0, (f - mn) / r);
		//issue1139: survives threshold, so round up to opaque voxel
		txl = max(txl, 2.0/256.0);
		y = ((2.0 * layer) + 0.5)/nlayer;
		FragColor = texture(colormap, vec2(txl, y));
	}
	if (layer > 0.7)
		FragColor.a = step(0.00001, FragColor.a);
	//if (modulation > 10)
	//	FragColor.a *= texture(modulationVol, vx.xyz).r;
	//	FragColor.rgb *= texture(modulationVol, vx.xyz).r;
	if (isAlphaThreshold) {
		if ((cal_minNeg != cal_maxNeg) && ( f < 0.0) && (f > cal_maxNeg))
			FragColor.a = pow(-f / -cal_maxNeg, 2.0);
		else if ((f > 0.0) && (cal_min > 0.0))
			FragColor.a *= pow(f / cal_min, 2.0); //issue435:  A = (V/X)**2
		//FragColor.g = 0.0;
	} else if (isColorbarFromZero) {
		if ((cal_minNeg != cal_maxNeg) && ( f < 0.0) && (f > cal_maxNeg))
			FragColor.a = 0.0;
		else if ((f > 0.0) && (cal_min > 0.0) && (f < cal_min))
			FragColor.a *= 0.0;

	}
	if (modulation == 1) {
		FragColor.rgb *= texture(modulationVol, vx.xyz).r;
	} else if (modulation == 2) {
		FragColor.a = texture(modulationVol, vx.xyz).r;
	}
	FragColor.a *= opacity;
	if (layer < 1.0) return;
	vec4 prevColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
	// https://en.wikipedia.org/wiki/Alpha_compositing
	float aout = FragColor.a + (1.0 - FragColor.a) * prevColor.a;
	if (aout <= 0.0) return;
	if (isAdditiveBlend)
		FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a)) / aout;
	else
		FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a * (1.0 - FragColor.a))) / aout;
	FragColor.a = aout;
}`,t0=`#line 773
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float layer;
uniform float scl_slope;
uniform float scl_inter;
uniform float cal_max;
uniform float cal_min;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform float opacity;
uniform mat4 mtx;
uniform bool hasAlpha;
uniform int modulation;
uniform highp sampler3D modulationVol;
float textureWidth;
float nlayer;
float layerY;

vec4 scalar2color(uint idx) {
	float fx = (float(idx) + 0.5) / textureWidth;
	vec4 clr = texture(colormap, vec2(fx, layerY)).rgba;
	if (clr.a > 0.0)
		clr.a = 1.0;
	clr.a *= opacity;
	return clr;
}

vec4 paqd2color(uvec4 rgba) {
  // paqd r: max prob index, g: 2nd index, b: max prob a: 2nd prob
  float prob1 = float(rgba.b)/255.0;
  float prob2 = float(rgba.a)/255.0;
  vec4 clr1 = scalar2color(rgba.r);
  vec4 clr2 = scalar2color(rgba.g);
  float total = prob1 + prob2;
  vec4 clr = vec4(clr1.rgb, total);
  // vec4 clr = vec4(clr1.rgb, prob1);
  if (total > 0.0) {
    clr.rgb = mix(clr2.rgb, clr1.rgb, prob1 / total);
  }
  return clr;
}
void main(void) {
	vec4 vx = vec4(TexCoord.xy, coordZ, 1.0) * mtx;
	ivec3 voxelCoord = ivec3(vx.xyz * vec3(textureSize(intensityVol, 0)));
	uvec4 rgba = texelFetch(intensityVol, voxelCoord, 0);
	FragColor = vec4(0.0, 0.0, 0.0, 0.0);
	if (rgba.r > uint(0)) {
		textureWidth = float(textureSize(colormap, 0).x);
		nlayer = float(textureSize(colormap, 0).y);
		layerY = ((2.0 * layer) + 1.5) / nlayer;
		FragColor = paqd2color(rgba);
		return;
	}
	// if (layer > 2.0) return;
	// FragColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
}`,a0=`#line 773
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float layer;
uniform float scl_slope;
uniform float scl_inter;
uniform float cal_max;
uniform float cal_min;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform float opacity;
uniform mat4 mtx;
uniform bool hasAlpha;
uniform int modulation;
uniform highp sampler3D modulationVol;
void main(void) {
	vec4 vx = vec4(TexCoord.xy, coordZ, 1.0) * mtx;
	uvec4 aColor = texture(intensityVol, vx.xyz);
	FragColor = vec4(float(aColor.r) / 255.0, float(aColor.g) / 255.0, float(aColor.b) / 255.0, float(aColor.a) / 255.0);
	if (modulation == 1)
		FragColor.rgb *= texture(modulationVol, vx.xyz).r;
	if (!hasAlpha) {
		FragColor.a = (FragColor.r * 0.21 + FragColor.g * 0.72 + FragColor.b * 0.07);
		//next line: we could binarize alpha, but see rendering of visible human
		//FragColor.a = step(0.01, FragColor.a);
	}
	if (modulation == 2)
		FragColor.a = texture(modulationVol, vx.xyz).r;
	FragColor.a *= opacity;
	if (layer < 1.0) return;
	vec4 prevColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
	// https://en.wikipedia.org/wiki/Alpha_compositing
	float aout = FragColor.a + (1.0 - FragColor.a) * prevColor.a;
	if (aout <= 0.0) return;
	FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a * (1.0 - FragColor.a))) / aout;
	FragColor.a = aout;
}`,i0=`#version 300 es
#line 808
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
	TexCoord = vPos.xy;
	gl_Position = vec4((vPos.x - 0.5) * 2.0, (vPos.y - 0.5) * 2.0, 0.0, 1.0);
}`,r0=`#version 300 es
#line 829
	precision highp float;
	precision highp int;
	precision highp isampler3D;
	layout(location = 0) out int label;
	layout(location = 1) out int strength;
	in vec2 TexCoord;
	uniform int finalPass;
	uniform float coordZ;
	uniform lowp sampler3D in3D;
	uniform highp isampler3D backTex; // background
	uniform highp isampler3D labelTex; // label
	uniform highp isampler3D strengthTex; // strength
void main(void) {
	vec3 interpolatedTextureCoordinate = vec3(TexCoord.xy, coordZ);
	ivec3 size = textureSize(backTex, 0);
	ivec3 texelIndex = ivec3(floor(interpolatedTextureCoordinate * vec3(size)));
	int background = texelFetch(backTex, texelIndex, 0).r;
	label = texelFetch(labelTex, texelIndex, 0).r;
	strength = texelFetch(strengthTex, texelIndex, 0).r;
	for (int k = -1; k <= 1; k++) {
		for (int j = -1; j <= 1; j++) {
			for (int i = -1; i <= 1; i++) {
				if (i != 0 && j != 0 && k != 0) {
					ivec3 neighborIndex = texelIndex + ivec3(i,j,k);
					int neighborBackground = texelFetch(backTex, neighborIndex, 0).r;
					int neighborStrength = texelFetch(strengthTex, neighborIndex, 0).r;
					int strengthCost = abs(neighborBackground - background);
					int takeoverStrength = neighborStrength - strengthCost;
					if (takeoverStrength > strength) {
						strength = takeoverStrength;
						label = texelFetch(labelTex, neighborIndex, 0).r;
					}
				}
			}
		}
	}
	if (finalPass < 1)
		return;
	int ok = 1;
	ivec4 labelCount = ivec4(0,0,0,0);
	for (int k = -1; k <= 1; k++)
		for (int j = -1; j <= 1; j++)
			for (int i = -1; i <= 1; i++) {
				ivec3 neighborIndex = texelIndex + ivec3(i,j,k);
				int ilabel = texelFetch(labelTex, neighborIndex, 0).r;
				if ((ilabel < 0) || (ilabel > 3))
					ok = 0;
				else
					labelCount[ilabel]++;
			}
	if (ok != 1) {
		return;
	}
	int maxIdx = 0;
	for (int i = 1; i < 4; i++) {
		if (labelCount[i] > labelCount[maxIdx])
			maxIdx = i;
	}
	label = maxIdx;
}`,s0=`#version 300 es
layout(location=0) in vec3 pos;
uniform mat4 mvpMtx;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
}`,n0=`#version 300 es
precision highp int;
precision highp float;
uniform vec4 surfaceColor;
out vec4 color;
void main() {
	color = surfaceColor;
}`,o0=`#version 300 es
layout(location=0) in vec3 pos;
layout(location=1) in vec4 clr;
out vec4 vClr;
uniform mat4 mvpMtx;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
	vClr = clr;
}`,c0=`#version 300 es
precision highp int;
precision highp float;
in vec4 vClr;
out vec4 color;
uniform float opacity;
void main() {
	color = vec4(vClr.rgb, opacity);
}`,Ln=`#version 300 es
layout(location=0) in vec3 pos;
layout(location=1) in vec4 norm;
layout(location=2) in vec4 clr;
uniform mat4 mvpMtx;
//uniform mat4 modelMtx;
uniform mat4 normMtx;
out vec4 vClr;
out vec3 vN;
out vec4 vP;
out vec4 vPc;
void main(void) {
	vec3 lightPosition = vec3(0.0, 0.0, -10.0);
	vP = vec4(pos, 1.0);
	vPc = mvpMtx * vec4(pos, 1.0);
	gl_Position = vPc;
	vN = normalize((normMtx * vec4(norm.xyz,1.0)).xyz);
	//vV = -vec3(modelMtx*vec4(pos,1.0));
	vClr = clr;
}`,l0=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
out vec4 color;
vec4 packFloatToVec4i(const float value) {
	const vec4 bitSh = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);
	const vec4 bitMsk = vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);
	vec4 res = fract(value * bitSh);
	res -= res.xxyz * bitMsk;
	return res;
}
void main() {
	color = packFloatToVec4i(gl_FragCoord.z);
}`,h0=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
float stepmix(float edge0, float edge1, float E, float x){
	float T = clamp(0.5 * (x - edge0 + E) / E, 0.0, 1.0);
	return mix(edge0, edge1, T);
}
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0);
	float ambient = 0.3;
	float diffuse = 0.6;
	float specular = 0.5;
	float shininess = 50.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float df = max(0.0, dot(n, l));
	float sf = pow(max(dot(reflect(l, n), r), 0.0), shininess);
	const float A = 0.1;
	const float B = 0.3;
	const float C = 0.6;
	const float D = 1.0;
	float E = fwidth(df);
	if (df > A - E && df < A + E) df = stepmix(A, B, E, df);
	else if (df > B - E && df < B + E) df = stepmix(B, C, E, df);
	else if (df > C - E && df < C + E) df = stepmix(C, D, E, df);
	else if (df < A) df = 0.0;
	else if (df < B) df = B;
	else if (df < C) df = C;
	else df = D;
	E = fwidth(sf);
	if (sf > 0.5 - E && sf < 0.5 + E)
		sf = smoothstep(0.5 - E, 0.5 + E, sf);
	else
		sf = step(0.5, sf);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(df, 0.0) * vClr.rgb * diffuse;
	color.rgb = a + d + (specular * sf);
	color.a = opacity;
}`,d0=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.3;
	float diffuse = 0.6;
	float specular = 0.25;
	float shininess = 10.0;
	float PenWidth = 0.6;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	float view = abs(dot(n,r)); //with respect to viewer
	if (PenWidth < view) discard;
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color.rgb = a + d + s;
	color.a = opacity;
}`,f0=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	const float thresh = 0.4;
	const vec3 viewDir = vec3(0.0, 0.0, -1.0);
	vec3 n = normalize(vN);
	// use abs() for two-sided lighting, max() for one sided
	float cosTheta = abs(dot(n, viewDir));
	// float cosTheta = max(dot(n, viewDir), 0.0);
	// optional fresnel equation - adjust exponent
	// cosTheta = 1.0 - pow(1.0 - cosTheta, 2.0);
	// use step for binary edges, smoothstep for feathered edges
	// vec3 d = step(thresh, cosTheta) * vClr.rgb;
	vec3 d = smoothstep(thresh - 0.05, thresh + 0.05, cosTheta) * vClr.rgb;
	color = vec4(d, opacity);
}`,u0=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
  const float edge0 = 0.1;
  const float edge1 = 0.25;
  const vec3 viewDir = vec3(0.0, 0.0, -1.0);
  vec3 n = normalize(vN);
  float cosTheta = abs(dot(n, viewDir));
  float alpha = 1.0 - smoothstep(edge0, edge1, cosTheta);
  if (alpha <= 0.0) {
    discard;
  }
  color = vec4(0.0, 0.0, 0.0, opacity * alpha);
}`,b0=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float diffuse = 1.0;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 0.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = max(dot(n, l), 0.0);
	vec3 d = lightNormDot * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(d + s, opacity);
}`,p0=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	float diffuse = 1.4;
	vec3 l = vec3(0.0, 0.0, -1.0);
	float lightNormDot = max(dot(normalize(vN), l), 0.0);
	color = vec4(lightNormDot * vClr.rgb * diffuse, opacity);
}`,m0=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	float specularRGB = 0.7;
	float specularWhite = 0.3;
	float shininess = 10.0;
	float diffuse = 1.0;
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	vec3 n = normalize(vN);
	vec3 l = vec3(0.0, 0.0, -1.0);
	float lightNormDot = max(dot(n, l), 0.0);
	vec3 d3 = lightNormDot * vClr.rgb * diffuse;
	float s = pow(max(dot(reflect(l, n), r), 0.0), shininess);
	vec3 s3 = specularRGB * s * vClr.rgb;
	s *= specularWhite;
	color = vec4(d3 + s3 + s, opacity);
}`,g0=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
in vec4 vPc;
out vec4 color;
void main() {
	vec3 n = normalize(vN);
	// Compute curvature
	vec3 dx = dFdx(n);
	vec3 dy = dFdy(n);
	vec3 xneg = n - dx;
	vec3 xpos = n + dx;
	vec3 yneg = n - dy;
	vec3 ypos = n + dy;
	float depth = length(vPc.xyz);
	float curv = (cross(xneg, xpos).y - cross(yneg, ypos).x) / depth;
	//at this stage 0.5 for flat, with valleys dark and ridges bright
	curv = 1.0 - (curv + 0.5);
	//clamp
	curv =  min(max(curv, 0.0), 1.0);
	// easing function
	curv = pow(curv, 0.5);
	//modulate ambient and diffuse with curvature
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.6;
	float diffuse = 0.6;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 lightPosition = vec3(0.0, 10.0, -2.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient * curv;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,A0=`#version 300 es
precision highp int;
precision highp float;
uniform vec4 sliceMM;
uniform float thickMM ;
in vec4 vClr;
in vec4 vP;  // vertex position in mm
out vec4 color;
void main() {
    const float LINE_WIDTH_PX = 4.0;   // target thickness in pixels
    //const float LINE_THRESH_MM = 1.5;   // target thickness in pixels
    const float TILT_STRENGTH = 1.0;   // >0 shrinks ribbon for oblique triangles
    // --- signed distances to each orthogonal plane (object space) ---
    vec3 d = vP.xyz - sliceMM.xyz;
    vec3 ad = abs(d);
    // --- derivatives to get pixel-consistent widths (per-axis) ---
    vec3 fd = fwidth(vP.xyz);
    //minDist is in mm not pixels
    float minDist = min(ad.x, min(ad.y, ad.z));
    if (minDist >  sliceMM.w) discard;
    // --- per-plane obliqueness: use the two in-plane components' fwidth ---
    float tiltX = length(fd.yz); // for plane with normal X
    float tiltY = length(fd.xz); // for plane with normal Y
    float tiltZ = length(fd.xy); // for plane with normal Z
    float tfX = clamp(1.0 / (1.0 + TILT_STRENGTH * tiltX), 0.0, 1.0);
    float tfY = clamp(1.0 / (1.0 + TILT_STRENGTH * tiltY), 0.0, 1.0);
    float tfZ = clamp(1.0 / (1.0 + TILT_STRENGTH * tiltZ), 0.0, 1.0);
    // --- half-widths for each plane (apply per-axis tilt factor) ---
    vec3 halfWidth;
    halfWidth.x = (LINE_WIDTH_PX * 0.5) * fd.x * tfX;
    halfWidth.y = (LINE_WIDTH_PX * 0.5) * fd.y * tfY;
    halfWidth.z = (LINE_WIDTH_PX * 0.5) * fd.z * tfZ;
    // --- smooth alpha for each plane ---
    vec3 edgeA = 1.0 - smoothstep(vec3(0.0), halfWidth, ad);
    // combine planes (max of X,Y,Z ribbons)
    float edgeAlpha = max(edgeA.x, max(edgeA.y, edgeA.z));
    if (edgeAlpha <= 1e-4) discard; // outside ribbons
    color = vec4(vClr.rgb, vClr.a * edgeAlpha);
}`,y0=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.35;
	float diffuse = 0.5;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,x0=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
uniform sampler2D matCap;
out vec4 color;
void main() {
	vec3 n = normalize(vN);
	vec2 uv = n.xy * 0.5 + 0.5;
	uv.y = 1.0 - uv.y;
	vec3 clr = texture(matCap,uv.xy).rgb * vClr.rgb;
	color = vec4(clr, opacity);
}`,w0=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	float ambient = 0.35;
	float diffuse = 0.6;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	color = vec4(a + d, opacity);
}`,v0=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.35;
	float diffuse = 0.5;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 up = vec3(0.0, 1.0, 0.0);
	float ax = dot(n, up) * 0.5 + 0.5;  //Shreiner et al. (2013) OpenGL Programming Guide, 8th Ed., p 388. ISBN-10: 0321773039
	vec3 upClr = vec3(1.0, 1.0, 0.95);
	vec3 downClr = vec3(0.4, 0.4, 0.6);
	vec3 a = vClr.rgb * ambient;
	a *= mix(downClr, upClr, ax);
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,E0=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
//Spherical harmonics constants
const float C1 = 0.429043;
const float C2 = 0.511664;
const float C3 = 0.743125;
const float C4 = 0.886227;
const float C5 = 0.247708;
//Spherical harmonics coefficients
// Ramamoorthi, R., and P. Hanrahan. 2001b. "An Efficient Representation for Irradiance Environment Maps." In Proceedings of SIGGRAPH 2001, pp. 497500.
// https://github.com/eskimoblood/processingSketches/blob/master/data/shader/shinyvert.glsl
// https://github.com/eskimoblood/processingSketches/blob/master/data/shader/shinyvert.glsl
// Constants for Eucalyptus Grove lighting
const vec3 L00  = vec3( 0.3783264,  0.4260425,  0.4504587);
const vec3 L1m1 = vec3( 0.2887813,  0.3586803,  0.4147053);
const vec3 L10  = vec3( 0.0379030,  0.0295216,  0.0098567);
const vec3 L11  = vec3(-0.1033028, -0.1031690, -0.0884924);
const vec3 L2m2 = vec3(-0.0621750, -0.0554432, -0.0396779);
const vec3 L2m1 = vec3( 0.0077820, -0.0148312, -0.0471301);
const vec3 L20  = vec3(-0.0935561, -0.1254260, -0.1525629);
const vec3 L21  = vec3(-0.0572703, -0.0502192, -0.0363410);
const vec3 L22  = vec3( 0.0203348, -0.0044201, -0.0452180);
vec3 SH(vec3 vNormal) {
	vNormal = vec3(vNormal.x,vNormal.z,vNormal.y);
	vec3 diffuseColor = C1 * L22 * (vNormal.x * vNormal.x - vNormal.y * vNormal.y) +
	C3 * L20 * vNormal.z * vNormal.z +
	C4 * L00 -
	C5 * L20 +
	2.0 * C1 * L2m2 * vNormal.x * vNormal.y +
	2.0 * C1 * L21  * vNormal.x * vNormal.z +
	2.0 * C1 * L2m1 * vNormal.y * vNormal.z +
	2.0 * C2 * L11  * vNormal.x +
	2.0 * C2 * L1m1 * vNormal.y +
	2.0 * C2 * L10  * vNormal.z;
	return diffuseColor;
}
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.3;
	float diffuse = 0.6;
	float specular = 0.1;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	vec3 a = vClr.rgb * ambient;
	vec3 d = vClr.rgb * diffuse * SH(-reflect(n, vec3(l.x, l.y, -l.z)) );
	color = vec4(a + d + s, opacity);
}`,T0=`#version 300 es
layout(location=0) in vec3 pos;
layout(location=1) in vec4 norm;
layout(location=2) in vec4 clr;
uniform mat4 mvpMtx;
//uniform mat4 modelMtx;
uniform mat4 normMtx;
out vec4 vClr;
flat out vec3 vN;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
	vN = normalize((normMtx * vec4(norm.xyz,1.0)).xyz);
	//vV = -vec3(modelMtx*vec4(pos,1.0));
	vClr = clr;
}`,xl=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
flat in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.35;
	float diffuse = 0.5;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,I0=`#version 300 es
#line 1260
#define MAX_CLIP_PLANES 6
//precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 volScale;
uniform vec3 texVox;
uniform vec4 clipPlane;
uniform vec4 clipPlanes[MAX_CLIP_PLANES];
uniform bool isClipCutaway;
uniform highp sampler3D volume, overlay;
uniform highp sampler3D paqd;
uniform vec4 paqdUniforms;
uniform float overlays;
uniform mat4 matRAS;
uniform mat4 mvpMtx;
uniform float drawOpacity, renderOverlayBlend;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
uniform int backgroundMasksOverlays;
in vec3 vColor;
out vec4 fColor;
`+Ns+`
void main() {
	int id = 254;
	vec3 start = vColor;
	gl_FragDepth = 1.0;
	fColor = vec4(0.0, 0.0, 0.0, 0.0); //assume no hit: ID = 0
	float fid = float(id & 255)/ 255.0;
	vec3 backPosition = GetBackPosition(start);
	vec3 dir = normalize(backPosition - start);
	//clipVolumeStart(start, backPosition);
	float len = length(backPosition - start);
	float lenVox = length((texVox * start) - (texVox * backPosition));
	if ((lenVox < 0.5) || (len > 3.0)) return;//discard; //length limit for parallel rays
	float sliceSize = len / lenVox; //e.g. if ray length is 1.0 and traverses 50 voxels, each voxel is 0.02 in unit cube
	float stepSize = sliceSize; //quality: larger step is faster traversal, but fewer samples
	float opacityCorrection = stepSize/sliceSize;
	dir = normalize(dir);
	vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	bool hasClip = false;
	vec2 sampleRange = vec2(0.0, len);
	for (int i = 0; i < MAX_CLIP_PLANES; i++)
		clipSampleRange(dir, samplePos, clipPlanes[i], sampleRange, hasClip);
	bool isClip = (sampleRange.x > 0.0) || ((sampleRange.y < len) && (sampleRange.y > 0.0));
	//vec4 clipPos = applyClip(dir, samplePos, len, isClip);
	if (isClip) fColor = vec4(samplePos.xyz, 253.0 / 255.0); //assume no hit: ID = 0
	if ((isClipCutaway) && (sampleRange.x <= 0.0) && (sampleRange.y >= len)) {
		//completely clipped, but ray does not intersect plane
		if (hasClip)
			samplePos.a = len + 1.0;
		else
			sampleRange = vec2(0.0, 0.0);
	}
	//start: OPTIONAL fast pass: rapid traversal until first hit
	float stepSizeFast = sliceSize * 1.9;
	vec4 deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	while (samplePos.a <= len) {
		if (skipSample(samplePos.a, sampleRange) ^^ isClipCutaway) {
			samplePos += deltaDirFast;
			continue;
		}
		float val = texture(volume, samplePos.xyz).a;
		if (val > 0.01) {
			fColor = vec4(samplePos.rgb, fid);
			gl_FragDepth = frac2ndc(samplePos.xyz);
			break;
		}
		samplePos += deltaDirFast; //advance ray position
	}
	//end: fast pass
	if ((overlays < 1.0) || (backgroundMasksOverlays > 0)) {
		return; //background hit, no overlays
	}
	//overlay pass
	len = min(len, samplePos.a); //only find overlay closer than background
	samplePos = vec4(start.xyz, 0.0); //ray position
	while (samplePos.a <= len) {
		float val = texture(overlay, samplePos.xyz).a;
		if (val > 0.01) {
			fColor = vec4(samplePos.rgb, fid);
			gl_FragDepth = frac2ndc(samplePos.xyz);
			return;
		}
		samplePos += deltaDirFast; //advance ray position
	}
	//if (fColor.a == 0.0) discard; //no hit in either background or overlays
	//you only get here if there is a hit with the background that is closer than any overlay
}`,M0=`#version 300 es
// an attribute is an input (in) to a vertex shader.
// It will receive data from a buffer
layout(location=0)  in vec3 a_position;
layout(location=1)  in vec3 a_color;
// A matrix to transform the positions by
uniform mat4 u_matrix;
out vec3 vColor;
// all shaders have a main function
void main() {
	// Multiply the position by the matrix.
	vec4 pos = vec4(a_position, 1.0);
	gl_Position = u_matrix * vec4(pos);
	vColor = a_color;
}
`,C0=`#version 300 es
precision highp float;
uniform vec4 u_color;
in vec3 vColor;
out vec4 outColor;
void main() {
	outColor = vec4(vColor, 1.0);
}`,D0=`#version 300 es
#line 1359
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
	TexCoord = vPos.xy;
	vec2 viewCoord = (vPos.xy - 0.5) * 2.0;
	gl_Position = vec4((vPos.xy - 0.5) * 2.0, 0.0, 1.0);
}`,_0=`#version 300 es
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform lowp sampler3D in3D;
void main(void) {
 FragColor = texture(in3D, vec3(TexCoord.xy, coordZ));
}`,qs=`#version 300 es
#line 286
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
    TexCoord = vPos.xy;
    gl_Position = vec4( (vPos.xy-vec2(0.5,0.5))* 2.0, 0.0, 1.0);
}`,S0=`#version 300 es
#line 298
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform highp sampler3D intensityVol;
void main(void) {
 vec3 vx = vec3(TexCoord.xy, coordZ);
 vec4 samp = texture(intensityVol,vx+vec3(+dX,+dY,+dZ));
 samp += texture(intensityVol,vx+vec3(+dX,+dY,-dZ));
 samp += texture(intensityVol,vx+vec3(+dX,-dY,+dZ));
 samp += texture(intensityVol,vx+vec3(+dX,-dY,-dZ));
 samp += texture(intensityVol,vx+vec3(-dX,+dY,+dZ));
 samp += texture(intensityVol,vx+vec3(-dX,+dY,-dZ));
 samp += texture(intensityVol,vx+vec3(-dX,-dY,+dZ));
 samp += texture(intensityVol,vx+vec3(-dX,-dY,-dZ));
 FragColor = samp*0.125;
}`,F0=`#version 300 es
#line 298
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform highp sampler3D intensityVol;
void main(void) {
 vec3 vx = vec3(TexCoord.xy, coordZ);
 vec4 XYZ = texture(intensityVol,vx+vec3(+dX,+dY,+dZ));
 vec4 OYZ = texture(intensityVol,vx+vec3(0.0,+dY,+dZ));
 vec4 xYZ = texture(intensityVol,vx+vec3(-dX,+dY,+dZ));
 vec4 XOZ = texture(intensityVol,vx+vec3(+dX,0.0,+dZ));
 vec4 OOZ = texture(intensityVol,vx+vec3(0.0,0.0,+dZ));
 vec4 xOZ = texture(intensityVol,vx+vec3(-dX,0.0,+dZ));
 vec4 XyZ = texture(intensityVol,vx+vec3(+dX,-dY,+dZ));
 vec4 OyZ = texture(intensityVol,vx+vec3(0.0,-dY,+dZ));
 vec4 xyZ = texture(intensityVol,vx+vec3(-dX,-dY,+dZ));

 vec4 XYO = texture(intensityVol,vx+vec3(+dX,+dY,0.0));
 vec4 OYO = texture(intensityVol,vx+vec3(0.0,+dY,0.0));
 vec4 xYO = texture(intensityVol,vx+vec3(-dX,+dY,0.0));
 vec4 XOO = texture(intensityVol,vx+vec3(+dX,0.0,0.0));
 vec4 OOO = texture(intensityVol,vx+vec3(0.0,0.0,0.0));
 vec4 xOO = texture(intensityVol,vx+vec3(-dX,0.0,0.0));
 vec4 XyO = texture(intensityVol,vx+vec3(+dX,-dY,0.0));
 vec4 OyO = texture(intensityVol,vx+vec3(0.0,-dY,0.0));
 vec4 xyO = texture(intensityVol,vx+vec3(-dX,-dY,0.0));

 vec4 XYz = texture(intensityVol,vx+vec3(+dX,+dY,-dZ));
 vec4 OYz = texture(intensityVol,vx+vec3(0.0,+dY,-dZ));
 vec4 xYz = texture(intensityVol,vx+vec3(-dX,+dY,-dZ));
 vec4 XOz = texture(intensityVol,vx+vec3(+dX,0.0,-dZ));
 vec4 OOz = texture(intensityVol,vx+vec3(0.0,0.0,-dZ));
 vec4 xOz = texture(intensityVol,vx+vec3(-dX,0.0,-dZ));
 vec4 Xyz = texture(intensityVol,vx+vec3(+dX,-dY,-dZ));
 vec4 Oyz = texture(intensityVol,vx+vec3(0.0,-dY,-dZ));
 vec4 xyz = texture(intensityVol,vx+vec3(-dX,-dY,-dZ));

 vec4 blurred = vec4 (0.0, 0.0, 0.0, 0.0);
 blurred.r = 2.0*(xOz.r +xOZ.r +xyO.r +xYO.r +xOO.r +XOz.r +XOZ.r +XyO.r +XYO.r +XOO.r) +xyz.r +xyZ.r +xYz.r +xYZ.r +Xyz.r +XyZ.r +XYz.r +XYZ.r;
 blurred.g = 2.0*(Oyz.r +OyZ.r +xyO.r +XyO.r +OyO.r +OYz.r +OYZ.r +xYO.r +XYO.r +OYO.r) +xyz.r +Xyz.r +xyZ.r +XyZ.r +xYz.r +XYz.r +xYZ.r +XYZ.r;
 blurred.b = 2.0*(Oyz.r +OYz.r +xOz.r +XOz.r +OOz.r +OyZ.r +OYZ.r +xOZ.r +XOZ.r +OOZ.r) +xyz.r +Xyz.r +xYz.r +XYz.r +xyZ.r +XyZ.r +XyZ.r +XYZ.r;
 blurred.a = 0.32*(abs(blurred.r)+abs(blurred.g)+abs(blurred.b));
 // 0.0357 = 1/28 to account for weights, rescale to 2**16,
 FragColor = 0.0357*blurred;
}`,qh=`
  gradientSample.a = log2(gradientSample.r*gradientSample.r + gradientSample.g*gradientSample.g + gradientSample.b*gradientSample.b + 1.922337562475971e-06) + 18.988706873717717;
`,R0=`#version 300 es
#line 323
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform highp sampler3D intensityVol;
void main(void) {
  vec3 vx = vec3(TexCoord.xy, coordZ);
  //Neighboring voxels 'T'op/'B'ottom, 'A'nterior/'P'osterior, 'R'ight/'L'eft
  float TAR = texture(intensityVol,vx+vec3(+dX,+dY,+dZ)).r;
  float TAL = texture(intensityVol,vx+vec3(+dX,+dY,-dZ)).r;
  float TPR = texture(intensityVol,vx+vec3(+dX,-dY,+dZ)).r;
  float TPL = texture(intensityVol,vx+vec3(+dX,-dY,-dZ)).r;
  float BAR = texture(intensityVol,vx+vec3(-dX,+dY,+dZ)).r;
  float BAL = texture(intensityVol,vx+vec3(-dX,+dY,-dZ)).r;
  float BPR = texture(intensityVol,vx+vec3(-dX,-dY,+dZ)).r;
  float BPL = texture(intensityVol,vx+vec3(-dX,-dY,-dZ)).r;
  vec4 gradientSample = vec4 (0.0, 0.0, 0.0, 0.0);
  gradientSample.r = BAR+BAL+BPR+BPL -TAR-TAL-TPR-TPL;
  gradientSample.g = TPR+TPL+BPR+BPL -TAR-TAL-BAR-BAL;
  gradientSample.b = TAL+TPL+BAL+BPL -TAR-TPR-BAR-BPR;
${qh}
	// 0.04242020977371934 = 1/(log2(3*8) - log2(1/(255**2*8))) // 3*8 -> max for 1st order gradient
	gradientSample.a *= 0.04242020977371934;
  gradientSample.rgb = normalize(gradientSample.rgb);
  gradientSample.rgb = (gradientSample.rgb * 0.5)+0.5;
  FragColor = gradientSample;
}`,N0=`#version 300 es
#line 323
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform float dX2;
uniform float dY2;
uniform float dZ2;
uniform highp sampler3D intensityVol;
void main(void) {
  vec3 vx = vec3(TexCoord.xy, coordZ);
  //Neighboring voxels 'T'op/'B'ottom, 'A'nterior/'P'osterior, 'R'ight/'L'eft
  vec4 TAR = texture(intensityVol,vx+vec3(+dX,+dY,+dZ));
  vec4 TAL = texture(intensityVol,vx+vec3(+dX,+dY,-dZ));
  vec4 TPR = texture(intensityVol,vx+vec3(+dX,-dY,+dZ));
  vec4 TPL = texture(intensityVol,vx+vec3(+dX,-dY,-dZ));
  vec4 BAR = texture(intensityVol,vx+vec3(-dX,+dY,+dZ));
  vec4 BAL = texture(intensityVol,vx+vec3(-dX,+dY,-dZ));
  vec4 BPR = texture(intensityVol,vx+vec3(-dX,-dY,+dZ));
  vec4 BPL = texture(intensityVol,vx+vec3(-dX,-dY,-dZ));
  vec4 T = texture(intensityVol,vx+vec3(+dX2,0.0,0.0));
  vec4 A = texture(intensityVol,vx+vec3(0.0,+dY2,0.0));
  vec4 R = texture(intensityVol,vx+vec3(0.0,0.0,+dZ2));
  vec4 B = texture(intensityVol,vx+vec3(-dX2,0.0,0.0));
  vec4 P = texture(intensityVol,vx+vec3(0.0,-dY2,0.0));
  vec4 L = texture(intensityVol,vx+vec3(0.0,0.0,-dZ2));
  vec4 gradientSample = vec4 (0.0, 0.0, 0.0, 0.0);
  gradientSample.r = -4.0*B.r +8.0*(BAR.r+BAL.r+BPR.r+BPL.r) -8.0*(TAR.r+TAL.r+TPR.r+TPL.r) +4.0*T.r;
  gradientSample.g = -4.0*P.g +8.0*(TPR.g+TPL.g+BPR.g+BPL.g) -8.0*(TAR.g+TAL.g+BAR.g+BAL.g) +4.0*A.g;
  gradientSample.b = -4.0*L.b +8.0*(TAL.b+TPL.b+BAL.b+BPL.b) -8.0*(TAR.b+TPR.b+BAR.b+BPR.b) +4.0*R.b;
${qh}
	gradientSample.a *= 0.0325;
  gradientSample.rgb = normalize(gradientSample.rgb);
  gradientSample.rgb =  (gradientSample.rgb * 0.5)+0.5;
  FragColor = gradientSample;
}`,k0=function(a,e,t){const i=a.createShader(a.VERTEX_SHADER);a.shaderSource(i,e),a.compileShader(i);const r=a.createShader(a.FRAGMENT_SHADER);a.shaderSource(r,t),a.compileShader(r);const s=a.createProgram();if(a.attachShader(s,i),a.attachShader(s,r),a.linkProgram(s),!a.getProgramParameter(s,a.LINK_STATUS))throw console.log(a.getProgramInfoLog(s)),a.getShaderParameter(i,a.COMPILE_STATUS)||console.log("Vertex shader compilation error:",a.getShaderInfoLog(i)),a.getShaderParameter(r,a.COMPILE_STATUS)||console.log("Fragment shader compilation error:",a.getShaderInfoLog(r)),V.error(a.getProgramInfoLog(s)),new Error("Shader failed to link, see console for log");return s},xe=class{constructor(a,e,t){U(this,"program"),U(this,"uniforms",{}),U(this,"isMatcap"),U(this,"isCrosscut"),this.program=k0(a,e,t);const i=/uniform[^;]+[ ](\w+);/g,r=/uniform[^;]+[ ](\w+);/,s=e.match(i),n=t.match(i);s&&s.forEach(o=>{const c=o.match(r);this.uniforms[c[1]]=-1}),n&&n.forEach(o=>{const c=o.match(r);this.uniforms[c[1]]=-1});for(const o in this.uniforms)this.uniforms[o]=a.getUniformLocation(this.program,o)}use(a){a.useProgram(this.program)}},wl=(a,e)=>{const t=Math.floor(Math.log(a)/Math.log(10)),i=a/Math.pow(10,t);let r;return e?i<1.5?r=1:i<3?r=2:i<7?r=5:r=10:i<=1?r=1:i<=2?r=2:i<=5?r=5:r=10,r*Math.pow(10,t)};function U0(a){return new Promise((e,t)=>{let i;a instanceof File?i=Promise.resolve(a):i=new Promise((r,s)=>{a.file(r,s)}),i.then(r=>{const s=new FileReader;s.onload=()=>{typeof s.result=="string"?e(s.result):t(new Error("Expected a string from FileReader.result"))},s.onerror=()=>{t(s.error??new Error("Unknown FileReader error"))},s.readAsDataURL(r)}).catch(r=>t(r))})}function j0(a){const e=a.hdr.dims,t=a.permRAS,i=e[1]*e[2]*e[3],r=new Int16Array(i),s=[0,0,0];for(let u=0;u<3;u++)for(let m=0;m<3;m++)Math.abs(t[u])-1===m&&(s[m]=u*Math.sign(t[u]));let n=1;const o=[1,1,1],c=[!1,!1,!1];for(let u=0;u<s.length;u++)for(let m=0;m<s.length;m++)Math.abs(s[m])===u&&(o[m]=n,(s[m]<0||Object.is(s[m],-0))&&(c[m]=!0),n*=e[m+1]);let l=ce.range(0,e[1]-1,1);c[0]&&(l=ce.range(e[1]-1,0,-1));for(let u=0;u<e[1];u++)l[u]*=o[0];let h=ce.range(0,e[2]-1,1);c[1]&&(h=ce.range(e[2]-1,0,-1));for(let u=0;u<e[2];u++)h[u]*=o[1];let d=ce.range(0,e[3]-1,1);c[2]&&(d=ce.range(e[3]-1,0,-1));for(let u=0;u<e[3];u++)d[u]*=o[2];let f=0;for(let u=0;u<e[3];u++)for(let m=0;m<e[2];m++)for(let p=0;p<e[1];p++)r[l[p]+h[m]+d[u]]=a.img[f],f++;return r}function B0(a){const e=[5960464477539063e-23,152587890625e-16,.00390625,1];return(a[0]*e[0]+a[1]*e[1]+a[2]*e[2]+a[3]*e[3])/255}function vl(a,e){return a.scl_slope===0&&(a.scl_slope=1),e*a.scl_slope+a.scl_inter}function Xr(a,e,t=4){const i=wl(e-a,!1),r=wl(i/(t-1),!0),s=Math.floor(a/r)*r,n=Math.ceil(e/r)*r;return[r,s,n,s===a&&n===e]}function El(a,e){let t=Xr(a,e,3);return t[3]||(t=Xr(a,e,5)),t[3]||(t=Xr(a,e,4)),t[3]||(t=Xr(a,e,3)),t[3]||(t=Xr(a,e,5)),[t[0],t[1],t[2]]}function la(a){return a*(Math.PI/180)}function Gn(a,e,t,i){let r=-a,s=-e;return isFinite(t)&&isFinite(i)&&(r=t,s=i),r>s&&([r,s]=[s,r]),[r,s]}function zn(a,e,t){return Math.min(Math.max(a,e),t)}function Le(a,e=[0,1,2]){const t=Ce();return t[0]=a[e[0]],t[1]=a[e[1]],t[2]=a[e[2]],t}function P0(a){const e=Be(1,0,0,0),t=aa();return it(t,e,a),t[0]}function O0(a,e,t,i){const r=Be(a,e,t,1),s=Ke(i);bt(s,s),r[0]=r[0]*2-1,r[1]=r[1]*2-1,r[2]=r[2]*2-1;const n=aa();return it(n,r,s),n[3]===0||(n[0]/=n[3],n[1]/=n[3],n[2]/=n[3]),n}var{version:Tl}=Wu,Ia=["ASC","BYU","DFS","FSM","PIAL","ORIG","INFLATED","SMOOTHWM","SPHERE","WHITE","G","GEO","GII","ICO","MZ3","NV","OBJ","OFF","PLY","SRF","STL","TCK","TRACT","TRI","TRK","TT","TRX","VTK","WRL","X3D","JCON","JSON"],Qr=0,Kn=1,Hn=2,Ma=33984,Jr=33985,Ws=33986,Il=33987,V0=33988,qn=33989,Ys=33990,ha=33991,Ha=33992,Ml=33992,Cl=33993,Dl=33994,L0=33995,G0=33996,z0=33997,K0=33998,H0=33999,_l={filename:"",isSaveDrawing:!1,volumeByIndex:0},Ca,q0=class{constructor(a=Rt){U(this,"loaders",{}),U(this,"dicomLoader",null),U(this,"canvas",null),U(this,"_gl",null),U(this,"isBusy",!1),U(this,"needsRefresh",!1),U(this,"colormapTexture",null),U(this,"colormapLists",[]),U(this,"volumeTexture",null),U(this,"gradientTexture",null),U(this,"gradientTextureAmount",0),U(this,"useCustomGradientTexture",!1),U(this,"renderGradientValues",!1),U(this,"drawTexture",null),U(this,"paqdTexture",null),U(this,"drawUndoBitmaps",[]),U(this,"drawLut",Ie.makeDrawLut("$itksnap")),U(this,"drawOpacity",.8),U(this,"drawRimOpacity",-1),U(this,"clickToSegmentIsGrowing",!1),U(this,"clickToSegmentGrowingBitmap",null),U(this,"clickToSegmentXY",[0,0]),U(this,"renderDrawAmbientOcclusion",.4),U(this,"colorbarHeight",0),U(this,"drawPenLocation",[NaN,NaN,NaN]),U(this,"drawPenAxCorSag",-1),U(this,"drawFillOverwrites",!0),U(this,"drawPenFillPts",[]),U(this,"drawShapeStartLocation",[NaN,NaN,NaN]),U(this,"drawShapePreviewBitmap",null),U(this,"overlayTexture",null),U(this,"overlayTextureID",null),U(this,"sliceMMShader"),U(this,"slice2DShader"),U(this,"sliceV1Shader"),U(this,"orientCubeShader"),U(this,"orientCubeShaderVAO",null),U(this,"rectShader"),U(this,"rectOutlineShader"),U(this,"renderShader"),U(this,"lineShader"),U(this,"line3DShader"),U(this,"passThroughShader"),U(this,"renderGradientShader"),U(this,"renderGradientValuesShader"),U(this,"renderSliceShader"),U(this,"renderVolumeShader"),U(this,"pickingMeshShader"),U(this,"pickingImageShader"),U(this,"colorbarShader"),U(this,"customSliceShader",null),U(this,"fontShader",null),U(this,"fiberShader"),U(this,"fontTexture",null),U(this,"circleShader"),U(this,"matCapTexture",null),U(this,"bmpShader",null),U(this,"bmpTexture",null),U(this,"thumbnailVisible",!1),U(this,"bmpTextureWH",1),U(this,"growCutShader"),U(this,"orientShaderAtlasU",null),U(this,"orientShaderAtlasI",null),U(this,"orientShaderU",null),U(this,"orientShaderI",null),U(this,"orientShaderF",null),U(this,"orientShaderRGBU",null),U(this,"orientShaderPAQD",null),U(this,"surfaceShader",null),U(this,"blurShader",null),U(this,"sobelBlurShader",null),U(this,"sobelFirstOrderShader",null),U(this,"sobelSecondOrderShader",null),U(this,"genericVAO",null),U(this,"unusedVAO",null),U(this,"crosshairs3D",null),U(this,"DEFAULT_FONT_GLYPH_SHEET",bl),U(this,"DEFAULT_FONT_METRICS",pl),U(this,"fontMetrics"),U(this,"fontMets",null),U(this,"fontPx",12),U(this,"legendFontScaling",1),U(this,"backgroundMasksOverlays",0),U(this,"overlayOutlineWidth",0),U(this,"overlayAlphaShader",1),U(this,"position"),U(this,"extentsMin"),U(this,"extentsMax"),U(this,"resizeObserver",null),U(this,"resizeEventListener",null),U(this,"canvasObserver",null),U(this,"syncOpts",{"3d":!1,"2d":!1,zoomPan:!1,cal_min:!1,cal_max:!1,clipPlane:!1,gamma:!1,sliceType:!1,crosshair:!1}),U(this,"readyForSync",!1),U(this,"uiData",{mousedown:!1,touchdown:!1,mouseButtonLeftDown:!1,mouseButtonCenterDown:!1,mouseButtonRightDown:!1,mouseDepthPicker:!1,clickedTile:-1,pan2DxyzmmAtMouseDown:[0,0,0,1],prevX:0,prevY:0,currX:0,currY:0,currentTouchTime:0,lastTouchTime:0,touchTimer:null,doubleTouch:!1,isDragging:!1,dragStart:[0,0],dragEnd:[0,0],dragClipPlaneStartDepthAziElev:[0,0,0],lastTwoTouchDistance:0,multiTouchGesture:!1,windowX:0,windowY:0,activeDragMode:null,activeDragButton:null,angleFirstLine:[0,0,0,0],angleState:"none",activeClipPlaneIndex:0}),Wa(this,Ca,null),U(this,"back",null),U(this,"overlays",[]),U(this,"deferredVolumes",[]),U(this,"deferredMeshes",[]),U(this,"furthestVertexFromOrigin",100),U(this,"volScale",[]),U(this,"vox",[]),U(this,"mousePos",[0,0]),U(this,"screenSlices",[]),U(this,"cuboidVertexBuffer"),U(this,"otherNV",null),U(this,"volumeObject3D",null),U(this,"pivot3D",[0,0,0]),U(this,"furthestFromPivot",10),U(this,"currentClipPlaneIndex",0),U(this,"lastCalled",new Date().getTime()),U(this,"selectedObjectId",-1),U(this,"CLIP_PLANE_ID",1),U(this,"VOLUME_ID",254),U(this,"DISTANCE_FROM_CAMERA",-.54),U(this,"graph",{LTWH:[0,0,640,480],opacity:0,vols:[0],autoSizeMultiplanar:!1,normalizeValues:!1,isRangeCalMinMax:!1}),U(this,"customLayout",[]),U(this,"meshShaders",[{Name:"Phong",Frag:y0},{Name:"Matte",Frag:w0},{Name:"Harmonic",Frag:E0},{Name:"Hemispheric",Frag:v0},{Name:"Crevice",Frag:g0},{Name:"Edge",Frag:b0},{Name:"Diffuse",Frag:p0},{Name:"Outline",Frag:d0},{Name:"Specular",Frag:m0},{Name:"Toon",Frag:h0},{Name:"Flat",Frag:xl},{Name:"Matcap",Frag:x0},{Name:"Rim",Frag:f0},{Name:"Silhouette",Frag:u0},{Name:"Crosscut",Frag:A0}]),U(this,"dragModes",{contrast:1,measurement:2,angle:7,none:0,pan:3,slicer3D:4,callbackOnly:5}),U(this,"sliceTypeAxial",0),U(this,"sliceTypeCoronal",1),U(this,"sliceTypeSagittal",2),U(this,"sliceTypeMultiplanar",3),U(this,"sliceTypeRender",4),U(this,"onDragRelease",()=>{}),U(this,"onMouseUp",()=>{}),U(this,"onLocationChange",()=>{}),U(this,"onIntensityChange",()=>{}),U(this,"onClickToSegment",()=>{}),U(this,"onImageLoaded",()=>{}),U(this,"onMeshLoaded",()=>{}),U(this,"onFrameChange",()=>{}),U(this,"onError",()=>{}),U(this,"onColormapChange",()=>{}),U(this,"onInfo",()=>{}),U(this,"onWarn",()=>{}),U(this,"onDebug",()=>{}),U(this,"onVolumeAddedFromUrl",()=>{}),U(this,"onVolumeWithUrlRemoved",()=>{}),U(this,"onVolumeUpdated",()=>{}),U(this,"onMeshAddedFromUrl",()=>{}),U(this,"onMeshAdded",()=>{}),U(this,"onMeshWithUrlRemoved",()=>{}),U(this,"onZoom3DChange",()=>{}),U(this,"onAzimuthElevationChange",()=>{}),U(this,"onClipPlaneChange",()=>{}),U(this,"onCustomMeshShaderAdded",()=>{}),U(this,"onMeshShaderChanged",()=>{}),U(this,"onMeshPropertyChanged",()=>{}),U(this,"onDicomLoaderFinishedWithImages",()=>{}),U(this,"onDocumentLoaded",()=>{}),U(this,"onOptsChange",()=>{}),U(this,"document",new jn),U(this,"mediaUrlMap",new Map),U(this,"initialized",!1),U(this,"currentDrawUndoBitmap");for(const e in a)typeof a[e]=="function"?this[e]=a[e]:this.opts[e]=Rt[e]===void 0?Rt[e]:a[e];this.opts.forceDevicePixelRatio===0?this.uiData.dpr=window.devicePixelRatio||1:this.opts.forceDevicePixelRatio<0?this.uiData.dpr=1:this.uiData.dpr=this.opts.forceDevicePixelRatio,this.currentDrawUndoBitmap=this.opts.maxDrawUndoBitmaps,this.opts.drawingEnabled&&this.createEmptyDrawing(),this.opts.thumbnail.length>0&&(this.thumbnailVisible=!0),V.setLogLevel(this.opts.logLevel),this.document.setOptsChangeCallback((e,t,i)=>{this.onOptsChange(e,t,i)})}get scene(){return this.document.scene}get opts(){return this.document.opts}get sliceMosaicString(){return this.document.opts.sliceMosaicString||""}set sliceMosaicString(a){this.document.opts.sliceMosaicString=a}get isAlphaClipDark(){return this.document.opts.isAlphaClipDark}set isAlphaClipDark(a){this.document.opts.isAlphaClipDark=a}cleanup(){this.resizeEventListener&&(window.removeEventListener("resize",this.resizeEventListener),this.resizeEventListener=null),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.canvasObserver&&(this.canvasObserver.disconnect(),this.canvasObserver=null),se(this,Ca)&&(se(this,Ca).abort(),fa(this,Ca,null)),this.document.removeOptsChangeCallback()}get volumes(){return this.document.volumes}set volumes(a){this.document.volumes=a}get meshes(){return this.document.meshes}set meshes(a){this.document.meshes=a}get drawBitmap(){return this.document.drawBitmap}set drawBitmap(a){this.document.drawBitmap=a}get volScaleMultiplier(){return this.scene.volScaleMultiplier}set volScaleMultiplier(a){this.setScale(a)}async saveScene(a="niivue.png"){function e(i,r){const s=document.createElement("a");document.body.appendChild(s),s.style.display="none";const n=window.URL.createObjectURL(i);s.href=n,s.download=r,s.click(),s.remove()}const t=this.canvas;if(!t)throw new Error("canvas not defined");this.drawScene(),t.toBlob(i=>{i&&(a===""&&(a=`niivue-screenshot-${new Date().toString()}.png`,a=a.replace(/\s/g,"_")),e(i,a))})}async attachTo(a,e=null){return await this.attachToCanvas(document.getElementById(a),e),V.debug("attached to element with id: ",a),this}async attachToCanvas(a,e=null){return this.canvas=a,e===null&&(e=navigator.hardwareConcurrency>6,V.debug("AntiAlias ",e," Threads ",navigator.hardwareConcurrency)),this.gl=this.canvas.getContext("webgl2",{alpha:!0,antialias:e}),this.uiData.max2D=this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE),this.uiData.max3D=this.gl.getParameter(this.gl.MAX_3D_TEXTURE_SIZE),V.info("NIIVUE VERSION ",Tl),V.debug(`Max texture size 2D: ${this.uiData.max2D} 3D: ${this.uiData.max3D}`),this.canvas.parentElement.style.backgroundColor="black",this.opts.isResizeCanvas&&(this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.display="block",this.canvas.width=this.canvas.offsetWidth,this.canvas.height=this.canvas.offsetHeight,this.resizeEventListener=()=>{requestAnimationFrame(()=>{this.resizeListener()})},window.addEventListener("resize",this.resizeEventListener),this.resizeObserver=new ResizeObserver(()=>{requestAnimationFrame(()=>{this.resizeListener()})}),this.resizeObserver.observe(this.canvas.parentElement),this.canvasObserver=new MutationObserver(t=>{for(const i of t)if(i.type==="childList"&&i.removedNodes.length>0&&Array.from(i.removedNodes).includes(this.canvas)){this.cleanup();break}}),this.canvasObserver.observe(this.canvas.parentElement,{childList:!0})),this.opts.interactive&&this.registerInteractions(),await this.init(),this.drawScene(),this}syncWith(a,e={"2d":!0,"3d":!0}){a instanceof Array||(a=[a]),this.otherNV=a,this.syncOpts={...e}}broadcastTo(a,e={"2d":!0,"3d":!0}){a instanceof Array||(a=[a]),this.otherNV=a,this.syncOpts=e}doSync3d(a){a.scene.renderAzimuth=this.scene.renderAzimuth,a.scene.renderElevation=this.scene.renderElevation,a.scene.volScaleMultiplier=this.scene.volScaleMultiplier}doSync2d(a){const e=this.frac2mm(this.scene.crosshairPos);a.scene.crosshairPos=a.mm2frac(e),a.scene.pan2Dxyzmm=ma(this.scene.pan2Dxyzmm)}doSyncGamma(a){const e=this.scene.gamma,t=a.scene.gamma;e!==t&&a.setGamma(e)}doSyncZoomPan(a){a.scene.pan2Dxyzmm=ma(this.scene.pan2Dxyzmm)}doSyncCrosshair(a){const e=this.frac2mm(this.scene.crosshairPos);a.scene.crosshairPos=a.mm2frac(e)}doSyncCalMin(a){this.volumes[0].cal_min!==a.volumes[0].cal_min&&(a.volumes[0].cal_min=this.volumes[0].cal_min,a.updateGLVolume())}doSyncCalMax(a){this.volumes[0].cal_max!==a.volumes[0].cal_max&&(a.volumes[0].cal_max=this.volumes[0].cal_max,a.updateGLVolume())}doSyncSliceType(a){a.setSliceType(this.opts.sliceType)}doSyncClipPlane(a){a.setClipPlane(this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex])}sync(){if(!(!this.gl||!this.otherNV||typeof this.otherNV>"u")&&this.gl.canvas.matches(":focus"))for(let a=0;a<this.otherNV.length;a++)this.otherNV[a]!==this&&(this.syncOpts.gamma&&this.doSyncGamma(this.otherNV[a]),this.syncOpts.crosshair&&this.doSyncCrosshair(this.otherNV[a]),this.syncOpts.zoomPan&&this.doSyncZoomPan(this.otherNV[a]),this.syncOpts.sliceType&&this.doSyncSliceType(this.otherNV[a]),this.syncOpts.cal_min&&this.doSyncCalMin(this.otherNV[a]),this.syncOpts.cal_max&&this.doSyncCalMax(this.otherNV[a]),this.syncOpts.clipPlane&&this.doSyncClipPlane(this.otherNV[a]),this.syncOpts["2d"]&&this.doSync2d(this.otherNV[a]),this.syncOpts["3d"]&&this.doSync3d(this.otherNV[a]),this.otherNV[a].canvas!==this.canvas&&this.otherNV[a].drawScene(),this.otherNV[a].createOnLocationChange())}arrayEquals(a,e){return Array.isArray(a)&&Array.isArray(e)&&a.length===e.length&&a.every((t,i)=>t===e[i])}textSizePoints(){this.opts.textHeight>=0&&(V.warn("textHeight is deprecated (use fontMinPx and fontSizeScaling)"),this.opts.fontMinPx=this.opts.textHeight*217,this.opts.fontSizeScaling=.4,this.opts.textHeight=-1);const a=this.uiData.dpr||1,e=this.opts.fontMinPx,t=this.gl.canvas.width/a,i=this.gl.canvas.height/a,r=t*i,s=800*600,n=Math.max(r/s,1),o=Math.pow(n,this.opts.fontSizeScaling),c=e*o*a;this.fontPx=c,V.debug(`${t.toFixed(0)}x${i.toFixed(0)} pts (dpi=${a}) => areaScale=${n.toFixed(2)}, scale=${o.toFixed(2)}, minPx=${this.opts.fontMinPx} fontScale=${this.opts.fontSizeScaling} fontPx=${c.toFixed(2)}`)}resizeListener(){if(!(!this.canvas||!this.gl)){if(!this.opts.isResizeCanvas){this.opts.forceDevicePixelRatio>=0&&V.warn("this.opts.forceDevicePixelRatio requires isResizeCanvas"),this.drawScene();return}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.display="block",this.opts.forceDevicePixelRatio===0?this.uiData.dpr=window.devicePixelRatio||1:this.opts.forceDevicePixelRatio<0?this.uiData.dpr=1:this.uiData.dpr=this.opts.forceDevicePixelRatio,V.debug("devicePixelRatio: "+this.uiData.dpr),"width"in this.canvas.parentElement?(this.canvas.width=this.canvas.parentElement.width*this.uiData.dpr,this.canvas.height=this.canvas.parentElement.height*this.uiData.dpr):(this.canvas.width=this.canvas.offsetWidth*this.uiData.dpr,this.canvas.height=this.canvas.offsetHeight*this.uiData.dpr),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.textSizePoints(),this.drawScene()}}getRelativeMousePosition(a,e){if(e=e||a.target,!e)return;const t=e.getBoundingClientRect();return{x:a.clientX-t.left,y:a.clientY-t.top}}getNoPaddingNoBorderCanvasRelativeMousePosition(a,e){return e=e||a.target,this.getRelativeMousePosition(a,e)}mouseContextMenuListener(a){a.preventDefault()}mouseDownListener(a){if(this.uiData.mousedown=!0,this.eventInBounds(a))this.opts.bounds&&(this.opts.showBoundsBorder=!0);else{this.opts.showBoundsBorder=!1,this.drawScene();return}a.preventDefault(),this.drawPenLocation=[NaN,NaN,NaN],this.drawPenAxCorSag=-1,this.drawShapeStartLocation=[NaN,NaN,NaN];const e=this.getNoPaddingNoBorderCanvasRelativeMousePosition(a,this.gl.canvas);if(this.opts.dragMode===7&&this.uiData.angleState==="drawing_second_line"||(this.setDragStart(e.x,e.y),this.setDragEnd(e.x,e.y)),V.debug("mouse down"),V.debug(a),!e)return;const[t,i]=[e.x*this.uiData.dpr,e.y*this.uiData.dpr];this.opts.clickToSegment&&(this.clickToSegmentXY=[t,i]);const r=this.getLabelAtPoint([t,i]);if(r){if(r.onClick){r.onClick(r,a);return}for(const s of this.meshes){if(s.type!=="connectome"){if(Array.isArray(r.points)&&r.points.length===3&&r.points.every(Number.isFinite)){const[n,o,c]=r.points;this.scene.crosshairPos=this.mm2frac([n,o,c]),this.updateGLVolume()}continue}for(const n of s.nodes)n.label===r&&(this.scene.crosshairPos=this.mm2frac([n.x,n.y,n.z]),this.updateGLVolume())}}this.uiData.clickedTile=this.tileIndex(t,i),a.button===Qr&&a.shiftKey?(this.uiData.mouseButtonCenterDown=!0,this.setActiveDragMode(Qr,!0,a.ctrlKey),this.handleMouseAction(this.uiData.activeDragMode,a,e)):a.button===Qr?(this.uiData.mouseButtonLeftDown=!0,this.setActiveDragMode(Qr,!1,a.ctrlKey),this.handleMouseAction(this.uiData.activeDragMode,a,e)):a.button===Hn?(this.uiData.mouseButtonRightDown=!0,this.setActiveDragMode(Hn,a.shiftKey,a.ctrlKey),this.handleMouseAction(this.uiData.activeDragMode,a,e)):a.button===Kn&&(this.uiData.mouseButtonCenterDown=!0,this.setActiveDragMode(Kn,a.shiftKey,a.ctrlKey),this.handleMouseAction(this.uiData.activeDragMode,a,e)),this.drawScene()}getMouseButtonDragMode(a,e,t){const i=this.opts.mouseEventConfig;return a===Qr?i!=null&&i.leftButton?e&&i.leftButton.withShift!==void 0?i.leftButton.withShift:t&&i.leftButton.withCtrl!==void 0?i.leftButton.withCtrl:i.leftButton.primary:t?8:this.opts.dragModePrimary:a===Hn?(i==null?void 0:i.rightButton)!==void 0?i.rightButton:this.opts.dragMode:a===Kn?(i==null?void 0:i.centerButton)!==void 0?i.centerButton:this.opts.dragMode:this.opts.dragMode}getTouchDragMode(a){const e=this.opts.touchEventConfig;return a?(e==null?void 0:e.doubleTouch)??this.opts.dragMode:(e==null?void 0:e.singleTouch)??this.opts.dragModePrimary}setActiveDragMode(a,e,t){this.uiData.activeDragMode=this.getMouseButtonDragMode(a,e,t),this.uiData.activeDragButton=a}getCurrentDragMode(){return this.uiData.activeDragMode!==null?this.uiData.activeDragMode:this.opts.dragMode}clearActiveDragMode(){this.uiData.activeDragMode=null,this.uiData.activeDragButton=null}handleMouseAction(a,e,t){if(a===8)this.mouseDown(t.x,t.y),this.mouseClick(t.x,t.y);else if(a===9)this.uiData.windowX=e.x,this.uiData.windowY=e.y;else{if(this.mousePos=[t.x*this.uiData.dpr,t.y*this.uiData.dpr],a===0)return;if(a===7)if(this.uiData.angleState==="none")this.uiData.angleState="drawing_first_line";else if(this.uiData.angleState==="drawing_second_line"){const i=[t.x*this.uiData.dpr,t.y*this.uiData.dpr],r=this.tileIndex(i[0],i[1]);let s={sliceIndex:-1,sliceType:0,slicePosition:0};if(r>=0&&r<this.screenSlices.length){const d=this.screenSlices[r].axCorSag;let f=0;d===0?f=this.scene.crosshairPos[2]:d===1?f=this.scene.crosshairPos[1]:d===2&&(f=this.scene.crosshairPos[0]),s={sliceIndex:r,sliceType:d,slicePosition:f}}const n=[this.uiData.angleFirstLine[2],this.uiData.angleFirstLine[3],i[0],i[1]],o=this.canvasPos2frac([this.uiData.angleFirstLine[0],this.uiData.angleFirstLine[1]]),c=this.canvasPos2frac([this.uiData.angleFirstLine[2],this.uiData.angleFirstLine[3]]),l=this.canvasPos2frac([n[0],n[1]]),h=this.canvasPos2frac([n[2],n[3]]);if(o[0]>=0&&c[0]>=0&&l[0]>=0&&h[0]>=0){const d=this.frac2mm(o),f=this.frac2mm(c),u=this.frac2mm(l),m=this.frac2mm(h),p={firstLineMM:{start:ee(d[0],d[1],d[2]),end:ee(f[0],f[1],f[2])},secondLineMM:{start:ee(u[0],u[1],u[2]),end:ee(m[0],m[1],m[2])},sliceIndex:s.sliceIndex,sliceType:s.sliceType,slicePosition:s.slicePosition,angle:this.calculateAngleBetweenLines(this.uiData.angleFirstLine,n)};this.document.completedAngles.push(p)}this.resetAngleMeasurement(),this.uiData.angleState="complete",this.drawScene();return}else this.uiData.angleState==="complete"&&(this.resetAngleMeasurement(),this.uiData.angleState="drawing_first_line");this.setDragStart(t.x,t.y),this.uiData.isDragging||(this.uiData.pan2DxyzmmAtMouseDown=ma(this.scene.pan2Dxyzmm)),this.uiData.isDragging=!0,this.uiData.dragClipPlaneStartDepthAziElev=this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex]}}calculateMinMaxVoxIdx(a){if(a.length>2)throw new Error("array must not contain more than two values");return[Math.floor(Math.min(a[0],a[1])),Math.floor(Math.max(a[0],a[1]))]}calculateNewRange({volIdx:a=0}={}){if(this.opts.sliceType===4&&this.sliceMosaicString.length<1||this.uiData.dragStart[0]===this.uiData.dragEnd[0]&&this.uiData.dragStart[1]===this.uiData.dragEnd[1])return;let e=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]);if(e[0]<0)return;const t=this.frac2vox(e,a);if(e=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]),e[0]<0)return;const i=this.frac2vox(e,a);let r=-Number.MAX_VALUE,s=Number.MAX_VALUE;const n=this.calculateMinMaxVoxIdx([t[0],i[0]]),o=this.calculateMinMaxVoxIdx([t[1],i[1]]),c=this.calculateMinMaxVoxIdx([t[2],i[2]]);t[0]-i[0]===0?n[1]=t[0]+1:t[1]-i[1]===0?o[1]=t[1]+1:t[2]-i[2]===0&&(c[1]=t[2]+1);const l=this.volumes[a].hdr,h=this.volumes[a].img;if(!l||!h)return;const d=l.dims[1],f=l.dims[2];for(let p=c[0];p<c[1];p++){const g=p*d*f;for(let b=o[0];b<o[1];b++){const A=b*d;for(let y=n[0];y<n[1];y++){const x=g+A+y;s>h[x]&&(s=h[x]),r<h[x]&&(r=h[x])}}}if(s>=r)return;const u=vl(l,s),m=vl(l,r);this.volumes[a].cal_min=u,this.volumes[a].cal_max=m,this.onIntensityChange(this.volumes[a])}generateMouseUpCallback(a,e){const t=this.tileIndex(this.uiData.dragStart[0],this.uiData.dragStart[1]),i=this.tileIndex(this.uiData.dragEnd[0],this.uiData.dragEnd[1]);let r=-1;t===i&&(r=i);let s=-1;r>=0&&(s=this.screenSlices[r].axCorSag);const n=this.frac2mm(a),o=this.frac2mm(e),c=Ce();zc(c,ee(n[0],n[1],n[2]),ee(o[0],o[1],o[2]));const l=fs(c),h=this.frac2vox(a),d=this.frac2vox(e);this.onDragRelease({fracStart:a,fracEnd:e,voxStart:h,voxEnd:d,mmStart:n,mmEnd:o,mmLength:l,tileIdx:r,axCorSag:s})}mouseUpListener(){this.uiData.mousedown=!1;function a(r){return Object.prototype.toString.call(r).indexOf("Function")>-1}const e={mouseButtonRightDown:this.uiData.mouseButtonRightDown,mouseButtonCenterDown:this.uiData.mouseButtonCenterDown,isDragging:this.uiData.isDragging,mousePos:this.mousePos,fracPos:this.canvasPos2frac(this.mousePos)};this.uiData.mouseButtonRightDown=!1;const t=this.uiData.mouseButtonCenterDown;this.uiData.mouseButtonCenterDown=!1,this.uiData.mouseButtonLeftDown=!1;const i=this.getCurrentDragMode();if(this.drawPenFillPts.length>0?this.drawPenFilled():this.opts.drawingEnabled&&!isNaN(this.drawPenLocation[0])?this.drawAddUndoBitmap():this.opts.drawingEnabled&&!isNaN(this.drawShapeStartLocation[0])&&(this.opts.penType===1||this.opts.penType===2)&&(this.opts.penValue===0?this.drawAddUndoBitmap():this.drawAddUndoBitmap(this.drawFillOverwrites),this.drawShapePreviewBitmap=null),this.drawPenLocation=[NaN,NaN,NaN],this.drawPenAxCorSag=-1,this.drawShapeStartLocation=[NaN,NaN,NaN],this.drawShapePreviewBitmap&&(this.drawBitmap=this.drawShapePreviewBitmap,this.drawShapePreviewBitmap=null,this.refreshDrawing(!0,!1)),a(this.onMouseUp)&&this.onMouseUp(e),this.uiData.isDragging){if(this.uiData.isDragging=!1,i===7){if(this.uiData.angleState==="drawing_first_line"){this.uiData.angleFirstLine=[this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]],this.uiData.angleState="drawing_second_line",this.uiData.isDragging=!0,this.drawScene();return}if(this.uiData.angleState==="drawing_second_line"){this.uiData.angleState="complete",this.clearActiveDragMode(),this.drawScene();return}}i===5&&this.drawScene();const r=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]),s=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);if(this.generateMouseUpCallback(r,s),i===6){this.clearActiveDragMode();return}if(i===1){if(t){this.clearActiveDragMode();return}if(this.uiData.dragStart[0]===this.uiData.dragEnd[0]&&this.uiData.dragStart[1]===this.uiData.dragEnd[1]){this.clearActiveDragMode();return}this.calculateNewRange({volIdx:0}),this.refreshLayers(this.volumes[0],0)}if(i===2){const n=this.getCurrentSliceInfo(),o=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]),c=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);if(o[0]>=0&&c[0]>=0){const l=this.frac2mm(o),h=this.frac2mm(c);this.document.completedMeasurements.push({startMM:ee(l[0],l[1],l[2]),endMM:ee(h[0],h[1],h[2]),sliceIndex:n.sliceIndex,sliceType:n.sliceType,slicePosition:n.slicePosition,distance:lf(ee(l[0],l[1],l[2]),ee(h[0],h[1],h[2]))})}this.clearActiveDragMode(),this.drawScene();return}}this.clearActiveDragMode(),this.drawScene()}checkMultitouch(a){if(this.uiData.touchdown&&!this.uiData.multiTouchGesture){const e=this.canvas.getBoundingClientRect();this.mouseDown(a.touches[0].clientX-e.left,a.touches[0].clientY-e.top),this.mouseClick(a.touches[0].clientX-e.left,a.touches[0].clientY-e.top)}}touchStartListener(a){a.preventDefault(),this.uiData.touchTimer||(this.uiData.touchTimer=setTimeout(()=>{this.resetBriCon(a)},this.opts.longTouchTimeout)),this.uiData.touchdown=!0,this.uiData.currentTouchTime=new Date().getTime();const e=this.uiData.currentTouchTime-this.uiData.lastTouchTime;if(e<this.opts.doubleTouchTimeout&&e>0){this.uiData.doubleTouch=!0,this.setDragStart(a.targetTouches[0].clientX-a.target.getBoundingClientRect().left,a.targetTouches[0].clientY-a.target.getBoundingClientRect().top),this.resetBriCon(a),this.uiData.lastTouchTime=this.uiData.currentTouchTime;return}else this.uiData.doubleTouch=!1,this.setDragStart(0,0),this.setDragEnd(0,0),this.uiData.lastTouchTime=this.uiData.currentTouchTime;this.uiData.touchdown&&a.touches.length<2?this.uiData.multiTouchGesture=!1:this.uiData.multiTouchGesture=!0,setTimeout(this.checkMultitouch.bind(this),1,a)}touchEndListener(a){if(a.preventDefault(),this.uiData.touchdown=!1,this.uiData.lastTwoTouchDistance=0,this.uiData.multiTouchGesture=!1,this.uiData.touchTimer&&(clearTimeout(this.uiData.touchTimer),this.uiData.touchTimer=null),this.uiData.isDragging){this.uiData.isDragging=!1,this.getCurrentDragMode()===1&&(this.calculateNewRange(),this.refreshLayers(this.volumes[0],0));const e=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]),t=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);this.generateMouseUpCallback(e,t)}this.mouseUpListener()}windowingHandler(a,e,t=0){const i=this.uiData.windowX,r=this.uiData.windowY;let s=this.volumes[0].cal_min,n=this.volumes[0].cal_max;const o=this.volumes[0].global_min,c=this.volumes[0].global_max;e<r?(s+=1,n+=1):e>r&&(s-=1,n-=1),a>i?(s-=1,n+=1):a<i&&(s+=1,n-=1),n-s<1&&(n=s+1),s<o&&(s=o),n>c&&(n=c),s>n&&(s=n-1),this.volumes[t].cal_min=s,this.volumes[t].cal_max=n,this.refreshLayers(this.volumes[t],0),this.uiData.windowX=a,this.uiData.windowY=e}mouseLeaveListener(){this.clickToSegmentIsGrowing&&(V.debug("Mouse left canvas, stopping clickToSegment preview."),this.clickToSegmentIsGrowing=!1,this.refreshDrawing(!0,!1)),this.opts.drawingEnabled&&!isNaN(this.drawPenLocation[0])&&(V.debug("Mouse left canvas during drawing, resetting pen state."),this.drawPenLocation=[NaN,NaN,NaN],this.drawPenAxCorSag=-1,this.drawPenFillPts=[]),this.opts.drawingEnabled&&!isNaN(this.drawShapeStartLocation[0])&&(V.debug("Mouse left canvas during shape drawing, resetting shape state."),this.drawShapeStartLocation=[NaN,NaN,NaN],this.drawShapePreviewBitmap&&(this.drawBitmap=this.drawShapePreviewBitmap,this.drawShapePreviewBitmap=null,this.refreshDrawing(!0,!1))),(this.uiData.isDragging||this.uiData.mousedown)&&(V.debug("Mouse left canvas during drag, resetting drag state."),this.uiData.isDragging=!1,this.uiData.mouseButtonLeftDown=!1,this.uiData.mouseButtonCenterDown=!1,this.uiData.mouseButtonRightDown=!1,this.uiData.mousedown=!1,this.drawScene()),this.mousePos=[-1,-1]}mouseMoveListener(a){this.uiData.mousedown&&this.drawScene();const e=this.getNoPaddingNoBorderCanvasRelativeMousePosition(a,this.gl.canvas);if(e){if(!this.eventInBounds(a)){this.updateMousePos(e.x,e.y);return}if(this.uiData.mousedown){const t=e.x*this.uiData.dpr,i=e.y*this.uiData.dpr;if(this.tileIndex(t,i)!==this.uiData.clickedTile)return;const s=this.getCurrentDragMode();if(s===8){this.mouseMove(e.x,e.y),this.mouseClick(e.x,e.y),this.drawScene(),this.uiData.prevX=this.uiData.currX,this.uiData.prevY=this.uiData.currY;return}if(s===9){this.windowingHandler(e.x,e.y),this.drawScene(),this.uiData.prevX=this.uiData.currX,this.uiData.prevY=this.uiData.currY;return}this.setDragEnd(e.x,e.y),this.drawScene(),this.uiData.prevX=this.uiData.currX,this.uiData.prevY=this.uiData.currY}else if(this.getCurrentDragMode()===7&&this.uiData.angleState==="drawing_second_line"){const t=this.getNoPaddingNoBorderCanvasRelativeMousePosition(a,this.gl.canvas);if(!t)return;this.setDragEnd(t.x,t.y),this.drawScene()}else if(!this.uiData.mousedown&&this.opts.clickToSegment){const t=this.getNoPaddingNoBorderCanvasRelativeMousePosition(a,this.gl.canvas);if(!t)return;const i=t.x*this.uiData.dpr,r=t.y*this.uiData.dpr;this.mousePos=[i,r];const s=this.tileIndex(i,r);s>=0&&this.opts.drawingEnabled&&this.screenSlices[s].axCorSag<=2&&(this.clickToSegmentXY=[i,r],this.clickToSegmentIsGrowing=!0,this.doClickToSegment({x:i,y:r,tileIndex:s}))}}}resetBriCon(a=null){if(this.uiData.isDragging)return;if(!this.eventInBounds(a)){this.opts.showBoundsBorder=!1;return}let e=!1;this.opts.sliceType===4&&(e=!0);let t=0,i=0;if(a!==null&&("targetTouches"in a?(t=a.targetTouches[0].clientX-a.target.getBoundingClientRect().left,i=a.targetTouches[0].clientY-a.target.getBoundingClientRect().top):(t=a.offsetX,i=a.offsetY),t*=this.uiData.dpr,i*=this.uiData.dpr,this.inRenderTile(t,i)>=0&&(e=!0)),e){this.uiData.mouseDepthPicker=!0,this.drawScene(),this.drawScene();return}this.getCurrentDragMode()!==4&&(this.volumes.length<1||this.uiData.doubleTouch||(this.volumes[0].cal_min=this.volumes[0].robust_min,this.volumes[0].cal_max=this.volumes[0].robust_max,this.onIntensityChange(this.volumes[0]),this.refreshLayers(this.volumes[0],0),this.drawScene()))}setDragStart(a,e){a*=this.uiData.dpr,e*=this.uiData.dpr,this.uiData.dragStart[0]=a,this.uiData.dragStart[1]=e}setDragEnd(a,e){a*=this.uiData.dpr,e*=this.uiData.dpr,this.uiData.dragEnd[0]=a,this.uiData.dragEnd[1]=e}touchMoveListener(a){if(this.uiData.touchdown&&a.touches.length<2){const e=this.canvas.getBoundingClientRect();if(this.uiData.isDragging||(this.uiData.pan2DxyzmmAtMouseDown=ma(this.scene.pan2Dxyzmm)),this.uiData.isDragging=!0,this.uiData.doubleTouch&&this.uiData.isDragging){this.setDragEnd(a.targetTouches[0].clientX-a.target.getBoundingClientRect().left,a.targetTouches[0].clientY-a.target.getBoundingClientRect().top),this.drawScene();return}const t=this.getTouchDragMode(!1);t===8?(this.mouseClick(a.touches[0].clientX-e.left,a.touches[0].clientY-e.top),this.mouseMove(a.touches[0].clientX-e.left,a.touches[0].clientY-e.top)):t===9&&(this.windowingHandler(a.touches[0].pageX,a.touches[0].pageY),this.drawScene())}else this.handlePinchZoom(a)}handlePinchZoom(a){if(a.targetTouches.length===2&&a.changedTouches.length===2){const e=Math.hypot(a.touches[0].pageX-a.touches[1].pageX,a.touches[0].pageY-a.touches[1].pageY),t=this.canvas.getBoundingClientRect();this.mousePos=[a.touches[0].clientX-t.left,a.touches[0].clientY-t.top],e<this.uiData.lastTwoTouchDistance?this.sliceScroll2D(-.01,a.touches[0].clientX-t.left,a.touches[0].clientY-t.top):this.sliceScroll2D(.01,a.touches[0].clientX-t.left,a.touches[0].clientY-t.top),this.uiData.lastTwoTouchDistance=e}}cycleActiveClipPlane(){const a=this.scene.clipPlanes.length||6;this.uiData.activeClipPlaneIndex==null?this.uiData.activeClipPlaneIndex=0:this.uiData.activeClipPlaneIndex=(this.uiData.activeClipPlaneIndex+1)%a;const e=this.uiData.activeClipPlaneIndex;return this.scene.clipPlanes[e]||(this.scene.clipPlanes[e]=[0,0,0,2]),this.scene.clipPlaneDepthAziElevs[e]||(this.scene.clipPlaneDepthAziElevs[e]=[2,0,0]),e}keyUpListener(a){if(!this.cursorInBounds()){this.opts.showBoundsBorder=!1,this.drawScene();return}const e=new Date().getTime(),t=e-this.lastCalled;if(a.code===this.opts.cycleClipPlaneHotKey&&t>this.opts.keyDebounceTime){const i=this.cycleActiveClipPlane();console.log("Active clip plane cycled to:",i),console.log("clip planes",this.scene.clipPlanes),this.lastCalled=e}if(a.code===this.opts.clipPlaneHotKey){if(t>this.opts.keyDebounceTime){switch(this.currentClipPlaneIndex=(this.currentClipPlaneIndex+1)%7,this.currentClipPlaneIndex){case 0:this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex]=[2,0,0];break;case 1:this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex]=[0,270,0];break;case 2:this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex]=[0,90,0];break;case 3:this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex]=[0,0,0];break;case 4:this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex]=[0,180,0];break;case 5:this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex]=[0,0,-90];break;case 6:this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex]=[0,0,90];break}this.setClipPlane(this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex])}this.lastCalled=e}else if(a.code===this.opts.viewModeHotKey){const i=new Date().getTime();i-this.lastCalled>this.opts.keyDebounceTime&&(this.setSliceType((this.opts.sliceType+1)%5),this.lastCalled=i)}this.drawScene()}keyDownListener(a){if(!this.cursorInBounds()){this.opts.showBoundsBorder=!1,this.drawScene();return}a.code==="KeyH"&&this.opts.sliceType===4?this.setRenderAzimuthElevation(this.scene.renderAzimuth-1,this.scene.renderElevation):a.code==="KeyL"&&this.opts.sliceType===4?this.setRenderAzimuthElevation(this.scene.renderAzimuth+1,this.scene.renderElevation):a.code==="KeyJ"&&this.opts.sliceType===4?this.setRenderAzimuthElevation(this.scene.renderAzimuth,this.scene.renderElevation+1):a.code==="KeyK"&&this.opts.sliceType===4?this.setRenderAzimuthElevation(this.scene.renderAzimuth,this.scene.renderElevation-1):a.code==="KeyH"&&this.opts.sliceType!==4?this.moveCrosshairInVox(-1,0,0):a.code==="KeyL"&&this.opts.sliceType!==4?this.moveCrosshairInVox(1,0,0):a.code==="KeyU"&&this.opts.sliceType!==4&&a.ctrlKey?this.moveCrosshairInVox(0,0,1):a.code==="KeyD"&&this.opts.sliceType!==4&&a.ctrlKey?this.moveCrosshairInVox(0,0,-1):a.code==="KeyJ"&&this.opts.sliceType!==4?this.moveCrosshairInVox(0,-1,0):a.code==="KeyK"&&this.opts.sliceType!==4?this.moveCrosshairInVox(0,1,0):a.code==="KeyM"&&this.opts.sliceType!==4?(this.opts.dragMode++,this.opts.dragMode>=4&&(this.opts.dragMode=0),V.info("drag mode changed to ",Lh[this.opts.dragMode])):a.code==="ArrowLeft"?this.setFrame4D(this.volumes[0].id,this.volumes[0].frame4D-1):a.code==="ArrowRight"?this.setFrame4D(this.volumes[0].id,this.volumes[0].frame4D+1):a.code==="Slash"&&a.shiftKey&&alert(`NIIVUE VERSION: ${Tl}`),this.drawScene()}wheelListener(a){if(this.thumbnailVisible||this.opts.sliceMosaicString.length>0)return;if(this.eventInBounds(a))this.opts.bounds&&(this.opts.showBoundsBorder=!0);else{this.opts.showBoundsBorder=!1,this.drawScene();return}a.preventDefault(),a.stopPropagation();const e=this.uiData.dragStart.reduce((c,l)=>c+l,0),t=this.uiData.dragEnd.reduce((c,l)=>c+l,0),i=e>0&&t>0;if(this.getCurrentDragMode()===6&&i){const c=a.deltaY>0?1:-1;this.uiData.dragStart[0]<this.uiData.dragEnd[0]?(this.uiData.dragStart[0]-=c,this.uiData.dragEnd[0]+=c):(this.uiData.dragStart[0]+=c,this.uiData.dragEnd[0]-=c),this.uiData.dragStart[1]<this.uiData.dragEnd[1]?(this.uiData.dragStart[1]-=c,this.uiData.dragEnd[1]+=c):(this.uiData.dragStart[1]+=c,this.uiData.dragEnd[1]-=c),this.uiData.isDragging=!0,this.drawScene(),this.uiData.isDragging=!1;const l=this.tileIndex(this.uiData.dragStart[0],this.uiData.dragStart[1]);l>=0?this.generateMouseUpCallback(this.screenXY2TextureFrac(this.uiData.dragStart[0],this.uiData.dragStart[1],l),this.screenXY2TextureFrac(this.uiData.dragEnd[0],this.uiData.dragEnd[1],l)):V.warn("Could not generate drag release callback for ROI selection: Invalid tile index.");return}let r=a.deltaY<0?-.01:.01;if(this.opts.invertScrollDirection&&(r=-r),this.opts.clickToSegment){r<0?(this.opts.clickToSegmentPercent-=.01,this.opts.clickToSegmentPercent=Math.max(this.opts.clickToSegmentPercent,0)):(this.opts.clickToSegmentPercent+=.01,this.opts.clickToSegmentPercent=Math.min(this.opts.clickToSegmentPercent,1));const c=this.clickToSegmentXY[0],l=this.clickToSegmentXY[1],h=this.tileIndex(c,l);h>=0&&this.screenSlices[h].axCorSag<=2&&(V.debug(`Adjusting clickToSegment threshold: ${this.opts.clickToSegmentPercent.toFixed(3)}`),this.clickToSegmentIsGrowing=!0,this.doClickToSegment({x:c,y:l,tileIndex:h}));return}const s=this.canvas.getBoundingClientRect(),n=a.clientX-s.left,o=a.clientY-s.top;if(this.getCurrentDragMode()===3&&this.inRenderTile(this.uiData.dpr*n,this.uiData.dpr*o)===-1){const c=r<0?1:-1;let l=this.scene.pan2Dxyzmm[3]*(1+10*(.01*c));l=Math.round(l*10)/10;const h=this.scene.pan2Dxyzmm[3]-l;this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=l),this.scene.pan2Dxyzmm[3]=l;const d=this.frac2mm(this.scene.crosshairPos);this.scene.pan2Dxyzmm[0]+=h*d[0],this.scene.pan2Dxyzmm[1]+=h*d[1],this.scene.pan2Dxyzmm[2]+=h*d[2],this.drawScene(),this.canvas.focus(),this.sync();return}this.sliceScroll2D(r,n,o)}registerInteractions(){if(!this.canvas)throw new Error("canvas undefined");fa(this,Ca,new AbortController);const{signal:a}=se(this,Ca);this.canvas.addEventListener("mousedown",this.mouseDownListener.bind(this),{signal:a}),this.canvas.addEventListener("mouseup",this.mouseUpListener.bind(this),{signal:a}),this.canvas.addEventListener("mousemove",this.mouseMoveListener.bind(this),{signal:a}),this.canvas.addEventListener("mouseleave",this.mouseLeaveListener.bind(this),{signal:a}),this.canvas.addEventListener("touchstart",this.touchStartListener.bind(this),{signal:a}),this.canvas.addEventListener("touchend",this.touchEndListener.bind(this),{signal:a}),this.canvas.addEventListener("touchmove",this.touchMoveListener.bind(this),{signal:a}),this.canvas.addEventListener("wheel",this.wheelListener.bind(this),{signal:a}),this.canvas.addEventListener("contextmenu",this.mouseContextMenuListener.bind(this),{signal:a}),this.canvas.addEventListener("dblclick",this.resetBriCon.bind(this),{signal:a}),this.canvas.addEventListener("dragenter",this.dragEnterListener.bind(this),{signal:a}),this.canvas.addEventListener("dragover",this.dragOverListener.bind(this),{signal:a}),this.canvas.addEventListener("drop",e=>{this.dropListener(e).catch(console.error)},{signal:a}),this.canvas.setAttribute("tabindex","0"),this.canvas.addEventListener("keyup",this.keyUpListener.bind(this),{signal:a}),this.canvas.addEventListener("keydown",this.keyDownListener.bind(this),{signal:a})}dragEnterListener(a){a.stopPropagation(),a.preventDefault()}dragOverListener(a){a.stopPropagation(),a.preventDefault()}getFileExt(a,e=!0){V.debug("fullname: ",a);const t=/(?:\.([^.]+))?$/;let i=t.exec(a)[1];if(i=i.toUpperCase(),i==="GZ")i=t.exec(a.slice(0,-3))[1],i=i.toUpperCase();else if(i==="CBOR"){const r=i;i=t.exec(a.slice(0,-5))[1],i=i.toUpperCase(),i=`${i}.${r}`}return e?i:i.toLowerCase()}async addVolumeFromUrl(a){const e=await st.loadFromUrl(a);return this.document.addImageOptions(e,a),e.onColormapChange=this.onColormapChange,this.mediaUrlMap.set(e,a.url),this.onVolumeAddedFromUrl&&this.onVolumeAddedFromUrl(a,e),this.addVolume(e),e}async addVolumesFromUrl(a){const e=a.map(async i=>{const r=this.getFileExt(i.name||i.url);if(r==="DCM")throw new Error("DICOM files must be loaded using useDicomLoader");if(this.loaders[r]){let o=i.url;const c=this.loaders[r].toExt;let l=i.name||i.url;if(l=l.split("/").pop(),typeof i.url=="string"){const d=i.url;try{const f=await fetch(d);if(!f.ok)throw new Error(`Failed to load file: ${f.statusText}`);o=await f.arrayBuffer()}catch(f){throw new Error(`Failed to load url ${d}: ${f}`)}}const h=await this.loaders[r].loader(o);i.url=h,i.name=`${l}.${c}`}const s={url:i.url,headers:i.headers,name:i.name,colormap:i.colormap?i.colormap:i.colorMap,colormapNegative:i.colormapNegative?i.colormapNegative:i.colorMapNegative,opacity:i.opacity,urlImgData:i.urlImgData,cal_min:i.cal_min,cal_max:i.cal_max,trustCalMinMax:this.opts.trustCalMinMax,isManifest:i.isManifest,frame4D:i.frame4D,limitFrames4D:i.limitFrames4D||this.opts.limitFrames4D,colorbarVisible:i.colorbarVisible},n=await st.loadFromUrl(s);return this.document.addImageOptions(n,s),n.onColormapChange=this.onColormapChange,this.mediaUrlMap.set(n,s.url),this.onVolumeAddedFromUrl&&this.onVolumeAddedFromUrl(s,n),n}),t=await Promise.all(e);for(let i=0;i<t.length;i++)this.addVolume(t[i]);return t}getMediaByUrl(a){return[...this.mediaUrlMap.entries()].filter(e=>e[1]===a).map(e=>e[0]).pop()}removeVolumeByUrl(a){const e=this.getMediaByUrl(a);if(e)this.removeVolume(e);else throw new Error("No volume with URL present")}async traverseFileTree(a,e="",t){return new Promise(i=>{if(a.isFile)a.file(r=>{r.fullPath=e+r.name,r._webkitRelativePath=e+r.name,t.push(r),i(t)});else if(a.isDirectory){const r=a.createReader(),s=()=>{r.readEntries(n=>{if(n.length>0){const o=[];for(const c of n)o.push(this.traverseFileTree(c,e+a.name+"/",t));Promise.all(o).then(s).catch(c=>{throw c})}else i(t)})};s()}})}readDirectory(a){const e=a.createReader();let t=[];const i=async s=>{const n=[],o=async c=>new Promise((l,h)=>c.file(l,h));for(let c=0;c<s.length;c++)n.push(await o(s[c]));return n},r=()=>{e.readEntries(s=>{s.length?(t=t.concat(s),r()):i(t).then(async()=>{}).catch(n=>{throw n})})};return r(),t}isMeshExt(a){const e=this.getFileExt(a);return V.debug("dropped ext"),V.debug(e),Ia.includes(e)}async loadFromArrayBuffer(a,e){const t=this.getFileExt(e);if(Ia.includes(t)){await this.addMeshFromUrl({url:e,buffer:a});return}const i=nn(e);i.buffer=a,i.name=e,await this.addVolumeFromUrl(i)}async loadFromFile(a){const e=this.getFileExt(a.name);if(Ia.includes(e)){await Xa.loadFromFile({file:a,gl:this.gl,name:a.name}).then(t=>{this.addMesh(t)});return}await st.loadFromFile({file:a,name:a.name}).then(t=>{this.addVolume(t)})}useLoader(a,e,t){this.loaders={...this.loaders,[e.toUpperCase()]:{loader:a,toExt:t}}}useDicomLoader(a){this.dicomLoader=a}getDicomLoader(){return this.dicomLoader}async dropListener(a){if(this.eventInBounds(a))this.opts.bounds&&(this.opts.showBoundsBorder=!0);else{this.opts.showBoundsBorder=!1;return}if(a.stopPropagation(),a.preventDefault(),!this.opts.dragAndDropEnabled)return;const e=[],t=a.dataTransfer;if(!t)return;const i=t.getData("text/uri-list");if(i){const r=nn(i),s=this.getFileExt(i);V.debug("dropped ext"),V.debug(s),Ia.includes(s)?this.addMeshFromUrl({url:i}).catch(n=>{throw n}):s==="NVD"?this.loadDocumentFromUrl(i).catch(n=>{throw n}):this.addVolumeFromUrl(r).catch(n=>{throw n})}else{const r=t.items;if(r.length>0){!a.shiftKey&&!a.altKey&&(this.volumes=[],this.overlays=[],this.meshes=[]),this.closeDrawing(),this.closePAQD();for(const s of Array.from(r)){const n=s.webkitGetAsEntry();if(V.debug(n),!n)throw new Error("could not get entry from file");if(n.isFile){const o=this.getFileExt(n.name);let c;if(n.name.lastIndexOf("HEAD")!==-1)for(const l of Array.from(r)){const h=l.webkitGetAsEntry();if(!h)throw new Error("could not get paired entry");const d=n.name.substring(0,n.name.lastIndexOf("HEAD")),f=h.name.substring(0,h.name.lastIndexOf("BRIK"));d===f&&(c=h)}if(n.name.toUpperCase().lastIndexOf("HDR")!==-1)for(const l of Array.from(r)){const h=l.webkitGetAsEntry();if(!h)throw new Error("could not get paired entry");const d=n.name.substring(0,n.name.toUpperCase().lastIndexOf("HDR")),f=h.name.substring(0,h.name.toUpperCase().lastIndexOf("IMG"));d===f&&(c=h)}if(n.name.lastIndexOf("BRIK")!==-1||n.name.toUpperCase().lastIndexOf("IMG")!==-1)continue;if(this.loaders[o]){const l=await U0(n);await this.loadImages([{url:l,name:`${n.name}`}]);continue}if(Ia.includes(o)){n.file(l=>{(async()=>{try{const h=await Xa.loadFromFile({file:l,gl:this.gl,name:l.name});this.addMesh(h)}catch(h){console.error("Error loading mesh:",h)}})().catch(h=>console.error(h))});continue}else if(o==="NVD"){n.file(l=>{(async()=>{try{const h=await jn.loadFromFile(l);await this.loadDocument(h),V.debug("loaded document")}catch(h){console.error(h)}})().catch(h=>console.error(h))});break}n.file(l=>{(async()=>{try{if(c)c.file(h=>{(async()=>{try{const d=await st.loadFromFile({file:l,urlImgData:h,limitFrames4D:this.opts.limitFrames4D});this.addVolume(d)}catch(d){console.error(d)}})().catch(console.error)});else{const h=await st.loadFromFile({file:l,urlImgData:c,limitFrames4D:this.opts.limitFrames4D});a.altKey?(V.debug("alt key detected: assuming this is a drawing overlay"),this.drawClearAllUndoBitmaps(),this.loadDrawing(h)):this.addVolume(h)}}catch(h){console.error(h)}})().catch(console.error)})}else n.isDirectory&&this.traverseFileTree(n,"",e).then(o=>{const c=this.getDicomLoader().loader;if(!c)throw new Error("No loader for DICOM files");c(o).then(async l=>{const h=l.map(d=>st.loadFromUrl({url:d.data,name:d.name,limitFrames4D:this.opts.limitFrames4D}));Promise.all(h).then(async d=>{await this.onDicomLoaderFinishedWithImages(d)}).catch(d=>{throw d})}).catch(l=>{console.error("Error loading DICOM files:",l)})}).catch(o=>{throw o})}}}this.drawScene()}setMultiplanarPadPixels(a){this.opts.multiplanarPadPixels=a,this.drawScene()}setMultiplanarLayout(a){typeof a=="string"&&(a=parseInt(a)),this.opts.multiplanarLayout=a,this.drawScene()}setCornerOrientationText(a){this.opts.isCornerOrientationText=a,this.updateGLVolume()}setIsOrientationTextVisible(a){this.opts.isOrientationTextVisible=a,this.drawScene()}setShowAllOrientationMarkers(a){this.opts.showAllOrientationMarkers=a,this.drawScene()}setHeroImage(a){this.opts.heroImageFraction=a,this.drawScene()}setCustomLayout(a){for(let e=0;e<a.length;e++){const[t,i,r,s]=a[e].position,n=t+r,o=i+s;for(let c=e+1;c<a.length;c++){const[l,h,d,f]=a[c].position,u=l+d,m=h+f,p=t<u&&n>l,g=i<m&&o>h;if(p&&g)throw new Error(`Custom layout is invalid. Tile ${e} overlaps with tile ${c}.`)}}this.customLayout=a,this.drawScene()}clearCustomLayout(){this.customLayout=null,this.drawScene()}getCustomLayout(){return this.customLayout}setRadiologicalConvention(a){this.opts.isRadiologicalConvention=a,this.updateGLVolume()}setDefaults(a={},e=!1){this.document.opts={...Rt},this.scene.sceneData={...as};for(const t in a)typeof a[t]=="function"?this[t]=a[t]:this.opts[t]=Rt[t]===void 0?Rt[t]:a[t];if(this.scene.pan2Dxyzmm=[0,0,0,1],e&&this.volumes&&this.volumes.length>0)for(let t=0;t<this.volumes.length;t++)this.volumes[t].cal_min=this.volumes[t].robust_min,this.volumes[t].cal_max=this.volumes[t].robust_max;this.updateGLVolume()}setMeshThicknessOn2D(a){this.opts.meshThicknessOn2D=a,this.updateGLVolume()}setSliceMosaicString(a){this.sliceMosaicString=a,this.updateGLVolume()}setSliceMM(a){this.opts.isSliceMM=a,this.updateGLVolume()}setAdditiveBlend(a){this.opts.isAdditiveBlend=a,this.updateGLVolume()}getRadiologicalConvention(){return this.opts.isRadiologicalConvention}setHighResolutionCapable(a){typeof a=="boolean"&&(a=a?0:-1),this.opts.forceDevicePixelRatio=a,this.resizeListener(),this.drawScene()}watchOptsChanges(a){this.onOptsChange=a}unwatchOptsChanges(){this.onOptsChange=()=>{}}addVolume(a){this.volumes.push(a);const e=this.volumes.length===1?0:this.volumes.length-1;this.setVolume(a,e),this.onImageLoaded(a),V.debug("loaded volume",a.name),V.debug(a)}addMesh(a){this.meshes.push(a);const e=this.meshes.length===1?0:this.meshes.length-1;this.setMesh(a,e),this.onMeshLoaded(a)}getVolumeIndexByID(a){const e=this.volumes.length;for(let t=0;t<e;t++)if(this.volumes[t].id===a)return t;return-1}drawAddUndoBitmap(a=!0){if(!this.drawBitmap||this.drawBitmap.length<1){V.debug("drawAddUndoBitmap error: No drawing open");return}if(!a&&this.drawUndoBitmaps.length>0){const e=this.drawBitmap.length,t=lo(this.drawUndoBitmaps[this.currentDrawUndoBitmap],e);for(let i=0;i<e;i++)t[i]>0&&(this.drawBitmap[i]=t[i]);this.refreshDrawing(!1)}this.currentDrawUndoBitmap++,this.currentDrawUndoBitmap>=this.opts.maxDrawUndoBitmaps&&(this.currentDrawUndoBitmap=0),this.drawUndoBitmaps[this.currentDrawUndoBitmap]=Dp(this.drawBitmap)}drawClearAllUndoBitmaps(){if(this.currentDrawUndoBitmap=this.opts.maxDrawUndoBitmaps,!(!this.drawUndoBitmaps||this.drawUndoBitmaps.length<1))for(let a=this.drawUndoBitmaps.length-1;a>=0;a--)this.drawUndoBitmaps[a]=new Uint8Array}drawUndo(){const{drawBitmap:a,currentDrawUndoBitmap:e}=_p({drawUndoBitmaps:this.drawUndoBitmaps,currentDrawUndoBitmap:this.currentDrawUndoBitmap,drawBitmap:this.drawBitmap});this.drawBitmap=a,this.currentDrawUndoBitmap=e,this.refreshDrawing(!0)}loadDrawing(a){if(this.drawBitmap&&V.debug("Overwriting open drawing!"),!this.back)throw new Error("back undefined");this.drawClearAllUndoBitmaps();const e=a.hdr.dims;if(e[1]!==this.back.hdr.dims[1]||e[2]!==this.back.hdr.dims[2]||e[3]!==this.back.hdr.dims[3])return V.debug("drawing dimensions do not match background image"),!1;a.img.constructor!==Uint8Array&&V.debug("Drawings should be UINT8");const t=a.permRAS,i=e[1]*e[2]*e[3];this.drawBitmap=new Uint8Array(i),this.opts.is2DSliceShader?this.drawTexture=this.r8Tex2D(this.drawTexture,ha,this.back.dims,!0):this.drawTexture=this.r8Tex(this.drawTexture,ha,this.back.dims,!0);const r=[0,0,0];for(let m=0;m<3;m++)for(let p=0;p<3;p++)Math.abs(t[m])-1===p&&(r[p]=m*Math.sign(t[m]));let s=1;const n=[1,1,1],o=[!1,!1,!1];for(let m=0;m<r.length;m++)for(let p=0;p<r.length;p++)Math.abs(r[p])===m&&(n[p]=s,(r[p]<0||Object.is(r[p],-0))&&(o[p]=!0),s*=e[p+1]);let c=ce.range(0,e[1]-1,1);o[0]&&(c=ce.range(e[1]-1,0,-1));for(let m=0;m<e[1];m++)c[m]*=n[0];let l=ce.range(0,e[2]-1,1);o[1]&&(l=ce.range(e[2]-1,0,-1));for(let m=0;m<e[2];m++)l[m]*=n[1];let h=ce.range(0,e[3]-1,1);o[2]&&(h=ce.range(e[3]-1,0,-1));for(let m=0;m<e[3];m++)h[m]*=n[2];const d=a.img,f=this.drawBitmap;let u=0;for(let m=0;m<e[3];m++)for(let p=0;p<e[2];p++)for(let g=0;g<e[1];g++)f[c[g]+l[p]+h[m]]=d[u],u++;return this.drawAddUndoBitmap(),this.refreshDrawing(!1),this.drawScene(),!0}binarize(a){const e=a.hdr.dims,t=e[1]*e[2]*e[3],i=new Uint8Array(t);for(let r=0;r<t;r++)a.img[r]!==0&&(i[r]=1);a.img=i,a.hdr.datatypeCode=2,a.hdr.cal_min=0,a.hdr.cal_max=1}async loadDrawingFromUrl(a,e=!1){this.drawBitmap&&V.debug("Overwriting open drawing!"),this.drawClearAllUndoBitmaps();let t=!1;try{const i=await st.loadFromUrl(nn(a));e&&await this.binarize(i),t=this.loadDrawing(i)}catch{V.error("loadDrawingFromUrl() failed to load "+a),this.drawClearAllUndoBitmaps()}return t}findOtsu(a=2){if(this.volumes.length<1)return[];const e=this.volumes[0].img,t=e.length;if(t<1)return[];const i=256,r=i-1,s=new Array(i).fill(0),n=this.volumes[0].cal_min,o=this.volumes[0].cal_max;if(o<=n)return[];const c=(o-n)/i;function l(b){return b*c+n}const h=(i-1)/Math.abs(o-n),d=this.volumes[0].hdr.scl_inter,f=this.volumes[0].hdr.scl_slope;for(let b=0;b<t;b++){let A=e[b]*f+d;A=Math.min(Math.max(A,n),o),A=Math.round((A-n)*h),s[A]++}const u=Array(i).fill(0).map(()=>Array(i).fill(0)),m=Array(i).fill(0).map(()=>Array(i).fill(0));for(let b=1;b<i;++b)u[b][b]=s[b],m[b][b]=b*s[b];for(let b=1;b<i-1;++b)u[1][b+1]=u[1][b]+s[b+1],m[1][b+1]=m[1][b]+(b+1)*s[b+1];for(let b=2;b<i;b++)for(let A=b+1;A<i;A++)u[b][A]=u[1][A]-u[1][b-1],m[b][A]=m[1][A]-m[1][b-1];for(let b=1;b<i;++b)for(let A=b+1;A<i;A++)u[b][A]!==0&&(u[b][A]=m[b][A]*m[b][A]/u[b][A]);let p=0;const g=[1/0,1/0,1/0];if(a>3)for(let b=0;b<i-3;b++)for(let A=b+1;A<i-2;A++)for(let y=A+1;y<i-1;y++){const x=u[0][b]+u[b+1][A]+u[A+1][y]+u[y+1][r];x>p&&(g[0]=b,g[1]=A,g[2]=y,p=x)}else if(a===3)for(let b=0;b<i-2;b++)for(let A=b+1;A<i-1;A++){const y=u[0][b]+u[b+1][A]+u[A+1][r];y>p&&(g[0]=b,g[1]=A,p=y)}else for(let b=0;b<i-1;b++){const A=u[0][b]+u[b+1][r];A>p&&(g[0]=b,p=A)}return[l(g[0]),l(g[1]),l(g[2])]}drawOtsu(a=2){if(this.volumes.length===0)return;const e=this.volumes[0].img.length,t=this.findOtsu(a);if(t.length<3)return;this.drawBitmap||this.createEmptyDrawing();const i=this.drawBitmap,r=this.volumes[0].img;for(let s=0;s<e;s++){if(i[s]!==0)continue;const n=r[s];n>t[0]&&(i[s]=1),n>t[1]&&(i[s]=2),n>t[2]&&(i[s]=3)}this.drawAddUndoBitmap(),this.refreshDrawing(!0)}removeHaze(a=5,e=0){const t=this.volumes[e].img,i=this.volumes[e].hdr,r=t.length;let s=2;(a===5||a===1)&&(s=4),(a===4||a===2)&&(s=3);const n=this.findOtsu(s);if(n.length<3)return;let o=n[0];a===1&&(o=n[2]),a===2&&(o=n[1]);const c=i.scl_inter,l=i.scl_slope,h=this.volumes[e].global_min;for(let d=0;d<r;d++)t[d]*l+c<o&&(t[d]=h);this.refreshLayers(this.volumes[e],0),this.drawScene()}async saveImage(a=_l){var n;const e={..._l,...a},{filename:t,isSaveDrawing:i,volumeByIndex:r}=e;return V.debug("saveImage",t,i,r),((n=this.back)==null?void 0:n.dims)===void 0?(V.debug("No voxelwise image open"),!1):i?this.drawBitmap?await this.volumes[0].saveToDisk(t,this.drawBitmap):(V.debug("No drawing open"),!1):(V.debug("saving image"),this.volumes[r].saveToDisk(t))}getMeshIndexByID(a){if(typeof a=="number")return a>=this.meshes.length?-1:a;const e=this.meshes.length;for(let t=0;t<e;t++)if(this.meshes[t].id===a)return t;return-1}setMeshProperty(a,e,t){const i=this.getMeshIndexByID(a);if(i<0){V.warn("setMeshProperty() id not loaded",a);return}this.meshes[i].setProperty(e,t,this.gl),this.updateGLVolume(),this.onMeshPropertyChanged(i,e,t)}indexNearestXYZmm(a,e,t,i){const r=this.getMeshIndexByID(a);return r<0?(V.warn("indexNearestXYZmm() id not loaded",a),[NaN,NaN]):this.meshes[r].indexNearestXYZmm(e,t,i)}decimateHierarchicalMesh(a,e=3){const t=this.getMeshIndexByID(a);if(t<0){V.warn("reverseFaces() id not loaded",a);return}const i=this.meshes[t].decimateHierarchicalMesh(this.gl,e);return this.updateGLVolume(),i}reverseFaces(a){const e=this.getMeshIndexByID(a);if(e<0){V.warn("reverseFaces() id not loaded",a);return}this.meshes[e].reverseFaces(this.gl),this.updateGLVolume()}async setMeshLayerProperty(a,e,t,i){const r=this.getMeshIndexByID(a);if(r<0){V.warn("setMeshLayerProperty() id not loaded",a);return}await this.meshes[r].setLayerProperty(e,t,i,this.gl),this.updateGLVolume()}setPan2Dxyzmm(a){this.scene.pan2Dxyzmm=a,this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=a[3]),this.drawScene()}setRenderAzimuthElevation(a,e){this.scene.renderAzimuth=a,this.scene.renderElevation=e,this.onAzimuthElevationChange(a,e),this.drawScene()}getOverlayIndexByID(a){const e=this.overlays.length;for(let t=0;t<e;t++)if(this.overlays[t].id===a)return t;return-1}setVolume(a,e=0){const t=this.volumes.length;if(e>t)return;const i=this.getVolumeIndexByID(a.id);e===0?(this.volumes.splice(i,1),this.volumes.unshift(a),this.back=this.volumes[0],this.overlays=this.volumes.slice(1)):e<0?(this.volumes.splice(this.getVolumeIndexByID(a.id),1),this.back=this.volumes[0],this.volumes.length>1?this.overlays=this.volumes.slice(1):this.overlays=[]):(this.volumes.splice(i,1),this.volumes.splice(e,0,a),this.overlays=this.volumes.slice(1),this.back=this.volumes[0]),this.updateGLVolume()}setMesh(a,e=0){this.meshes.forEach(r=>{V.debug("MESH: ",r.name)});const t=this.meshes.length;if(e>t)return;const i=this.getMeshIndexByID(a.id);e===0?(this.meshes.splice(i,1),this.meshes.unshift(a)):e<0?this.meshes.splice(this.getMeshIndexByID(a.id),1):(this.meshes.splice(i,1),this.meshes.splice(e,0,a)),this.updateGLVolume(),this.meshes.forEach(r=>{V.debug(r.name)})}removeVolume(a){if(this.setVolume(a,-1),this.mediaUrlMap.has(a)){const e=this.mediaUrlMap.get(a);this.onVolumeWithUrlRemoved(e),this.mediaUrlMap.delete(a)}this.drawScene()}removeVolumeByIndex(a){if(a>=this.volumes.length)throw new Error("Index of volume out of bounds");this.removeVolume(this.volumes[a])}removeMesh(a){if(a.unloadMesh(this.gl),this.setMesh(a,-1),this.mediaUrlMap.has(a)){const e=this.mediaUrlMap.get(a);this.onMeshWithUrlRemoved(e),this.mediaUrlMap.delete(a)}}removeMeshByUrl(a){const e=this.getMediaByUrl(a);e&&(this.removeMesh(e),this.mediaUrlMap.delete(e),this.onMeshWithUrlRemoved(a))}moveVolumeToBottom(a){this.setVolume(a,0)}moveVolumeUp(a){const e=this.getVolumeIndexByID(a.id);this.setVolume(a,e+1)}moveVolumeDown(a){const e=this.getVolumeIndexByID(a.id);this.setVolume(a,e-1)}moveVolumeToTop(a){this.setVolume(a,this.volumes.length-1)}mouseDown(a,e){a*=this.uiData.dpr,e*=this.uiData.dpr,this.mousePos=[a,e]}updateMousePos(a,e){return a*=this.uiData.dpr,e*=this.uiData.dpr,this.mousePos=[a,e],[a,e]}mouseMove(a,e){a*=this.uiData.dpr,e*=this.uiData.dpr;const t=(a-this.mousePos[0])/this.uiData.dpr,i=(e-this.mousePos[1])/this.uiData.dpr;this.mousePos=[a,e],!(this.inRenderTile(a,e)<0)&&(Math.abs(t)<1&&Math.abs(i)<1||(this.scene.renderAzimuth+=t,this.scene.renderElevation+=i,this.drawScene()))}sph2cartDeg(a,e){const t=-e*(Math.PI/180),i=(a-90)%360*(Math.PI/180),r=[Math.cos(t)*Math.cos(i),Math.cos(t)*Math.sin(i),Math.sin(t)],s=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);return s<=0||(r[0]/=s,r[1]/=s,r[2]/=s),r}setClipPlanes(a){this.scene.clipPlanes=[],this.scene.clipPlaneDepthAziElevs=[];for(let e=0;e<a.length;e++){const t=a[e],i=this.sph2cartDeg(t[1],t[2]),r=-t[0],s=[i[0],i[1],i[2],r];this.scene.clipPlanes.push(s),this.scene.clipPlaneDepthAziElevs.push(t)}this.drawScene()}setClipPlane(a){if(!a||a.length===0)return;const e=this.uiData.activeClipPlaneIndex??0;for(this.scene.clipPlanes||(this.scene.clipPlanes=[]),this.scene.clipPlaneDepthAziElevs||(this.scene.clipPlaneDepthAziElevs=[]);this.scene.clipPlanes.length<=e;)this.scene.clipPlanes.push([0,0,0,2]);for(;this.scene.clipPlaneDepthAziElevs.length<=e;)this.scene.clipPlaneDepthAziElevs.push([2,0,0]);const t=this.sph2cartDeg(a[1]+180,a[2]),i=[t[0],t[1],t[2],a[0]];this.scene.clipPlanes[e]=i,this.scene.clipPlaneDepthAziElevs[e]=a,this.onClipPlaneChange(i),this.drawScene()}setCrosshairColor(a){this.opts.crosshairColor=a,this.drawScene()}setCrosshairWidth(a){this.opts.crosshairWidth=a,this.crosshairs3D&&(this.crosshairs3D.mm[0]=NaN),this.drawScene()}setDrawColormap(a){this.drawLut=Ie.makeDrawLut(a),this.updateGLVolume()}setDrawingEnabled(a){this.opts.drawingEnabled=a,this.opts.drawingEnabled?this.drawBitmap||this.createEmptyDrawing():(this.clickToSegmentIsGrowing&&(this.clickToSegmentIsGrowing=!1,this.refreshDrawing(!0,!1)),this.drawPenLocation=[NaN,NaN,NaN],this.drawPenAxCorSag=-1,this.drawPenFillPts=[],this.drawShapeStartLocation=[NaN,NaN,NaN],this.drawShapePreviewBitmap&&(this.drawBitmap=this.drawShapePreviewBitmap,this.drawShapePreviewBitmap=null)),this.drawScene()}setPenValue(a,e=!1){this.opts.penValue=a,this.opts.isFilledPen=e,this.drawScene()}setDrawOpacity(a){this.drawOpacity=a,this.drawScene()}setSelectionBoxColor(a){this.opts.selectionBoxColor=a}setBounds(a){if(!Array.isArray(a)||a.length!==4)throw new Error("setBounds: expected [x1,y1,x2,y2] array");this.opts.bounds=[[a[0],a[1]],[a[2],a[3]]],this.gl&&this.drawScene()}sliceScroll2D(a,e,t,i=!0){if(this.opts.scrollRequiresFocus&&this.canvas!==document.activeElement){V.warn("Canvas element does not have focus. Scroll events will not be processed.");return}if(this.inGraphTile(e,t)){let r=this.volumes[0].frame4D;a>0&&r++,a<0&&r--,this.setFrame4D(this.volumes[0].id,r);return}if(a!==0&&this.opts.dragMode===3&&this.inRenderTile(this.uiData.dpr*e,this.uiData.dpr*t)===-1){let r=this.scene.pan2Dxyzmm[3]*(1+10*a);r=Math.round(r*10)/10;const s=this.scene.pan2Dxyzmm[3]-r;this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=r),this.scene.pan2Dxyzmm[3]=r;const n=this.frac2mm(this.scene.crosshairPos);this.scene.pan2Dxyzmm[0]+=s*n[0],this.scene.pan2Dxyzmm[1]+=s*n[1],this.scene.pan2Dxyzmm[2]+=s*n[2],this.drawScene(),this.canvas.focus(),this.sync();return}this.mouseClick(e,t,a,i)}setSliceType(a){return this.opts.sliceType=a,this.drawScene(),this}setOpacity(a,e){this.volumes[a].opacity=e,this.updateGLVolume()}setScale(a){this.scene.volScaleMultiplier=a,this.drawScene()}setClipPlaneColor(a){this.opts.clipPlaneColor=a,this.renderShader.use(this.gl),this.gl.uniform4fv(this.renderShader.uniforms.clipPlaneColor,this.opts.clipPlaneColor),this.drawScene()}setClipPlaneThick(a){V.warn("setClipPlaneThick() has been removed. use setClipPlanes() instead.")}setClipVolume(a,e){V.warn("setClipVolume() has been removed. use setClipPlanes() instead.")}async setVolumeRenderIllumination(a=0){this.renderGradientValues=Number.isNaN(a),this.renderShader=this.renderVolumeShader,this.renderGradientValues?this.renderShader=this.renderGradientValuesShader:(this.opts.gradientAmount=a,a>0||this.opts.gradientOpacity>0?this.renderShader=this.renderGradientShader:a<0&&(this.renderShader=this.renderSliceShader)),await this.refreshLayers(this.volumes[0],0),this.initRenderShader(this.renderShader,a),this.renderShader.use(this.gl),this.setClipPlaneColor(this.opts.clipPlaneColor),Number.isNaN(a)?this.gradientTextureAmount=1:this.gradientTextureAmount=a,!(this.volumes.length<1)&&this.drawScene()}async setGradientOpacity(a=0,e=0){this.opts.gradientOpacity=a,this.opts.renderSilhouette=e,this.renderGradientValues?this.renderShader=this.renderGradientValuesShader:this.gradientTextureAmount>0||a>0?this.renderShader=this.renderGradientShader:this.gradientTextureAmount<0&&(this.renderShader=this.renderSliceShader),this.initRenderShader(this.renderShader,this.gradientTextureAmount),this.renderShader.use(this.gl),this.gradientTextureAmount>0&&this.refreshLayers(this.volumes[0],0),this.drawScene()}overlayRGBA(a){const e=a.hdr,t=e.dims[1]*e.dims[2]*e.dims[3],i=new Uint8ClampedArray(t*4),r=.2*Math.min(Math.min(e.dims[1],e.dims[2]),e.dims[3]),s=.5*e.dims[1],n=.5*e.dims[2],o=.5*e.dims[3];let c=0;for(let l=0;l<e.dims[3];l++)for(let h=0;h<e.dims[2];h++)for(let d=0;d<e.dims[1];d++){const f=Math.abs(d-s),u=Math.abs(h-n),m=Math.abs(l-o),p=Math.sqrt(f*f+u*u+m*m);let g=0;p<r&&(g=255),i[c++]=0,i[c++]=g,i[c++]=0,i[c++]=g*.5}return i}vox2mm(a,e){return ce.vox2mm(a,e)}cloneVolume(a){return this.volumes[a].clone()}async loadDocumentFromUrl(a){const e=await jn.loadFromUrl(a);await this.loadDocument(e)}async loadDocument(a){this.volumes=[],this.meshes=[],this.document=a,this.document.labels=this.document.labels?this.document.labels:[];const e={...Rt,...a.opts};this.scene.pan2Dxyzmm=a.scene.pan2Dxyzmm?a.scene.pan2Dxyzmm:[0,0,0,1],this.document.opts=e,this.scene.clipPlaneDepthAziElevs&&this.setClipPlane(this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex??0]),V.debug("load document",a),this.mediaUrlMap.clear(),this.createEmptyDrawing();const t=a.encodedImageBlobs;for(let r=0;r<a.imageOptionsArray.length;r++){const s=a.imageOptionsArray[r],n=t[r];if(n){"colorMap"in s&&(s.colormap=s.colorMap);const o=await st.loadFromBase64({base64:n,...s});if(o){if(o.colormapLabel){const c=Object.keys(o.colormapLabel.lut).length,l=new Uint8ClampedArray(c);for(const h in o.colormapLabel.lut)l[h]=o.colormapLabel.lut[h];o.colormapLabel.lut=l}this.addVolume(o)}}}this.volumes.length>0&&(this.back=this.volumes[0]);for(const r of a.meshDataObjects??[]){const s={gl:this.gl,...r};r.offsetPt0&&(s.rgba255[3]=0,s.tris=new Uint32Array(r.offsetPt0)),V.debug(s);const n=new Xa(s.pts,s.tris,s.name,s.rgba255,s.opacity,s.visible,this.gl,s.connectome,s.dpg,s.dps,s.dpv);r.offsetPt0&&(n.fiberGroupColormap=r.fiberGroupColormap,n.fiberColor=r.fiberColor,n.fiberDither=r.fiberDither,n.fiberRadius=r.fiberRadius,n.colormap=r.colormap),n.meshShaderIndex=s.meshShaderIndex,n.layers=s.layers,n.updateMesh(this.gl),V.debug(n),this.addMesh(n)}if(a.data.connectomes)for(const r of a.data.connectomes){const s=JSON.parse(r),n=this.loadConnectomeAsMesh(s);n.updateMesh(this.gl),this.addMesh(n)}this.createEmptyDrawing();const i=a.encodedDrawingBlob;if(i){const r=await ce.b64toUint8(i);if(r){const s=this.back.dims;let n=s[1]*s[2]*s[3];if(r.length-352===n&&(n+=352),r.length!==n)throw new Error(`drawBitmap size does not match the texture dimensions (${s[1]}${s[2]}${s[3]}) ${n} != ${s[1]*s[2]*s[3]}.`);this.drawBitmap=r,this.refreshDrawing()}}return await this.setGradientOpacity(this.opts.gradientOpacity),await this.setVolumeRenderIllumination(this.opts.gradientAmount),this.updateGLVolume(),this.drawScene(),this.onDocumentLoaded(a),this}async generateLoadDocumentJavaScript(a,e){const t=this.json(),i=await ce.compressToBase64String(JSON.stringify(t));return`
        ${e}

        async function saveNiivueAsHtml(pageName) {
          //get new docstring
          const docString = nv1.json();
          const html =
          document.getElementsByTagName("html")[0]
              .innerHTML.replace(base64, await NVUtilities.compressToBase64String(JSON.stringify(docString)));
          NVUtilities.download(html, pageName, "application/html");
        }

        var nv1 = new Niivue();
        await nv1.attachTo("${a}");
        var base64 = "${i}";
        NVUtilities.decompressBase64String(base64).then((jsonText) => {
          var json = JSON.parse(jsonText); // string -> JSON
          var doc = NVDocument.loadFromJSON(json);
          nv1.loadDocument(doc);
          nv1.updateGLVolume();
        });

      `}async generateHTML(a="gl1",e){return`<!DOCTYPE html>
        <html lang="en">
          <head>
            <meta charset="utf-8" />
            <meta http-equiv="X-UA-Compatible" content="IE=edge" />
            <meta name="viewport" content="width=device-width,initial-scale=1.0" />
            <title>Save as HTML</title>
            <style>
            html {
              height: auto;
              min-height: 100%;
              margin: 0;
            }
            body {
              display: flex;
              flex-direction: column;
              margin: 0;
              min-height: 100%;
              width: 100%;
              position: absolute;
              font-family: system-ui, Arial, Helvetica, sans-serif;
              background: #ffffff;
              color: black;
              user-select: none; /* Standard syntax */
            }
            header {
              margin: 10px;
            }
            main {
              flex: 1;
              background: #000000;
              position: relative;
            }
            footer {
              margin: 10px;
            }
            canvas {
              position: absolute;
              cursor: crosshair;
            }
            canvas:focus {
              outline: 0px;
            }
            div {
              display: table-row;
              background-color: blue;
            }
            </style>
          </head>
          <body>
            <noscript>niivue requires JavaScript.</noscript>
            <header>
            Save the current scene as HTML
            <button id="save">Save as HTML</button>
            </header>
            <main>
              <canvas id="gl1"></canvas>
            </main>
            <script type="module" async>
              ${await this.generateLoadDocumentJavaScript(a,e)}
              function saveAsHtml() {
                saveNiivueAsHtml("page.html");
              }
              // assign our event handler
              var button = document.getElementById("save");
              button.onclick = saveAsHtml;
            <\/script>
          </body>
        </html>`}async saveHTML(a="untitled.html",e="gl1",t){const i=await this.generateHTML(e,t);return ce.download(i,a,"application/html")}json(){return this.document.opts=this.opts,this.document.scene=this.scene,this.document.volumes=this.volumes,this.document.meshes=this.meshes,this.drawScene(),this.document.previewImageDataURL=this.canvas.toDataURL(),this.document.json()}async saveDocument(a="untitled.nvd",e=!0,t={}){const{embedImages:i=!0,embedPreview:r=!0}=t;this.document.title=a,this.document.volumes=this.volumes,this.document.meshes=this.meshes,r?(this.drawScene(),this.document.previewImageDataURL=this.canvas.toDataURL()):this.document.previewImageDataURL="",await this.document.download(a,e,{embedImages:i})}async loadImages(a){const e=[],t=[];for(const i of a)if("url"in i){const r=this.getFileExt(i.name?i.name:i.url);if(this.loaders[r]){const s=this.loaders[r].toExt.toUpperCase();Ia.includes(s)?t.push(i):e.push(i);continue}Ia.includes(r.toUpperCase())?t.push(i):e.push(i)}return e.length>0&&await this.loadVolumes(e),t.length>0&&await this.loadMeshes(t),this}async loadDicoms(a){if(!this.getDicomLoader())throw new Error("No dicom loader set. Please set a dicom loader before loading dicoms");this.drawScene(),this.volumes=[];const e=a.map(async i=>{let r=null;if(i.isManifest)r=await st.fetchDicomData(i.url);else{const h=await fetch(i.url);if(!h.ok)throw new Error(`Failed to load file: ${h.statusText}`);const d=await h.arrayBuffer();r=[{name:i.url.split("/").pop(),data:d}]}const s=this.getDicomLoader().loader,n=await s(r),o=n[0].name,c=n[0].data;return await st.loadFromUrl({url:c,name:o})}),t=await Promise.all(e);return t.length===1?this.addVolume(t[0]):this.onDicomLoaderFinishedWithImages(t),this}async loadVolumes(a){return this.drawScene(),this.thumbnailVisible?(this.deferredVolumes=a,this):(this.volumes=[],this.closePAQD(),await this.addVolumesFromUrl(a),this)}async addMeshFromUrl(a){const e=this.getFileExt(a.url);if(e==="JCON"||e==="JSON"){const r=await(await fetch(a.url,{})).json(),s=this.loadConnectomeAsMesh(r);return this.mediaUrlMap.set(s,a.url),this.onMeshAddedFromUrl(a,s),this.addMesh(s),s}const t=await Xa.loadFromUrl({...a,gl:this.gl});return this.mediaUrlMap.set(t,a.url),this.onMeshAddedFromUrl(a,t),this.addMesh(t),t}async addMeshesFromUrl(a){const e=a.map(async i=>{const r=this.getFileExt(i.name||i.url);if(this.loaders[r]){let n=i.url;const o=this.loaders[r].toExt;let c=i.name||i.url;if(c=c.split("/").pop(),typeof i.url=="string"){const u=i.url;try{const m=await fetch(u);if(!m.ok)throw new Error(`Failed to load file: ${m.statusText}`);n=await m.arrayBuffer()}catch(m){throw new Error(`Failed to load url ${u}: ${m}`)}}const{positions:l,indices:h,colors:d=null}=await this.loaders[r].loader(n);i.name=`${c}.${o}`;const f=await _a.createMZ3Async(l,h,!1,d);i.buffer=f}if(r==="JCON"||r==="JSON"){const o=await(await fetch(i.url,{})).json(),c=this.loadConnectomeAsMesh(o);return this.mediaUrlMap.set(c,i.url),this.onMeshAddedFromUrl(i,c),c}const s=await Xa.loadFromUrl({...i,gl:this.gl});return this.mediaUrlMap.set(s,i.url),this.onMeshAddedFromUrl(i,s),s}),t=await Promise.all(e);for(let i=0;i<t.length;i++)this.addMesh(t[i]);return t}async loadMeshes(a){return this.drawScene(),this.thumbnailVisible?(this.deferredMeshes=a,this):(this.initialized,this.meshes=[],await this.addMeshesFromUrl(a),this.updateGLVolume(),this.drawScene(),this)}async loadConnectomeFromUrl(a,e={}){const i=await(await fetch(a,{headers:e})).json();return this.loadConnectome(i)}async loadFreeSurferConnectomeFromUrl(a,e={}){const i=await(await fetch(a,{headers:e})).json();return this.loadFreeSurferConnectome(i)}async loadFreeSurferConnectome(a){const e=zs.convertFreeSurferConnectome(a);return this.loadConnectome(e)}handleNodeAdded(a){const e=a.detail.node,t=[1,1,1,1];this.addLabel(e.name,{textColor:t,bulletScale:1,bulletColor:t,lineWidth:0,lineColor:t,lineTerminator:"none",textScale:1},[e.x,e.y,e.z]),this.drawScene()}loadConnectomeAsMesh(a){let e=a;if("data_type"in a&&a.data_type==="fs_pointset")e=zs.convertFreeSurferConnectome(a),V.warn("converted FreeSurfer connectome",e);else if("nodes"in a){const t=a.nodes;"names"in t&&"X"in t&&"Y"in t&&"Z"in t&&"Color"in t&&"Size"in t&&(e=zs.convertLegacyConnectome(a))}else throw new Error("not a known connectome format");return new zs(this.gl,e)}loadConnectome(a){this.drawScene(),this.meshes=[];const e=this.loadConnectomeAsMesh(a);return this.addMesh(e),this.drawScene(),this}createEmptyDrawing(){if(this.back===null||!this.back.dims||Math.min(Math.min(this.back.dims[1],this.back.dims[2]),this.back.dims[3])<1)return;const e=this.back.dims[1]*this.back.dims[2]*this.back.dims[3];this.drawBitmap=new Uint8Array(e),this.clickToSegmentGrowingBitmap=new Uint8Array(e),this.drawClearAllUndoBitmaps(),this.drawAddUndoBitmap(),this.opts.is2DSliceShader?this.drawTexture=this.r8Tex2D(this.drawTexture,ha,this.back.dims):this.drawTexture=this.r8Tex(this.drawTexture,ha,this.back.dims,!0),this.refreshDrawing(!1)}r16Tex(a,e,t,i){a&&this.gl.deleteTexture(a),a=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_3D,a),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R16I,t[1],t[2],t[3]);const r=t[1]*t[2]*t[3];return i.length!==r&&(i=new Int16Array(r)),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,t[1],t[2],t[3],this.gl.RED_INTEGER,this.gl.SHORT,i),a}drawGrowCut(){if(!this.back||!this.back.dims)throw new Error("back not defined");const a=this.back.hdr,e=this.gl,t=a.dims[1]*a.dims[2]*a.dims[3];if(!this.drawBitmap||this.drawBitmap.length!==t){V.debug("bitmap dims are wrong");return}const i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.disable(e.CULL_FACE),e.viewport(0,0,this.back.dims[1],this.back.dims[2]),e.disable(e.BLEND);let r=j0(this.back);const s=this.r16Tex(null,L0,this.back.dims,r);for(let x=1;x<t;x++)r[x]=this.drawBitmap[x];const n=this.r16Tex(null,K0,this.back.dims,r),o=this.r16Tex(null,H0,this.back.dims,r),c=1e4;for(let x=1;x<t;x++)r[x]>0&&(r[x]=c);const l=this.r16Tex(null,G0,this.back.dims,r),h=this.r16Tex(null,z0,this.back.dims,r);e.bindVertexArray(this.genericVAO);const d=this.growCutShader;d.use(e);const f=128;e.uniform1i(d.uniforms.finalPass,0),e.uniform1i(d.uniforms.backTex,11);for(let x=0;x<f;x++){e.uniform1i(d.uniforms.labelTex,14),e.uniform1i(d.uniforms.strengthTex,12);for(let E=0;E<this.back.dims[3];E++){const I=1/this.back.dims[3]*(E+.5);e.uniform1f(d.uniforms.coordZ,I),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,o,0,E),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT1,h,0,E),e.drawBuffers([e.COLOR_ATTACHMENT0,e.COLOR_ATTACHMENT1]),e.checkFramebufferStatus(e.FRAMEBUFFER)!==e.FRAMEBUFFER_COMPLETE&&V.error("Incomplete framebuffer"),e.drawArrays(e.TRIANGLE_STRIP,0,4)}x===f-1&&e.uniform1i(d.uniforms.finalPass,1),e.uniform1i(d.uniforms.labelTex,15),e.uniform1i(d.uniforms.strengthTex,13);for(let E=0;E<this.back.dims[3];E++){const I=1/this.back.dims[3]*(E+.5);e.uniform1f(d.uniforms.coordZ,I),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,n,0,E),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT1,l,0,E),e.drawBuffers([e.COLOR_ATTACHMENT0,e.COLOR_ATTACHMENT1]),e.checkFramebufferStatus(e.FRAMEBUFFER)!==e.FRAMEBUFFER_COMPLETE&&V.error("Incomplete framebuffer"),e.drawArrays(e.TRIANGLE_STRIP,0,4)}}e.drawBuffers([e.COLOR_ATTACHMENT0]);const u=e.COLOR_ATTACHMENT1,m=n;e.readBuffer(u);const p=e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT),g=e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE);(p!==e.RED_INTEGER||g!==e.SHORT)&&V.debug("readPixels will fail."),r=new Int16Array;const b=this.back.dims[1]*this.back.dims[2],A=new Int16Array(b);for(let x=0;x<this.back.dims[3];x++)e.framebufferTextureLayer(e.FRAMEBUFFER,u,m,0,x),e.readPixels(0,0,this.back.dims[1],this.back.dims[2],p,g,A),r=Int16Array.from([...r,...A]);let y=r[0];for(let x=0;x<r.length;x++)y=Math.max(y,r[x]);for(let x=1;x<t;x++)this.drawBitmap[x]=r[x];e.deleteTexture(s),e.deleteTexture(l),e.deleteTexture(h),e.deleteTexture(n),e.deleteTexture(o),e.bindVertexArray(this.unusedVAO),e.viewport(0,0,e.canvas.width,e.canvas.height),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(i),this.drawAddUndoBitmap(),this.refreshDrawing(!0)}drawPt(a,e,t,i,r=null){var d;if(r===null&&(r=this.drawBitmap),!((d=this.back)!=null&&d.dims))throw new Error("back.dims not set");const s=this.back.dims[1],n=this.back.dims[2],o=this.back.dims[3];a=Math.min(Math.max(a,0),s-1),e=Math.min(Math.max(e,0),n-1),t=Math.min(Math.max(t,0),o-1),r[a+e*s+t*s*n]=i;const c=this.drawPenAxCorSag===0,l=this.drawPenAxCorSag===1,h=this.drawPenAxCorSag===2;if(this.opts.penSize>1){const f=Math.floor(this.opts.penSize/2);for(let u=-f;u<=f;u++)for(let m=-f;m<=f;m++)c?r[a+u+(e+m)*s+t*s*n]=i:l?r[a+u+e*s+(t+m)*s*n]=i:h&&(r[a+(e+m)*s+(t+u)*s*n]=i)}}drawPenLine(a,e,t){const i=Math.abs(a[0]-e[0]),r=Math.abs(a[1]-e[1]),s=Math.abs(a[2]-e[2]);let n=-1,o=-1,c=-1;e[0]>a[0]&&(n=1),e[1]>a[1]&&(o=1),e[2]>a[2]&&(c=1);let l=a[0],h=a[1],d=a[2];const f=e[0],u=e[1],m=e[2];if(i>=r&&i>=s){let p=2*r-i,g=2*s-i;for(;l!==f;)l+=n,p>=0&&(h+=o,p-=2*i),g>=0&&(d+=c,g-=2*i),p+=2*r,g+=2*s,this.drawPt(l,h,d,t)}else if(r>=i&&r>=s){let p=2*i-r,g=2*s-r;for(;h!==u;)h+=o,p>=0&&(l+=n,p-=2*r),g>=0&&(d+=c,g-=2*r),p+=2*i,g+=2*s,this.drawPt(l,h,d,t)}else{let p=2*r-s,g=2*i-s;for(;d!==m;)d+=c,p>=0&&(h+=o,p-=2*s),g>=0&&(l+=n,g-=2*s),p+=2*r,g+=2*i,this.drawPt(l,h,d,t)}}drawRectangleMask(a,e,t){var f;if(!((f=this.back)!=null&&f.dims))throw new Error("back.dims not set");const i=this.back.dims[1],r=this.back.dims[2],s=this.back.dims[3],n=Math.min(Math.max(Math.min(a[0],e[0]),0),i-1),o=Math.min(Math.max(Math.min(a[1],e[1]),0),r-1),c=Math.min(Math.max(Math.min(a[2],e[2]),0),s-1),l=Math.min(Math.max(Math.max(a[0],e[0]),0),i-1),h=Math.min(Math.max(Math.max(a[1],e[1]),0),r-1),d=Math.min(Math.max(Math.max(a[2],e[2]),0),s-1);for(let u=c;u<=d;u++)for(let m=o;m<=h;m++)for(let p=n;p<=l;p++)this.drawPt(p,m,u,t)}drawEllipseMask(a,e,t){var A;if(!((A=this.back)!=null&&A.dims))throw new Error("back.dims not set");const i=this.back.dims[1],r=this.back.dims[2],s=this.back.dims[3],n=Math.min(Math.max(Math.min(a[0],e[0]),0),i-1),o=Math.min(Math.max(Math.min(a[1],e[1]),0),r-1),c=Math.min(Math.max(Math.min(a[2],e[2]),0),s-1),l=Math.min(Math.max(Math.max(a[0],e[0]),0),i-1),h=Math.min(Math.max(Math.max(a[1],e[1]),0),r-1),d=Math.min(Math.max(Math.max(a[2],e[2]),0),s-1),f=(n+l)/2,u=(o+h)/2,m=(c+d)/2,p=Math.abs(l-n)/2,g=Math.abs(h-o)/2,b=Math.abs(d-c)/2;for(let y=c;y<=d;y++)for(let x=o;x<=h;x++)for(let E=n;E<=l;E++){const I=(E-f)/(p+.5),w=(x-u)/(g+.5),v=(y-m)/(b+.5);I*I+w*w+v*v<=1&&this.drawPt(E,x,y,t)}}drawingBinaryDilationWithSeed(a,e=6){try{let t=function(g){return g[0]+g[1]*o+g[2]*c};const i=this.drawBitmap,r=this.back.dims[1],s=this.back.dims[2],n=this.back.dims[3],o=r,c=r*s,l=c*n,h=t(a);if(h<0||h>=l)throw new Error("Seed index is out of bounds.");const d=i[h];if(d===0)throw new Error("Seed voxel is not part of a filled cluster.");const f=i.slice();for(let g=0;g<l;g++)f[g]=f[g]===d?1:0;this.drawFloodFillCore(f,h,e);const u=i.slice(),m=[],p=[-c,c,-r,r,-1,1];m.push(...p),e>6&&m.push(-r-1,-r+1,r-1,r+1,-c-r,-c+r,-c-1,-c+1,c-r,c+r,c-1,c+1),e>18&&m.push(-c-r-1,-c-r+1,-c+r-1,-c+r+1,c-r-1,c-r+1,c+r-1,c+r+1);for(let g=0;g<l;g++)if(f[g]===2){const b=g%r,A=Math.floor(g%c/r),y=Math.floor(g/c);for(const x of m){const E=g+x;if(E<0||E>=l)continue;const I=E%r,w=Math.floor(E%c/r),v=Math.floor(E/c);Math.abs(I-b)>1||Math.abs(w-A)>1||Math.abs(v-y)>1||i[E]===0&&(u[E]=d)}}this.drawBitmap=u,this.drawAddUndoBitmap(),this.refreshDrawing(!0)}catch(t){V.error("Error in drawingBinaryDilationWithSeed:",t)}}drawFloodFillCore(a,e,t=6){var l;if(!((l=this.back)!=null&&l.dims))throw new Error("back.dims undefined");const i=[this.back.dims[1],this.back.dims[2],this.back.dims[3]],r=i[0],s=r*i[1];function n(h){return h[0]+h[1]*r+h[2]*s}function o(h){const d=Math.floor(h/s),f=Math.floor((h-d*s)/r);return[Math.floor(h%r),f,d]}const c=[];for(c.push(e),a[e]=2;c.length>0;){let h=function(u){const m=f.slice();if(m[0]+=u[0],m[1]+=u[1],m[2]+=u[2],m[0]<0||m[1]<0||m[2]<0||m[0]>=i[0]||m[1]>=i[1]||m[2]>=i[2])return;const p=n(m);a[p]===1&&(a[p]=2,c.push(p))};const d=c[0];c.shift();const f=o(d);h([0,0,-1]),h([0,0,1]),h([0,-1,0]),h([0,1,0]),h([-1,0,0]),h([1,0,0]),!(t<=6)&&(h([-1,-1,0]),h([1,1,0]),h([-1,1,0]),h([1,1,0]),h([0,-1,-1]),h([0,1,-1]),h([-1,0,-1]),h([1,0,-1]),h([0,-1,1]),h([0,1,1]),h([-1,0,1]),h([1,0,1]),!(t<=18)&&(h([-1,-1,-1]),h([1,-1,-1]),h([-1,1,-1]),h([1,1,-1]),h([-1,-1,1]),h([1,-1,1]),h([-1,1,1]),h([1,1,1])))}}drawFloodFill(a,e=0,t=0,i=NaN,r=NaN,s=6,n=Number.POSITIVE_INFINITY,o=!1,c=null,l=!1){var C;if(!this.drawBitmap&&(V.warn("drawFloodFill called without an initialized drawBitmap."),this.createEmptyDrawing(),!this.drawBitmap)){V.error("Failed to create drawing bitmap.");return}if(this.clickToSegmentIsGrowing&&!this.clickToSegmentGrowingBitmap){if(V.warn("drawFloodFill called in preview mode without initialized clickToSegmentGrowingBitmap."),this.drawBitmap)this.clickToSegmentGrowingBitmap=this.drawBitmap.slice();else{V.error("Cannot initialize growing bitmap as drawBitmap is null.");return}if(!this.clickToSegmentGrowingBitmap){V.error("Failed to create growing bitmap.");return}}if(c===null&&(c=this.drawBitmap),!c){V.error("drawFloodFill targetBitmap is null.");return}if(!((C=this.back)!=null&&C.dims))throw new Error("back.dims undefined");e=Math.abs(e);const h=[this.back.dims[1],this.back.dims[2],this.back.dims[3]];if(a[0]<0||a[1]<0||a[2]<0||a[0]>=h[0]||a[1]>=h[1]||a[2]>=h[2])return;const d=h[0],f=d*h[1],u=f*h[2],m=this.clickToSegmentIsGrowing?this.drawBitmap:c;if(!m){V.error("Could not determine original bitmap state.");return}const p=new Uint8Array(u).fill(0);let g=-1;o&&this.drawPenAxCorSag===0?g=2:o&&this.drawPenAxCorSag===1?g=1:o&&this.drawPenAxCorSag===2&&(g=0);function b(D){const S=Math.floor(D/f),k=Math.floor((D-S*f)/d);return[Math.floor(D%d),k,S]}function A(D){return D[0]+D[1]*d+D[2]*f}const y=D=>this.vox2mm(D,this.back.matRAS),x=y(a),E=n**2;function I(D){const S=b(D);if(g>=0&&S[g]!==a[g])return!1;const k=y(S);return(k[0]-x[0])**2+(k[1]-x[1])**2+(k[2]-x[2])**2<=E}const w=A(a),v=m[w];if(l&&v===0){V.debug("Grow/Erase Cluster tool requires starting on a masked voxel."),this.clickToSegmentIsGrowing&&this.clickToSegmentGrowingBitmap&&this.drawBitmap&&(this.clickToSegmentGrowingBitmap.set(this.drawBitmap),this.refreshDrawing(!0,!0));return}if(t===0&&v===e&&!l&&e!==0&&(V.debug("drawFloodFill selected voxel is already desired color"),!this.clickToSegmentIsGrowing))return;let M=NaN;if(l&&(t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)){const D=m.slice();for(let L=0;L<u;L++)D[L]=D[L]===v&&I(L)?1:0;if(D[w]!==1){V.error("Seed voxel could not be marked for cluster ID.");return}this.drawFloodFillCore(D,w,s);const S=this.volumes[0].img2RAS();let k=0,F=0;for(let L=0;L<u;L++)D[L]===2&&(k+=S[L],F++);M=F>0?k/F:S[w],V.debug(`Grow Cluster using mean intensity: ${M.toFixed(2)} from ${F} voxels.`);let B=-1/0,O=1/0;t===Number.POSITIVE_INFINITY&&(B=M),t===Number.NEGATIVE_INFINITY&&(O=M);for(let L=0;L<u;L++)if(D[L]===2)p[L]=1;else if(m[L]===0){const _=S[L];_>=B&&_<=O&&I(L)&&(p[L]=1)}e=v}else if(t===0)if(l&&e===0){V.debug(`Erase Cluster: Identifying cluster with color ${v}`);for(let D=0;D<u;D++)p[D]=m[D]===v&&I(D)?1:0}else for(let D=0;D<u;D++)m[D]===v&&I(D)&&v!==0&&(p[D]=1);else{const D=this.volumes[0].img2RAS();M=D[w];let S=-1/0,k=1/0;isFinite(i)&&isFinite(r)?(S=i,k=r):t===Number.POSITIVE_INFINITY?S=M:t===Number.NEGATIVE_INFINITY&&(k=M);for(let F=0;F<u;F++){const B=D[F];B>=S&&B<=k&&I(F)&&(p[F]=1)}e=m[w],e===0&&(e=this.opts.penValue,(e<1||!isFinite(e))&&(e=1))}if(p[w]!==1){let D=!1;if(l&&t!==0?v!==0&&(D=!0):(v!==0||e===0)&&(D=!0),D&&I(w))p[w]=1,V.debug("Forcing seed voxel to 1 in working buffer.");else{V.debug("Seed voxel not marked as candidate '1' and not valid originally."),this.clickToSegmentIsGrowing&&this.clickToSegmentGrowingBitmap&&this.drawBitmap&&this.clickToSegmentGrowingBitmap.set(this.drawBitmap);return}}this.drawFloodFillCore(p,w,s);for(let D=0;D<u;D++)p[D]===2?c[D]=e:this.clickToSegmentIsGrowing&&c===this.clickToSegmentGrowingBitmap&&(c[D]=m[D]);this.clickToSegmentIsGrowing?this.refreshDrawing(!0,!0):(this.drawAddUndoBitmap(),this.refreshDrawing(!0,!1))}floodFillSectionFIFO(a,e,t,i){const r=e[0],[s,n]=t,[o,c]=i,l=4*(o-s+c-n+2),h=new Int32Array(l*2);let d=0,f=0;function u(g,b){if(g<s||g>o||b<n||b>c)return;const A=g+b*r;a[A]===0&&(a[A]=2,h[f]=g,h[f+1]=b,f=(f+2)%h.length)}function m(){if(d===f)return null;const g=h[d],b=h[d+1];return d=(d+2)%h.length,[g,b]}for(let g=s;g<=o;g++)u(g,n),u(g,c);for(let g=n+1;g<=c-1;g++)u(s,g),u(o,g);let p;for(;(p=m())!==null;){const[g,b]=p;u(g-1,b),u(g+1,b),u(g,b-1),u(g,b+1)}}drawPenFilled(){var g;const a=this.drawPenFillPts.length;if(a<2){this.drawPenFillPts=[];return}const e=this.drawPenAxCorSag;let t=0,i=1;if(e===1&&(i=2),e===2&&(t=1,i=2),!((g=this.back)!=null&&g.dims))throw new Error("back.dims undefined");const r=[this.back.dims[t+1],this.back.dims[i+1]],s=new Uint8Array(r[0]*r[1]);let n=1;function o(b,A){const y=Math.abs(b[0]-A[0]),x=Math.abs(b[1]-A[1]);s[b[0]+b[1]*r[0]]=n,s[A[0]+A[1]*r[0]]=n;let E=-1,I=-1;A[0]>b[0]&&(E=1),A[1]>b[1]&&(I=1);let w=b[0],v=b[1];const M=A[0],C=A[1];if(y>=x){let D=2*x-y;for(;w!==M;)w+=E,D>=0&&(v+=I,D-=2*y),D+=2*x,s[w+v*r[0]]=n}else{let D=2*y-x;for(;v!==C;)v+=I,D>=0&&(w+=E,D-=2*x),D+=2*y,s[w+v*r[0]]=n}}function c(b){const A=Math.min(Math.max(b[0],0),r[0]-1),y=Math.min(Math.max(b[1],0),r[1]-1);return[A,y]}const l=c([this.drawPenFillPts[0][t],this.drawPenFillPts[0][i]]);let h=[...l],d=[...l],f=l;for(let b=1;b<a;b++){let A=[this.drawPenFillPts[b][t],this.drawPenFillPts[b][i]];A=c(A),h=[Math.min(A[0],h[0]),Math.min(A[1],h[1])],d=[Math.max(A[0],d[0]),Math.max(A[1],d[1])],o(f,A),f=A}o(l,f);const u=1;h[0]=Math.max(0,h[0]-u),h[1]=Math.max(0,h[1]-u),d[0]=Math.min(r[0]-1,d[0]+u),d[1]=Math.min(r[1]-1,d[1]+u);for(let b=0;b<r[1];b++)for(let A=0;A<r[0];A++){if(A>=h[0]&&A<d[0]&&b>=h[1]&&b<=d[1])continue;const y=A+b*r[0];s[y]===0&&(s[y]=2)}const m=Date.now();this.floodFillSectionFIFO(s,r,h,d),V.debug(`FloodFill ${Date.now()-m}`),n=this.opts.penValue;const p=this.drawPenFillPts[0][3-(t+i)];if(!this.drawBitmap)throw new Error("drawBitmap undefined");if(e===0){const b=p*r[0]*r[1];for(let A=0;A<r[0]*r[1];A++)s[A]!==2&&(this.drawBitmap[A+b]=n)}else{let b=1;const A=this.back.dims[1]*this.back.dims[2];let y=p*this.back.dims[1];e===2&&(b=this.back.dims[1],y=p);let x=0;for(let E=0;E<r[1];E++)for(let I=0;I<r[0];I++)s[x]!==2&&(this.drawBitmap[I*b+E*A+y]=n),x++}if(!this.drawFillOverwrites&&this.drawUndoBitmaps[this.currentDrawUndoBitmap].length>0){const b=this.drawBitmap.length,A=lo(this.drawUndoBitmaps[this.currentDrawUndoBitmap],b);for(let y=0;y<b;y++)A[y]!==0&&(this.drawBitmap[y]=A[y])}this.drawPenFillPts=[],this.drawAddUndoBitmap(),this.refreshDrawing(!1)}closeDrawing(){this.drawClearAllUndoBitmaps(),this.drawTexture=this.rgbaTex(this.drawTexture,ha,[2,2,2,2],!0),this.drawBitmap=null,this.clickToSegmentGrowingBitmap=null,this.drawScene()}refreshDrawing(a=!0,e=!1){var n;e&&(!this.opts.drawingEnabled||!this.opts.clickToSegment)&&(V.debug("refreshDrawing: Conditions not met for clickToSegment bitmap, using drawBitmap."),e=!1);const t=e?this.clickToSegmentGrowingBitmap:this.drawBitmap;!t&&!e&&this.clickToSegmentGrowingBitmap?V.warn("refreshDrawing: drawBitmap is null, but clickToSegmentGrowingBitmap exists. Check state."):!t&&e&&this.drawBitmap?(V.warn("refreshDrawing: clickToSegmentGrowingBitmap is null, falling back to drawBitmap."),e=!1):t||V.warn("refreshDrawing: Both bitmaps are null. Uploading empty data.");const i=e?this.clickToSegmentGrowingBitmap:this.drawBitmap;if(!((n=this.back)!=null&&n.dims)){V.warn("refreshDrawing: back.dims undefined, cannot refresh drawing texture yet.");return}const r=this.back.dims.slice(),s=this.back.dims[1]*this.back.dims[2]*this.back.dims[3];if(!i){V.warn(`refreshDrawing: Bitmap data source (${e?"growing":"main"}) is null. Cannot update texture.`),a&&this.drawScene();return}if(i.length===8?(r[1]=2,r[2]=2,r[3]=2):s!==i.length&&V.warn(`Drawing bitmap length (${i.length}) must match the background image (${s})`),this.gl.activeTexture(ha),this.opts.is2DSliceShader){const o=this.frac2vox(this.scene.crosshairPos),c=Math.min(Math.max(o[2],0),r[3]-1),l=r[1]*r[2],h=c*l;V.debug(`refresh huge 2D drawing xyz ${r[1]}${r[2]}${r[3]} slice ${h}`);const d=i.subarray(h,h+l);this.gl.bindTexture(this.gl.TEXTURE_2D,this.drawTexture),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,r[1],r[2],this.gl.RED,this.gl.UNSIGNED_BYTE,d)}else this.gl.bindTexture(this.gl.TEXTURE_3D,this.drawTexture),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,r[1],r[2],r[3],this.gl.RED,this.gl.UNSIGNED_BYTE,i);if(!this.drawTexture){V.error("refreshDrawing: drawTexture (GPU texture) is null.");return}a&&this.drawScene()}closePAQD(){!this._gl||!this.paqdTexture||(this.paqdTexture=this.rgbaTex(this.paqdTexture,Ha,[2,2,2,2],!0))}r8Tex2D(a,e,t,i=!1){if(a&&this.gl.deleteTexture(a),a=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_2D,a),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage2D(this.gl.TEXTURE_2D,1,this.gl.R8,t[1],t[2]),i){const r=new Uint8Array(t[1]*t[2]);this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,t[1],t[2],this.gl.RED,this.gl.UNSIGNED_BYTE,r)}return a}r8Tex(a,e,t,i=!1){if(a&&this.gl.deleteTexture(a),a=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_3D,a),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R8,t[1],t[2],t[3]),i){const r=new Uint8Array(t[1]*t[2]*t[3]);this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,t[1],t[2],t[3],this.gl.RED,this.gl.UNSIGNED_BYTE,r)}return a}rgbaTex2D(a,e,t,i=null,r=!0){if(a&&this.gl.deleteTexture(a),a=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_2D,a),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage2D(this.gl.TEXTURE_2D,1,this.gl.RGBA8,t[1],t[2]),i){let s=i;const n=t[1],o=t[2];if(r){s=new Uint8Array(i.length);const c=n*4;for(let l=0;l<o;l++){const h=l*c,d=(o-1-l)*c;s.set(i.subarray(h,h+c),d)}}this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,n,o,this.gl.RGBA,this.gl.UNSIGNED_BYTE,s)}return a}rgbaTex(a,e,t,i=!1){if(a&&this.gl.deleteTexture(a),a=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_3D,a),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGBA8,t[1],t[2],t[3]),i){const r=new Uint8Array(t[1]*t[2]*t[3]*4);this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,t[1],t[2],t[3],this.gl.RGBA,this.gl.UNSIGNED_BYTE,r)}return a}rgba16Tex(a,e,t,i=!1){if(a&&this.gl.deleteTexture(a),a=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_3D,a),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,2),this.gl.pixelStorei(this.gl.PACK_ALIGNMENT,2),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGBA16UI,t[1],t[2],t[3]),i){const r=new Uint16Array(t[1]*t[2]*t[3]*4);this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,t[1],t[2],t[3],this.gl.RGBA_INTEGER,this.gl.UNSIGNED_SHORT,r)}return a}requestCORSIfNotSameOrigin(a,e){new URL(e,window.location.href).origin!==window.location.origin&&(a.crossOrigin="")}async loadPngAsTexture(a,e){return new Promise((t,i)=>{const r=new Image;r.onload=()=>{if(!this.bmpShader)return;let s;e===4?(this.bmpTexture!==null&&this.gl.deleteTexture(this.bmpTexture),this.bmpTexture=this.gl.createTexture(),s=this.bmpTexture,this.bmpTextureWH=r.width/r.height,this.gl.activeTexture(V0),this.bmpShader.use(this.gl),this.gl.uniform1i(this.bmpShader.uniforms.bmpTexture,4)):e===5?(this.gl.activeTexture(qn),this.matCapTexture!==null&&this.gl.deleteTexture(this.matCapTexture),this.matCapTexture=this.gl.createTexture(),s=this.matCapTexture):(this.fontShader.use(this.gl),this.gl.activeTexture(Il),this.gl.uniform1i(this.fontShader.uniforms.fontTexture,3),this.fontTexture!==null&&this.gl.deleteTexture(this.fontTexture),this.fontTexture=this.gl.createTexture(),s=this.fontTexture),this.gl.bindTexture(this.gl.TEXTURE_2D,s),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,r),t(s),e!==4&&this.drawScene()},r.onerror=i,this.requestCORSIfNotSameOrigin(r,a),r.src=a})}async loadFontTexture(a){return this.loadPngAsTexture(a,3)}async loadBmpTexture(a){return this.loadPngAsTexture(a,4)}async loadMatCapTexture(a){return this.loadPngAsTexture(a,5)}initFontMets(){if(!this.fontMetrics)throw new Error("fontMetrics undefined");this.fontMets={distanceRange:this.fontMetrics.atlas.distanceRange,size:this.fontMetrics.atlas.size,mets:{}};for(let t=0;t<256;t++)this.fontMets.mets[t]={xadv:0,uv_lbwh:[0,0,0,0],lbwh:[0,0,0,0]};const a=this.fontMetrics.atlas.width,e=this.fontMetrics.atlas.height;for(let t=0;t<this.fontMetrics.glyphs.length;t++){const i=this.fontMetrics.glyphs[t],r=i.unicode;if(this.fontMets.mets[r].xadv=i.advance,i.planeBounds===void 0)continue;let s=i.atlasBounds.left/a,n=(e-i.atlasBounds.top)/e,o=(i.atlasBounds.right-i.atlasBounds.left)/a,c=(i.atlasBounds.top-i.atlasBounds.bottom)/e;this.fontMets.mets[r].uv_lbwh=[s,n,o,c],s=i.planeBounds.left,n=i.planeBounds.bottom,o=i.planeBounds.right-i.planeBounds.left,c=i.planeBounds.top-i.planeBounds.bottom,this.fontMets.mets[r].lbwh=[s,n,o,c]}}async loadFont(a=bl,e=pl){await this.loadFontTexture(a);const t=await fetch(e);if(!t.ok)throw Error(t.statusText);const i=await t.text();this.fontMetrics=JSON.parse(i),this.initFontMets(),this.fontShader.use(this.gl),this.drawScene()}async loadDefaultMatCap(){return this.loadMatCapTexture(Mp)}async loadDefaultFont(){await this.loadFontTexture(this.DEFAULT_FONT_GLYPH_SHEET),this.fontMetrics=this.DEFAULT_FONT_METRICS,this.initFontMets()}async initText(){this.fontShader=new xe(this.gl,Qp,Jp),this.fontShader.use(this.gl),await this.loadDefaultFont(),await this.loadDefaultMatCap(),this.drawLoadingText(this.opts.loadingText)}meshShaderNameToNumber(a="Phong"){const e=a.toLowerCase();for(let t=0;t<this.meshShaders.length;t++)if(this.meshShaders[t].Name.toLowerCase()===e)return t}setMeshShader(a,e=2){let t=0;if(typeof e=="number"?t=e:t=this.meshShaderNameToNumber(e),t===void 0)throw new Error("shaderIndex undefined");t=Math.min(t,this.meshShaders.length-1),t=Math.max(t,0);const i=this.getMeshIndexByID(a);if(i>=this.meshes.length){V.debug("Unable to change shader until mesh is loaded (maybe you need async)");return}this.meshes[i].meshShaderIndex=t,this.updateGLVolume(),this.onMeshShaderChanged(i,t)}createCustomMeshShader(a,e="Custom"){if(!a)throw new Error("Need fragment shader");const t=this.meshShaderNameToNumber(e);t>=0&&(this.gl.deleteProgram(this.meshShaders[t].shader.program),this.meshShaders.splice(t,1));const i=new xe(this.gl,Ln,a);return i.use(this.gl),{Name:e,Frag:a,shader:i}}setCustomSliceShader(a=""){const e=this.gl;if(this.customSliceShader&&(e.deleteProgram(this.customSliceShader.program),this.customSliceShader=null),!a){this.updateGLVolume();return}const t=new xe(e,Ks,a);t.use(e),e.uniform1i(t.uniforms.volume,0),e.uniform1i(t.uniforms.colormap,1),e.uniform1i(t.uniforms.overlay,2),e.uniform1i(t.uniforms.drawing,7),e.uniform1i(t.uniforms.paqd,8),e.uniform1f(t.uniforms.drawOpacity,this.drawOpacity),this.customSliceShader=t,this.updateGLVolume()}setCustomMeshShader(a="",e="Custom"){const t=this.createCustomMeshShader(a,e);return this.meshShaders.push(t),this.onCustomMeshShaderAdded(a,e),this.meshShaders.length-1}meshShaderNames(a=!0){const e=[];for(let t=0;t<this.meshShaders.length;t++)e.push(this.meshShaders[t].Name);return a===!0?e.sort():e}initRenderShader(a,e=0){a.use(this.gl),this.gl.uniform1i(a.uniforms.volume,0),this.gl.uniform1i(a.uniforms.colormap,1),this.gl.uniform1i(a.uniforms.overlay,2),this.gl.uniform1i(a.uniforms.drawing,7),this.gl.uniform1i(a.uniforms.paqd,8),this.gl.uniform1fv(a.uniforms.renderDrawAmbientOcclusion,[this.renderDrawAmbientOcclusion,1]),this.gl.uniform1f(a.uniforms.gradientAmount,e),this.gl.uniform1f(a.uniforms.silhouettePower,this.opts.renderSilhouette);const t=new Float32Array(hs);for(let i=0;i<hs;i++)this.opts.gradientOpacity===0?t[i]=1:t[i]=Math.pow(i/(hs-1),this.opts.gradientOpacity*8);this.gl.uniform1fv(this.gl.getUniformLocation(a.program,"gradientOpacity"),t),a.uniforms.clipPlanes=this.gl.getUniformLocation(a.program,"clipPlanes[0]")}async init(){const a=this.gl.getExtension("WEBGL_debug_renderer_info");if(a){const s=this.gl.getParameter(a.UNMASKED_VENDOR_WEBGL),n=this.gl.getParameter(a.UNMASKED_RENDERER_WEBGL);V.info("renderer vendor: ",s),V.info("renderer: ",n)}else V.info("debug_renderer_info unavailable");const e=this.gl.getParameter(this.gl.RENDERER);V.info("firefox renderer: ",e),this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.FRONT),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.volumeTexture=this.rgbaTex(this.volumeTexture,Ma,[2,2,2,2],!0),this.overlayTexture=this.rgbaTex(this.overlayTexture,Ws,[2,2,2,2],!0),this.drawTexture=this.r8Tex(this.drawTexture,ha,[2,2,2,2],!0),this.paqdTexture=this.rgbaTex(this.paqdTexture,Ha,[2,2,2,2],!0);const t=[1,1,0,1,0,0,0,1,0,0,0,0],i=this.gl;this.cuboidVertexBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.cuboidVertexBuffer),i.bufferData(i.ARRAY_BUFFER,new Float32Array(t),i.STATIC_DRAW),this.genericVAO=i.createVertexArray(),i.bindVertexArray(this.genericVAO),i.bindBuffer(i.ARRAY_BUFFER,this.cuboidVertexBuffer),i.enableVertexAttribArray(0),i.vertexAttribPointer(0,3,i.FLOAT,!1,0,0),i.bindVertexArray(this.unusedVAO),this.pickingMeshShader=new xe(i,Ln,l0),this.pickingMeshShader.use(i),this.pickingImageShader=new xe(i,Yr,I0),this.pickingImageShader.use(i),this.pickingImageShader.uniforms.clipPlanes=this.gl.getUniformLocation(this.pickingImageShader.program,"clipPlanes[0]"),i.uniform1i(this.pickingImageShader.uniforms.volume,0),i.uniform1i(this.pickingImageShader.uniforms.colormap,1),i.uniform1i(this.pickingImageShader.uniforms.overlay,2),i.uniform1i(this.pickingImageShader.uniforms.drawing,7),this.slice2DShader=new xe(i,Ks,Vp),this.slice2DShader.use(i),i.uniform1i(this.slice2DShader.uniforms.volume,0),i.uniform1i(this.slice2DShader.uniforms.colormap,1),i.uniform1i(this.slice2DShader.uniforms.overlay,2),i.uniform1i(this.slice2DShader.uniforms.drawing,7),i.uniform1f(this.slice2DShader.uniforms.drawOpacity,this.drawOpacity),this.sliceMMShader=new xe(i,Ks,Lp),this.sliceMMShader.use(i),i.uniform1i(this.sliceMMShader.uniforms.volume,0),i.uniform1i(this.sliceMMShader.uniforms.colormap,1),i.uniform1i(this.sliceMMShader.uniforms.overlay,2),i.uniform1i(this.sliceMMShader.uniforms.drawing,7),i.uniform1f(this.sliceMMShader.uniforms.drawOpacity,this.drawOpacity),this.sliceV1Shader=new xe(i,Ks,Gp),this.sliceV1Shader.use(i),i.uniform1i(this.sliceV1Shader.uniforms.volume,0),i.uniform1i(this.sliceV1Shader.uniforms.colormap,1),i.uniform1i(this.sliceV1Shader.uniforms.overlay,2),i.uniform1i(this.sliceV1Shader.uniforms.drawing,7),i.uniform1f(this.sliceV1Shader.uniforms.drawOpacity,this.drawOpacity),this.orientCubeShader=new xe(i,M0,C0),this.orientCubeShaderVAO=i.createVertexArray(),i.bindVertexArray(this.orientCubeShaderVAO);const r=i.createBuffer();i.enableVertexAttribArray(0),i.enableVertexAttribArray(1),i.bindBuffer(i.ARRAY_BUFFER,r),i.bufferData(i.ARRAY_BUFFER,Yu,i.STATIC_DRAW),i.vertexAttribPointer(0,3,i.FLOAT,!1,24,0),i.enableVertexAttribArray(1),i.vertexAttribPointer(1,3,i.FLOAT,!1,24,12),i.bindVertexArray(this.unusedVAO),this.rectShader=new xe(i,gl,On),this.rectShader.use(i),this.rectOutlineShader=new xe(i,gl,zp),this.rectOutlineShader.use(i),this.lineShader=new xe(i,qp,On),this.lineShader.use(i),this.line3DShader=new xe(i,Wp,On),this.line3DShader.use(i),this.circleShader=new xe(i,Zp,$p),this.circleShader.use(i),this.renderVolumeShader=new xe(i,Yr,Bp),this.initRenderShader(this.renderVolumeShader),this.renderSliceShader=new xe(i,Yr,jp),this.initRenderShader(this.renderSliceShader),this.renderGradientShader=new xe(i,Yr,Pp),this.initRenderShader(this.renderGradientShader,.3),i.uniform1i(this.renderGradientShader.uniforms.matCap,5),i.uniform1i(this.renderGradientShader.uniforms.gradient,6),this.renderGradientValuesShader=new xe(i,Yr,Op),this.initRenderShader(this.renderGradientValuesShader),i.uniform1i(this.renderGradientValuesShader.uniforms.matCap,5),i.uniform1i(this.renderGradientValuesShader.uniforms.gradient,6),this.renderShader=this.renderVolumeShader,this.colorbarShader=new xe(i,Kp,Hp),this.colorbarShader.use(i),i.uniform1i(this.colorbarShader.uniforms.colormap,1),this.blurShader=new xe(i,qs,S0),this.sobelBlurShader=new xe(i,qs,F0),this.sobelFirstOrderShader=new xe(i,qs,R0),this.sobelSecondOrderShader=new xe(i,qs,N0),this.growCutShader=new xe(i,i0,r0),this.passThroughShader=new xe(i,D0,_0),this.orientShaderAtlasU=new xe(i,Ta,Hs.concat(yl)),this.orientShaderAtlasI=new xe(i,Ta,Al.concat(yl)),this.orientShaderU=new xe(i,Ta,Hs.concat(Vn)),this.orientShaderI=new xe(i,Ta,Al.concat(Vn)),this.orientShaderF=new xe(i,Ta,e0.concat(Vn)),this.orientShaderRGBU=new xe(i,Ta,Hs.concat(a0)),this.orientShaderPAQD=new xe(i,Ta,Hs.concat(t0)),this.surfaceShader=new xe(i,s0,n0),this.surfaceShader.use(i),this.fiberShader=new xe(i,o0,c0),this.pickingImageShader.use(i);for(let s=0;s<this.meshShaders.length;s++){const n=this.meshShaders[s];n.Name==="Flat"?n.shader=new xe(i,T0,xl):n.shader=new xe(i,Ln,n.Frag),n.shader.use(i),n.shader.isCrosscut=n.Name==="Crosscut",n.shader.isMatcap=n.Name==="Matcap",n.shader.isMatcap&&i.uniform1i(n.shader.uniforms.matCap,5)}return this.bmpShader=new xe(i,Yp,Xp),await this.initText(),this.opts.thumbnail.length>0&&(await this.loadBmpTexture(this.opts.thumbnail),this.thumbnailVisible=!0),this.updateGLVolume(),this.initialized=!0,this.resizeListener(),this.drawScene(),this}gradientGL(a){const e=this.gl;e.bindVertexArray(this.genericVAO);const t=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,t),e.viewport(0,0,a.dims[1],a.dims[2]),e.disable(e.BLEND);const i=this.rgbaTex(null,Ml,a.dims,!0),r=this.opts.gradientOrder===2?this.sobelBlurShader:this.blurShader;r.use(e),e.activeTexture(Ma),e.bindTexture(e.TEXTURE_3D,this.volumeTexture),e.texParameteri(e.TEXTURE_3D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_3D,e.TEXTURE_MAG_FILTER,e.LINEAR);const s=.7;e.uniform1i(r.uniforms.intensityVol,0),e.uniform1f(r.uniforms.dX,s/a.dims[1]),e.uniform1f(r.uniforms.dY,s/a.dims[2]),e.uniform1f(r.uniforms.dZ,s/a.dims[3]);for(let c=0;c<a.dims[3]-1;c++){const l=1/a.dims[3]*(c+.5);e.uniform1f(r.uniforms.coordZ,l),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,i,0,c);const h=e.checkFramebufferStatus(e.FRAMEBUFFER);h!==e.FRAMEBUFFER_COMPLETE&&V.error("blur shader: ",h),e.drawArrays(e.TRIANGLE_STRIP,0,4)}const n=this.opts.gradientOrder===2?this.sobelSecondOrderShader:this.sobelFirstOrderShader;n.use(e),e.activeTexture(Ml),e.bindTexture(e.TEXTURE_3D,i),e.texParameteri(e.TEXTURE_3D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_3D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.uniform1i(n.uniforms.intensityVol,8);const o=.7;e.uniform1f(n.uniforms.dX,o/a.dims[1]),e.uniform1f(n.uniforms.dY,o/a.dims[2]),e.uniform1f(n.uniforms.dZ,o/a.dims[3]),this.opts.gradientOrder===2&&(e.uniform1f(n.uniforms.dX2,2*o/a.dims[1]),e.uniform1f(n.uniforms.dY2,2*o/a.dims[2]),e.uniform1f(n.uniforms.dZ2,2*o/a.dims[3])),e.uniform1f(n.uniforms.coordZ,.5),this.gradientTexture!==null&&e.deleteTexture(this.gradientTexture),this.gradientTexture=this.rgbaTex(this.gradientTexture,Ys,a.dims);for(let c=0;c<a.dims[3]-1;c++){const l=1/a.dims[3]*(c+.5);e.uniform1f(n.uniforms.coordZ,l),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,this.gradientTexture,0,c);const h=e.checkFramebufferStatus(e.FRAMEBUFFER);h!==e.FRAMEBUFFER_COMPLETE&&V.error("sobel shader: ",h),e.drawArrays(e.TRIANGLE_STRIP,0,4)}e.deleteFramebuffer(t),e.deleteTexture(i),e.bindFramebuffer(e.FRAMEBUFFER,null),e.activeTexture(Ha),e.bindTexture(e.TEXTURE_3D,this.paqdTexture),this.gl.bindVertexArray(this.unusedVAO)}getGradientTextureData(){if(!this.gradientTexture||!this.back)return null;const a=this.gl,e=this.back.dims,t=e[1],i=e[2],r=e[3],s=t*i*r,n=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,n);const o=new Float32Array(s*4);try{for(let c=0;c<r;c++){a.framebufferTextureLayer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,this.gradientTexture,0,c);const l=a.checkFramebufferStatus(a.FRAMEBUFFER);if(l!==a.FRAMEBUFFER_COMPLETE){console.warn("Framebuffer not complete for gradient texture reading, slice",c,"status:",l.toString(16));continue}try{const h=new Uint8Array(t*i*4);a.readPixels(0,0,t,i,a.RGBA,a.UNSIGNED_BYTE,h);const d=new Float32Array(t*i*4);for(let u=0;u<h.length;u++)d[u]=h[u]/127.5-1;const f=c*t*i*4;o.set(d,f)}catch(h){console.warn("Failed to read pixels for slice",c,":",h);const d=c*t*i*4,f=new Float32Array(t*i*4);o.set(f,d)}}}catch(c){return console.error("Error reading gradient texture:",c),null}finally{a.deleteFramebuffer(n),a.bindFramebuffer(a.FRAMEBUFFER,null)}return o}setCustomGradientTexture(a,e){const t=this.gl;if(a===null){this.useCustomGradientTexture=!1,this.back&&this.gradientTextureAmount>0&&this.gradientGL(this.back.hdr);return}if(!e&&!this.back){console.warn("No dimensions provided and no background volume loaded");return}const i=e||this.back.dims,r=i[1],s=i[2],n=i[3],o=r*s*n*4;if(a.length!==o){console.warn(`Custom gradient data size mismatch. Expected ${o}, got ${a.length}`);return}this.useCustomGradientTexture=!0,this.gradientTexture!==null&&t.deleteTexture(this.gradientTexture),this.gradientTexture=t.createTexture(),t.activeTexture(Ys),t.bindTexture(t.TEXTURE_3D,this.gradientTexture),t.texParameteri(t.TEXTURE_3D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_3D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_3D,t.TEXTURE_WRAP_R,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_3D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_3D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.pixelStorei(t.UNPACK_ALIGNMENT,1);let c;if(a instanceof Float32Array){c=new Uint8Array(a.length);for(let l=0;l<a.length;l++){const h=Math.max(-1,Math.min(1,a[l]));c[l]=Math.round((h+1)*127.5)}}else c=a;t.texStorage3D(t.TEXTURE_3D,1,t.RGBA8,r,s,n),t.texSubImage3D(t.TEXTURE_3D,0,0,0,0,r,s,n,t.RGBA,t.UNSIGNED_BYTE,c),this.drawScene()}updateGLVolume(){var t;let a=0;const e=this.volumes.length;this.refreshColormaps(),this.closePAQD();for(let i=0;i<e;i++)this.volumes[i].toRAS&&(this.refreshLayers(this.volumes[i],a),a++);if(this.furthestVertexFromOrigin=0,e>0&&(this.furthestVertexFromOrigin=((t=this.volumeObject3D)==null?void 0:t.furthestVertexFromOrigin)??0),this.meshes)for(let i=0;i<this.meshes.length;i++)this.furthestVertexFromOrigin=Math.max(this.furthestVertexFromOrigin,this.meshes[i].furthestVertexFromOrigin);this.onVolumeUpdated&&this.onVolumeUpdated(),this.drawScene()}getDescriptives(a){const{layer:e=0,masks:t=[],drawingIsMask:i=!1,roiIsMask:r=!1,startVox:s=[0,0,0],endVox:n=[0,0,0]}=a;let o=null;const c=this.volumes[e].hdr,l=this.volumes[e].pixDimsRAS;let h=c.scl_slope;isNaN(h)&&(h=1);let d=c.scl_inter;isNaN(d)&&(d=1);const f=this.volumes[e].img,u=f.length,m=new Float32Array(u);for(let S=0;S<u;S++)m[S]=f[S]*h+d;const p=new Uint8Array(u);for(let S=0;S<u;S++)p[S]=1;if(t.length>0)for(let S=0;S<t.length;S++){const k=this.volumes[t[S]].img;if(k.length!==u){V.debug("Mask resolution does not match image. Skipping masking layer "+t[S]);continue}for(let F=0;F<u;F++)(k[F]===0||isNaN(k[F]))&&(p[F]=0)}else if(t.length<1&&i)for(let S=0;S<u;S++)(this.drawBitmap[S]===0||isNaN(this.drawBitmap[S]))&&(p[S]=0);else if(t.length<1&&r){p.fill(0);let S=-1;if(s[0]===n[0])S=0;else if(s[1]===n[1])S=1;else if(s[2]===n[2])S=2;else{console.error("Error: No constant dimension found.");return}const F=[0,1,2].filter(Me=>Me!==S),B=[];B[S]=s[S],B[F[0]]=(s[F[0]]+n[F[0]])/2,B[F[1]]=(s[F[1]]+n[F[1]])/2;const O=Math.abs(n[F[0]]-s[F[0]])/2,L=Math.abs(n[F[1]]-s[F[1]])/2,_=c.dims[1],q=c.dims[2],J=Math.max(0,Math.floor(B[F[0]]-O)),Z=Math.min(c.dims[F[0]+1]-1,Math.ceil(B[F[0]]+O)),Y=Math.max(0,Math.floor(B[F[1]]-L)),W=Math.min(c.dims[F[1]+1]-1,Math.ceil(B[F[1]]+L)),T=B[S];if(T<0||T>=c.dims[S+1]){console.error("Error: Constant dimension value is out of bounds.");return}for(let Me=J;Me<=Z;Me++)for(let Ne=Y;Ne<=W;Ne++){const ge=[];ge[S]=T,ge[F[0]]=Me,ge[F[1]]=Ne;const Ae=(ge[F[0]]-B[F[0]])/O,_e=(ge[F[1]]-B[F[1]])/L;if(Ae*Ae+_e*_e<=1){const pt=ge[0],Ut=ge[1],rt=ge[2]*_*q+Ut*_+pt;p[rt]=1}}const ne=O*l[F[0]+1],le=L*l[F[1]+1];o=Math.PI*ne*le}let g=0,b=0,A=0,y=Number.NEGATIVE_INFINITY,x=Number.POSITIVE_INFINITY,E=0,I=0,w=0;for(let S=0;S<u;S++){if(p[S]<1)continue;const k=m[S];g++;let F=b+(k-b)/g;A=A+(k-b)*(k-F),b=F,k!==0&&(E++,F=I+(k-I)/E,w=w+(k-I)*(k-F),I=F,x=Math.min(k,x),y=Math.max(k,y))}const v=Math.sqrt(A/(g-1)),M=Math.sqrt(w/(E-1)),C=x,D=y;return g!==E&&(x=Math.min(0,x),y=Math.max(0,y)),{mean:b,stdev:v,nvox:g,volumeMM3:g*c.pixDims[1]*c.pixDims[2]*c.pixDims[3],volumeML:g*c.pixDims[1]*c.pixDims[2]*c.pixDims[3]*.001,min:x,max:y,meanNot0:I,stdevNot0:M,nvoxNot0:E,minNot0:C,maxNot0:D,cal_min:this.volumes[e].cal_min,cal_max:this.volumes[e].cal_max,robust_min:this.volumes[e].robust_min,robust_max:this.volumes[e].robust_max,area:o}}refreshLayers(a,e){var I;if(this.volumes.length<1)return;this.refreshColormaps();const t=a.hdr;let i=a.img;a.frame4D>0&&a.frame4D<a.nFrame4D&&(i=a.img.slice(a.frame4D*a.nVox3D,(a.frame4D+1)*a.nVox3D));const r=a.opacity;if(e>1&&r===0)return;let s=null;if(!this.back)throw new Error("back undefined");this.gl.bindVertexArray(this.unusedVAO),this.crosshairs3D&&(this.crosshairs3D.mm[0]=NaN);let n=Ke(a.toRAS);if(e===0){this.volumeObject3D=Cp(a,this.VOLUME_ID,this.gl),bt(n,n),this.back.matRAS=a.matRAS,this.back.dims=a.dimsRAS,this.back.pixDims=a.pixDimsRAS;const{volScale:w,vox:v}=this.sliceScale(!0);this.volScale=w,this.vox=v,this.volumeObject3D.scale=w,(t.dims[1]>this.uiData.max2D||t.dims[2]>this.uiData.max2D)&&V.error("Image dimensions exceed maximum texture size of hardware.");const C=t.dims[1]>this.uiData.max3D||t.dims[2]>this.uiData.max3D||t.dims[3]>this.uiData.max3D;if(C&&t.datatypeCode===2304&&t.dims[3]<2){V.info(`Large RGBA image (>${this.uiData.max3D}) requires Texture2D`),this.opts.is2DSliceShader=!0,s=this.rgbaTex2D(this.volumeTexture,Ma,a.dimsRAS,i);return}if(C){V.info(`Large scalar image (>${this.uiData.max3D}) requires Texture2D (${t.dims[1]}${t.dims[2]}${t.dims[3]})`);const S=t.dims[1]*t.dims[2],k=this.frac2vox(this.scene.crosshairPos),B=Math.min(Math.max(k[2],0),t.dims[3]-1)*S,O=new Uint8Array(S*4),L=new Uint32Array(O.buffer),_=Math.floor(a.opacity*255),q=255*t.scl_slope/(a.cal_max-a.cal_min),J=255*(t.scl_inter-a.cal_min)/(a.cal_max-a.cal_min),Z=new Uint8Array(this.colormap(a.colormap)),Y=new Uint32Array(Z.buffer);let W=-1;for(let T=0;T<S;T++){const ne=i[T+B]*q+J,le=Math.round(Math.min(255,Math.max(0,ne)));L[T]=Y[le],O[W+=4]=_}this.opts.is2DSliceShader=!0,s=this.rgbaTex2D(this.volumeTexture,Ma,a.dimsRAS,O,!1);return}if(C&&V.warn(`dimensions exceed 3D limits ${t.dims}`),this.opts.is2DSliceShader=!1,s=this.rgbaTex(this.volumeTexture,Ma,a.dimsRAS),!this.renderShader)throw new Error("renderShader undefined");this.renderShader.use(this.gl),this.gl.uniform3fv(this.renderShader.uniforms.texVox,v),this.gl.uniform3fv(this.renderShader.uniforms.volScale,w);const D=this.pickingImageShader;D.use(this.gl),this.gl.uniform1i(D.uniforms.volume,0),this.gl.uniform1i(D.uniforms.colormap,1),this.gl.uniform1i(D.uniforms.overlay,2),this.gl.uniform3fv(D.uniforms.volScale,w),V.debug(this.volumeObject3D)}else{((I=this.back)==null?void 0:I.dims)===void 0&&V.error("Fatal error: Unable to render overlay: background dimensions not defined!");const w=this.mm2frac(a.mm000,0,!0);let v=this.mm2frac(a.mm100,0,!0),M=this.mm2frac(a.mm010,0,!0),C=this.mm2frac(a.mm001,0,!0);v=Fe(v,v,w),M=Fe(M,M,w),C=Fe(C,C,w),n=Ct(v[0],M[0],C[0],w[0],v[1],M[1],C[1],w[1],v[2],M[2],C[2],w[2],0,0,0,1),bt(n,n),e===1?(s=this.rgbaTex(this.overlayTexture,Ws,this.back.dims),this.overlayTexture=s,this.overlayTextureID=s):s=this.overlayTextureID}const o=this.gl.createFramebuffer();this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,o),this.gl.disable(this.gl.CULL_FACE),this.gl.viewport(0,0,this.back.dims[1],this.back.dims[2]),this.gl.disable(this.gl.BLEND);const c=this.gl.createTexture();this.gl.activeTexture(Cl),this.gl.bindTexture(this.gl.TEXTURE_3D,c),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1);let l=this.orientShaderU;if(!t)throw new Error("hdr undefined");if(!i)throw new Error("img undefined");if(t.datatypeCode===2)t.intent_code===1002&&(l=this.orientShaderAtlasU),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R8UI,t.dims[1],t.dims[2],t.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,t.dims[1],t.dims[2],t.dims[3],this.gl.RED_INTEGER,this.gl.UNSIGNED_BYTE,i);else if(t.datatypeCode===4)l=this.orientShaderI,t.intent_code===1002&&(l=this.orientShaderAtlasI),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R16I,t.dims[1],t.dims[2],t.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,t.dims[1],t.dims[2],t.dims[3],this.gl.RED_INTEGER,this.gl.SHORT,i);else if(t.datatypeCode===16)this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R32F,t.dims[1],t.dims[2],t.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,t.dims[1],t.dims[2],t.dims[3],this.gl.RED,this.gl.FLOAT,i),l=this.orientShaderF;else if(t.datatypeCode===64){let w=new Float32Array;w=Float32Array.from(i),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R32F,t.dims[1],t.dims[2],t.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,t.dims[1],t.dims[2],t.dims[3],this.gl.RED,this.gl.FLOAT,w),l=this.orientShaderF}else if(t.datatypeCode===128)l=this.orientShaderRGBU,l.use(this.gl),this.gl.uniform1i(l.uniforms.hasAlpha,0),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGB8UI,t.dims[1],t.dims[2],t.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,t.dims[1],t.dims[2],t.dims[3],this.gl.RGB_INTEGER,this.gl.UNSIGNED_BYTE,i);else if(t.datatypeCode===512)t.intent_code===1002&&(l=this.orientShaderAtlasU),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R16UI,t.dims[1],t.dims[2],t.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,t.dims[1],t.dims[2],t.dims[3],this.gl.RED_INTEGER,this.gl.UNSIGNED_SHORT,i);else if(t.datatypeCode===2304){if(l=this.orientShaderRGBU,a.colormapLabel){l=this.orientShaderPAQD;let w=!0;for(let v=0;v<e;v++){const M=this.volumes[v].hdr.datatypeCode===2304,C=!!this.volumes[v].colormapLabel;M&&C&&(w=!1)}w?this.paqdTexture=this.rgbaTex(this.paqdTexture,Ha,this.back.dims):V.warn("Current version only one probabilistic atlas (PAQD) at a time"),s=this.paqdTexture,this.gl.activeTexture(Cl)}l.use(this.gl),this.gl.uniform1i(l.uniforms.hasAlpha,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGBA8UI,t.dims[1],t.dims[2],t.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,t.dims[1],t.dims[2],t.dims[3],this.gl.RGBA_INTEGER,this.gl.UNSIGNED_BYTE,i)}a.global_min===void 0&&a.calMinMax();let h=null;if(this.gl.bindVertexArray(this.genericVAO),e>1){if(!this.back.dims)throw new Error("back.dims undefined");h=this.rgbaTex(h,Dl,this.back.dims),this.gl.bindTexture(this.gl.TEXTURE_3D,h);const w=this.passThroughShader;w.use(this.gl),this.gl.uniform1i(w.uniforms.in3D,2);for(let v=0;v<this.back.dims[3];v++){const M=1/this.back.dims[3]*(v+.5);this.gl.uniform1f(w.uniforms.coordZ,M),this.gl.framebufferTextureLayer(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,h,0,v),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}else h=this.rgbaTex(h,Dl,[2,2,2,2]);l.use(this.gl),this.gl.activeTexture(Jr);let d=null;if(a.colormapLabel!==null&&a.colormapLabel.lut.length>7){const w=a.colormapLabel.max-a.colormapLabel.min+1;d=this.createColormapTexture(d,1,w),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,w,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,a.colormapLabel.lut),this.gl.uniform1f(l.uniforms.cal_min,a.colormapLabel.min-.5),this.gl.uniform1f(l.uniforms.cal_max,a.colormapLabel.max+.5),this.gl.bindTexture(this.gl.TEXTURE_2D,d)}else this.gl.bindTexture(this.gl.TEXTURE_2D,this.colormapTexture),this.gl.uniform1f(l.uniforms.cal_min,a.cal_min),this.gl.uniform1f(l.uniforms.cal_max,a.cal_max);"alphaThreshold"in a&&(V.warn("alphaThreshold is deprecated: use colormapType"),a.alphaThreshold===!0&&(a.colormapType=2),a.alphaThreshold===!1&&(a.colormapType=1),delete a.alphaThreshold);const f=a.colormapType!==0?1:0,u=a.colormapType===2?1:0;this.gl.uniform1i(l.uniforms.isAlphaThreshold,u),this.gl.uniform1i(l.uniforms.isColorbarFromZero,f),this.gl.uniform1i(l.uniforms.isAdditiveBlend,this.opts.isAdditiveBlend?1:0);let m=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY;if(a.colormapNegative.length>0&&(m=Math.min(-a.cal_min,-a.cal_max),p=Math.max(-a.cal_min,-a.cal_max),isFinite(a.cal_minNeg)&&isFinite(a.cal_maxNeg)&&(m=Math.min(a.cal_minNeg,a.cal_maxNeg),p=Math.max(a.cal_minNeg,a.cal_maxNeg))),e>0&&this.overlayOutlineWidth>0){const w=a.cal_min,v=a.cal_max;let M=Math.min(w,v)<=0&&Math.max(w,v)>=0;!M&&m<p&&(M=m<=0&&p>=0),M&&V.error("issue1139: do not use overlayOutlineWidth when thresholds cross or touch zero")}if(!l)throw new Error("orientShader undefined");this.gl.uniform1f(l.uniforms.layer??null,e),this.gl.uniform1f(l.uniforms.cal_minNeg??null,m),this.gl.uniform1f(l.uniforms.cal_maxNeg??null,p),this.gl.bindTexture(this.gl.TEXTURE_3D,c),this.gl.uniform1i(l.uniforms.intensityVol??null,9),this.gl.uniform1i(l.uniforms.blend3D??null,10),this.gl.uniform1i(l.uniforms.colormap??null,1),this.gl.uniform1f(l.uniforms.scl_inter??null,t.scl_inter),this.gl.uniform1f(l.uniforms.scl_slope??null,t.scl_slope),this.gl.uniform1f(l.uniforms.opacity??null,r),this.gl.uniform1i(l.uniforms.modulationVol??null,7);let g=null;if(a.modulationImage!==null&&a.modulationImage>=0&&a.modulationImage<this.volumes.length){V.debug("modulating",this.volumes);const w=this.volumes[a.modulationImage].hdr;if(w.dims[1]===t.dims[1]&&w.dims[2]===t.dims[2]&&w.dims[3]===t.dims[3]){a.modulateAlpha?(this.gl.uniform1i(l.uniforms.modulation,2),this.gl.uniform1f(l.uniforms.opacity,1)):this.gl.uniform1i(l.uniforms.modulation,1),g=this.r8Tex(g,this.gl.TEXTURE7,t.dims,!0),this.gl.activeTexture(this.gl.TEXTURE7),this.gl.bindTexture(this.gl.TEXTURE_3D,g);const v=t.dims[1]*t.dims[2]*t.dims[3],M=new Uint8Array(v),C=this.volumes[a.modulationImage].cal_min,D=1/(this.volumes[a.modulationImage].cal_max-C),S=this.volumes[a.modulationImage].img.buffer;let k=new Uint8Array(S);switch(w.datatypeCode){case 4:k=new Int16Array(S);break;case 16:k=new Float32Array(S);break;case 64:k=new Float64Array(S);break;case 128:k=new Uint8Array(S);break;case 512:k=new Uint16Array(S);break}V.debug(this.volumes[a.modulationImage]);const F=this.volumes[a.modulationImage].colormapNegative.length>0;let B=this.volumes[a.modulationImage].cal_min,O=this.volumes[a.modulationImage].cal_max;isFinite(this.volumes[a.modulationImage].cal_minNeg)&&isFinite(this.volumes[a.modulationImage].cal_maxNeg)&&(B=this.volumes[a.modulationImage].cal_minNeg,O=this.volumes[a.modulationImage].cal_minNeg),B=Math.abs(B),O=Math.abs(O),B>O&&([B,O]=[O,B]);const L=1/(O-B);let _=Math.abs(a.modulateAlpha);_=Math.max(_,1);const q=this.volumes[a.modulationImage].frame4D*v;for(let J=0;J<v;J++){const Z=k[J+q]*w.scl_slope+w.scl_inter;let Y=(Z-C)*D;F&&Z<0&&(Y=(Math.abs(Z)-B)*L),Y=Math.min(Math.max(Y,0),1),Y=Math.pow(Y,_)*255,M[J]=Y}this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,t.dims[1],t.dims[2],t.dims[3],this.gl.RED,this.gl.UNSIGNED_BYTE,M)}else V.debug("Modulation image dimensions do not match target")}else this.gl.uniform1i(l.uniforms.modulation,0);if(this.gl.uniformMatrix4fv(l.uniforms.mtx,!1,n),!this.back.dims)throw new Error("back.dims undefined");let b=0;t.intent_code===1002&&(b=this.opts.atlasOutline,this.gl.uniform1ui(l.uniforms.activeIndex,this.opts.atlasActiveIndex|0)),this.gl.uniform4fv(l.uniforms.xyzaFrac,[1/this.back.dims[1],1/this.back.dims[2],1/this.back.dims[3],b]),V.debug("back dims: ",this.back.dims);for(let w=0;w<this.back.dims[3];w++){const v=1/this.back.dims[3]*(w+.5);this.gl.uniform1f(l.uniforms.coordZ,v),this.gl.framebufferTextureLayer(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,s,0,w),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}if(this.gl.bindVertexArray(this.unusedVAO),this.gl.deleteTexture(c),this.gl.deleteTexture(g),this.gl.deleteTexture(h),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.deleteFramebuffer(o),e===0&&(this.volumeTexture=s,this.gradientTextureAmount>0&&!this.useCustomGradientTexture?(this.gradientGL(t),this.gl.bindVertexArray(this.genericVAO)):this.gradientTextureAmount<=0&&(this.gradientTexture!==null&&this.gl.deleteTexture(this.gradientTexture),this.gradientTexture=null)),!this.renderShader)throw new Error("renderShader undefined");this.renderShader.use(this.gl);const A=this.sliceScale(!0),y=A.vox,x=A.volScale;if(this.gl.uniform1f(this.renderShader.uniforms.overlays,this.overlays.length),this.gl.uniform4fv(this.renderShader.uniforms.clipPlaneColor,this.opts.clipPlaneColor),this.gl.uniform1f(this.renderShader.uniforms.backOpacity,this.volumes[0].opacity),this.gl.uniform1f(this.renderShader.uniforms.renderOverlayBlend,this.opts.renderOverlayBlend),this.gl.uniform4fv(this.renderShader.uniforms.clipPlane,this.scene.clipPlane),this.gl.uniform3fv(this.renderShader.uniforms.texVox,y),this.gl.uniform3fv(this.renderShader.uniforms.volScale,x),!this.pickingImageShader)throw new Error("pickingImageShader undefined");this.pickingImageShader.use(this.gl),this.gl.uniform1f(this.pickingImageShader.uniforms.overlays,this.overlays.length),this.gl.uniform3fv(this.pickingImageShader.uniforms.texVox,y);let E=this.sliceMMShader;if(this.opts.is2DSliceShader&&(E=this.slice2DShader),this.opts.isV1SliceShader&&(E=this.sliceV1Shader),this.customSliceShader&&(E=this.customSliceShader),!E)throw new Error("slice shader undefined");E.use(this.gl),this.gl.uniform1f(E.uniforms.overlays,this.overlays.length),this.gl.uniform1f(E.uniforms.drawOpacity,this.drawOpacity),d!==null&&(this.gl.deleteTexture(d),this.gl.activeTexture(Jr),this.gl.bindTexture(this.gl.TEXTURE_2D,this.colormapTexture)),this.gl.uniform1i(E.uniforms.drawing,7),this.gl.activeTexture(ha),this.opts.is2DSliceShader?this.gl.bindTexture(this.gl.TEXTURE_2D,this.drawTexture):this.gl.bindTexture(this.gl.TEXTURE_3D,this.drawTexture),this.gl.uniform4fv(E.uniforms.paqdUniforms,this.opts.paqdUniforms),this.gl.uniform1i(E.uniforms.paqd,8),this.gl.activeTexture(Ha),this.gl.bindTexture(this.gl.TEXTURE_3D,this.paqdTexture),this.updateInterpolation(e)}colormaps(){return Ie.colormaps()}addColormap(a,e){Ie.addColormap(a,e)}setColormap(a,e){const t=this.getVolumeIndexByID(a);this.volumes[t].colormap=e,this.updateGLVolume()}idx(a,e,t,i){return t*i[0]*i[1]+e*i[0]+a}check_previous_slice(a,e,t,i,r,s,n,o){const c=new Uint32Array(27);let l=0;if(!r)return 0;const h=a[this.idx(t,i,r,s)];if(n>=6){const d=this.idx(t,i,r-1,s);h===a[d]&&(c[l++]=e[d])}if(n>=18){if(t){const d=this.idx(t-1,i,r-1,s);h===a[d]&&(c[l++]=e[d])}if(i){const d=this.idx(t,i-1,r-1,s);h===a[d]&&(c[l++]=e[d])}if(t<s[0]-1){const d=this.idx(t+1,i,r-1,s);h===a[d]&&(c[l++]=e[d])}if(i<s[1]-1){const d=this.idx(t,i+1,r-1,s);h===a[d]&&(c[l++]=e[d])}}if(n===26){if(t&&i){const d=this.idx(t-1,i-1,r-1,s);h===a[d]&&(c[l++]=e[d])}if(t<s[0]-1&&i){const d=this.idx(t+1,i-1,r-1,s);h===a[d]&&(c[l++]=e[d])}if(t&&i<s[1]-1){const d=this.idx(t-1,i+1,r-1,s);h===a[d]&&(c[l++]=e[d])}if(t<s[0]-1&&i<s[1]-1){const d=this.idx(t+1,i+1,r-1,s);h===a[d]&&(c[l++]=e[d])}}return l?(this.fill_tratab(o,c,l),c[0]):0}do_initial_labelling(a,e,t){let i=1;const r=8192;let s=r,n=new Uint32Array(s).fill(0);const o=new Uint32Array(e[0]*e[1]*e[2]).fill(0),c=new Uint32Array(27);for(let l=0;l<e[2];l++)for(let h=0;h<e[1];h++)for(let d=0;d<e[0];d++){let f=0;const u=a[this.idx(d,h,l,e)];if(u!==0){if(c[0]=this.check_previous_slice(a,o,d,h,l,e,t,n),c[0]&&(f+=1),t>=6){if(d){const m=this.idx(d-1,h,l,e);u===a[m]&&(c[f++]=o[m])}if(h){const m=this.idx(d,h-1,l,e);u===a[m]&&(c[f++]=o[m])}}if(t>=18){if(h&&d){const m=this.idx(d-1,h-1,l,e);u===a[m]&&(c[f++]=o[m])}if(h&&d<e[0]-1){const m=this.idx(d+1,h-1,l,e);u===a[m]&&(c[f++]=o[m])}}if(f)o[this.idx(d,h,l,e)]=c[0],this.fill_tratab(n,c,f);else{if(o[this.idx(d,h,l,e)]=i,i>=s){s+=r;const m=new Uint32Array(s);m.set(n),n=m}n[i-1]=i,i++}}}for(let l=0;l<i-1;l++){let h=l;for(;n[h]!==h+1;)h=n[h]-1;n[l]=h+1}return[i-1,n,o]}fill_tratab(a,e,t){let i=0;const r=new Uint32Array(t+5).fill(0);let n=2147483647;for(let o=0;o<t;o++){let c=e[o];for(i=0;a[c-1]!==c;)if(c=a[c-1],i++,i>100){V.info(`
Ooh no!!`);break}r[o]=c,n=Math.min(n,c)}for(let o=0;o<t;o++)a[r[o]-1]=n}translate_labels(a,e,t,i){const r=e[0]*e[1]*e[2];let s=0;const n=new Uint32Array(r).fill(0);for(let l=0;l<i;l++)s=Math.max(s,t[l]);const o=new Uint32Array(s).fill(0);let c=0;for(let l=0;l<r;l++)a[l]&&(o[t[a[l]-1]-1]||(c+=1,o[t[a[l]-1]-1]=c),n[l]=o[t[a[l]-1]-1]);return[c,n]}largest_original_cluster_labels(a,e,t){const i=a.length,r=new Uint32Array(e+1).fill(0),s=new Uint32Array(e+1).fill(0);for(let c=0;c<i;c++){const l=a[c],h=t[c];r[h]=l,s[h]++}let n=0;for(let c=0;c<e+1;c++){const l=r[c];n=Math.max(n,l);for(let h=0;h<e+1;h++)h!==c&&l===r[h]&&(s[c]<s[h]||s[c]===s[h]&&c<h)&&(r[c]=0)}const o=new Uint32Array(i).fill(0);for(let c=0;c<i;c++)o[c]=r[t[c]];return[n,o]}bwlabel(a,e,t=26,i=!1,r=!1){const s=Date.now(),n=e[0]*e[1]*e[2],o=new Uint32Array(n).fill(0);if(![6,18,26].includes(t))return V.info("bwlabel: conn must be 6, 18 or 26."),[0,o];if(e[0]<2||e[1]<2||e[2]<1)return V.info("bwlabel: img must be 2 or 3-dimensional"),[0,o];if(i)for(let u=0;u<n;u++)a[u]!==0&&(o[u]=1);else o.set(a);let[c,l,h]=this.do_initial_labelling(o,e,t);l===void 0&&(l=new Uint32Array);const[d,f]=this.translate_labels(h,e,l,c);if(V.info(t+" neighbor clustering into "+d+" regions in "+(Date.now()-s)+"ms"),r){const[u,m]=this.largest_original_cluster_labels(o,d,f);return[u,m]}return[d,f]}async createConnectedLabelImage(a,e=26,t=!1,i=!1){var h,d;const r=this.getVolumeIndexByID(a),s=Uint32Array.from(((h=this.volumes[r].dims)==null?void 0:h.slice(1,4))??[]),n=Uint32Array.from(((d=this.volumes[r].img)==null?void 0:d.slice())??[]),[o,c]=this.bwlabel(n,s,e,t,i),l=this.volumes[r].clone();l.opacity=.5,l.colormap="random";for(let f=0;f<l.img.length;f++)l.img[f]=c[f];return l.cal_min=0,l.cal_max=o,l}async scalecropUint8(a,e=0,t=255,i,r){const s=a.length,n=new Uint8Array(s);for(let o=0;o<s;o++){let c=a[o];c=e+r*(c-i),c=Math.max(c,e),c=Math.min(c,t),n[o]=c}return n}async scalecropFloat32(a,e=0,t=1,i,r){const s=a.length,n=new Float32Array(s);for(let o=0;o<s;o++){let c=a[o];c=e+r*(c-i),c=Math.max(c,e),c=Math.min(c,t),n[o]=c}return n}getScale(a,e=0,t=255,i=0,r=.999){let s=a.global_min,n=a.global_max;if(a.hdr.datatypeCode===2)return[s,1];if((!isFinite(i)||!isFinite(r))&&isFinite(a.cal_min)&&isFinite(a.cal_max)&&a.cal_max>a.cal_min){s=a.cal_min,n=a.cal_max;const A=(t-e)/(n-s);return V.info(" Robust Rescale:  min: "+s+"  max: "+n+" scale: "+A),[s,A]}let o=a.img;const c=a.hdr.dims[1]*a.hdr.dims[2]*a.hdr.dims[3];if(a.hdr.scl_slope!==1||a.hdr.scl_inter!==0){const A=a.img;o=new Float32Array(a.img.length);for(let y=0;y<c;y++)o[y]=A[y]*a.hdr.scl_slope+a.hdr.scl_inter}if(s<0&&V.warn("WARNING: Input image has value(s) below 0.0 !"),V.info(" Input:    min: "+s+"  max: "+n),i===0&&r===1)return[s,1];let l=0;for(let A=0;A<c;A++)Math.abs(o[A])>=1e-15&&l++;const h=1e3,d=(n-s)/h,f=new Array(h).fill(0);for(let A=0;A<c;A++){const y=o[A];let x=Math.floor((y-s)/d);x=Math.min(x,h-1),f[x]++}const u=new Array(h).fill(0);u[0]=f[0];for(let A=1;A<h;A++)u[A]=u[A-1]+f[A];let m=Math.floor(i*c),p=0;for(;p<h&&!(u[p]>=m);)p++;const g=s;for(s=p*d+g,m=c-Math.floor((1-r)*l),p=0;p<h-1&&!(u[p+1]>=m);)p++;n=p*d+g;let b=1;return s!==n&&(b=(t-e)/(n-s)),V.info(" Rescale:  min: "+s+"  max: "+n+" scale: "+b),[s,b]}conformVox2Vox(a,e,t=256,i=1,r=!1){const s=e.flat(),n=Ct(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],s[8],s[9],s[10],s[11],s[12],s[13],s[14],s[15]),o=Be(a[1]/2,a[2]/2,a[3]/2,1),c=aa(),l=we();xt(l,n),it(c,o,l);const h=ee(c[0],c[1],c[2]),d=ee(i,i,i);let f=Ct(-1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1);r&&(f=Ct(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),xt(f,f);const u=Be(t,t,t,1),m=we();Vc(m,f,d);const p=Be(u[0],u[1],u[2],1);it(p,p,m),bf(p,p,.5);const g=Ce();Fe(g,h,ee(p[0],p[1],p[2]));const b=we();xt(b,m),b[3]=g[0],b[7]=g[1],b[11]=g[2];const A=we();bt(A,b);const y=we();sh(y,n,A);const x=we();return bt(x,y),[b,y,x]}async createNiftiArray(a=[256,256,256],e=[1,1,1],t=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],i=2,r=new Uint8Array){return await st.createNiftiArray(a,e,t,i,r)}async niftiArray2NVImage(a=new Uint8Array){return await st.loadFromUrl({url:a})}async loadFromUrl(a){return await st.loadFromUrl({url:a})}async conform(a,e=!1,t=!0,i=!1,r=!1){const o=this.conformVox2Vox(a.hdr.dims,a.hdr.affine.flat(),256,1,e),c=o[0],l=o[2],h=256*256*256,d=new Float32Array(h),f=new Float32Array(a.img),u=a.hdr.dims[1]*a.hdr.dims[2]*a.hdr.dims[3];if(a.hdr.scl_slope!==1||a.hdr.scl_inter!==0)for(let C=0;C<u;C++)f[C]=f[C]*a.hdr.scl_slope+a.hdr.scl_inter;const m=a.hdr.dims[1],p=a.hdr.dims[2],g=a.hdr.dims[3],b=m*p;let A=-1;function y(C,D,S){return C+D*m+S*b}const x=l[0],E=l[4],I=l[8];if(t)for(let C=0;C<256;C++)for(let D=0;D<256;D++){const S=D*l[1]+C*l[2]+l[3],k=D*l[5]+C*l[6]+l[7],F=D*l[9]+C*l[10]+l[11];for(let B=0;B<256;B++){const O=B*x+S,L=B*E+k,_=B*I+F,q=Math.floor(O),J=Math.floor(L),Z=Math.floor(_);if(A++,q<0||J<0||Z<0)continue;const Y=Math.ceil(O),W=Math.ceil(L),T=Math.ceil(_);if(Y>=m||W>=p||T>=g)continue;const ne=O-q,le=L-J,de=_-Z,Me=1-ne,Ne=1-le,ge=1-de,Ae=y(q,J,Z);let _e=0;_e+=f[Ae]*Me*Ne*ge,_e+=f[Ae+b]*Me*Ne*de,_e+=f[Ae+m]*Me*le*ge,_e+=f[Ae+m+b]*Me*le*de,_e+=f[Ae+1]*ne*Ne*ge,_e+=f[Ae+1+b]*ne*Ne*de,_e+=f[Ae+1+m]*ne*le*ge,_e+=f[Ae+1+m+b]*ne*le*de,d[A]=_e}}else for(let C=0;C<256;C++)for(let D=0;D<256;D++){const S=D*l[1]+C*l[2]+l[3],k=D*l[5]+C*l[6]+l[7],F=D*l[9]+C*l[10]+l[11];for(let B=0;B<256;B++){const O=Math.round(B*x+S),L=Math.round(B*E+k),_=Math.round(B*I+F);A++,!(O<0||L<0||_<0)&&(O>=m||L>=p||_>=g||(d[A]=f[y(O,L,_)]))}}let w=0;r&&(w=NaN);let v=new Uint8Array;if(i){const C=await this.getScale(a,0,1,w),D=await this.scalecropFloat32(d,0,1,C[0],C[1]);v=await this.createNiftiArray([256,256,256],[1,1,1],Array.from(c),16,new Uint8Array(D.buffer))}else{const C=await this.getScale(a,0,255,w),D=await this.scalecropUint8(d,0,255,C[0],C[1]);v=await this.createNiftiArray([256,256,256],[1,1,1],Array.from(c),2,D)}return await this.niftiArray2NVImage(v)}setRenderDrawAmbientOcclusion(a){if(!this.renderShader)throw new Error("renderShader undefined");this.renderDrawAmbientOcclusion=a,this.renderShader.use(this.gl),this.gl.uniform1fv(this.renderShader.uniforms.renderDrawAmbientOcclusion,[this.renderDrawAmbientOcclusion,1]),this.drawScene()}setColorMap(a,e){this.setColormap(a,e)}setColormapNegative(a,e){const t=this.getVolumeIndexByID(a);this.volumes[t].colormapNegative=e,this.updateGLVolume()}setModulationImage(a,e,t=0){const i=this.getVolumeIndexByID(a);let r=null;e.length>0&&(r=this.getVolumeIndexByID(e)),this.volumes[i].modulationImage=r,this.volumes[i].modulateAlpha=t,this.updateGLVolume()}setGamma(a=1){this.scene.gamma=a,Ie.gamma=a,this.updateGLVolume()}async loadDeferred4DVolumes(a){const e=this.getVolumeIndexByID(a),t=this.volumes[e];if(t.nTotalFrame4D<=t.nFrame4D)return;t.nTotalFrame4D=t.nFrame4D;let i;t.fileObject?i=await st.loadFromFile({file:t.fileObject}):i=await st.loadFromUrl({url:t.url}),i&&(t.img=i.img.slice(),t.nTotalFrame4D=i.nTotalFrame4D,t.nFrame4D=i.nFrame4D,this.updateGLVolume())}setFrame4D(a,e){const t=this.getVolumeIndexByID(a),i=this.volumes[t];e>i.nFrame4D-1&&(e=i.nFrame4D-1),e<0&&(e=0),e!==i.frame4D&&(i.frame4D=e,this.updateGLVolume(),this.onFrameChange(i,e),this.createOnLocationChange())}getFrame4D(a){const e=this.getVolumeIndexByID(a);return this.volumes[e].frame4D}colormapFromKey(a){return Ie.colormapFromKey(a)}colormap(a="",e=!1){return Ie.colormap(a,e)}createColormapTexture(a=null,e=0,t=256){return a!==null&&this.gl.deleteTexture(a),e<1||t<1?null:(a=this.gl.createTexture(),this.gl.activeTexture(Jr),this.gl.bindTexture(this.gl.TEXTURE_2D,a),this.gl.texStorage2D(this.gl.TEXTURE_2D,1,this.gl.RGBA8,t,e),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),a)}addColormapList(a="",e=NaN,t=NaN,i=!1,r=!1,s=!0,n=!1){a.length<1&&(s=!1),this.colormapLists.push({name:a,min:e,max:t,isColorbarFromZero:i,negative:r,visible:s,invert:n})}refreshColormaps(){if(this.colormapLists=[],this.volumes.length<1&&this.meshes.length<1)return;const a=this.volumes.length;if(a>0)for(let s=0;s<a;s++){const n=this.volumes[s],o=Gn(n.cal_min,n.cal_max,n.cal_minNeg,n.cal_maxNeg),c=n.colormapType!==0;this.addColormapList(n.colormapNegative,o[0],o[1],c,!0,n.colorbarVisible,n.colormapInvert),this.addColormapList(n.colormap,n.cal_min,n.cal_max,c,!1,n.colorbarVisible,n.colormapInvert)}const e=this.meshes.length;if(e>0)for(let s=0;s<e;s++){const n=this.meshes[s];if(!n.colorbarVisible)continue;const o=n.layers.length,c=n.fiberColor.toLowerCase();if(n.offsetPt0&&c.startsWith("dp")){let l=null;const h=parseInt(c.substring(3));c.startsWith("dpg")&&!n.fiberGroupColormap&&(l=h<n.dpg.length?n.dpg[h]:n.dpg[0]),c.startsWith("dps")&&(l=h<n.dps.length?n.dps[h]:n.dps[0]),c.startsWith("dpv")&&(l=h<n.dpv.length?n.dpv[h]:n.dpv[0]),l&&typeof n.colormap=="string"&&this.addColormapList(n.colormap,l.cal_min,l.cal_max,!1,!1,!0,n.colormapInvert)}if("edgeColormap"in n&&"edges"in n&&n.edges!==void 0){const l=Gn(n.edgeMin,n.edgeMax,NaN,NaN);this.addColormapList(n.edgeColormapNegative,l[0],l[1],!1,!0,!0,n.colormapInvert),this.addColormapList(n.edgeColormap,n.edgeMin,n.edgeMax,!1,!1,!0,n.colormapInvert)}if(!(o<1))for(let l=0;l<o;l++){const h=this.meshes[s].layers[l];if(!h.colorbarVisible||h.colormap.length<1)continue;const d=h.colormapType!==0;if(h.useNegativeCmap){const f=Gn(h.cal_min,h.cal_max,h.cal_minNeg,h.cal_maxNeg);this.addColormapList(h.colormapNegative,f[0],f[1],d,!0,!0,h.colormapInvert)}this.addColormapList(h.colormap,h.cal_min,h.cal_max,d,!1,!0,h.colormapInvert)}}const t=this.colormapLists.length;if(t<1)return;this.colormapTexture=this.createColormapTexture(this.colormapTexture,t+1);let i=new Uint8ClampedArray;function r(s){const n=new Uint8ClampedArray(i.length+s.length);n.set(i),n.set(s,i.length),i=n}for(let s=0;s<t;s++)r(Array.from(this.colormap(this.colormapLists[s].name,this.colormapLists[s].invert)));return r(Array.from(this.drawLut.lut)),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,256,t+1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,i),this}sliceScale(a=!1){var s;let e=this.screenFieldOfViewMM(0);a&&(e=this.screenFieldOfViewVox(0));const t=Math.max(e[0],Math.max(e[1],e[2])),i=[e[0]/t,e[1]/t,e[2]/t];if(!((s=this.back)!=null&&s.dims))throw new Error("back.dims undefined");const r=[this.back.dims[1],this.back.dims[2],this.back.dims[3]];return{volScale:i,vox:r,longestAxis:t,dimsMM:e}}tileIndex(a,e){for(let t=0;t<this.screenSlices.length;t++){const i=this.screenSlices[t].leftTopWidthHeight;if(a>i[0]&&e>i[1]&&a<i[0]+i[2]&&e<i[1]+i[3])return t}return-1}inRenderTile(a,e){const t=this.tileIndex(a,e);return t>=0&&this.screenSlices[t].axCorSag===4?t:-1}sliceScroll3D(a=0){if(a!==0){if(this.volumes.length>0&&this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex][0]<1.8){const e=this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex].slice();return a>0&&(e[0]=Math.min(1.5,e[0]+.025)),a<0&&(e[0]=Math.max(-1.5,e[0]-.025)),e[0]!==this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex][0]?(this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex]=e,this.setClipPlane(this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex])):void 0}a>0&&(this.scene.volScaleMultiplier=Math.min(2,this.scene.volScaleMultiplier*1.1)),a<0&&(this.scene.volScaleMultiplier=Math.max(.5,this.scene.volScaleMultiplier*.9)),this.drawScene()}}inGraphTile(a,e){if(this.graph.opacity<=0||this.volumes.length<1||this.volumes[0].nFrame4D<1||!this.graph.plotLTWH||this.graph.plotLTWH[2]<1||this.graph.plotLTWH[3]<1)return!1;const t=[(a-this.graph.LTWH[0])/this.graph.LTWH[2],(e-this.graph.LTWH[1])/this.graph.LTWH[3]];return t[0]>0&&t[1]>0&&t[0]<=1&&t[1]<=1}updateBitmapFromClickToSegment(){if(this.clickToSegmentGrowingBitmap===null||this.drawBitmap===null||this.clickToSegmentGrowingBitmap.length!==this.drawBitmap.length)return;const a=this.drawBitmap.length;for(let e=0;e<a;e++)this.drawBitmap[e]=this.clickToSegmentGrowingBitmap[e]}sumBitmap(a){let e=0;for(let t=0;t<a.length;t++)e+=a[t];return e}doClickToSegment(a){const{tileIndex:e}=a;if(e<0||e>=this.screenSlices.length){V.warn(`Invalid tileIndex ${e} received in doClickToSegment.`);return}const t=this.screenSlices[e].axCorSag;if(t>2){V.warn("ClickToSegment attempted on non-2D slice tile.");return}const i=this.screenXY2TextureFrac(this.clickToSegmentXY[0],this.clickToSegmentXY[1],e,!1);if(i[0]<0){V.debug("Click location outside valid texture fraction for the tile.");return}const r=this.frac2vox(i),s=this.opts.clickToSegmentPercent;let n=this.back.getValue(r[0],r[1],r[2]);this.opts.clickToSegmentAutoIntensity&&(s!==0&&(n===0&&(n=.01),this.opts.clickToSegmentIntensityMax=n*(1+s),this.opts.clickToSegmentIntensityMin=n*(1-s)),n>(this.back.cal_min+this.back.cal_max)*.5?this.opts.clickToSegmentBright=!0:this.opts.clickToSegmentBright=!1);const o=this.opts.clickToSegmentBright?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;this.drawPenAxCorSag=t;const c=this.clickToSegmentIsGrowing?this.clickToSegmentGrowingBitmap:this.drawBitmap;if(!c){if(V.error("Target bitmap for flood fill is null."),this.clickToSegmentIsGrowing){if(this.drawBitmap||this.createEmptyDrawing(),!this.drawBitmap)return;this.clickToSegmentGrowingBitmap=this.drawBitmap.slice()}else if(this.createEmptyDrawing(),!this.drawBitmap)return;V.warn("Initialized missing bitmap in doClickToSegment.")}if(this.drawFloodFill([r[0],r[1],r[2]],this.opts.penValue,o,this.opts.clickToSegmentIntensityMin,this.opts.clickToSegmentIntensityMax,this.opts.floodFillNeighbors,this.opts.clickToSegmentMaxDistanceMM,this.opts.clickToSegmentIs2D,c),!this.clickToSegmentIsGrowing&&(V.debug("Applying clickToSegment mask to drawBitmap."),this.drawBitmap?(this.refreshDrawing(!1,!1),this.drawScene()):V.error("Cannot refresh drawing after click-to-segment apply, drawBitmap is null."),this.drawBitmap)){const l=this.getDescriptives({layer:0,masks:[],drawingIsMask:!0});this.onClickToSegment({mL:l.volumeML,mm3:l.volumeMM3})}this.createOnLocationChange(t)}mouseClick(a,e,t=0,i=!0){if(a*=this.uiData.dpr,e*=this.uiData.dpr,this.canvas.focus(),this.thumbnailVisible){this.thumbnailVisible=!1,Promise.all([this.loadVolumes(this.deferredVolumes),this.loadMeshes(this.deferredMeshes)]).catch(r=>{throw r});return}if(this.inGraphTile(a,e)){if(!this.graph.plotLTWH)throw new Error("plotLTWH undefined");const r=[(a-this.graph.plotLTWH[0])/this.graph.plotLTWH[2],(e-this.graph.plotLTWH[1])/this.graph.plotLTWH[3]];if(r[0]>0&&r[1]>0&&r[0]<=1&&r[1]<=1){const s=Math.round(r[0]*(this.volumes[0].nFrame4D-1));this.setFrame4D(this.volumes[0].id,s);return}r[0]>.5&&r[1]>1&&this.loadDeferred4DVolumes(this.volumes[0].id).catch(s=>{throw s});return}if(this.inRenderTile(a,e)>=0){this.sliceScroll3D(t),this.drawScene();return}if(!(this.screenSlices.length<1||this.gl.canvas.height<1||this.gl.canvas.width<1))for(let r=0;r<this.screenSlices.length;r++){const s=this.screenSlices[r].axCorSag;if(this.drawPenAxCorSag>=0&&this.drawPenAxCorSag!==s||s>2&&!this.opts.clickToSegment&&t===0)continue;const n=this.screenXY2TextureFrac(a,e,r,!0);if(!(n[0]<0)){if(t!==0||!i){if(!i){s<=2&&(this.scene.crosshairPos[2-s]=t,this.drawScene(),this.createOnLocationChange(s));return}const o=t<0?-1:1,c=[0,0,0];s<=2&&(c[2-s]=o,this.moveCrosshairInVox(c[0],c[1],c[2]));return}if(this.opts.isForceMouseClickToVoxelCenters?this.scene.crosshairPos=Nt(this.vox2frac(this.frac2vox(n))):this.scene.crosshairPos=Nt(n),this.opts.drawingEnabled){const o=this.frac2vox(this.scene.crosshairPos);if(!isFinite(this.opts.penValue)||this.opts.penValue<0||Object.is(this.opts.penValue,-0)){let c=0,l=Math.abs(this.opts.penValue);const h=!0;Object.is(this.opts.penValue,-0)?(c=0,l=0,V.debug("Erase Cluster selected")):(c=this.opts.penValue,V.debug("Intensity Grow selected",c)),this.drawFloodFill(o,l,c,NaN,NaN,this.opts.floodFillNeighbors,Number.POSITIVE_INFINITY,!1,this.drawBitmap,h),this.drawScene(),this.createOnLocationChange(s);return}else if(this.opts.clickToSegment){s<=2&&(this.clickToSegmentIsGrowing=!1,this.doClickToSegment({x:this.clickToSegmentXY[0],y:this.clickToSegmentXY[1],tileIndex:r})),this.createOnLocationChange(s);return}else if(this.opts.penType===0){if(isNaN(this.drawPenLocation[0]))this.drawPenAxCorSag=s,this.drawPenFillPts=[],this.drawPt(...o,this.opts.penValue);else{if(o[0]===this.drawPenLocation[0]&&o[1]===this.drawPenLocation[1]&&o[2]===this.drawPenLocation[2]){this.drawScene(),this.createOnLocationChange(s);return}this.drawPenLine(o,this.drawPenLocation,this.opts.penValue)}this.drawPenLocation=o,this.opts.isFilledPen&&this.drawPenFillPts.push(o),this.refreshDrawing(!1,!1)}else(this.opts.penType===1||this.opts.penType===2)&&(isNaN(this.drawShapeStartLocation[0])?(this.drawPenAxCorSag=s,this.drawShapeStartLocation=[...o],this.drawBitmap&&(this.drawShapePreviewBitmap=this.drawBitmap.slice())):this.drawShapePreviewBitmap&&this.drawBitmap&&(this.drawBitmap.set(this.drawShapePreviewBitmap),this.opts.penType===1?this.drawRectangleMask(this.drawShapeStartLocation,o,this.opts.penValue):this.opts.penType===2&&this.drawEllipseMask(this.drawShapeStartLocation,o,this.opts.penValue),this.refreshDrawing(!1,!1)))}this.drawScene(),this.createOnLocationChange(s);return}}}drawRuler(){let a=[],e=[];for(let b=0;b<this.screenSlices.length;b++)if(this.screenSlices[b].axCorSag!==4&&this.screenSlices[b].fovMM.length>1){e=this.screenSlices[b].leftTopWidthHeight,a=this.screenSlices[b].fovMM;break}if(e.length<4)return;const[t,i,r,s]=this.getBoundsRegion(),o=100/a[0]*e[2],c=Math.max(Math.round(o*.1),2),l=Number(this.opts.rulerWidth),h=Math.floor(e[0]+.5*e[2]-.5*o),d=Math.floor(e[1]+e[3]-c)+.5*l,f=Math.max(t,h),u=Math.min(t+r,h+o),m=Math.min(i+s,d);if(u<=f)return;const p=[f,m,u,m];let g=[0,0,0,1];this.opts.rulerColor[0]+this.opts.rulerColor[1]+this.opts.rulerColor[2]<.8&&(g=[1,1,1,1]),this.drawRuler10cm(p,g,l+1),this.drawRuler10cm(p,this.opts.rulerColor,l)}drawRuler10cm(a,e,t=1){if(!this.lineShader)throw new Error("lineShader undefined");this.gl.bindVertexArray(this.genericVAO),this.lineShader.use(this.gl),this.gl.uniform4fv(this.lineShader.uniforms.lineColor,e),this.gl.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.lineShader.uniforms.thickness,t),this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,a),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4);const i=-.1*(a[0]-a[2]),r=a[1]-Math.floor(.5*this.opts.rulerWidth),s=Math.floor(r-.35*i),n=Math.floor(r-.7*i);for(let o=0;o<11;o++){let c=a[0]+o*i;c=Math.max(c,a[0]+.5*t),c=Math.min(c,a[2]-.5*t);const l=[c,r,c,s];o%5===0&&(l[3]=n),this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,l),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}this.gl.bindVertexArray(this.unusedVAO)}screenXY2mm(a,e,t=-1){let i;for(let r=0;r<this.screenSlices.length;r++){let s=r;if(t>=0&&(s=t),this.screenSlices[s].axCorSag>2)continue;const o=this.screenSlices[s].leftTopWidthHeight;if(a<o[0]||e<o[1]||a>o[0]+o[2]||e>o[1]+o[3]||(i=this.screenXY2TextureFrac(a,e,s,!1),i[0]<0))continue;const c=this.frac2mm(i);return Be(c[0],c[1],c[2],s)}return Be(NaN,NaN,NaN,NaN)}dragForPanZoom(a){const e=this.screenXY2mm(a[2],a[3]);if(isNaN(e[0]))return;const t=this.screenXY2mm(a[0],a[1],e[3]);if(isNaN(t[0])||isNaN(e[0])||isNaN(e[3]))return;const i=aa(),r=this.uiData.pan2DxyzmmAtMouseDown[3];pf(i,e,t),this.scene.pan2Dxyzmm[0]=this.uiData.pan2DxyzmmAtMouseDown[0]+r*i[0],this.scene.pan2Dxyzmm[1]=this.uiData.pan2DxyzmmAtMouseDown[1]+r*i[1],this.scene.pan2Dxyzmm[2]=this.uiData.pan2DxyzmmAtMouseDown[2]+r*i[2],this.canvas.focus()}dragForCenterButton(a){this.dragForPanZoom(a)}dragForSlicer3D(a){let e=this.uiData.pan2DxyzmmAtMouseDown[3];const t=a[3]-a[1];e+=t*.01,e=Math.max(e,.1),e=Math.min(e,10);const r=this.scene.pan2Dxyzmm[3]-e;this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=e),this.scene.pan2Dxyzmm[3]=e;const s=this.frac2mm(this.scene.crosshairPos);this.scene.pan2Dxyzmm[0]+=r*s[0],this.scene.pan2Dxyzmm[1]+=r*s[1],this.scene.pan2Dxyzmm[2]+=r*s[2]}drawMeasurementTool(a,e=!0){function t(l,h,d,f,u){const m=l-d,p=h-f;if(m===0&&p===0)return{origin:[d+u,f],terminus:[d+u,f]};const g=Math.sqrt(m*m+p*p),b=u*m/g,A=u*p/g;return{origin:[l+b,h+A],terminus:[d-b,f-A]}}const i=this.gl;if(i.viewport(0,0,i.canvas.width,i.canvas.height),i.bindVertexArray(this.genericVAO),i.depthFunc(i.ALWAYS),i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),!this.lineShader)throw new Error("lineShader undefined");this.lineShader.use(this.gl),i.uniform4fv(this.lineShader.uniforms.lineColor,this.opts.rulerColor),i.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[i.canvas.width,i.canvas.height]),i.uniform1f(this.lineShader.uniforms.thickness,this.opts.rulerWidth),i.uniform4fv(this.lineShader.uniforms.startXYendXY,a),i.drawArrays(i.TRIANGLE_STRIP,0,4);const r=this.opts.measureLineColor;r[3]=1,i.uniform4fv(this.lineShader.uniforms.lineColor,r);const s=this.opts.rulerWidth;i.uniform1f(this.lineShader.uniforms.thickness,s*2);let n=[a[0],a[1]-s,a[0],a[1]+s];i.uniform4fv(this.lineShader.uniforms.startXYendXY,n),i.drawArrays(i.TRIANGLE_STRIP,0,4),n=[a[2],a[3]-s,a[2],a[3]+s],i.uniform4fv(this.lineShader.uniforms.startXYendXY,n),i.drawArrays(i.TRIANGLE_STRIP,0,4);let o=this.canvasPos2frac([a[0],a[1]]),c=this.canvasPos2frac([a[2],a[3]]);if(o[0]>=0&&c[0]>=0){const l=this.frac2mm(o);o=ee(l[0],l[1],l[2]);const h=this.frac2mm(c);c=ee(h[0],h[1],h[2]);const d=Ce();zc(d,o,c);const f=fs(d);let u=2;f>9&&(u=1),f>99&&(u=0);let m=f.toFixed(u);this.opts.showMeasureUnits&&(m=`${m} mm`);let p=a;const[g,b,A,y]=a,{origin:x,terminus:E}=t(g,b,A,y,30);switch(this.opts.measureTextJustify){case"start":p=[...x,...x.map(I=>I+1)];break;case"end":p=p=[...E,...E.map(I=>I+1)];break;default:p=a;break}e&&this.drawTextBetween(p,m,this.opts.measureTextHeight/.06,this.opts.measureTextColor)}i.bindVertexArray(this.unusedVAO)}drawAngleMeasurementTool(){this.uiData.angleState==="drawing_first_line"?this.drawMeasurementTool([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]],!1):this.uiData.angleState==="drawing_second_line"&&(this.drawMeasurementTool(this.uiData.angleFirstLine,!1),this.drawMeasurementTool([this.uiData.angleFirstLine[2],this.uiData.angleFirstLine[3],this.uiData.dragEnd[0],this.uiData.dragEnd[1]],!1),this.drawAngleText())}drawAngleText(){const a=this.uiData.angleFirstLine,e=[this.uiData.angleFirstLine[2],this.uiData.angleFirstLine[3],this.uiData.dragEnd[0],this.uiData.dragEnd[1]],t=this.calculateAngleBetweenLines(a,e),i=this.uiData.angleFirstLine[2],r=this.uiData.angleFirstLine[3],s=`${t.toFixed(1)}`;this.drawTextBetween([i,r,i+1,r+1],s,this.opts.measureTextHeight/.06,this.opts.measureTextColor)}drawAngleTextForAngle(a){const e=this.calculateAngleBetweenLines(a.firstLine,a.secondLine),t=a.firstLine[2],i=a.firstLine[3],r=`${e.toFixed(1)}`;this.drawTextBetween([t,i,t+1,i+1],r,this.opts.measureTextHeight/.06,this.opts.measureTextColor)}calculateAngleBetweenLines(a,e){const t=a[2],i=a[3],r=a[0]-t,s=a[1]-i,n=e[2]-t,o=e[3]-i,c=r*n+s*o,l=Math.sqrt(r*r+s*s),h=Math.sqrt(n*n+o*o);if(l===0||h===0)return 0;const d=Math.max(-1,Math.min(1,c/(l*h)));return Math.acos(d)*(180/Math.PI)}resetAngleMeasurement(){this.uiData.angleState="none",this.uiData.angleFirstLine=[0,0,0,0]}getCurrentSliceInfo(){const a=this.tileIndex(this.uiData.dragStart[0],this.uiData.dragStart[1]);if(a>=0&&a<this.screenSlices.length){const i=this.screenSlices[a].axCorSag;let r=0;return i===0?r=this.scene.crosshairPos[2]:i===1?r=this.scene.crosshairPos[1]:i===2&&(r=this.scene.crosshairPos[0]),{sliceIndex:a,sliceType:i,slicePosition:r}}const e=this.opts.sliceType;let t=0;return e===0?t=this.scene.crosshairPos[2]:e===1?t=this.scene.crosshairPos[1]:e===2?t=this.scene.crosshairPos[0]:e===3&&this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]])[0]>=0&&(t=this.scene.crosshairPos[2]),{sliceIndex:-1,sliceType:e,slicePosition:t}}getCurrentSlicePosition(a){return a===0?this.scene.crosshairPos[2]:a===1?this.scene.crosshairPos[1]:a===2?this.scene.crosshairPos[0]:0}shouldDrawOnCurrentSlice(a,e,t){if(this.opts.sliceType===3){if(e>2)return!1;for(let o=0;o<this.screenSlices.length;o++)if(this.screenSlices[o].axCorSag===e){const c=this.getCurrentSlicePosition(e);if(Math.abs(c-t)<.001)return!0}return!1}else if(this.opts.sliceType!==e)return!1;const i=this.getCurrentSlicePosition(e);return Math.abs(i-t)<.001}clearMeasurements(){this.document.completedMeasurements=[],this.drawScene()}clearAngles(){this.document.completedAngles=[],this.drawScene()}clearAllMeasurements(){this.document.completedMeasurements=[],this.document.completedAngles=[],this.drawScene()}setDragMode(a){if(typeof a=="string")switch(a){case"none":this.opts.dragMode=0;break;case"contrast":this.opts.dragMode=1;break;case"measurement":this.opts.dragMode=2;break;case"angle":this.opts.dragMode=7;break;case"pan":this.opts.dragMode=3;break;case"slicer3D":this.opts.dragMode=4;break;case"callbackOnly":this.opts.dragMode=5;break;case"roiSelection":this.opts.dragMode=6;break;default:console.warn(`Unknown drag mode: ${a}`);return}else this.opts.dragMode=a;this.opts.dragMode!==7&&this.resetAngleMeasurement(),this.clearActiveDragMode()}setMouseEventConfig(a){this.opts.mouseEventConfig=a,this.clearActiveDragMode()}setTouchEventConfig(a){this.opts.touchEventConfig=a,this.clearActiveDragMode()}getMouseEventConfig(){return this.opts.mouseEventConfig}getTouchEventConfig(){return this.opts.touchEventConfig}drawRect(a,e=[1,0,0,-1]){if(e[3]<0&&(e=this.opts.crosshairColor),!this.rectShader)throw new Error("rectShader undefined");this.gl.disable(this.gl.CULL_FACE),this.opts.selectionBoxIsOutline?(this.drawCircle(a,e,.1),this.rectOutlineShader.use(this.gl),this.gl.enable(this.gl.BLEND),this.gl.uniform1f(this.rectOutlineShader.uniforms.thickness,this.opts.selectionBoxLineThickness),this.gl.uniform4fv(this.rectOutlineShader.uniforms.lineColor,e),this.gl.uniform2fv(this.rectOutlineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform4f(this.rectOutlineShader.uniforms.leftTopWidthHeight,a[0],a[1],a[2],a[3]),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)):(this.rectShader.use(this.gl),this.gl.enable(this.gl.BLEND),this.gl.uniform4fv(this.rectShader.uniforms.lineColor,e),this.gl.uniform2fv(this.rectShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform4f(this.rectShader.uniforms.leftTopWidthHeight,a[0],a[1],a[2],a[3]),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO))}drawBoundsBox(a,e,t=2){if(!this.rectOutlineShader)throw new Error("rectOutlineShader undefined");const i=this.gl,[r,s,n,o]=a;i.viewport(0,0,i.canvas.width,i.canvas.height),this.rectOutlineShader.use(i),i.enable(i.BLEND),i.uniform1f(this.rectOutlineShader.uniforms.thickness,t),i.uniform4fv(this.rectOutlineShader.uniforms.lineColor,e),i.uniform2fv(this.rectOutlineShader.uniforms.canvasWidthHeight,[i.canvas.width,i.canvas.height]),i.uniform4f(this.rectOutlineShader.uniforms.leftTopWidthHeight,r,s,n,o),i.bindVertexArray(this.genericVAO),i.drawArrays(i.TRIANGLE_STRIP,0,4),i.bindVertexArray(this.unusedVAO)}drawCircle(a,e=this.opts.fontColor,t=1){if(!this.circleShader)throw new Error("circleShader undefined");this.circleShader.use(this.gl),this.gl.enable(this.gl.BLEND),this.gl.uniform4fv(this.circleShader.uniforms.circleColor,e),this.gl.uniform2fv(this.circleShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform4f(this.circleShader.uniforms.leftTopWidthHeight,a[0],a[1],a[2],a[3]),this.gl.uniform1f(this.circleShader.uniforms.fillPercent,t),this.gl.uniform4fv(this.circleShader.uniforms.circleColor,e),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}drawSelectionBox(a){if(this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.getCurrentDragMode()===6){this.drawCircle(a,this.opts.selectionBoxColor,.1);return}this.drawRect(a,this.opts.selectionBoxColor)}effectiveCanvasHeight(){let a=this.gl.canvas.height;if(this.opts.bounds){const[[,e],[,t]]=this.opts.bounds,i=Math.round(e*this.gl.canvas.height);a=Math.round(t*this.gl.canvas.height)-i}return a-this.colorbarHeight}effectiveCanvasWidth(){let a=this.gl.canvas.width;if(this.opts.bounds){const[[e],[t]]=this.opts.bounds;a=Math.round((t-e)*this.gl.canvas.width)}return a-this.getLegendPanelWidth()}getAllLabels(){const i=this.meshes.filter(s=>s.type==="connectome").flatMap(s=>s.nodes).map(s=>s.label).filter(s=>s!==void 0);return[...this.document.labels,...i]}getConnectomeLabels(){const i=this.meshes.filter(o=>o.type==="connectome"&&o.showLegend!==!1).flatMap(o=>o.nodes).map(o=>o.label).filter(o=>o!==void 0&&o.text!==""),r=this.document.labels.filter(o=>o.anchor==null||o.anchor===0),s=new Set(i);for(const o of r)s.add(o);const n=this.meshes.filter(o=>o.type==="mesh");for(let o=0;o<n.length;o++)for(let c=0;c<n[o].layers.length;c++)if(n[o].layers[c].labels)for(let l=0;l<n[o].layers[c].labels.length;l++)s.add(n[o].layers[c].labels[l]);return Array.from(s)}getBulletMarginWidth(){let a=0;const e=this.getConnectomeLabels();if(e.length===0)return 0;const t=e.length===1?e[0].style.bulletScale:e.reduce((s,n)=>s.style.bulletScale>n.style.bulletScale?s:n).style.bulletScale,i=e.length===1?e[0]:e.reduce((s,n)=>{const o=this.fontPx*s.style.textScale,c=this.fontPx*n.style.textScale;return this.textHeight(o,s.text)>this.textHeight(c,n.text)?s:n}),r=this.fontPx*i.style.textScale;return a=this.textHeight(r,i.text)*t,a+=r,a}getLegendPanelWidth(){const a=this.getConnectomeLabels();if(!this.opts.showLegend||a.length===0)return 0;const t=this.fontPx*1;let i=0;const r=a.reduce((c,l)=>{const h=this.fontPx*c.style.textScale,d=this.fontPx*l.style.textScale;return this.textWidth(h,c.text)>this.textWidth(d,l.text)?c:l}),s=this.fontPx*r.style.textScale,n=this.textWidth(s,r.text),o=this.getBulletMarginWidth();return n&&(i=o+n,i+=t*2),i>=this.gl.canvas.width?0:i}getLegendPanelHeight(a=1){const e=this.getConnectomeLabels();let t=0;const i=this.fontPx;for(const r of e){const s=this.fontPx*r.style.textScale*a,n=this.textHeight(s,r.text);t+=n}return t&&(t+=i/2*(e.length+1)*a),t}reserveColorbarPanel(){const a=3*this.fontPx;if(a<0)return[0,0,0,0];const[e,t,i,r]=this.getBoundsRegion(),n=(this.opts.colorbarWidth>0&&this.opts.colorbarWidth<=1?this.opts.colorbarWidth:1)*i,o=[e+(i-n)/2,t+r-a,n,a];return this.colorbarHeight=o[3]+1,o}drawColorbarCore(a=0,e=[0,0,0,0],t=!1,i=0,r=1,s){if(e[2]<=0||e[3]<=0)return;const n=this.fontPx;if(n<=0)return;this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);let o=n;const c=3*n;let l=n;if(e[3]<c){if(e[3]<3)return;o=1,l=e[3]-2}this.gl.disable(this.gl.DEPTH_TEST),this.colorbarHeight=e[3]+1;const h=[e[0]+o,e[1],e[2]-2*o,l],d=[h[0]-1,h[1]-1,h[2]+2,h[3]+2];if(this.opts.showColorbarBorder&&this.drawRect(d,this.opts.crosshairColor),!this.colorbarShader)throw new Error("colorbarShader undefined");this.colorbarShader.use(this.gl),this.gl.activeTexture(Jr),this.gl.bindTexture(this.gl.TEXTURE_2D,this.colormapTexture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST);const f=a;if(this.gl.uniform1f(this.colorbarShader.uniforms.layer,f),this.gl.uniform2fv(this.colorbarShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.disable(this.gl.CULL_FACE),t){const I=[h[0]+h[2],h[1],-h[2],h[3]];this.gl.uniform4fv(this.colorbarShader.uniforms.leftTopWidthHeight,I)}else this.gl.uniform4fv(this.colorbarShader.uniforms.leftTopWidthHeight,h);this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);let u=0;if(s&&r<0&&t?(u=r,r=0):s&&i>0&&(u=i,i=0),i===r||n<1)return;const m=Math.abs(r-i);let[p,g]=El(i,r);g<i&&(g+=p);function b(I){return I.toFixed(6).replace(/\.?0*$/,"")}let A=g;const y=[0,h[1]+h[3]-n*.5,2,n*.75],x=y[1]+y[3],E=1;for(;A<=r;){y[0]=h[0]+(A-i)/m*h[2],this.drawRect(y);const I=b(E*A);this.drawTextBelow([y[0],x],I),A+=p}if(u!==0){const I=[h[0]+(u-i)/m*h[2],h[1]-h[3]*.25,2,h[3]*1.5];this.drawRect(I)}}drawColorbar(){const a=this.colormapLists,e=a.length;if(e<1)return;let t=0;for(let n=0;n<e;n++)a[n].visible&&t++;if(t<1)return;let i=this.reserveColorbarPanel();const r=3*this.fontPx;if(r<0)return;let s=i[2]/t;(i[2]<=0||i[3]<=0)&&(s=this.gl.canvas.width/t,i=[0,this.gl.canvas.height-r,s,r]),i[2]=s;for(let n=0;n<e;n++)a[n].visible&&(this.drawColorbarCore(n,i,a[n].negative,a[n].min,a[n].max,a[n].isColorbarFromZero),i[0]+=s)}textWidth(a,e){if(!e)return 0;let t=0;const i=new TextEncoder().encode(e);for(let r=0;r<e.length;r++)t+=a*this.fontMets.mets[i[r]].xadv;return t}textHeight(a,e){if(!e)return 0;const t=new Set(Array.from(e)),i=new TextEncoder().encode(Array.from(t).join("")),s=Object.values(this.fontMets.mets).filter((n,o)=>i.includes(o)).reduce((n,o)=>n.lbwh[3]>o.lbwh[3]?n:o).lbwh[3];return a*s}drawChar(a,e,t){if(!this.fontShader)throw new Error("fontShader undefined");const i=this.fontMets.mets[t],r=a[0]+e*i.lbwh[0],s=-(e*i.lbwh[1]),n=e*i.lbwh[2],o=e*i.lbwh[3],c=a[1]+(s-o)+e;return this.gl.uniform4f(this.fontShader.uniforms.leftTopWidthHeight,r,c,n,o),this.gl.uniform4fv(this.fontShader.uniforms.uvLeftTopWidthHeight,i.uv_lbwh),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),e*i.xadv}drawLoadingText(a){if(!a)return;if(!this.canvas)throw new Error("canvas undefined");const[e,t,i,r]=this.getBoundsRegion();this.gl.viewport(e,t,i,r),this.gl.enable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND);const s=e+i/2,n=t+r/2;this.drawTextBelow([s,n],a,3)}drawText(a,e,t=1,i=null){if(this.fontPx<=0)return;if(!this.fontShader)throw new Error("fontShader undefined");this.fontShader.use(this.gl);const r=this.fontPx*t;this.gl.enable(this.gl.BLEND),this.gl.uniform2f(this.fontShader.uniforms.canvasWidthHeight,this.gl.canvas.width,this.gl.canvas.height),i===null&&(i=this.opts.fontColor),this.gl.uniform4fv(this.fontShader.uniforms.fontColor,i);let s=r/this.fontMets.size*this.fontMets.distanceRange;s=Math.max(s,1),this.gl.uniform1f(this.fontShader.uniforms.screenPxRange,s);const n=new TextEncoder().encode(e);this.gl.bindVertexArray(this.genericVAO);for(let o=0;o<e.length;o++)a[0]+=this.drawChar(a,r,n[o]);this.gl.bindVertexArray(this.unusedVAO)}drawTextRight(a,e,t=1,i=null){this.fontPx<=0||(a[1]-=.5*this.fontPx,this.drawText(a,e,t,i))}drawTextLeft(a,e,t=1,i=null){if(this.fontPx<=0)return;const r=this.fontPx*t;a[0]-=this.textWidth(r,e),a[1]-=.5*r,this.drawText(a,e,t,i)}drawTextRightBelow(a,e,t=1,i=null){this.fontPx<=0||this.drawText(a,e,t,i)}drawTextBetween(a,e,t=1,i=null){if(this.fontPx<=0)return;const r=[(a[0]+a[2])*.5,(a[1]+a[3])*.5],s=this.fontPx*t,n=this.textWidth(s,e);r[0]-=.5*n,r[1]-=.5*s;const o=[r[0]-1,r[1]-1,n+2,s+2];let c=i;c===null&&(c=this.opts.crosshairColor),c&&c[0]+c[1]+c[2]>.8?c=[0,0,0,.5]:c=[1,1,1,.5],this.drawRect(o,c),this.drawText(r,e,t,i)}drawTextBelow(a,e,t=1,i=null){if(this.fontPx<=0)return;if(!this.canvas)throw new Error("canvas undefined");let r=this.fontPx*t,s=this.textWidth(r,e);s>this.canvas.width&&(t*=(this.canvas.width-2)/s,r=this.fontPx*t,s=this.textWidth(r,e)),a[0]-=.5*this.textWidth(r,e),a[0]=Math.max(a[0],1),a[0]=Math.min(a[0],this.canvas.width-s-1),this.drawText(a,e,t,i)}drawTextAbove(a,e,t=1,i=null){if(this.fontPx<=0)return;if(!this.canvas)throw new Error("canvas undefined");let r=this.fontPx*t,s=this.textWidth(r,e);s>this.canvas.width&&(t*=(this.canvas.width-2)/s,r=this.fontPx*t,s=this.textWidth(r,e)),a[0]-=.5*this.textWidth(r,e),a[0]=Math.max(a[0],1),a[0]=Math.min(a[0],this.canvas.width-s-1),a[1]-=r,this.drawText(a,e,t,i)}updateInterpolation(a,e=!1){let t=this.gl.LINEAR;!e&&this.opts.isNearestInterpolation&&(t=this.gl.NEAREST),a===0?this.gl.activeTexture(Ma):this.gl.activeTexture(Ws),this.opts.is2DSliceShader?(this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,t),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,t)):(this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,t),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,t))}setAtlasOutline(a){this.opts.atlasOutline=a,this.updateGLVolume(),this.drawScene()}setInterpolation(a){this.opts.isNearestInterpolation=a;const e=this.volumes.length;if(!(e<1)){for(let t=0;t<e;t++)this.updateInterpolation(t);this.drawScene()}}calculateMvpMatrix2D(a,e,t,i=1/0,r=0,s=0,n=0,o=!1){this.gl.viewport(a[0],this.gl.canvas.height-(a[1]+a[3]),a[2],a[3]);let l=e[0],h=t[0],d=[l,e[1]],f=[h-l,t[1]-e[1]];o&&(d=[t[0],e[1]],f=[e[0]-t[0],t[1]-e[1]],l=-t[0],h=-e[0]);const u=2*Math.max(Math.abs(e[2]),Math.abs(t[2])),m=we();let p=.01,g=u*8;if(i!==1/0){let I=o;n===0&&(s===0||s===180)&&(I=!I);let w=u*1.8-r;I||(w=u*1.8+r),g=w-i,p=w+i}Os(m,l,h,e[1],t[1],g,p);const b=we();b[0]=-1;const A=ee(0,0,-u*1.8);qa(b,b,A),Bs(b,b,la(270-n)),Ps(b,b,la(s-180));const y=we();bt(y,b);const x=we();xt(x,y);const E=we();return Da(E,m,b),{modelViewProjectionMatrix:E,modelMatrix:b,normalMatrix:x,leftTopMM:d,fovMM:f}}swizzleVec3MM(a,e){return e===1?a=Le(a,[0,2,1]):e===2&&(a=Le(a,[1,2,0])),a}screenFieldOfViewVox(a=0){const e=Nt(this.volumeObject3D.fieldOfViewDeObliqueMM);return this.swizzleVec3MM(e,a)}screenFieldOfViewMM(a=0,e=!1){if(this.volumes.length<1){let o=ee(this.extentsMin[0],this.extentsMin[1],this.extentsMin[2]),c=ee(this.extentsMax[0],this.extentsMax[1],this.extentsMax[2]);o=this.swizzleVec3MM(o,a),c=this.swizzleVec3MM(c,a);const l=Ce();return Fe(l,c,o),l}if(!e&&!this.opts.isSliceMM)return this.screenFieldOfViewVox(a);const t=this.volumeObject3D.extentsMin,i=this.volumeObject3D.extentsMax;let r=ee(t[0],t[1],t[2]),s=ee(i[0],i[1],i[2]);r=this.swizzleVec3MM(r,a),s=this.swizzleVec3MM(s,a);const n=Ce();return Fe(n,s,r),n}screenFieldOfViewExtendedVox(a=0){const e=this.volumes[0].extentsMinOrtho,t=this.volumes[0].extentsMaxOrtho;let i=ee(e[0],e[1],e[2]),r=ee(t[0],t[1],t[2]);const s=we();i=this.swizzleVec3MM(i,a),r=this.swizzleVec3MM(r,a);const n=Ce();return Fe(n,r,i),{mnMM:i,mxMM:r,rotation:s,fovMM:n}}screenFieldOfViewExtendedMM(a=0){if(this.volumes.length<1){let o=ee(this.extentsMin[0],this.extentsMin[1],this.extentsMin[2]),c=ee(this.extentsMax[0],this.extentsMax[1],this.extentsMax[2]);const l=we();o=this.swizzleVec3MM(o,a),c=this.swizzleVec3MM(c,a);const h=Ce();return Fe(h,c,o),{mnMM:o,mxMM:c,rotation:l,fovMM:h}}if(!this.volumeObject3D)throw new Error("volumeObject3D undefined");const e=this.volumeObject3D.extentsMin,t=this.volumeObject3D.extentsMax;let i=ee(e[0],e[1],e[2]),r=ee(t[0],t[1],t[2]);const s=we();i=this.swizzleVec3MM(i,a),r=this.swizzleVec3MM(r,a);const n=Ce();return Fe(n,r,i),{mnMM:i,mxMM:r,rotation:s,fovMM:n}}drawSliceOrientationText(a,e,t=[NaN,NaN]){this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);let i="S";e===0&&(i="A");let r=this.opts.isRadiologicalConvention?"R":"L";e===2&&(r=this.opts.sagittalNoseLeft?"A":"P");let s="I";e===0&&(s="P");let n=this.opts.isRadiologicalConvention?"L":"R";if(e===2&&(n=this.opts.sagittalNoseLeft?"P":"A"),this.opts.isCornerOrientationText){this.drawTextRightBelow([a[0],a[1]],r+i);return}let o=!0,c=!0;const l=this.opts.showAllOrientationMarkers,h=this.opts.showAllOrientationMarkers;if(!isNaN(t[0])){const d=this.fontPx+2;t[1]>d&&(this.drawTextBelow([a[0]+a[2]*.5,a[1]+t[1]-d],i),o=!1);const f=this.textWidth(d,r)+2;t[0]>f&&(this.drawTextRight([a[0]+t[0]-f,a[1]+a[3]*.5],r),c=!1)}o&&this.drawTextBelow([a[0]+a[2]*.5,a[1]],i),c&&this.drawTextRight([a[0],a[1]+a[3]*.5],r),l&&this.drawTextAbove([a[0]+a[2]*.5,a[1]+a[3]],s),h&&this.drawTextLeft([a[0]+a[2],a[1]+a[3]*.5],n)}xyMM2xyzMM(a,e){let t=2;a===1&&(t=1),a===2&&(t=0);let i=[0,0,0],r=[1,1,0],s=[1,0,1];i[t]=e,r[t]=e,s[t]=e,i=this.frac2mm(i),r=this.frac2mm(r),s=this.frac2mm(s),i=this.swizzleVec3MM(ee(i[0],i[1],i[2]),a),r=this.swizzleVec3MM(ee(r[0],r[1],r[2]),a),s=this.swizzleVec3MM(ee(s[0],s[1],s[2]),a);const n=(r[0]-i[0])*(s[1]-i[1])-(s[0]-i[0])*(r[1]-i[1]);let o=(r[0]-i[0])*(s[2]-i[2])-(s[0]-i[0])*(r[2]-i[2]);o/=n;let c=(r[1]-i[1])*(s[2]-i[2])-(s[1]-i[1])*(r[2]-i[2]);c/=n;const l=[0,0,0,0,0];return l[0]=i[0],l[1]=i[1],l[2]=i[2],l[3]=c,l[4]=o,l}draw2DMain(a,e,t=NaN){let i=new Float32Array([0,0,0]);this.volumes.length>0&&(i=new Float32Array(this.volumes[0].frac2mm.slice()));let r=this.screenFieldOfViewExtendedMM(e),s=we();!this.opts.isSliceMM&&this.volumes.length>0&&(i=new Float32Array(this.volumes[0].frac2mmOrtho.slice()),s=Ke(this.volumes[0].mm2ortho),r=this.screenFieldOfViewExtendedVox(e));let n=this.opts.isRadiologicalConvention&&e<2;t===1/0||t===-1/0?(n=t!==1/0,e===1&&(n=!n)):this.opts.sagittalNoseLeft&&e===2&&(n=!n);let o=0,c=0;e===2?c=n?90:-90:e===1?c=n?180:0:(c=n?180:0,o=n?-90:90);const l=this.gl;let h=!1;if(a[2]===0||a[3]===0){h=!0;const A=l.canvas.width/r.fovMM[0],y=l.canvas.height/r.fovMM[1],x=Math.min(A,y),E=A/x,I=y/x;r.fovMM[0]*=E,r.fovMM[1]*=I;let w=(r.mnMM[0]+r.mxMM[0])*.5;r.mnMM[0]=w-r.fovMM[0]*.5,r.mxMM[0]=w+r.fovMM[0]*.5,w=(r.mnMM[1]+r.mxMM[1])*.5,r.mnMM[1]=w-r.fovMM[1]*.5,r.mxMM[1]=w+r.fovMM[1]*.5,a=[0,0,l.canvas.width,l.canvas.height]}if(isNaN(t)){const A=this.scene.pan2Dxyzmm,y=this.swizzleVec3MM(ee(A[0],A[1],A[2]),e),x=this.scene.pan2Dxyzmm[3];r.mnMM[0]-=y[0],r.mxMM[0]-=y[0],r.mnMM[1]-=y[1],r.mxMM[1]-=y[1],r.mnMM[0]/=x,r.mxMM[0]/=x,r.mnMM[1]/=x,r.mxMM[1]/=x}let d=2;e===1&&(d=1),e===2&&(d=0);let f=this.scene.crosshairPos[d],u=this.frac2mm(this.scene.crosshairPos);!isNaN(t)&&t!==1/0&&t!==-1/0&&(u=this.frac2mm([.5,.5,.5]),u[d]=t,f=this.mm2frac(u)[d]);const m=u[d],p=l.canvas.height-a[1]-a[3],g=[a[0],p,a[2],a[3]];this.clearBounds(l.DEPTH_BUFFER_BIT,g),l.viewport(g[0],g[1],g[2],g[3]);let b=this.calculateMvpMatrix2D(a,r.mnMM,r.mxMM,1/0,0,c,o,n);if(t===1/0||t===-1/0){const A=a.slice();this.draw3D(a,b.modelViewProjectionMatrix,b.modelMatrix,b.normalMatrix,c,o);const y=this.screenSlices[this.screenSlices.length-1];y.leftTopWidthHeight=A,y.axCorSag=e,y.sliceFrac=1/0,y.AxyzMxy=this.xyMM2xyzMM(e,f),y.leftTopMM=b.leftTopMM,y.fovMM=b.fovMM;return}if(l.enable(l.DEPTH_TEST),l.blendFunc(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA),l.disable(l.BLEND),l.depthFunc(l.ALWAYS),l.disable(l.CULL_FACE),this.volumes.length>0){let A=this.sliceMMShader;if(this.opts.is2DSliceShader&&(A=this.slice2DShader),this.opts.isV1SliceShader&&(A=this.sliceV1Shader),this.customSliceShader&&(A=this.customSliceShader),!A)throw new Error("slice Shader undefined");A.use(this.gl),l.uniform1f(A.uniforms.overlayOutlineWidth,this.overlayOutlineWidth),l.uniform1f(A.uniforms.overlayAlphaShader,this.overlayAlphaShader),l.uniform1i(A.uniforms.isAlphaClipDark,this.isAlphaClipDark?1:0),l.uniform1i(A.uniforms.backgroundMasksOverlays,this.backgroundMasksOverlays),l.uniform1f(A.uniforms.drawOpacity,this.drawOpacity),l.uniform1f(A.uniforms.drawRimOpacity,this.drawRimOpacity),l.enable(l.BLEND),l.blendFunc(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA),l.uniform1f(A.uniforms.opacity,this.volumes[0].opacity),l.uniform1i(A.uniforms.axCorSag,e),l.uniform1f(A.uniforms.slice,f),l.uniformMatrix4fv(A.uniforms.frac2mm,!1,i),l.uniformMatrix4fv(A.uniforms.mvpMtx,!1,b.modelViewProjectionMatrix.slice()),l.bindVertexArray(this.genericVAO),l.drawArrays(l.TRIANGLE_STRIP,0,4),l.bindVertexArray(this.unusedVAO),this.screenSlices.push({leftTopWidthHeight:a,axCorSag:e,sliceFrac:f,AxyzMxy:this.xyMM2xyzMM(e,f),leftTopMM:b.leftTopMM,screen2frac:[],fovMM:b.fovMM})}if(l.depthMask(!0),l.depthFunc(l.LEQUAL),isNaN(t)&&this.drawCrosshairs3D(!0,1,b.modelViewProjectionMatrix,!0,this.opts.isSliceMM),this.opts.meshThicknessOn2D>0){this.opts.meshThicknessOn2D!==1/0&&(b=this.calculateMvpMatrix2D(a,r.mnMM,r.mxMM,this.opts.meshThicknessOn2D,m,c,o,n));const A=Ke(b.modelViewProjectionMatrix);Da(A,A,s),this.drawMesh3D(!0,1,A,b.modelMatrix,b.normalMatrix,!0)}isNaN(t)&&this.drawCrosshairs3D(!1,.15,b.modelViewProjectionMatrix,!0,this.opts.isSliceMM),h&&this.opts.isOrientationTextVisible&&this.drawSliceOrientationText(a,e),this.readyForSync=!0}draw2D(a,e,t=NaN,i=[NaN,NaN]){const[r,s,n,o]=this.getBoundsRegion();let c;a[2]===0&&a[3]===0?this.opts.bounds?c=[r,s,n,o]:c=[0,0,this.gl.canvas.width,this.gl.canvas.height]:c=a.slice();const l=[NaN,NaN];if(i[0]===1/0){const h=this.sliceScale().volScale;let d=this.scaleSlice(h[0],h[1],[0,0],[c[2],c[3]]);e===1&&(d=this.scaleSlice(h[0],h[2],[0,0],[c[2],c[3]])),e===2&&(d=this.scaleSlice(h[1],h[2],[0,0],[c[2],c[3]])),i[0]=d[2],i[1]=d[3]}isNaN(i[0])?this.draw2DMain(c,e,t):(l[0]=Math.floor(.5*(c[2]-i[0])),l[1]=Math.floor(.5*(c[3]-i[1])),c[0]+=l[0],c[1]+=l[1],c[2]=i[0],c[3]=i[1],this.draw2DMain(c,e,t)),!(t===1/0||t===-1/0||e===4)&&c[2]!==0&&c[3]!==0&&this.opts.isOrientationTextVisible&&this.drawSliceOrientationText(c,e,l)}calculateMvpMatrix(a,e=[0,0,0,0],t,i){const r=this.gl;(e[2]===0||e[3]===0)&&(e=[0,0,r.canvas.width,r.canvas.height]);const s=e[2]/e[3];let n=this.furthestFromPivot;const o=this.pivot3D,c=we();n=.8*n/this.scene.volScaleMultiplier,s<1?Os(c,-n,n,-n/s,n/s,n*8,n*.01):Os(c,-n*s,n*s,-n,n,n*8,n*.01);const l=we();l[0]=-1;const h=ee(0,0,-n*1.8);qa(l,l,h),this.position&&qa(l,l,this.position),Bs(l,l,la(270-i)),Ps(l,l,la(t-180)),qa(l,l,[-o[0],-o[1],-o[2]]);const d=we();bt(d,l);const f=we();xt(f,d);const u=we();return Da(u,c,l),[u,l,f]}calculateModelMatrix(a,e){if(!this.back)throw new Error("back undefined");const t=we();if(t[0]=-1,Bs(t,t,la(270-e)),Ps(t,t,la(a-180)),this.back.obliqueRAS){const i=Ke(this.back.obliqueRAS);Da(t,t,i)}return t}calculateRayDirection(a,e){const t=ee(0,0,-1),i=this.calculateModelMatrix(a,e),r=pa(1,0,0,0,-1,0,0,0,-1),s=Ce();Gc(s,t,r);const n=Zn();tf(n,i);const o=Zn();if(!af(o,n))return ee(0,0,1);const c=Ce();Gc(c,s,o),It(c,c);const l=5e-5;for(let h=0;h<3;h++)Math.abs(c[h])<l&&(c[h]=Math.sign(c[h])*l||l);return c}sceneExtentsMinMax(a=!0){let e=ee(0,0,0),t=ee(0,0,0);if(this.volumes.length>0){if(!this.volumeObject3D)throw new Error("volumeObject3D undefined");e=ee(this.volumeObject3D.extentsMin[0],this.volumeObject3D.extentsMin[1],this.volumeObject3D.extentsMin[2]),t=ee(this.volumeObject3D.extentsMax[0],this.volumeObject3D.extentsMax[1],this.volumeObject3D.extentsMax[2]),a||(e=ee(this.volumes[0].extentsMinOrtho[0],this.volumes[0].extentsMinOrtho[1],this.volumes[0].extentsMinOrtho[2]),t=ee(this.volumes[0].extentsMaxOrtho[0],this.volumes[0].extentsMaxOrtho[1],this.volumes[0].extentsMaxOrtho[2]))}if(this.meshes.length>0){if(this.volumes.length<1){const r=this.meshes[0].extentsMin,s=this.meshes[0].extentsMax;e=ee(r[0],r[1],r[2]),t=ee(s[0],s[1],s[2])}for(let r=0;r<this.meshes.length;r++){const s=this.meshes[r].extentsMin,n=this.meshes[r].extentsMax,o=ee(s[0],s[1],s[2]);xo(e,e,o);const c=ee(n[0],n[1],n[2]);wo(t,t,c)}}const i=Ce();return Fe(i,t,e),[e,t,i]}setPivot3D(){const[a,e]=this.sceneExtentsMinMax(),t=Ce();ka(t,a,e),cf(t,t,.5),this.pivot3D=[t[0],t[1],t[2]],Fe(t,e,a),this.extentsMin=a,this.extentsMax=e,this.furthestFromPivot=ya(t)*.5}getMaxVols(){if(this.volumes.length<1)return 0;let a=0;for(let e=0;e<this.volumes.length;e++)a=Math.max(a,this.volumes[e].nFrame4D);return a}detectPartialllyLoaded4D(){if(this.volumes.length<1)return!1;for(let a=0;a<this.volumes.length;a++)if(this.volumes[a].nFrame4D<this.volumes[a].hdr.dims[4])return!0;return!1}drawGraph(){if(this.getMaxVols()<2)return;const a=this.graph,[e,t,i,r]=this.getBoundsRegion();let s=0;if(a.autoSizeMultiplanar&&this.opts.sliceType===3)for(let Y=0;Y<this.screenSlices.length;Y++){const W=this.screenSlices[Y].axCorSag;if(W===0&&(s=this.screenSlices[Y].leftTopWidthHeight[1]),W!==2)continue;const T=this.screenSlices[Y].leftTopWidthHeight.slice();T[1]===s?(a.LTWH[0]=T[0]+T[2],a.LTWH[1]=T[1]):(a.LTWH[0]=T[0],a.LTWH[1]=T[1]+T[3]),a.LTWH[2]=T[2],a.LTWH[3]=T[2]}if(a.LTWH[0]=Math.max(e,a.LTWH[0]),a.LTWH[1]=Math.max(t,a.LTWH[1]),a.LTWH[2]=Math.min(i,a.LTWH[2]),a.LTWH[3]=Math.min(r,a.LTWH[3]),a.opacity<=0||a.LTWH[2]<=5||a.LTWH[3]<=5||Math.floor(a.LTWH[0]+a.LTWH[2])>e+i||Math.floor(a.LTWH[1]+a.LTWH[3])>t+r)return;a.backColor=[.15,.15,.15,a.opacity],a.lineColor=[1,1,1,1],this.opts.backColor[0]+this.opts.backColor[1]+this.opts.backColor[2]>1.5&&(a.backColor=[.95,.95,.95,a.opacity],a.lineColor=[0,0,0,1]);const n=.2,o=.3;a.lineColor[3]=n,a.textColor=a.lineColor.slice(),a.textColor[3]=1,a.lineThickness=3,a.gridLineThickness=1,a.lineAlpha=1,a.lines=[];const c=[];if(a.vols.length<1)this.volumes[0]!=null&&c.push(0);else for(let Y=0;Y<a.vols.length;Y++){const W=a.vols[Y];this.volumes[W]==null||this.volumes[W].nFrame4D<2||c.push(W)}if(c.length<1)return;const l=this.volumes[c[0]].nFrame4D;if(this.graph.selectedColumn=this.volumes[c[0]].frame4D,l<2){V.debug("Unable to generate a graph: Selected volume is 3D not 4D");return}for(let Y=0;Y<c.length;Y++){a.lines[Y]=[];const W=this.frac2vox(this.scene.crosshairPos),T=this.volumes[c[Y]];let ne=T.nFrame4D;ne=Math.min(ne,l);for(let le=0;le<ne;le++){const de=T.getValue(W[0],W[1],W[2],le);a.lines[Y].push(de)}}a.lineRGB=[[.8,0,0],[0,.7,0],[0,0,.9],[.7,.7,0],[.8,0,.8],[0,.7,.7],[.6,.6,.6],[0,0,0]];let h=a.lines[0][0],d=a.lines[0][0];for(let Y=0;Y<a.lines.length;Y++)for(let W=0;W<a.lines[Y].length;W++){const T=a.lines[Y][W];h=Math.min(T,h),d=Math.max(T,d)}const f=this.volumes[c[0]].cal_min,u=this.volumes[c[0]].cal_max;if(a.isRangeCalMinMax&&f<u&&isFinite(f)&&isFinite(u)&&(h=f,d=u),a.normalizeValues&&d>h){const Y=d-h;for(let W=0;W<a.lines.length;W++)for(let T=0;T<a.lines[W].length;T++){const ne=a.lines[W][T];a.lines[W][T]=(ne-h)/Y}h=0,d=1}h>=d&&(d=h+1),this.drawRect(a.LTWH,a.backColor);const[m,p,g]=El(h,d),b=Math.max(0,-1*Math.floor(Math.log(m)/Math.log(10)));h=Math.min(p,h),d=Math.max(g,d);function A(Y){return Y.toFixed(6).replace(/\.?0*$/,"")}let y=this.fontPx*.7;const x=i/this.uiData.dpr,E=r/this.uiData.dpr,I=x*E,w=800*600;I<w?y=0:y=Math.max(y,this.opts.fontMinPx);const v=y/this.fontPx;let M=0,C=p;if(y>0)for(;C<=d;){const Y=C.toFixed(b),W=this.textWidth(y,Y);M=Math.max(W,M),C+=m}const D=.05,S=Math.abs(a.LTWH[2]),k=Math.abs(a.LTWH[3]),F=[a.LTWH[0]+D*S+M,a.LTWH[1]+D*k,a.LTWH[2]-M-2*D*S,a.LTWH[3]-y-2.5*D*k];this.graph.LTWH=a.LTWH,this.graph.plotLTWH=F,this.drawRect(F,this.opts.backColor);const B=d-h,O=F[3]/B,L=F[2]/(a.lines[0].length-1),_=F[1]+F[3];C=p+.5*m;const q=a.lineColor.slice();for(q[3]=.5*a.lineColor[3];C<=d;){const Y=_-(C-h)*O;this.drawLine([F[0],Y,F[0]+F[2],Y],a.gridLineThickness,q),C+=m}C=p;const J=.5*a.gridLineThickness;for(;C<=d;){const Y=_-(C-h)*O;this.drawLine([F[0]-J,Y,F[0]+F[2]+a.gridLineThickness,Y],a.gridLineThickness,a.lineColor);const W=C.toFixed(b);y>0&&this.drawTextLeft([F[0]-6,Y],W,v,a.textColor),C+=m}let Z=1;for(;a.lines[0].length/Z>20;)Z*=5;for(let Y=0;Y<a.lines[0].length;Y+=Z){const W=Y*L+F[0];let T=a.gridLineThickness;if(Y%2===1)T*=.5,this.drawLine([W,F[1],W,F[1]+F[3]],T,q);else{const ne=A(Y);y>0&&this.drawTextBelow([W,2+F[1]+F[3]],ne,v,a.textColor),this.drawLine([W,F[1],W,F[1]+F[3]],T,a.lineColor)}}for(let Y=0;Y<a.lines.length;Y++){let W=[1,0,0,a.lineAlpha];Y<a.lineRGB.length&&(W=[a.lineRGB[Y][0],a.lineRGB[Y][1],a.lineRGB[Y][2],a.lineAlpha]);for(let T=1;T<a.lines[Y].length;T++){const ne=(T-1)*L,le=T*L,de=(a.lines[Y][T-1]-h)*O,Me=(a.lines[Y][T]-h)*O,Ne=[F[0]+ne,F[1]+F[3]-de,F[0]+le,F[1]+F[3]-Me];this.drawLine(Ne,a.lineThickness,W)}}if(a.selectedColumn>=0&&a.selectedColumn<a.lines[0].length){const Y=a.selectedColumn*L+F[0];this.drawLine([Y,F[1],Y,F[1]+F[3]],a.lineThickness,[a.lineRGB[0][0],a.lineRGB[0][1],a.lineRGB[0][2],o])}y>0&&a.LTWH[1]+a.LTWH[3]>F[1]+F[3]+y*2.4&&this.drawTextBelow([F[0]+.5*F[2],F[1]+F[3]+y*1.2],"Volume",v,a.textColor),this.detectPartialllyLoaded4D()&&this.drawTextBelow([F[0]+F[2],F[1]+F[3]+y*.5],"...",v,a.textColor)}depthPicker(a,e){if(!this.uiData.mouseDepthPicker)return;this.uiData.mouseDepthPicker=!1;const t=this.gl,i=this.mousePos[0]*a[2]/a[2],r=t.canvas.height-this.mousePos[1]*a[3]/a[3]-1,s=new Uint8Array(4);if(t.readPixels(i,r,1,1,t.RGBA,t.UNSIGNED_BYTE,s),this.selectedObjectId=s[3],this.selectedObjectId===this.VOLUME_ID){this.scene.crosshairPos=new Float32Array(s.slice(0,3)).map(d=>d/255);return}const n=B0(s);if(n>1)return;const o=(this.mousePos[0]-a[0])/a[2],c=(t.canvas.height-this.mousePos[1]-a[1])/a[3],l=O0(o,c,n,e),h=this.mm2frac(l,0,!0);h[0]<0||h[0]>1||h[1]<0||h[1]>1||h[2]<0||h[2]>1||(this.scene.crosshairPos=this.mm2frac(l,0,!0))}drawImage3D(a,e,t){if(this.volumes.length===0)return;const i=this.gl,r=this.calculateRayDirection(e,t),s=this.volumeObject3D;if(s){i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),i.enable(i.CULL_FACE),i.cullFace(i.FRONT);let n=this.renderShader;if(this.uiData.mouseDepthPicker&&(n=this.pickingImageShader),n.use(this.gl),i.uniform1i(n.uniforms.backgroundMasksOverlays,this.backgroundMasksOverlays),this.gradientTextureAmount>0&&n.uniforms.normMtx&&this.gradientTexture){i.activeTexture(Ys),i.bindTexture(i.TEXTURE_3D,this.gradientTexture);const o=this.calculateModelMatrix(e,t),c=we();bt(c,o);const l=we();xt(l,c),i.uniformMatrix4fv(n.uniforms.normMtx,!1,l)}if(this.drawBitmap&&this.drawBitmap.length>8?i.uniform2f(n.uniforms.renderDrawAmbientOcclusionXY,this.renderDrawAmbientOcclusion,this.drawOpacity):i.uniform2f(n.uniforms.renderDrawAmbientOcclusionXY,this.renderDrawAmbientOcclusion,0),this.gl.uniform4fv(n.uniforms.paqdUniforms,this.opts.paqdUniforms),i.uniformMatrix4fv(n.uniforms.mvpMtx,!1,a),i.uniformMatrix4fv(n.uniforms.matRAS,!1,this.back.matRAS),i.uniform3fv(n.uniforms.rayDir,r),this.gradientTextureAmount<0)i.uniform4fv(n.uniforms.clipPlane,[this.scene.crosshairPos[0],this.scene.crosshairPos[1],this.scene.crosshairPos[2],30]);else{const c=new Float32Array(24).fill(2);for(let l=0;l<this.scene.clipPlaneDepthAziElevs.length;l++){const h=this.scene.clipPlaneDepthAziElevs[l],d=this.sph2cartDeg(h[1]+180,h[2]),f=[d[0],d[1],d[2],h[0]];c.set(f,l*4)}this.gl.uniform4fv(n.uniforms.clipPlanes,c)}i.uniform1f(n.uniforms.drawOpacity,1),i.uniform1i(n.uniforms.isClipCutaway,this.opts.isClipPlanesCutaway?1:0),i.bindVertexArray(s.vao),i.drawElements(s.mode,s.indexCount,i.UNSIGNED_SHORT,0),i.bindVertexArray(this.unusedVAO)}}drawOrientationCube(a,e=0,t=0){if(!this.opts.isOrientCube)return;const i=.05*Math.min(a[2],a[3]);if(i<5)return;const r=this.gl;r.enable(r.CULL_FACE),r.cullFace(r.BACK),r.disable(r.DEPTH_TEST),this.orientCubeShader.use(this.gl),r.bindVertexArray(this.orientCubeShaderVAO);const s=we(),n=we();Os(n,0,r.canvas.width,0,r.canvas.height,-10*i,10*i);let o=0;a[1]===0&&(o=r.canvas.height-this.effectiveCanvasHeight()),qa(s,s,[1.8*i+a[0],o+1.8*i+a[1],0]),Vc(s,s,[i,i,i]),Bs(s,s,la(270-t)),Ps(s,s,la(-e));const c=we();Da(c,n,s),r.uniformMatrix4fv(this.orientCubeShader.uniforms.u_matrix,!1,c),r.drawArrays(r.TRIANGLE_STRIP,0,168),r.bindVertexArray(this.unusedVAO),this.gl.disable(this.gl.CULL_FACE)}createOnLocationChange(a=NaN){const[e,t,i]=this.sceneExtentsMinMax(!0),r=Math.max(Math.max(i[0],i[1]),i[2]);function s(d){return Math.max(0,-Math.ceil(Math.log10(Math.abs(d))))}let n=s(r*.001);const o=this.frac2mm(this.scene.crosshairPos,0,!0);function c(d,f=0){return parseFloat(d.toFixed(f))}let l=c(o[0],n)+""+c(o[1],n)+""+c(o[2],n);if(this.volumes.length>0&&this.volumes[0].nFrame4D>0&&(l+=""+c(this.volumes[0].frame4D)),this.volumes.length>0){let d=" = ";for(let m=0;m<this.volumes.length;m++){const p=this.volumes[m].mm2vox(o);let g=this.volumes[m].getValue(p[0],p[1],p[2],this.volumes[m].frame4D);if(n=3,this.volumes[m].colormapLabel!==null){const b=Math.round(g);if(this.volumes[m].hdr.intent_code===1002&&this.volumes[m].hdr.datatypeCode===2304){const A=this.volumes[m].getValues(p[0],p[1],p[2],this.volumes[m].frame4D);if(A[2]>2){const y=Math.round(100*A[2]/255);if(d+=this.volumes[m].colormapLabel.labels[A[0]]+` (${y}%)`,A[3]>2){const x=Math.round(100*A[3]/255);d+=" "+this.volumes[m].colormapLabel.labels[A[1]]+` (${x}%)`}}}else b>=0&&this.volumes[m].colormapLabel.labels&&b<this.volumes[m].colormapLabel.labels.length?d+=this.volumes[m].colormapLabel.labels[b]:d+="undefined("+c(g,n)+")"}else d+=c(g,n);this.volumes[m].imaginary&&(g=this.volumes[m].getValue(p[0],p[1],p[2],this.volumes[m].frame4D,!0),g>=0&&(d+="+"),d+=c(g,n)),d+="   "}l+=d;const f=this.back.dimsRAS,u=f[1]*f[2]*f[3];if(this.drawBitmap&&this.drawBitmap.length===u){const m=this.frac2vox(this.scene.crosshairPos),p=m[0]+m[1]*f[1]+m[2]*f[1]*f[2];l+=" "+this.drawLut.labels[this.drawBitmap[p]]}}const h={mm:this.frac2mm(this.scene.crosshairPos,0,!0),axCorSag:a,vox:this.frac2vox(this.scene.crosshairPos),frac:this.scene.crosshairPos,xy:[this.mousePos[0],this.mousePos[1]],values:this.volumes.map(d=>{const f=this.frac2mm(this.scene.crosshairPos,0,!0),u=d.mm2vox(f),m=d.getValue(u[0],u[1],u[2],d.frame4D);return{name:d.name,value:m,id:d.id,mm:f,vox:u}}),string:l};this.onLocationChange(h)}addLabel(a,e,t,i,r){const s={textColor:this.opts.legendTextColor,textScale:1,textAlignment:"left",lineWidth:0,lineColor:this.opts.legendTextColor,lineTerminator:"none",bulletScale:0,bulletColor:this.opts.legendTextColor},n=e?{...s,...e}:{...s},o=new jo(a,{...n},t,i,r);return this.document.labels.push(o),o}calculateScreenPoint(a,e,t){const i=aa();return it(i,[...a,1],e),i[3]!==0&&(i[0]=(i[0]/i[3]+1)*.5*t[2],i[1]=(1-i[1]/i[3])*.5*t[3],i[2]/=i[3],i[0]+=t[0],i[1]+=t[1]),i}getLabelAtPoint(a){const e=this.legendFontScaling,t=this.fontPx*e,i=this.fontPx*e;for(const l of this.document.labels){if(l.anchor==null||l.anchor===0)continue;const h=this.fontPx*l.style.textScale*e,d=this.textHeight(h,l.text),f=this.textWidth(h,l.text);if(!(l.anchor&1&&a[0]>f)&&!(l.anchor&2&&(a[0]<(this.gl.canvas.width-f)/2||a[0]>(this.gl.canvas.width+f)/2))&&!(l.anchor&4&&a[0]<this.gl.canvas.width-f)&&!(l.anchor&8&&(a[1]<i/2||a[1]>d+i/2))&&!(l.anchor&16&&(a[1]<(this.gl.canvas.height-d-i)/2||a[1]>(this.gl.canvas.height+d-i/2)/2))&&!(l.anchor&32&&(a[1]<this.gl.canvas.height-d-i||a[1]>this.gl.canvas.height-i/2)))return l}V.debug("screenPoint",a);const r=this.getLegendPanelHeight(e),s=this.getLegendPanelWidth(),n=this.gl.canvas.width-s;let o=(this.canvas.height-r)/2;if(V.debug("panelrect",n,o,n+s,o+r),a[0]<n||a[1]<o||a[0]>n+s||a[1]>o+r)return null;const c=this.getConnectomeLabels();for(const l of c){const h=this.fontPx*l.style.textScale*e,d=this.textHeight(h,l.text);if(a[1]>=o&&a[1]<=o+d+t/2)return V.debug(`label clicked ${l.text}`),l;o+=d,o+=t/2}return null}drawLabelLine(a,e,t,i,r=!1){const s=Array.isArray(a.points)&&Array.isArray(a.points[0])?a.points:[a.points];for(const n of s){const o=this.calculateScreenPoint(n,t,i);r?this.drawDottedLine([...e,o[0],o[1]],a.style.lineWidth,a.style.lineColor):this.draw3DLine(e,[o[0],o[1],o[2]],a.style.lineWidth,a.style.lineColor)}}draw3DLabel(a,e,t,i,r,s,n,o=1){const c=a.text,l=e[0],h=e[1],d=this.fontPx*o,f=this.textHeight(a.style.textScale,c)*d;if(a.style.lineWidth>0&&Array.isArray(a.points)&&this.drawLabelLine(a,[l,h+f],t,i,n),a.style.bulletScale){const p=a.style.bulletScale*f,g=f-p,b=h+g/2+p/2,A=l+(r-p)/2;this.drawCircle([A,b,p,p],a.style.bulletColor)}let u=l;if(s)if(a.style.textAlignment!=="left"){const p=this.textWidth(a.style.textScale,a.text)*d;if(a.style.textAlignment==="right")u=l+s-d*1.5-p;else{const g=s-(r||d);u+=(g-p)/2}}else u+=r;const m=a.style.textScale;this.drawText([u,h],c,m,a.style.textColor)}draw3DLabels(a,e,t=!1){const i=this.getConnectomeLabels();if(!this.opts.showLegend||i.length===0)return;let r=this.getLegendPanelHeight(1);if(!this.canvas||r<1)return;const s=this.gl;if(s.disable(s.CULL_FACE),s.viewport(0,0,this.canvas.width,this.canvas.height),this.legendFontScaling=1,r>this.canvas.height){const u=10*this.uiData.dpr;this.legendFontScaling=Math.max(this.canvas.height-u,1)/r,V.debug(`Legend too large for screen, font reduction factor x${this.legendFontScaling}`),r=this.getLegendPanelHeight(this.legendFontScaling)}const n=this.fontPx*this.legendFontScaling,o=this.getBulletMarginWidth(),c=this.getLegendPanelWidth(),l=s.canvas.width-c;let h=(this.canvas.height-r)/2;this.drawRect([s.canvas.width-c,h,c-n,r],this.opts.legendBackgroundColor);const d=s.getParameter(s.BLEND),f=s.getParameter(s.DEPTH_FUNC);t||(s.disable(s.BLEND),s.depthFunc(s.LEQUAL));for(const u of i){this.draw3DLabel(u,[l,h],a,e,o,c,t,this.legendFontScaling);const m=this.fontPx*u.style.textScale,p=this.textHeight(m,u.text)*this.legendFontScaling;h+=p,h+=n/2}t||(s.depthFunc(f),d&&s.enable(s.BLEND))}drawAnchoredLabels(){const a=this.fontPx,e=this.document.labels.filter(t=>t.anchor!=null&&t.anchor!==0);for(const t of e){const i=t.text,r=this.textHeight(t.style.textScale,i)*a,s=this.textWidth(t.style.textScale,i)*a;let n,o;const l=this.fontPx*1,h=l;let d=l/4,f=0,u=0;t.anchor&1&&(n=0),t.anchor&4&&(n=this.canvas.width-s,f-=l/4),t.anchor&2&&(n=(this.canvas.width-s)/2,f-=l/4,d+=l/4),t.anchor&8&&(o=0),t.anchor&16&&(o=(this.canvas.height-r-l)/2,u-=l/4),t.anchor&32&&(o=this.canvas.height-r-l,u-=l/4),this.drawRect([n+f,o+u,s+d,r+h],t.style.backgroundColor),this.draw3DLabel(t,[n,o])}}draw3D(a=[0,0,0,0],e=null,t=null,i=null,r=null,s=0){const n=this.gl,[o,c,l,h]=this.getBoundsRegion();let d=[...a];(d[2]===0||d[3]===0)&&(d=this.opts.bounds?[o,c,l,h]:[0,0,n.canvas.width,n.canvas.height]);const f=r!==null;this.setPivot3D(),f||(r=this.scene.renderAzimuth,s=this.scene.renderElevation),e===null&&([e,t,i]=this.calculateMvpMatrix(null,d,r,s));const u=[...d];this.screenSlices.push({leftTopWidthHeight:d.slice(),axCorSag:4,sliceFrac:0,AxyzMxy:[],leftTopMM:[],fovMM:[P0(t),0]});const m=[d[0],n.canvas.height-d[3]-d[1],d[2],d[3]];if(d[1]=n.canvas.height-d[3]-d[1],n.clear(n.DEPTH_BUFFER_BIT),n.enable(n.DEPTH_TEST),n.depthFunc(n.ALWAYS),n.depthMask(!0),this.draw3DLabels(e,u,!1),this.gl.viewport(m[0],m[1],m[2],m[3]),this.volumes.length>0&&(this.updateInterpolation(0,!0),this.updateInterpolation(1,!0),this.drawImage3D(e,r,s)),this.updateInterpolation(0),this.updateInterpolation(1),f||this.drawCrosshairs3D(!0,1,e),this.drawMesh3D(!0,1,e,t,i),this.uiData.mouseDepthPicker){this.depthPicker(d,e),this.createOnLocationChange(),this.draw3D(u,e,t,i,r,s);return}this.opts.meshXRay>0&&this.drawMesh3D(!1,this.opts.meshXRay,e,t,i),this.gl.disable(this.gl.CULL_FACE),this.draw3DLabels(e,u,!1),n.viewport(d[0],d[1],d[2],d[3]),f||this.drawCrosshairs3D(!1,.15,e),n.viewport(o,c,l,h),this.drawOrientationCube(d,r,s);const p="azimuth: "+this.scene.renderAzimuth.toFixed(0)+" elevation: "+this.scene.renderElevation.toFixed(0);return this.readyForSync=!0,this.sync(),this.draw3DLabels(e,u,!0),p}drawMesh3D(a=!0,e=1,t,i,r,s=!1){if(this.meshes.length<1)return;const n=this.gl;t||([t,i,r]=this.calculateMvpMatrix(this.volumeObject3D,void 0,this.scene.renderAzimuth,this.scene.renderElevation)),n.enable(n.DEPTH_TEST),a?n.depthFunc(n.LEQUAL):n.depthFunc(n.ALWAYS),n.cullFace(n.BACK),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA);let o=!1;for(const c of this.meshes){if(!c.visible||c.opacity<=0||c.indexCount<3)continue;const l=c.opacity*e;let h=this.meshShaders[c.meshShaderIndex].shader;if(this.uiData.mouseDepthPicker&&(h=this.pickingMeshShader),h.use(n),h.isCrosscut){n.disable(n.DEPTH_TEST),n.disable(n.CULL_FACE);const d=this.frac2mm(this.scene.crosshairPos,0,this.opts.isSliceMM);n.uniformMatrix4fv(h.uniforms.modelMtx,!1,i),s&&(Math.abs(i[2])+Math.abs(i[4])+Math.abs(i[9])>=2.95&&(d[1]=1e9,d[2]=1e9),Math.abs(i[0])+Math.abs(i[6])+Math.abs(i[9])>=2.95&&(d[0]=1e9,d[2]=1e9),Math.abs(i[0])+Math.abs(i[5])+Math.abs(i[10])>=2.95&&(d[0]=1e9,d[1]=1e9));let f=Number(this.opts.meshThicknessOn2D);Number.isFinite(f)||(f=1),n.uniform4fv(h.uniforms.sliceMM,[d[0],d[1],d[2],f])}else n.enable(n.CULL_FACE),n.enable(n.DEPTH_TEST);if(n.uniformMatrix4fv(h.uniforms.mvpMtx,!1,t),n.uniformMatrix4fv(h.uniforms.normMtx,!1,r),n.uniform1f(h.uniforms.opacity,l),l>=1?(n.disable(n.BLEND),n.depthMask(!0)):(n.enable(n.BLEND),n.depthMask(!1)),c.offsetPt0&&(c.fiberSides<3||c.fiberRadius<=0)){o=!0;continue}h.isMatcap&&(n.activeTexture(qn),n.bindTexture(n.TEXTURE_2D,this.matCapTexture)),n.bindVertexArray(c.vao),n.drawElements(n.TRIANGLES,c.indexCount,n.UNSIGNED_INT,0),n.bindVertexArray(this.unusedVAO)}if(n.enable(n.CULL_FACE),this.opts.meshXRay>0&&!o){n.enable(n.BLEND),n.depthMask(!1),n.depthFunc(n.ALWAYS);for(const c of this.meshes){if(!c.visible||c.indexCount<3)continue;const l=this.meshShaders[c.meshShaderIndex].shader;l.use(n),n.uniformMatrix4fv(l.uniforms.mvpMtx,!1,t),n.uniformMatrix4fv(l.uniforms.normMtx,!1,r),n.uniform1f(l.uniforms.opacity,c.opacity*e*this.opts.meshXRay),n.bindVertexArray(c.vao),n.drawElements(n.TRIANGLES,c.indexCount,n.UNSIGNED_INT,0),n.bindVertexArray(this.unusedVAO)}n.depthMask(!0),n.depthFunc(n.GREATER),n.disable(n.BLEND)}if(o){const c=this.fiberShader;c.use(n),n.uniformMatrix4fv(c.uniforms.mvpMtx,!1,t),n.uniform1f(c.uniforms.opacity,e);for(const l of this.meshes)l.offsetPt0&&(l.fiberSides>=3&&l.fiberRadius>0||(n.bindVertexArray(l.vaoFiber),n.drawElements(n.LINE_STRIP,l.indexCount,n.UNSIGNED_INT,0),n.bindVertexArray(this.unusedVAO)))}n.depthMask(!0),n.disable(n.BLEND),this.readyForSync=!0}drawCrosshairs3D(a=!0,e=1,t=null,i=!1,r=!0){var u,m;if(!this.opts.show3Dcrosshair&&!i||this.opts.crosshairWidth<=0&&i)return;const s=this.gl,n=this.frac2mm(this.scene.crosshairPos,0,r);let o=1;const[c,l,h]=this.sceneExtentsMinMax(r);if(this.volumes.length>0){if(!this.back)throw new Error("back undefined");o=.5*Math.min(Math.min(this.back.pixDims[1],this.back.pixDims[2]),this.back.pixDims[3])}else(h[0]<50||h[0]>1e3)&&(o=h[0]*.02);if(o*=this.opts.crosshairWidth,((u=this.opts)==null?void 0:u.crosshairWidthUnit)==="percent"&&(o=h[0]*this.opts.crosshairWidth*.5*.01),((m=this.opts)==null?void 0:m.crosshairWidthUnit)==="mm"&&(o=this.opts.crosshairWidth*.5),(this.crosshairs3D===null||this.crosshairs3D.mm[0]!==n[0]||this.crosshairs3D.mm[1]!==n[1]||this.crosshairs3D.mm[2]!==n[2])&&(this.crosshairs3D!==null&&(s.deleteBuffer(this.crosshairs3D.indexBuffer),s.deleteBuffer(this.crosshairs3D.vertexBuffer)),this.crosshairs3D=ja.generateCrosshairs(this.gl,1,n,c,l,o,20,this.opts.crosshairGap),this.crosshairs3D.mm=n),!this.surfaceShader)throw new Error("surfaceShader undefined");const d=this.surfaceShader;d.use(this.gl),t==null&&([t]=this.calculateMvpMatrix(this.crosshairs3D,void 0,this.scene.renderAzimuth,this.scene.renderElevation)),s.uniformMatrix4fv(d.uniforms.mvpMtx,!1,t),s.disable(s.CULL_FACE),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,this.crosshairs3D.indexBuffer),s.enable(s.DEPTH_TEST);const f=[...this.opts.crosshairColor];a?(s.disable(s.BLEND),s.depthFunc(s.LEQUAL)):(s.enable(s.BLEND),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA),s.depthFunc(s.ALWAYS)),f[3]=e,s.uniform4fv(d.uniforms.surfaceColor,f),s.bindVertexArray(this.crosshairs3D.vao),s.drawElements(s.TRIANGLES,this.crosshairs3D.indexCount,s.UNSIGNED_INT,0),s.bindVertexArray(this.unusedVAO)}mm2frac(a,e=0,t=!1){if(this.volumes.length<1){const i=ee(.1,.5,.5),[r,s,n]=this.sceneExtentsMinMax();return i[0]=(a[0]-r[0])/n[0],i[1]=(a[1]-r[1])/n[1],i[2]=(a[2]-r[2])/n[2],isFinite(i)||(isFinite(i[0])||(i[0]=.5),isFinite(i[1])||(i[1]=.5),isFinite(i[2])||(i[2]=.5),this.meshes.length<1&&V.error("mm2frac() not finite: objects not (yet) loaded.")),i}return this.volumes[e].convertMM2Frac(a,t||this.opts.isSliceMM)}vox2frac(a,e=0){return this.volumes[e].convertVox2Frac(a)}frac2vox(a,e=0){return this.volumes.length<=e?[0,0,0]:this.volumes[e].convertFrac2Vox(a)}moveCrosshairInVox(a,e,t){const i=this.frac2vox(this.scene.crosshairPos),r=i[2];i[0]+=a,i[1]+=e,i[2]+=t,i[0]=zn(i[0],0,this.volumes[0].dimsRAS[1]-1),i[1]=zn(i[1],0,this.volumes[0].dimsRAS[2]-1),i[2]=zn(i[2],0,this.volumes[0].dimsRAS[3]-1),this.scene.crosshairPos=this.vox2frac(i),this.createOnLocationChange(),this.opts.is2DSliceShader&&r!==i[2]&&(this.updateGLVolume(),this.refreshDrawing(!1)),this.drawScene()}frac2mm(a,e=0,t=!1){const i=Be(a[0],a[1],a[2],1);if(this.volumes.length>0)return this.volumes[e].convertFrac2MM(a,t||this.opts.isSliceMM);{const[r,s]=this.sceneExtentsMinMax(),n=(o,c,l)=>o*(1-l)+c*l;i[0]=n(r[0],s[0],a[0]),i[1]=n(r[1],s[1],a[1]),i[2]=n(r[2],s[2],a[2])}return i}screenXY2TextureFrac(a,e,t,i=!0){const r=ee(-1,-1,-1),s=this.screenSlices[t].axCorSag;if(s>2)return r;const n=this.screenSlices[t].leftTopWidthHeight.slice();let o=!1;n[2]<0&&(o=!0,n[0]+=n[2],n[2]=-n[2]);let c=(a-n[0])/n[2];o&&(c=1-c);const l=1-(e-n[1])/n[3];if(c<0||c>1||l<0||l>1||this.screenSlices[t].AxyzMxy.length<4)return r;let h=ee(0,0,0);h[0]=this.screenSlices[t].leftTopMM[0]+c*this.screenSlices[t].fovMM[0],h[1]=this.screenSlices[t].leftTopMM[1]+l*this.screenSlices[t].fovMM[1];const d=this.screenSlices[t].AxyzMxy;h[2]=d[2]+d[4]*(h[1]-d[1])-d[3]*(h[0]-d[0]),s===1&&(h=Le(h,[0,2,1])),s===2&&(h=Le(h,[2,0,1]));const f=this.mm2frac(h);return i&&(f[0]<0||f[0]>1||f[1]<0||f[1]>1||f[2]<0||f[2]>1)?r:f}canvasPos2frac(a){for(let e=0;e<this.screenSlices.length;e++){const t=this.screenXY2TextureFrac(a[0],a[1],e);if(t[0]>=0)return t}return[-1,-1,-1]}frac2canvasPosWithTile(a,e){const t=this.frac2mm(a);let i={distance:1/0};for(let r=0;r<this.screenSlices.length;r++){const s=this.screenSlices[r].axCorSag;if(s>2||this.screenSlices[r].AxyzMxy.length<4||e!==void 0&&s!==e)continue;let n=ee(t[0],t[1],t[2]);s===1&&(n=Le(n,[0,2,1])),s===2&&(n=Le(n,[1,2,0]));const o=this.screenSlices[r].AxyzMxy,c=o[2]+o[4]*(n[1]-o[1])-o[3]*(n[0]-o[0]),l=Math.abs(n[2]-c),h=this.opts.sliceType===3?1:.1;if(l<i.distance&&(i={index:r,distance:l}),l<=h){const d=(n[0]-this.screenSlices[r].leftTopMM[0])/this.screenSlices[r].fovMM[0],f=(n[1]-this.screenSlices[r].leftTopMM[1])/this.screenSlices[r].fovMM[1];if(d>=0&&d<=1&&f>=0&&f<=1){const u=this.screenSlices[r].leftTopWidthHeight.slice();let m=!1;u[2]<0&&(m=!0,u[0]+=u[2],u[2]=-u[2]);let p=d;m&&(p=1-d);const g=1-f,b=u[0]+p*u[2],A=u[1]+g*u[3];return{pos:[b,A],tileIndex:r}}}}return null}frac2canvasPos(a){const e=this.frac2mm(a);let t={index:-1,distance:1/0};for(let i=0;i<this.screenSlices.length;i++){const r=this.screenSlices[i].axCorSag;if(r>2||this.screenSlices[i].AxyzMxy.length<4)continue;let s=ee(e[0],e[1],e[2]);r===1&&(s=Le(s,[0,2,1])),r===2&&(s=Le(s,[1,2,0]));const n=this.screenSlices[i].AxyzMxy,o=n[2]+n[4]*(s[1]-n[1])-n[3]*(s[0]-n[0]),c=Math.abs(s[2]-o),l=this.opts.sliceType===3?1:.1;if(c<t.distance&&(t={index:i,distance:c}),c<=l){const h=(s[0]-this.screenSlices[i].leftTopMM[0])/this.screenSlices[i].fovMM[0],d=(s[1]-this.screenSlices[i].leftTopMM[1])/this.screenSlices[i].fovMM[1];if(h>=0&&h<=1&&d>=0&&d<=1){const f=this.screenSlices[i].leftTopWidthHeight.slice();let u=!1;f[2]<0&&(u=!0,f[0]+=f[2],f[2]=-f[2]);let m=h;u&&(m=1-h);const p=1-d,g=f[0]+m*f[2],b=f[1]+p*f[3];return[g,b]}}}if(t.index>=0&&t.distance<2){const i=t.index,r=this.screenSlices[i].axCorSag;let s=ee(e[0],e[1],e[2]);r===1&&(s=Le(s,[0,2,1])),r===2&&(s=Le(s,[1,2,0]));const n=this.screenSlices[i].AxyzMxy;s[2]=n[2]+n[4]*(s[1]-n[1])-n[3]*(s[0]-n[0]);const o=(s[0]-this.screenSlices[i].leftTopMM[0])/this.screenSlices[i].fovMM[0],c=(s[1]-this.screenSlices[i].leftTopMM[1])/this.screenSlices[i].fovMM[1];if(o>=-.1&&o<=1.1&&c>=-.1&&c<=1.1){const l=Math.max(0,Math.min(1,o)),h=Math.max(0,Math.min(1,c)),d=this.screenSlices[i].leftTopWidthHeight.slice();let f=!1;d[2]<0&&(f=!0,d[0]+=d[2],d[2]=-d[2]);let u=l;f&&(u=1-l);const m=1-h,p=d[0]+u*d[2],g=d[1]+m*d[3];return[p,g]}}return null}scaleSlice(a,e,t=[0,0],i=[0,0]){const r=i[0]===0?this.effectiveCanvasWidth()-t[0]:i[0]-t[0],s=i[1]===0?this.effectiveCanvasHeight()-t[1]:i[1]-t[1];let n=r/a;e*n>s&&(n=s/e);const o=a*n,c=e*n;return[(r-o)*.5,(s-c)*.5,o,c,n]}drawThumbnail(){if(!this.bmpShader)throw new Error("bmpShader undefined");this.bmpShader.use(this.gl);const[a,e,t,i]=this.getBoundsRegion();this.gl.uniform2f(this.bmpShader.uniforms.canvasWidthHeight,t,i);let r=i,s=i*this.bmpTextureWH;s>t&&(r=t/this.bmpTextureWH,s=t);const n=a+(t-s)/2,o=e+(i-r)/2;this.gl.uniform4f(this.bmpShader.uniforms.leftTopWidthHeight,n,o,s,r),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}drawLine(a,e=1,t=[1,0,0,-1]){if(this.gl.bindVertexArray(this.genericVAO),!this.lineShader)throw new Error("lineShader undefined");this.lineShader.use(this.gl),t[3]<0&&(t=this.opts.crosshairColor),this.gl.uniform4fv(this.lineShader.uniforms.lineColor,t),this.gl.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.lineShader.uniforms.thickness,e),this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,a),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}draw3DLine(a,e,t=1,i=[1,0,0,-1]){if(this.gl.bindVertexArray(this.genericVAO),!this.line3DShader)throw new Error("line3DShader undefined");this.line3DShader.use(this.gl),i[3]<0&&(i=this.opts.crosshairColor),this.gl.uniform4fv(this.line3DShader.uniforms.lineColor,i),this.gl.uniform2fv(this.line3DShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.line3DShader.uniforms.thickness,t),this.gl.uniform2fv(this.line3DShader.uniforms.startXY,a),this.gl.uniform3fv(this.line3DShader.uniforms.endXYZ,e),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}drawDottedLine(a,e=1,t=[1,0,0,-1]){if(this.gl.bindVertexArray(this.genericVAO),!this.lineShader)throw new Error("lineShader undefined");this.lineShader.use(this.gl);const i=t[3]<0?[...this.opts.crosshairColor]:[...t];i[3]=.3;const r=Hc(a[2]-a[0],a[3]-a[1]),s=qc(r);Af(r,r);const o=this.fontPx*1;gf(r,r,o/2);const c=qc(r);let l=Math.floor(s/c);s%c&&l++;const h=[a[0],a[1]];this.gl.uniform4fv(this.lineShader.uniforms.lineColor,i),this.gl.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.lineShader.uniforms.thickness,e);for(let d=0;d<l-1;d++){if(d%2){h[0]+=r[0],h[1]+=r[1];continue}const f=[h[0],h[1],h[0]+r[0],h[1]+r[1]];this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,f),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),h[0]+=r[0],h[1]+=r[1]}this.gl.bindVertexArray(this.unusedVAO)}drawGraphLine(a,e=[1,0,0,.5],t=2){this.drawLine(a,t,e)}drawCrossLinesMM(a,e,t,i,r){if(a<0||this.screenSlices.length<=a)return;const s=this.screenSlices[a];let n=s.sliceFrac;n===1/0&&V.debug("Rendering approximate cross lines in world view mode"),n===1/0&&(n=.5);let c=i.slice(),l=r.slice();const h=Math.max(1,this.opts.crosshairWidth);e===1&&(c=t.slice()),e===2&&(c=t.slice(),l=i.slice());function d(f){const u=Hc(0,0);return u[0]=s.leftTopWidthHeight[0]+(f[0]-s.leftTopMM[0])/s.fovMM[0]*s.leftTopWidthHeight[2],u[1]=s.leftTopWidthHeight[1]+s.leftTopWidthHeight[3]-(f[1]-s.leftTopMM[1])/s.fovMM[1]*s.leftTopWidthHeight[3],u}if(c.length>0&&e===0){const f=n,u=1;for(let m=0;m<c.length;m++){const p=this.frac2mm([.5,.5,.5]);p[u]=c[m];let g=this.mm2frac(p);g=g[u];let b=this.frac2mm([0,g,f]);b=Le(b,[0,1,2]);let A=this.frac2mm([1,g,f]);A=Le(A,[0,1,2]),b=d(b),A=d(A),this.drawLine([b[0],b[1],A[0],A[1]],h)}}if(c.length>0&&e===1){const f=n,u=2;for(let m=0;m<c.length;m++){const p=this.frac2mm([.5,.5,.5]);p[u]=c[m];let g=this.mm2frac(p);g=g[u];let b=this.frac2mm([0,f,g]);b=Le(b,[0,2,1]);let A=this.frac2mm([1,f,g]);A=Le(A,[0,2,1]),b=d(b),A=d(A),this.drawLine([b[0],b[1],A[0],A[1]],h)}}if(c.length>0&&e===2){const f=n,u=2;for(let m=0;m<c.length;m++){const p=this.frac2mm([.5,.5,.5]);p[u]=c[m];let g=this.mm2frac(p);g=g[u];let b=this.frac2mm([f,0,g]);b=Le(b,[1,2,0]);let A=this.frac2mm([f,1,g]);A=Le(A,[1,2,0]),b=d(b),A=d(A),this.drawLine([b[0],b[1],A[0],A[1]],h)}}if(l.length>0&&e===0){const f=n,u=0;for(let m=0;m<l.length;m++){const p=this.frac2mm([.5,.5,.5]);p[u]=l[m];let g=this.mm2frac(p);g=g[u];let b=this.frac2mm([g,0,f]);b=Le(b,[0,1,2]);let A=this.frac2mm([g,1,f]);A=Le(A,[0,1,2]),b=d(b),A=d(A),this.drawLine([b[0],b[1],A[0],A[1]],h)}}if(l.length>0&&e===1){const f=n,u=0;for(let m=0;m<l.length;m++){const p=this.frac2mm([.5,.5,.5]);p[u]=l[m];let g=this.mm2frac(p);g=g[u];let b=this.frac2mm([g,f,0]);b=Le(b,[0,2,1]);let A=this.frac2mm([g,f,1]);A=Le(A,[0,2,1]),b=d(b),A=d(A),this.drawLine([b[0],b[1],A[0],A[1]],h)}}if(l.length>0&&e===2){const f=n,u=1;for(let m=0;m<l.length;m++){const p=this.frac2mm([.5,.5,.5]);p[u]=l[m];let g=this.mm2frac(p);g=g[u];let b=this.frac2mm([f,g,0]);b=Le(b,[1,2,0]);let A=this.frac2mm([f,g,1]);A=Le(A,[1,2,0]),b=d(b),A=d(A),this.drawLine([b[0],b[1],A[0],A[1]],h)}}}drawCrossLines(a,e,t,i,r){if(a<0||this.screenSlices.length<=a)return;if(this.opts.isSliceMM)return this.drawCrossLinesMM(a,e,t,i,r);if(this.screenSlices[a].sliceFrac===1/0)return this.drawCrossLinesMM(a,e,t,i,r);const s=this.screenSlices[a];let n=i.slice(),o=r.slice();if(e===1&&(n=t.slice()),e===2&&(n=t.slice(),o=i.slice()),n.length>0){const c=s.leftTopWidthHeight.slice();let l=2;e===0&&(l=1);const h=this.frac2mm([.5,.5,.5]);for(let d=0;d<n.length;d++){h[l]=n[d];const f=this.mm2frac(h);this.drawRect([c[0],c[1]+c[3]-f[l]*c[3],c[2],1])}}if(o.length>0){const c=s.leftTopWidthHeight.slice(),l=s.fovMM[0]<0;let h=0;e===2&&(h=1);const d=this.frac2mm([.5,.5,.5]);for(let f=0;f<o.length;f++){d[h]=o[f];const u=this.mm2frac(d);l?this.drawRect([c[0]+(c[2]-u[h]*c[2]),c[1],1,c[3]]):this.drawRect([c[0]+u[h]*c[2],c[1],1,c[3]])}}}drawMosaic(a){var g;this.screenSlices=[];const[e,t,i,r]=this.getBoundsRegion(),s=this.screenFieldOfViewMM(0,!0),n=this.screenFieldOfViewMM(0);a=a.replaceAll(";"," ;").trim();const o=[],c=[],l=[],h=a.split(/\s+/);let d=1;const f=this.fontPx;let u=0,m=0,p=0;(g=this.volumes[0])!=null&&g.dims||(p=Math.ceil(this.opts.tileMargin*.3));for(let b=0;b<2;b++){let A=!1,y=!1,x=0,E=0,I=0,w=0,v=!1,M=0,C=0,D=0,S=0;for(let B=0;B<h.length;B++){const O=h[B];if(O.includes("X")){y=!0;continue}if(O.includes("L")){v=!O.includes("-");continue}if(O.includes("H")){B++,C=Math.abs(Math.max(0,Math.min(1,parseFloat(h[B]))));continue}if(O.includes("V")){B++;continue}if(O.includes("A")){M=0;continue}if(O.includes("C")){M=1;continue}if(O.includes("S")){M=2;continue}if(O.includes("R")){A=!0;continue}if(O.includes(";")){I+=x,w=Math.max(w,E+D),x=0,E=0,D=0;continue}S=D,C>0&&!A&&(S=Math.round(S*(1-C))),E+=S,S=0;const L=parseFloat(O);if(isNaN(L))continue;let _=0,q=n;if(A&&(q=s),M===2?S=q[1]:S=q[0],M===0?_=q[1]:_=q[2],b===0)A||(M===0&&o.push(L),M===1&&c.push(L),M===2&&l.push(L));else{const J=[e+u+d*E,t+m+d*I,d*S,d*_];if(this.fontPx=v?f:0,A){let Z=L<0?-1/0:1/0;Object.is(L,-0)&&(Z=-1/0),this.draw2D(J,M,Z)}else this.draw2D(J,M,L);y&&this.drawCrossLines(this.screenSlices.length-1,M,o,c,l),A=!1,y=!1}D=S,E+=p,x=Math.max(x,_)}if(I+=x,w=Math.max(w,E+D),w<=0||I<=0)break;const k=(i-2*this.opts.tileMargin-p)/w,F=(r-2*this.opts.tileMargin)/I;d=Math.min(k,F),this.opts.centerMosaic?(u=Math.floor(.5*(i-w*d)),m=Math.floor(.5*(r-I*d))):(u=this.opts.tileMargin,m=this.opts.tileMargin)}this.fontPx=f}calculateWidthHeight(a,e,t,i){let r,s;switch(a){case 0:r=e[0],s=e[1];break;case 1:r=e[0],s=e[2];break;case 2:r=e[1],s=e[2];break;default:return[t,i]}const n=r/s,o=t/i;let c,l;return n>o?(c=t,l=t/n):(l=i,c=i*n),[c,l]}getBoundsRegionCSS(){const a=this.gl.canvas.getBoundingClientRect();if(!this.opts.bounds)return[0,0,a.width,a.height];const[[e,t],[i,r]]=this.opts.bounds,s=Math.round(e*a.width),n=Math.round((i-e)*a.width),o=Math.round(t*a.height),c=Math.round(r*a.height),l=c-o,h=a.height-c;return[s,h,n,l]}eventInBounds(a){const e=this.gl.canvas.getBoundingClientRect();let t,i;if(a instanceof MouseEvent)t=a.clientX,i=a.clientY;else if(a instanceof TouchEvent){const h=a.touches[0]??a.changedTouches[0];if(!h)return!1;t=h.clientX,i=h.clientY}else t=a.clientX,i=a.clientY;const r=t-e.left,s=i-e.top,[n,o,c,l]=this.getBoundsRegionCSS();return r>=n&&r<=n+c&&s>=o&&s<=o+l}cursorInBounds(){if(this.mousePos[0]<0||this.mousePos[1]<0)return!1;const[a,e,t,i]=this.getBoundsRegion(),[r,s]=this.mousePos;return r>=a&&r<=a+t&&s>=e&&s<=e+i}getBoundsRegion(){var u;const a=this.gl,e=((u=this.uiData)==null?void 0:u.dpr)||window.devicePixelRatio||1,t=a.canvas,i=t.clientWidth,r=t.clientHeight;if(!this.opts.bounds)return[0,0,a.canvas.width,a.canvas.height];const[[s,n],[o,c]]=this.opts.bounds,l=Math.floor(s*i*e),h=Math.ceil((o-s)*i*e);let d=Math.floor((1-c)*r*e),f=Math.ceil((c-n)*r*e);return d<0&&(f+=d,d=0),d+f>a.canvas.height&&(f=a.canvas.height-d),[l,d,h,f]}inBounds(a,e){const[t,i,r,s]=this.getBoundsRegion(),n=a*this.uiData.dpr,o=this.gl.canvas.height-e*this.uiData.dpr;return n>=t&&n<=t+r&&o>=i&&o<=i+s}bindTextures(){this.gl.activeTexture(Ma),this.gl.bindTexture(this.gl.TEXTURE_3D,this.volumeTexture),this.gl.activeTexture(Ws),this.gl.bindTexture(this.gl.TEXTURE_3D,this.overlayTexture),this.gl.activeTexture(Ha),this.gl.bindTexture(this.gl.TEXTURE_3D,this.paqdTexture),this.gl.activeTexture(Il),this.gl.bindTexture(this.gl.TEXTURE_2D,this.fontTexture),this.gl.activeTexture(Jr),this.gl.bindTexture(this.gl.TEXTURE_2D,this.colormapTexture),this.gl.activeTexture(qn),this.gl.bindTexture(this.gl.TEXTURE_2D,this.matCapTexture),this.gl.activeTexture(Ys),this.gl.bindTexture(this.gl.TEXTURE_3D,this.gradientTexture)}clearBounds(a=this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT,e){const t=this.gl,[i,r,s,n]=e??this.getBoundsRegion(),o=t.canvas.height-r-n;a&t.DEPTH_BUFFER_BIT&&t.clearDepth(1),t.enable(t.SCISSOR_TEST),t.scissor(i,o,s,n),a&t.COLOR_BUFFER_BIT&&t.clearColor(this.opts.backColor[0],this.opts.backColor[1],this.opts.backColor[2],this.opts.backColor[3]),t.clear(a),t.disable(t.SCISSOR_TEST)}drawBoundsBorder(){if(!this.opts.showBoundsBorder)return;const[a,e,t,i]=this.getBoundsRegion();this.drawBoundsBox([a,e,t,i],this.opts.boundsBorderColor,this.opts.selectionBoxLineThickness)}drawSceneCore(){var c,l,h;if(!this.initialized)return;this.colorbarHeight=0;const[a,e,t,i]=this.getBoundsRegion();if(this.gl.viewport(a,e,t,i),this.clearBounds(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.bindTextures(),this.bmpTexture&&this.thumbnailVisible){this.drawThumbnail();return}let r="";if(this.volumes.length===0||typeof this.volumes[0].dims>"u"){if(this.meshes.length>0){if(this.sliceMosaicString.length>0){this.opts.isColorbar&&this.reserveColorbarPanel(),this.drawMosaic(this.sliceMosaicString),this.opts.isColorbar&&this.drawColorbar();return}this.screenSlices=[],this.draw3D([a,e,t,i]),this.opts.isColorbar&&this.drawColorbar();return}this.drawLoadingText(this.opts.loadingText);return}if(this.uiData.isDragging&&this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex][0]<1.8&&this.inRenderTile(this.uiData.dragStart[0],this.uiData.dragStart[1])>=0){const d=this.uiData.dragStart[0]-this.uiData.dragEnd[0],f=this.uiData.dragStart[1]-this.uiData.dragEnd[1],u=this.uiData.dragClipPlaneStartDepthAziElev.slice();if(u[1]-=d,u[1]=u[1]%360,u[2]+=f,u[1]!==this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex][1]||u[2]!==this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex][2])return this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex]=u,this.setClipPlane(this.scene.clipPlaneDepthAziElevs[this.uiData.activeClipPlaneIndex])}if(this.sliceMosaicString.length<1&&this.opts.sliceType===4){this.opts.isColorbar&&this.reserveColorbarPanel(),this.screenSlices=[],this.draw3D(),this.opts.isColorbar&&this.drawColorbar();return}this.opts.isColorbar&&this.reserveColorbarPanel();const s=this.getMaxVols(),n=this.opts.sliceType===3&&s>1&&this.graph.autoSizeMultiplanar&&this.graph.opacity>0;if(this.sliceMosaicString.length>0)this.drawMosaic(this.sliceMosaicString);else{const d=[0,0];let f=!1;if(this.screenSlices=[],this.customLayout&&this.customLayout.length>0){this.screenSlices=[];const{volScale:u}=this.sliceScale();for(const m of this.customLayout){const{sliceType:p,position:g,sliceMM:b}=m,A=[a+g[0]*t,e+g[1]*i,g[2]*t,g[3]*i];if(A[0]+A[2]>a+t&&(V.warn("adjusting slice width because it would have been clipped"),A[2]=a+t-A[0]),A[1]+A[3]>e+i&&(V.warn("adjusting slice height because it would have been clipped"),A[3]=e+i-A[1]),p===4)this.draw3D(A);else{const y=this.calculateWidthHeight(p,u,A[2],A[3]);this.draw2D(A,p,b??NaN,y)}}}else if(this.opts.sliceType===0||this.opts.sliceType===1||this.opts.sliceType===2){const{volScale:u}=this.sliceScale(),m=[a,e,t,i],p=this.calculateWidthHeight(this.opts.sliceType,u,m[2],m[3]);this.draw2D([0,0,0,0],this.opts.sliceType,NaN,p)}else{let u=function(le,de){return[(le-1)*A+le*y,(de-1)*A+de*y]},m=!1;this.opts.multiplanarForceRender?(m=!0,this.opts.multiplanarForceRender?this.opts.multiplanarShowRender=1:this.opts.multiplanarShowRender=2,delete this.opts.multiplanarForceRender):this.opts.multiplanarShowRender===1&&(m=!0);const p=isFinite(this.drawPenLocation[0])&&this.opts.drawingEnabled,{volScale:g}=this.sliceScale(),b=g.slice();this.opts.multiplanarEqualSize&&(g[0]=1,g[1]=1,g[2]=1),typeof this.opts.multiplanarPadPixels!="number"&&V.debug("multiplanarPadPixels must be numeric");const A=parseFloat(`${this.opts.multiplanarPadPixels}`)*this.uiData.dpr;let y=this.opts.tileMargin*this.uiData.dpr;y<0&&(y=2*(2+Math.ceil(this.fontPx)));const[x,E,I,w]=this.getBoundsRegion();let v=[this.effectiveCanvasWidth(),this.effectiveCanvasHeight()];this.opts.heroImageFraction>0&&this.opts.heroImageFraction<1&&(m=!1,f=!0,v[0]>v[1]&&this.opts.multiplanarLayout!==3?d[0]=v[0]*this.opts.heroImageFraction:d[1]=v[1]*this.opts.heroImageFraction,v=[v[0]-d[0],v[1]-d[1]]);const M=this.scaleSlice(g[0]+g[1],g[1]+g[2],u(2,2),v),C=Math.max(Math.max(g[1],g[2]),g[0]),D=this.scaleSlice(g[0]+g[0]+g[1],Math.max(g[1],g[2]),u(3,1),v),S=this.scaleSlice(g[0]+g[0]+g[1]+C,Math.max(g[1],g[2]),u(4,1),v),k=this.scaleSlice(C,g[1]+g[2]+g[2],u(1,3),v),F=this.scaleSlice(C,g[1]+g[2]+g[2]+C,u(1,4),v);let B=!p&&(s<2||!n),O=!1,L=!1,_=!1;this.opts.multiplanarLayout===1?O=!0:this.opts.multiplanarLayout===2?L=!0:this.opts.multiplanarLayout===3?_=!0:k[4]>D[4]&&k[4]>M[4]?O=!0:D[4]>M[4]?_=!0:L=!0;let q=M;if(O?(q=k,!f&&(m||this.opts.multiplanarShowRender===2&&F[4]>=k[4])?q=F:B=!1):_&&(q=D,!f&&(m||this.opts.multiplanarShowRender===2&&S[4]>=D[4])?q=S:B=!1),f){const le=d[0]===0?I:d[0],de=d[1]===0?w:d[1];if(((c=this.opts)==null?void 0:c.heroSliceType)===0||((l=this.opts)==null?void 0:l.heroSliceType)===1||((h=this.opts)==null?void 0:h.heroSliceType)===2)this.draw2D([x,E,le,de],this.opts.heroSliceType,NaN,[1/0,1/0]);else{const Me=q.slice();le===I&&(Me[0]=0),this.draw3D([x+Me[0],E,le,de])}q[0]+=d[0],q[1]+=d[1],B=!1}const J=g[0]*q[4]+y,Z=g[1]*q[4]+y,Y=g[2]*q[4]+y,W=b[0]*q[4],T=b[1]*q[4],ne=b[2]*q[4];if(O){if(this.draw2D([x+q[0],E+q[1],J,Z],0,NaN,[W,T]),this.draw2D([x+q[0],E+q[1]+Z+A,J,Y],1,NaN,[W,ne]),this.draw2D([x+q[0],E+q[1]+Z+A+Y+A,Z,Y],2,NaN,[T,ne]),B){const le=C*q[4];this.draw3D([x+q[0],E+q[1]+Z+Y+Y+A*3,le,le])}}else if(_){if(this.draw2D([x+q[0],E+q[1],J,Z],0,NaN,[W,T]),this.draw2D([x+q[0]+J+A,E+q[1],J,Y],1,NaN,[W,ne]),this.draw2D([x+q[0]+J+J+A*2,E+q[1],Z,Y],2,NaN,[T,ne]),B){const le=C*q[4];this.draw3D([x+q[0]+J+J+Z+A*3,E+q[1],le,le])}}else L&&(m||(B=!1),this.opts.multiplanarShowRender===2&&(B=!0),f&&(B=!1),this.draw2D([x+q[0],E+q[1]+Y+A,J,Z],0,NaN,[W,T]),this.draw2D([x+q[0],E+q[1],J,Y],1,NaN,[W,ne]),this.draw2D([x+q[0]+J+A,E+q[1],Z,Y],2,NaN,[T,ne]),B&&this.draw3D([x+q[0]+J+A,E+q[1]+Y+A,Z,Z]))}}if(this.opts.isRuler&&this.drawRuler(),this.opts.isColorbar&&this.drawColorbar(),n&&this.drawGraph(),this.uiData.isDragging){if(this.uiData.mouseButtonCenterDown){this.dragForCenterButton([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}if(this.getCurrentDragMode()===4){this.dragForSlicer3D([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}if(this.getCurrentDragMode()===3){this.dragForPanZoom([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}if(this.inRenderTile(this.uiData.dragStart[0],this.uiData.dragStart[1])>=0)return;this.getCurrentDragMode()===2&&this.drawMeasurementTool([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]),this.getCurrentDragMode()===7&&this.drawAngleMeasurementTool();const d=this.getCurrentDragMode();if(d===1||d===6){const f=Math.abs(this.uiData.dragStart[0]-this.uiData.dragEnd[0]),u=Math.abs(this.uiData.dragStart[1]-this.uiData.dragEnd[1]);this.drawSelectionBox([Math.min(this.uiData.dragStart[0],this.uiData.dragEnd[0]),Math.min(this.uiData.dragStart[1],this.uiData.dragEnd[1]),f,u])}}for(const d of this.document.completedMeasurements)if(this.shouldDrawOnCurrentSlice(d.sliceIndex,d.sliceType,d.slicePosition)){const f=this.mm2frac(d.startMM),u=this.mm2frac(d.endMM),m=this.frac2canvasPosWithTile(f,d.sliceType),p=this.frac2canvasPosWithTile(u,d.sliceType);m&&p&&m.tileIndex===p.tileIndex&&this.drawMeasurementTool([m.pos[0],m.pos[1],p.pos[0],p.pos[1]])}for(let d=0;d<this.document.completedAngles.length;d++){const f=this.document.completedAngles[d];if(this.shouldDrawOnCurrentSlice(f.sliceIndex,f.sliceType,f.slicePosition)){const m=this.mm2frac(f.firstLineMM.start),p=this.mm2frac(f.firstLineMM.end),g=this.mm2frac(f.secondLineMM.start),b=this.mm2frac(f.secondLineMM.end),A=this.frac2canvasPosWithTile(m,f.sliceType),y=this.frac2canvasPosWithTile(p,f.sliceType),x=this.frac2canvasPosWithTile(g,f.sliceType),E=this.frac2canvasPosWithTile(b,f.sliceType);if(A&&y&&x&&E&&A.tileIndex===y.tileIndex&&A.tileIndex===x.tileIndex&&A.tileIndex===E.tileIndex){this.drawMeasurementTool([A.pos[0],A.pos[1],y.pos[0],y.pos[1]],!1),this.drawMeasurementTool([x.pos[0],x.pos[1],E.pos[0],E.pos[1]],!1);const I={firstLine:[A.pos[0],A.pos[1],y.pos[0],y.pos[1]],secondLine:[x.pos[0],x.pos[1],E.pos[0],E.pos[1]],sliceIndex:f.sliceIndex,sliceType:f.sliceType,slicePosition:f.slicePosition};this.drawAngleTextForAngle(I)}}}const o=this.frac2mm([this.scene.crosshairPos[0],this.scene.crosshairPos[1],this.scene.crosshairPos[2]]);return r=o[0].toFixed(2)+""+o[1].toFixed(2)+""+o[2].toFixed(2),this.readyForSync=!0,this.sync(),this.drawAnchoredLabels(),this.drawBoundsBorder(),r}drawScene(){if(this.isBusy){this.needsRefresh=!0;return}this.isBusy=!1,this.needsRefresh=!1;let a=this.drawSceneCore();return this._gl!==null&&this.gl.finish(),this.needsRefresh&&(a=this.drawScene()),a}get gl(){if(!this._gl)throw new Error("unable to get WebGL context. Maybe the browser doesn't support WebGL2.");return this._gl}set gl(a){this._gl=a}findDrawingBoundarySlices(a){if(!this.back||!this.back.dims||!this.drawBitmap)return null;const e={dimX:this.back.dims[1],dimY:this.back.dims[2],dimZ:this.back.dims[3]};return Sp(a,this.drawBitmap,e)}interpolateMaskSlices(a,e,t={}){if(!this.back||!this.back.dims||!this.drawBitmap)throw new Error("Background image and drawing bitmap must be loaded");const i={dimX:this.back.dims[1],dimY:this.back.dims[2],dimZ:this.back.dims[3]},r=this.back.img,s=this.back.global_max;Up(this.drawBitmap,i,r,s,a,e,t,()=>this.refreshDrawing(!0))}};Ca=new WeakMap;class Wh{constructor(){this._listeners={}}addEventListener(e,t){const i=this._listeners;return i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t),this}removeEventListener(e,t){const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}return this}dispatchEvent(e){const i=this._listeners[e.type];if(i!==void 0){const r=i.slice(0);for(let s=0,n=r.length;s<n;s++)r[s].call(this,e)}return this}dispose(){for(const e in this._listeners)delete this._listeners[e]}}class Ja{constructor(e,t,i,r={}){if(this._name=void 0,this._parent=void 0,this._child=void 0,this._attributes=void 0,this._disposed=!1,this._name=e,this._parent=t,this._child=i,this._attributes=r,!t.isOnGraph(i))throw new Error("Cannot connect disconnected graphs.")}getName(){return this._name}getParent(){return this._parent}getChild(){return this._child}setChild(e){return this._child=e,this}getAttributes(){return this._attributes}dispose(){this._disposed||(this._parent._destroyRef(this),this._disposed=!0)}isDisposed(){return this._disposed}}class W0 extends Wh{constructor(...e){super(...e),this._emptySet=new Set,this._edges=new Set,this._parentEdges=new Map,this._childEdges=new Map}listEdges(){return Array.from(this._edges)}listParentEdges(e){return Array.from(this._childEdges.get(e)||this._emptySet)}listParents(e){const t=new Set;for(const i of this.listParentEdges(e))t.add(i.getParent());return Array.from(t)}listChildEdges(e){return Array.from(this._parentEdges.get(e)||this._emptySet)}listChildren(e){const t=new Set;for(const i of this.listChildEdges(e))t.add(i.getChild());return Array.from(t)}disconnectParents(e,t){for(const i of this.listParentEdges(e))(!t||t(i.getParent()))&&i.dispose();return this}_createEdge(e,t,i,r){const s=new Ja(e,t,i,r);this._edges.add(s);const n=s.getParent();this._parentEdges.has(n)||this._parentEdges.set(n,new Set),this._parentEdges.get(n).add(s);const o=s.getChild();return this._childEdges.has(o)||this._childEdges.set(o,new Set),this._childEdges.get(o).add(s),s}_destroyEdge(e){return this._edges.delete(e),this._parentEdges.get(e.getParent()).delete(e),this._childEdges.get(e.getChild()).delete(e),this}}function ds(){return ds=Object.assign||function(a){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(a[i]=t[i])}return a},ds.apply(this,arguments)}class Aa{constructor(e){if(this.list=[],e)for(const t of e)this.list.push(t)}add(e){this.list.push(e)}remove(e){const t=this.list.indexOf(e);t>=0&&this.list.splice(t,1)}removeChild(e){const t=[];for(const i of this.list)i.getChild()===e&&t.push(i);for(const i of t)this.remove(i);return t}listRefsByChild(e){const t=[];for(const i of this.list)i.getChild()===e&&t.push(i);return t}values(){return this.list}}class Re{constructor(e){if(this.set=new Set,this.map=new Map,e)for(const t of e)this.add(t)}add(e){const t=e.getChild();this.removeChild(t),this.set.add(e),this.map.set(t,e)}remove(e){this.set.delete(e),this.map.delete(e.getChild())}removeChild(e){const t=this.map.get(e)||null;return t&&this.remove(t),t}getRefByChild(e){return this.map.get(e)||null}values(){return Array.from(this.set)}}class kt{constructor(e){this.map={},e&&Object.assign(this.map,e)}set(e,t){this.map[e]=t}delete(e){delete this.map[e]}get(e){return this.map[e]||null}keys(){return Object.keys(this.map)}values(){return Object.values(this.map)}}const Te=Symbol("attributes"),Sa=Symbol("immutableKeys");class Oo extends Wh{constructor(e){super(),this._disposed=!1,this.graph=void 0,this[Te]=void 0,this[Sa]=void 0,this.graph=e,this[Sa]=new Set,this[Te]=this._createAttributes()}getDefaults(){return{}}_createAttributes(){const e=this.getDefaults(),t={};for(const i in e){const r=e[i];if(r instanceof Oo){const s=this.graph._createEdge(i,this,r);this[Sa].add(i),t[i]=s}else t[i]=r}return t}isOnGraph(e){return this.graph===e.graph}isDisposed(){return this._disposed}dispose(){this._disposed||(this.graph.listChildEdges(this).forEach(e=>e.dispose()),this.graph.disconnectParents(this),this._disposed=!0,this.dispatchEvent({type:"dispose"}))}detach(){return this.graph.disconnectParents(this),this}swap(e,t){for(const i in this[Te]){const r=this[Te][i];if(r instanceof Ja){const s=r;s.getChild()===e&&this.setRef(i,t,s.getAttributes())}else if(r instanceof Aa)for(const s of r.listRefsByChild(e)){const n=s.getAttributes();this.removeRef(i,e),this.addRef(i,t,n)}else if(r instanceof Re){const s=r.getRefByChild(e);if(s){const n=s.getAttributes();this.removeRef(i,e),this.addRef(i,t,n)}}else if(r instanceof kt)for(const s of r.keys()){const n=r.get(s);n.getChild()===e&&this.setRefMap(i,s,t,n.getAttributes())}}return this}get(e){return this[Te][e]}set(e,t){return this[Te][e]=t,this.dispatchEvent({type:"change",attribute:e})}getRef(e){const t=this[Te][e];return t?t.getChild():null}setRef(e,t,i){if(this[Sa].has(e))throw new Error(`Cannot overwrite immutable attribute, "${e}".`);const r=this[Te][e];if(r&&r.dispose(),!t)return this;const s=this.graph._createEdge(e,this,t,i);return this[Te][e]=s,this.dispatchEvent({type:"change",attribute:e})}listRefs(e){return this.assertRefList(e).values().map(i=>i.getChild())}addRef(e,t,i){const r=this.graph._createEdge(e,this,t,i);return this.assertRefList(e).add(r),this.dispatchEvent({type:"change",attribute:e})}removeRef(e,t){const i=this.assertRefList(e);if(i instanceof Aa)for(const r of i.listRefsByChild(t))r.dispose();else{const r=i.getRefByChild(t);r&&r.dispose()}return this}assertRefList(e){const t=this[Te][e];if(t instanceof Aa||t instanceof Re)return t;throw new Error(`Expected RefList or RefSet for attribute "${e}"`)}listRefMapKeys(e){return this.assertRefMap(e).keys()}listRefMapValues(e){return this.assertRefMap(e).values().map(t=>t.getChild())}getRefMap(e,t){const r=this.assertRefMap(e).get(t);return r?r.getChild():null}setRefMap(e,t,i,r){const s=this.assertRefMap(e),n=s.get(t);if(n&&n.dispose(),!i)return this;r=Object.assign(r||{},{key:t});const o=this.graph._createEdge(e,this,i,ds({},r,{key:t}));return s.set(t,o),this.dispatchEvent({type:"change",attribute:e,key:t})}assertRefMap(e){const t=this[Te][e];if(t instanceof kt)return t;throw new Error(`Expected RefMap for attribute "${e}"`)}dispatchEvent(e){return super.dispatchEvent(ds({},e,{target:this})),this.graph.dispatchEvent(ds({},e,{target:this,type:`node:${e.type}`})),this}_destroyRef(e){const t=e.getName();if(this[Te][t]===e)this[Te][t]=null,this[Sa].has(t)&&e.getChild().dispose();else if(this[Te][t]instanceof Aa)this[Te][t].remove(e);else if(this[Te][t]instanceof Re)this[Te][t].remove(e);else if(this[Te][t]instanceof kt){const i=this[Te][t];for(const r of i.keys())i.get(r)===e&&i.delete(r)}else return;this.graph._destroyEdge(e),this.dispatchEvent({type:"change",attribute:t})}}const Yh="v4.2.1",ai="@glb.bin";var X;(function(a){a.ACCESSOR="Accessor",a.ANIMATION="Animation",a.ANIMATION_CHANNEL="AnimationChannel",a.ANIMATION_SAMPLER="AnimationSampler",a.BUFFER="Buffer",a.CAMERA="Camera",a.MATERIAL="Material",a.MESH="Mesh",a.PRIMITIVE="Primitive",a.PRIMITIVE_TARGET="PrimitiveTarget",a.NODE="Node",a.ROOT="Root",a.SCENE="Scene",a.SKIN="Skin",a.TEXTURE="Texture",a.TEXTURE_INFO="TextureInfo"})(X||(X={}));var mn;(function(a){a.INTERLEAVED="interleaved",a.SEPARATE="separate"})(mn||(mn={}));var wt;(function(a){a.ARRAY_BUFFER="ARRAY_BUFFER",a.ELEMENT_ARRAY_BUFFER="ELEMENT_ARRAY_BUFFER",a.INVERSE_BIND_MATRICES="INVERSE_BIND_MATRICES",a.OTHER="OTHER",a.SPARSE="SPARSE"})(wt||(wt={}));var _t;(function(a){a[a.R=4096]="R",a[a.G=256]="G",a[a.B=16]="B",a[a.A=1]="A"})(_t||(_t={}));var ia;(function(a){a.GLTF="GLTF",a.GLB="GLB"})(ia||(ia={}));const In={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};class be{static createBufferFromDataURI(e){if(typeof Buffer>"u"){const t=atob(e.split(",")[1]),i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}else{const t=e.split(",")[1],i=e.indexOf("base64")>=0;return Buffer.from(t,i?"base64":"utf8")}}static encodeText(e){return new TextEncoder().encode(e)}static decodeText(e){return new TextDecoder().decode(e)}static concat(e){let t=0;for(const s of e)t+=s.byteLength;const i=new Uint8Array(t);let r=0;for(const s of e)i.set(s,r),r+=s.byteLength;return i}static pad(e,t=0){const i=this.padNumber(e.byteLength);if(i===e.byteLength)return e;const r=new Uint8Array(i);if(r.set(e),t!==0)for(let s=e.byteLength;s<i;s++)r[s]=t;return r}static padNumber(e){return Math.ceil(e/4)*4}static equals(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;let i=e.byteLength;for(;i--;)if(e[i]!==t[i])return!1;return!0}static toView(e,t=0,i=1/0){return new Uint8Array(e.buffer,e.byteOffset+t,Math.min(e.byteLength,i))}static assertView(e){if(e&&!ArrayBuffer.isView(e))throw new Error(`Method requires Uint8Array parameter; received "${typeof e}".`);return e}}class Y0{match(e){return e.length>=3&&e[0]===255&&e[1]===216&&e[2]===255}getSize(e){let t=new DataView(e.buffer,e.byteOffset+4),i,r;for(;t.byteLength;){if(i=t.getUint16(0,!1),X0(t,i),r=t.getUint8(i+1),r===192||r===193||r===194)return[t.getUint16(i+7,!1),t.getUint16(i+5,!1)];t=new DataView(e.buffer,t.byteOffset+i+2)}throw new TypeError("Invalid JPG, no size found")}getChannels(e){return 3}}class Mn{match(e){return e.length>=8&&e[0]===137&&e[1]===80&&e[2]===78&&e[3]===71&&e[4]===13&&e[5]===10&&e[6]===26&&e[7]===10}getSize(e){const t=new DataView(e.buffer,e.byteOffset);return be.decodeText(e.slice(12,16))===Mn.PNG_FRIED_CHUNK_NAME?[t.getUint32(32,!1),t.getUint32(36,!1)]:[t.getUint32(16,!1),t.getUint32(20,!1)]}getChannels(e){return 4}}Mn.PNG_FRIED_CHUNK_NAME="CgBI";class Ot{static registerFormat(e,t){this.impls[e]=t}static getMimeType(e){for(const t in this.impls)if(this.impls[t].match(e))return t;return null}static getSize(e,t){return this.impls[t]?this.impls[t].getSize(e):null}static getChannels(e,t){return this.impls[t]?this.impls[t].getChannels(e):null}static getVRAMByteLength(e,t){if(!this.impls[t])return null;if(this.impls[t].getVRAMByteLength)return this.impls[t].getVRAMByteLength(e);let i=0;const r=4,s=this.getSize(e,t);if(!s)return null;for(;s[0]>1||s[1]>1;)i+=s[0]*s[1]*r,s[0]=Math.max(Math.floor(s[0]/2),1),s[1]=Math.max(Math.floor(s[1]/2),1);return i+=1*r,i}static mimeTypeToExtension(e){return e==="image/jpeg"?"jpg":e.split("/").pop()}static extensionToMimeType(e){return e==="jpg"?"image/jpeg":e?`image/${e}`:""}}Ot.impls={"image/jpeg":new Y0,"image/png":new Mn};function X0(a,e){if(e>a.byteLength)throw new TypeError("Corrupt JPG, exceeded buffer limits");if(a.getUint8(e)!==255)throw new TypeError("Invalid JPG, marker table corrupted");return a}class Ba{static basename(e){const t=e.split(/[\\/]/).pop();return t.substring(0,t.lastIndexOf("."))}static extension(e){if(e.startsWith("data:image/")){const t=e.match(/data:(image\/\w+)/)[1];return Ot.mimeTypeToExtension(t)}else{if(e.startsWith("data:model/gltf+json"))return"gltf";if(e.startsWith("data:model/gltf-binary"))return"glb";if(e.startsWith("data:application/"))return"bin"}return e.split(/[\\/]/).pop().split(/[.]/).pop()}}var ho=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var a=0,e=arguments.length;e--;)a+=arguments[e]*arguments[e];return Math.sqrt(a)});function Q0(){var a=new ho(3);return ho!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function Wn(a){var e=a[0],t=a[1],i=a[2];return Math.hypot(e,t,i)}function J0(a,e,t){var i=e[0],r=e[1],s=e[2],n=t[3]*i+t[7]*r+t[11]*s+t[15];return n=n||1,a[0]=(t[0]*i+t[4]*r+t[8]*s+t[12])/n,a[1]=(t[1]*i+t[5]*r+t[9]*s+t[13])/n,a[2]=(t[2]*i+t[6]*r+t[10]*s+t[14])/n,a}(function(){var a=Q0();return function(e,t,i,r,s,n){var o,c;for(t||(t=3),i||(i=0),r?c=Math.min(r*t+i,e.length):c=e.length,o=i;o<c;o+=t)a[0]=e[o],a[1]=e[o+1],a[2]=e[o+2],s(a,a,n),e[o]=a[0],e[o+1]=a[1],e[o+2]=a[2];return e}})();function Z0(a){const e=Xh(),t=a.propertyType===X.NODE?[a]:a.listChildren();for(const i of t)i.traverse(r=>{const s=r.getMesh();if(!s)return;const n=$0(s,r.getWorldMatrix());n.min.every(isFinite)&&n.max.every(isFinite)&&(fo(n.min,e),fo(n.max,e))});return e}function $0(a,e){const t=Xh();for(const i of a.listPrimitives()){const r=i.getAttribute("POSITION"),s=i.getIndices();if(!r)continue;let n=[0,0,0],o=[0,0,0];for(let c=0,l=s?s.getCount():r.getCount();c<l;c++){const h=s?s.getScalar(c):c;n=r.getElement(h,n),o=J0(o,n,e),fo(o,t)}}return t}function fo(a,e){for(let t=0;t<3;t++)e.min[t]=Math.min(a[t],e.min[t]),e.max[t]=Math.max(a[t],e.max[t])}function Xh(){return{min:[1/0,1/0,1/0],max:[-1/0,-1/0,-1/0]}}const Sl="https://null.example";class ut{static dirname(e){const t=e.lastIndexOf("/");return t===-1?"./":e.substring(0,t+1)}static basename(e){return Ba.basename(new URL(e,Sl).pathname)}static extension(e){return Ba.extension(new URL(e,Sl).pathname)}static resolve(e,t){if(!this.isRelativePath(t))return t;const i=e.split("/"),r=t.split("/");i.pop();for(let s=0;s<r.length;s++)r[s]!=="."&&(r[s]===".."?i.pop():i.push(r[s]));return i.join("/")}static isAbsoluteURL(e){return this.PROTOCOL_REGEXP.test(e)}static isRelativePath(e){return!/^(?:[a-zA-Z]+:)?\//.test(e)}}ut.DEFAULT_INIT={};ut.PROTOCOL_REGEXP=/^[a-zA-Z]+:\/\//;function Fl(a){return Object.prototype.toString.call(a)==="[object Object]"}function Ra(a){if(Fl(a)===!1)return!1;const e=a.constructor;if(e===void 0)return!0;const t=e.prototype;return!(Fl(t)===!1||Object.hasOwn(t,"isPrototypeOf")===!1)}var uo,bo;(function(a){a[a.SILENT=4]="SILENT",a[a.ERROR=3]="ERROR",a[a.WARN=2]="WARN",a[a.INFO=1]="INFO",a[a.DEBUG=0]="DEBUG"})(bo||(bo={}));class Dt{constructor(e){this.verbosity=void 0,this.verbosity=e}debug(e){this.verbosity<=Dt.Verbosity.DEBUG&&console.debug(e)}info(e){this.verbosity<=Dt.Verbosity.INFO&&console.info(e)}warn(e){this.verbosity<=Dt.Verbosity.WARN&&console.warn(e)}error(e){this.verbosity<=Dt.Verbosity.ERROR&&console.error(e)}}uo=Dt;Dt.Verbosity=bo;Dt.DEFAULT_INSTANCE=new uo(uo.Verbosity.INFO);function em(a){var e=a[0],t=a[1],i=a[2],r=a[3],s=a[4],n=a[5],o=a[6],c=a[7],l=a[8],h=a[9],d=a[10],f=a[11],u=a[12],m=a[13],p=a[14],g=a[15],b=e*n-t*s,A=e*o-i*s,y=e*c-r*s,x=t*o-i*n,E=t*c-r*n,I=i*c-r*o,w=l*m-h*u,v=l*p-d*u,M=l*g-f*u,C=h*p-d*m,D=h*g-f*m,S=d*g-f*p;return b*S-A*D+y*C+x*M-E*v+I*w}function tm(a,e,t){var i=e[0],r=e[1],s=e[2],n=e[3],o=e[4],c=e[5],l=e[6],h=e[7],d=e[8],f=e[9],u=e[10],m=e[11],p=e[12],g=e[13],b=e[14],A=e[15],y=t[0],x=t[1],E=t[2],I=t[3];return a[0]=y*i+x*o+E*d+I*p,a[1]=y*r+x*c+E*f+I*g,a[2]=y*s+x*l+E*u+I*b,a[3]=y*n+x*h+E*m+I*A,y=t[4],x=t[5],E=t[6],I=t[7],a[4]=y*i+x*o+E*d+I*p,a[5]=y*r+x*c+E*f+I*g,a[6]=y*s+x*l+E*u+I*b,a[7]=y*n+x*h+E*m+I*A,y=t[8],x=t[9],E=t[10],I=t[11],a[8]=y*i+x*o+E*d+I*p,a[9]=y*r+x*c+E*f+I*g,a[10]=y*s+x*l+E*u+I*b,a[11]=y*n+x*h+E*m+I*A,y=t[12],x=t[13],E=t[14],I=t[15],a[12]=y*i+x*o+E*d+I*p,a[13]=y*r+x*c+E*f+I*g,a[14]=y*s+x*l+E*u+I*b,a[15]=y*n+x*h+E*m+I*A,a}function am(a,e){var t=e[0],i=e[1],r=e[2],s=e[4],n=e[5],o=e[6],c=e[8],l=e[9],h=e[10];return a[0]=Math.hypot(t,i,r),a[1]=Math.hypot(s,n,o),a[2]=Math.hypot(c,l,h),a}function im(a,e){var t=new ho(3);am(t,e);var i=1/t[0],r=1/t[1],s=1/t[2],n=e[0]*i,o=e[1]*r,c=e[2]*s,l=e[4]*i,h=e[5]*r,d=e[6]*s,f=e[8]*i,u=e[9]*r,m=e[10]*s,p=n+h+m,g=0;return p>0?(g=Math.sqrt(p+1)*2,a[3]=.25*g,a[0]=(d-u)/g,a[1]=(f-c)/g,a[2]=(o-l)/g):n>h&&n>m?(g=Math.sqrt(1+n-h-m)*2,a[3]=(d-u)/g,a[0]=.25*g,a[1]=(o+l)/g,a[2]=(f+c)/g):h>m?(g=Math.sqrt(1+h-n-m)*2,a[3]=(f-c)/g,a[0]=(o+l)/g,a[1]=.25*g,a[2]=(d+u)/g):(g=Math.sqrt(1+m-n-h)*2,a[3]=(o-l)/g,a[0]=(f+c)/g,a[1]=(d+u)/g,a[2]=.25*g),a}class De{static identity(e){return e}static eq(e,t,i=1e-5){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(Math.abs(e[r]-t[r])>i)return!1;return!0}static clamp(e,t,i){return e<t?t:e>i?i:e}static decodeNormalizedInt(e,t){switch(t){case 5126:return e;case 5123:return e/65535;case 5121:return e/255;case 5122:return Math.max(e/32767,-1);case 5120:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}static encodeNormalizedInt(e,t){switch(t){case 5126:return e;case 5123:return Math.round(De.clamp(e,0,1)*65535);case 5121:return Math.round(De.clamp(e,0,1)*255);case 5122:return Math.round(De.clamp(e,-1,1)*32767);case 5120:return Math.round(De.clamp(e,-1,1)*127);default:throw new Error("Invalid component type.")}}static decompose(e,t,i,r){let s=Wn([e[0],e[1],e[2]]);const n=Wn([e[4],e[5],e[6]]),o=Wn([e[8],e[9],e[10]]);em(e)<0&&(s=-s),t[0]=e[12],t[1]=e[13],t[2]=e[14];const l=e.slice(),h=1/s,d=1/n,f=1/o;l[0]*=h,l[1]*=h,l[2]*=h,l[4]*=d,l[5]*=d,l[6]*=d,l[8]*=f,l[9]*=f,l[10]*=f,im(i,l),r[0]=s,r[1]=n,r[2]=o}static compose(e,t,i,r){const s=r,n=t[0],o=t[1],c=t[2],l=t[3],h=n+n,d=o+o,f=c+c,u=n*h,m=n*d,p=n*f,g=o*d,b=o*f,A=c*f,y=l*h,x=l*d,E=l*f,I=i[0],w=i[1],v=i[2];return s[0]=(1-(g+A))*I,s[1]=(m+E)*I,s[2]=(p-x)*I,s[3]=0,s[4]=(m-E)*w,s[5]=(1-(u+A))*w,s[6]=(b+y)*w,s[7]=0,s[8]=(p+x)*v,s[9]=(b-y)*v,s[10]=(1-(u+g))*v,s[11]=0,s[12]=e[0],s[13]=e[1],s[14]=e[2],s[15]=1,s}}function rm(a,e){if(!!a!=!!e)return!1;const t=a.getChild(),i=e.getChild();return t===i||t.equals(i)}function sm(a,e){if(!!a!=!!e)return!1;const t=a.values(),i=e.values();if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r],n=i[r];if(s.getChild()!==n.getChild()&&!s.getChild().equals(n.getChild()))return!1}return!0}function nm(a,e){if(!!a!=!!e)return!1;const t=a.keys(),i=e.keys();if(t.length!==i.length)return!1;for(const r of t){const s=a.get(r),n=e.get(r);if(!!s!=!!n)return!1;const o=s.getChild(),c=n.getChild();if(o!==c&&!o.equals(c))return!1}return!0}function Qh(a,e){if(a===e)return!0;if(!!a!=!!e||!a||!e||a.length!==e.length)return!1;for(let t=0;t<a.length;t++)if(a[t]!==e[t])return!1;return!0}function Jh(a,e){if(a===e)return!0;if(!!a!=!!e)return!1;if(!Ra(a)||!Ra(e))return a===e;const t=a,i=e;let r=0,s=0,n;for(n in t)r++;for(n in i)s++;if(r!==s)return!1;for(n in t){const o=t[n],c=i[n];if(gn(o)&&gn(c)){if(!Qh(o,c))return!1}else if(Ra(o)&&Ra(c)){if(!Jh(o,c))return!1}else if(o!==c)return!1}return!0}function gn(a){return Array.isArray(a)||ArrayBuffer.isView(a)}const Rl="23456789abdegjkmnpqrvwxyzABDEGJKMNPQRVWXYZ",om=999,cm=6,Nl=new Set,lm=function(){let e="";for(let t=0;t<cm;t++)e+=Rl.charAt(Math.floor(Math.random()*Rl.length));return e},hm=function(){for(let e=0;e<om;e++){const t=lm();if(!Nl.has(t))return Nl.add(t),t}return""},xa=a=>a,dm=new Set;class Vo extends Oo{constructor(e,t=""){super(e),this[Te].name=t,this.init(),this.dispatchEvent({type:"create"})}getGraph(){return this.graph}getDefaults(){return Object.assign(super.getDefaults(),{name:"",extras:{}})}set(e,t){return Array.isArray(t)&&(t=t.slice()),super.set(e,t)}getName(){return this.get("name")}setName(e){return this.set("name",e)}getExtras(){return this.get("extras")}setExtras(e){return this.set("extras",e)}clone(){const e=this.constructor;return new e(this.graph).copy(this,xa)}copy(e,t=xa){for(const i in this[Te]){const r=this[Te][i];if(r instanceof Ja)this[Sa].has(i)||r.dispose();else if(r instanceof Aa||r instanceof Re)for(const s of r.values())s.dispose();else if(r instanceof kt)for(const s of r.values())s.dispose()}for(const i in e[Te]){const r=this[Te][i],s=e[Te][i];if(s instanceof Ja)this[Sa].has(i)?r.getChild().copy(t(s.getChild()),t):this.setRef(i,t(s.getChild()),s.getAttributes());else if(s instanceof Re||s instanceof Aa)for(const n of s.values())this.addRef(i,t(n.getChild()),n.getAttributes());else if(s instanceof kt)for(const n of s.keys()){const o=s.get(n);this.setRefMap(i,n,t(o.getChild()),o.getAttributes())}else Ra(s)?this[Te][i]=JSON.parse(JSON.stringify(s)):Array.isArray(s)||s instanceof ArrayBuffer||ArrayBuffer.isView(s)?this[Te][i]=s.slice():this[Te][i]=s}return this}equals(e,t=dm){if(this===e)return!0;if(this.propertyType!==e.propertyType)return!1;for(const i in this[Te]){if(t.has(i))continue;const r=this[Te][i],s=e[Te][i];if(r instanceof Ja||s instanceof Ja){if(!rm(r,s))return!1}else if(r instanceof Re||s instanceof Re||r instanceof Aa||s instanceof Aa){if(!sm(r,s))return!1}else if(r instanceof kt||s instanceof kt){if(!nm(r,s))return!1}else if(Ra(r)||Ra(s)){if(!Jh(r,s))return!1}else if(gn(r)||gn(s)){if(!Qh(r,s))return!1}else if(r!==s)return!1}return!0}detach(){return this.graph.disconnectParents(this,e=>e.propertyType!=="Root"),this}listParents(){return this.graph.listParents(this)}}class ht extends Vo{getDefaults(){return Object.assign(super.getDefaults(),{extensions:new kt})}getExtension(e){return this.getRefMap("extensions",e)}setExtension(e,t){return t&&t._validateParent(this),this.setRefMap("extensions",e,t)}listExtensions(){return this.listRefMapValues("extensions")}}class ie extends ht{init(){this.propertyType=X.ACCESSOR}getDefaults(){return Object.assign(super.getDefaults(),{array:null,type:ie.Type.SCALAR,componentType:ie.ComponentType.FLOAT,normalized:!1,sparse:!1,buffer:null})}static getElementSize(e){switch(e){case ie.Type.SCALAR:return 1;case ie.Type.VEC2:return 2;case ie.Type.VEC3:return 3;case ie.Type.VEC4:return 4;case ie.Type.MAT2:return 4;case ie.Type.MAT3:return 9;case ie.Type.MAT4:return 16;default:throw new Error("Unexpected type: "+e)}}static getComponentSize(e){switch(e){case ie.ComponentType.BYTE:return 1;case ie.ComponentType.UNSIGNED_BYTE:return 1;case ie.ComponentType.SHORT:return 2;case ie.ComponentType.UNSIGNED_SHORT:return 2;case ie.ComponentType.UNSIGNED_INT:return 4;case ie.ComponentType.FLOAT:return 4;default:throw new Error("Unexpected component type: "+e)}}getMinNormalized(e){const t=this.getNormalized(),i=this.getElementSize(),r=this.getComponentType();if(this.getMin(e),t)for(let s=0;s<i;s++)e[s]=De.decodeNormalizedInt(e[s],r);return e}getMin(e){const t=this.getArray(),i=this.getCount(),r=this.getElementSize();for(let s=0;s<r;s++)e[s]=1/0;for(let s=0;s<i*r;s+=r)for(let n=0;n<r;n++){const o=t[s+n];Number.isFinite(o)&&(e[n]=Math.min(e[n],o))}return e}getMaxNormalized(e){const t=this.getNormalized(),i=this.getElementSize(),r=this.getComponentType();if(this.getMax(e),t)for(let s=0;s<i;s++)e[s]=De.decodeNormalizedInt(e[s],r);return e}getMax(e){const t=this.get("array"),i=this.getCount(),r=this.getElementSize();for(let s=0;s<r;s++)e[s]=-1/0;for(let s=0;s<i*r;s+=r)for(let n=0;n<r;n++){const o=t[s+n];Number.isFinite(o)&&(e[n]=Math.max(e[n],o))}return e}getCount(){const e=this.get("array");return e?e.length/this.getElementSize():0}getType(){return this.get("type")}setType(e){return this.set("type",e)}getElementSize(){return ie.getElementSize(this.get("type"))}getComponentSize(){return this.get("array").BYTES_PER_ELEMENT}getComponentType(){return this.get("componentType")}getNormalized(){return this.get("normalized")}setNormalized(e){return this.set("normalized",e)}getScalar(e){const t=this.getElementSize(),i=this.getComponentType(),r=this.getArray();return this.getNormalized()?De.decodeNormalizedInt(r[e*t],i):r[e*t]}setScalar(e,t){const i=this.getElementSize(),r=this.getComponentType(),s=this.getArray();return this.getNormalized()?s[e*i]=De.encodeNormalizedInt(t,r):s[e*i]=t,this}getElement(e,t){const i=this.getNormalized(),r=this.getElementSize(),s=this.getComponentType(),n=this.getArray();for(let o=0;o<r;o++)i?t[o]=De.decodeNormalizedInt(n[e*r+o],s):t[o]=n[e*r+o];return t}setElement(e,t){const i=this.getNormalized(),r=this.getElementSize(),s=this.getComponentType(),n=this.getArray();for(let o=0;o<r;o++)i?n[e*r+o]=De.encodeNormalizedInt(t[o],s):n[e*r+o]=t[o];return this}getSparse(){return this.get("sparse")}setSparse(e){return this.set("sparse",e)}getBuffer(){return this.getRef("buffer")}setBuffer(e){return this.setRef("buffer",e)}getArray(){return this.get("array")}setArray(e){return this.set("componentType",e?fm(e):ie.ComponentType.FLOAT),this.set("array",e),this}getByteLength(){const e=this.get("array");return e?e.byteLength:0}}ie.Type={SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4"};ie.ComponentType={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:5126};function fm(a){switch(a.constructor){case Float32Array:return ie.ComponentType.FLOAT;case Uint32Array:return ie.ComponentType.UNSIGNED_INT;case Uint16Array:return ie.ComponentType.UNSIGNED_SHORT;case Uint8Array:return ie.ComponentType.UNSIGNED_BYTE;case Int16Array:return ie.ComponentType.SHORT;case Int8Array:return ie.ComponentType.BYTE;default:throw new Error("Unknown accessor componentType.")}}class Zh extends ht{init(){this.propertyType=X.ANIMATION}getDefaults(){return Object.assign(super.getDefaults(),{channels:new Re,samplers:new Re})}addChannel(e){return this.addRef("channels",e)}removeChannel(e){return this.removeRef("channels",e)}listChannels(){return this.listRefs("channels")}addSampler(e){return this.addRef("samplers",e)}removeSampler(e){return this.removeRef("samplers",e)}listSamplers(){return this.listRefs("samplers")}}class Lo extends ht{init(){this.propertyType=X.ANIMATION_CHANNEL}getDefaults(){return Object.assign(super.getDefaults(),{targetPath:null,targetNode:null,sampler:null})}getTargetPath(){return this.get("targetPath")}setTargetPath(e){return this.set("targetPath",e)}getTargetNode(){return this.getRef("targetNode")}setTargetNode(e){return this.setRef("targetNode",e)}getSampler(){return this.getRef("sampler")}setSampler(e){return this.setRef("sampler",e)}}Lo.TargetPath={TRANSLATION:"translation",ROTATION:"rotation",SCALE:"scale",WEIGHTS:"weights"};class ri extends ht{init(){this.propertyType=X.ANIMATION_SAMPLER}getDefaultAttributes(){return Object.assign(super.getDefaults(),{interpolation:ri.Interpolation.LINEAR,input:null,output:null})}getInterpolation(){return this.get("interpolation")}setInterpolation(e){return this.set("interpolation",e)}getInput(){return this.getRef("input")}setInput(e){return this.setRef("input",e,{usage:wt.OTHER})}getOutput(){return this.getRef("output")}setOutput(e){return this.setRef("output",e,{usage:wt.OTHER})}}ri.Interpolation={LINEAR:"LINEAR",STEP:"STEP",CUBICSPLINE:"CUBICSPLINE"};class $h extends ht{init(){this.propertyType=X.BUFFER}getDefaults(){return Object.assign(super.getDefaults(),{uri:""})}getURI(){return this.get("uri")}setURI(e){return this.set("uri",e)}}class La extends ht{init(){this.propertyType=X.CAMERA}getDefaults(){return Object.assign(super.getDefaults(),{type:La.Type.PERSPECTIVE,znear:.1,zfar:100,aspectRatio:null,yfov:Math.PI*2*50/360,xmag:1,ymag:1})}getType(){return this.get("type")}setType(e){return this.set("type",e)}getZNear(){return this.get("znear")}setZNear(e){return this.set("znear",e)}getZFar(){return this.get("zfar")}setZFar(e){return this.set("zfar",e)}getAspectRatio(){return this.get("aspectRatio")}setAspectRatio(e){return this.set("aspectRatio",e)}getYFov(){return this.get("yfov")}setYFov(e){return this.set("yfov",e)}getXMag(){return this.get("xmag")}setXMag(e){return this.set("xmag",e)}getYMag(){return this.get("ymag")}setYMag(e){return this.set("ymag",e)}}La.Type={PERSPECTIVE:"perspective",ORTHOGRAPHIC:"orthographic"};class ze extends Vo{_validateParent(e){if(!this.parentTypes.includes(e.propertyType))throw new Error(`Parent "${e.propertyType}" invalid for child "${this.propertyType}".`)}}ze.EXTENSION_NAME=void 0;class Se extends ht{init(){this.propertyType=X.TEXTURE_INFO}getDefaults(){return Object.assign(super.getDefaults(),{texCoord:0,magFilter:null,minFilter:null,wrapS:Se.WrapMode.REPEAT,wrapT:Se.WrapMode.REPEAT})}getTexCoord(){return this.get("texCoord")}setTexCoord(e){return this.set("texCoord",e)}getMagFilter(){return this.get("magFilter")}setMagFilter(e){return this.set("magFilter",e)}getMinFilter(){return this.get("minFilter")}setMinFilter(e){return this.set("minFilter",e)}getWrapS(){return this.get("wrapS")}setWrapS(e){return this.set("wrapS",e)}getWrapT(){return this.get("wrapT")}setWrapT(e){return this.set("wrapT",e)}}Se.WrapMode={CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497};Se.MagFilter={NEAREST:9728,LINEAR:9729};Se.MinFilter={NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987};const{R:Xs,G:Qs,B:Js,A:um}=_t;class Pa extends ht{init(){this.propertyType=X.MATERIAL}getDefaults(){return Object.assign(super.getDefaults(),{alphaMode:Pa.AlphaMode.OPAQUE,alphaCutoff:.5,doubleSided:!1,baseColorFactor:[1,1,1,1],baseColorTexture:null,baseColorTextureInfo:new Se(this.graph,"baseColorTextureInfo"),emissiveFactor:[0,0,0],emissiveTexture:null,emissiveTextureInfo:new Se(this.graph,"emissiveTextureInfo"),normalScale:1,normalTexture:null,normalTextureInfo:new Se(this.graph,"normalTextureInfo"),occlusionStrength:1,occlusionTexture:null,occlusionTextureInfo:new Se(this.graph,"occlusionTextureInfo"),roughnessFactor:1,metallicFactor:1,metallicRoughnessTexture:null,metallicRoughnessTextureInfo:new Se(this.graph,"metallicRoughnessTextureInfo")})}getDoubleSided(){return this.get("doubleSided")}setDoubleSided(e){return this.set("doubleSided",e)}getAlpha(){return this.get("baseColorFactor")[3]}setAlpha(e){const t=this.get("baseColorFactor").slice();return t[3]=e,this.set("baseColorFactor",t)}getAlphaMode(){return this.get("alphaMode")}setAlphaMode(e){return this.set("alphaMode",e)}getAlphaCutoff(){return this.get("alphaCutoff")}setAlphaCutoff(e){return this.set("alphaCutoff",e)}getBaseColorFactor(){return this.get("baseColorFactor")}setBaseColorFactor(e){return this.set("baseColorFactor",e)}getBaseColorTexture(){return this.getRef("baseColorTexture")}getBaseColorTextureInfo(){return this.getRef("baseColorTexture")?this.getRef("baseColorTextureInfo"):null}setBaseColorTexture(e){return this.setRef("baseColorTexture",e,{channels:Xs|Qs|Js|um,isColor:!0})}getEmissiveFactor(){return this.get("emissiveFactor")}setEmissiveFactor(e){return this.set("emissiveFactor",e)}getEmissiveTexture(){return this.getRef("emissiveTexture")}getEmissiveTextureInfo(){return this.getRef("emissiveTexture")?this.getRef("emissiveTextureInfo"):null}setEmissiveTexture(e){return this.setRef("emissiveTexture",e,{channels:Xs|Qs|Js,isColor:!0})}getNormalScale(){return this.get("normalScale")}setNormalScale(e){return this.set("normalScale",e)}getNormalTexture(){return this.getRef("normalTexture")}getNormalTextureInfo(){return this.getRef("normalTexture")?this.getRef("normalTextureInfo"):null}setNormalTexture(e){return this.setRef("normalTexture",e,{channels:Xs|Qs|Js})}getOcclusionStrength(){return this.get("occlusionStrength")}setOcclusionStrength(e){return this.set("occlusionStrength",e)}getOcclusionTexture(){return this.getRef("occlusionTexture")}getOcclusionTextureInfo(){return this.getRef("occlusionTexture")?this.getRef("occlusionTextureInfo"):null}setOcclusionTexture(e){return this.setRef("occlusionTexture",e,{channels:Xs})}getRoughnessFactor(){return this.get("roughnessFactor")}setRoughnessFactor(e){return this.set("roughnessFactor",e)}getMetallicFactor(){return this.get("metallicFactor")}setMetallicFactor(e){return this.set("metallicFactor",e)}getMetallicRoughnessTexture(){return this.getRef("metallicRoughnessTexture")}getMetallicRoughnessTextureInfo(){return this.getRef("metallicRoughnessTexture")?this.getRef("metallicRoughnessTextureInfo"):null}setMetallicRoughnessTexture(e){return this.setRef("metallicRoughnessTexture",e,{channels:Qs|Js})}}Pa.AlphaMode={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};class ed extends ht{init(){this.propertyType=X.MESH}getDefaults(){return Object.assign(super.getDefaults(),{weights:[],primitives:new Re})}addPrimitive(e){return this.addRef("primitives",e)}removePrimitive(e){return this.removeRef("primitives",e)}listPrimitives(){return this.listRefs("primitives")}getWeights(){return this.get("weights")}setWeights(e){return this.set("weights",e)}}class td extends ht{init(){this.propertyType=X.NODE}getDefaults(){return Object.assign(super.getDefaults(),{translation:[0,0,0],rotation:[0,0,0,1],scale:[1,1,1],weights:[],camera:null,mesh:null,skin:null,children:new Re})}copy(e,t=xa){if(t===xa)throw new Error("Node cannot be copied.");return super.copy(e,t)}getTranslation(){return this.get("translation")}getRotation(){return this.get("rotation")}getScale(){return this.get("scale")}setTranslation(e){return this.set("translation",e)}setRotation(e){return this.set("rotation",e)}setScale(e){return this.set("scale",e)}getMatrix(){return De.compose(this.get("translation"),this.get("rotation"),this.get("scale"),[])}setMatrix(e){const t=this.get("translation").slice(),i=this.get("rotation").slice(),r=this.get("scale").slice();return De.decompose(e,t,i,r),this.set("translation",t).set("rotation",i).set("scale",r)}getWorldTranslation(){const e=[0,0,0];return De.decompose(this.getWorldMatrix(),e,[0,0,0,1],[1,1,1]),e}getWorldRotation(){const e=[0,0,0,1];return De.decompose(this.getWorldMatrix(),[0,0,0],e,[1,1,1]),e}getWorldScale(){const e=[1,1,1];return De.decompose(this.getWorldMatrix(),[0,0,0],[0,0,0,1],e),e}getWorldMatrix(){const e=[];for(let r=this;r!=null;r=r.getParentNode())e.push(r);let t;const i=e.pop().getMatrix();for(;t=e.pop();)tm(i,i,t.getMatrix());return i}addChild(e){const t=e.getParentNode();t&&t.removeChild(e);for(const i of e.listParents())i.propertyType===X.SCENE&&i.removeChild(e);return this.addRef("children",e)}removeChild(e){return this.removeRef("children",e)}listChildren(){return this.listRefs("children")}getParentNode(){for(const e of this.listParents())if(e.propertyType===X.NODE)return e;return null}getMesh(){return this.getRef("mesh")}setMesh(e){return this.setRef("mesh",e)}getCamera(){return this.getRef("camera")}setCamera(e){return this.setRef("camera",e)}getSkin(){return this.getRef("skin")}setSkin(e){return this.setRef("skin",e)}getWeights(){return this.get("weights")}setWeights(e){return this.set("weights",e)}traverse(e){e(this);for(const t of this.listChildren())t.traverse(e);return this}}class Oa extends ht{init(){this.propertyType=X.PRIMITIVE}getDefaults(){return Object.assign(super.getDefaults(),{mode:Oa.Mode.TRIANGLES,material:null,indices:null,attributes:new kt,targets:new Re})}getIndices(){return this.getRef("indices")}setIndices(e){return this.setRef("indices",e,{usage:wt.ELEMENT_ARRAY_BUFFER})}getAttribute(e){return this.getRefMap("attributes",e)}setAttribute(e,t){return this.setRefMap("attributes",e,t,{usage:wt.ARRAY_BUFFER})}listAttributes(){return this.listRefMapValues("attributes")}listSemantics(){return this.listRefMapKeys("attributes")}getMaterial(){return this.getRef("material")}setMaterial(e){return this.setRef("material",e)}getMode(){return this.get("mode")}setMode(e){return this.set("mode",e)}listTargets(){return this.listRefs("targets")}addTarget(e){return this.addRef("targets",e)}removeTarget(e){return this.removeRef("targets",e)}}Oa.Mode={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class bm extends Vo{init(){this.propertyType=X.PRIMITIVE_TARGET}getDefaults(){return Object.assign(super.getDefaults(),{attributes:new kt})}getAttribute(e){return this.getRefMap("attributes",e)}setAttribute(e,t){return this.setRefMap("attributes",e,t,{usage:wt.ARRAY_BUFFER})}listAttributes(){return this.listRefMapValues("attributes")}listSemantics(){return this.listRefMapKeys("attributes")}}function lt(){return lt=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(a[i]=t[i])}return a},lt.apply(null,arguments)}class ad extends ht{init(){this.propertyType=X.SCENE}getDefaults(){return Object.assign(super.getDefaults(),{children:new Re})}copy(e,t=xa){if(t===xa)throw new Error("Scene cannot be copied.");return super.copy(e,t)}addChild(e){const t=e.getParentNode();return t&&t.removeChild(e),this.addRef("children",e)}removeChild(e){return this.removeRef("children",e)}listChildren(){return this.listRefs("children")}traverse(e){for(const t of this.listChildren())t.traverse(e);return this}}class id extends ht{init(){this.propertyType=X.SKIN}getDefaults(){return Object.assign(super.getDefaults(),{skeleton:null,inverseBindMatrices:null,joints:new Re})}getSkeleton(){return this.getRef("skeleton")}setSkeleton(e){return this.setRef("skeleton",e)}getInverseBindMatrices(){return this.getRef("inverseBindMatrices")}setInverseBindMatrices(e){return this.setRef("inverseBindMatrices",e,{usage:wt.INVERSE_BIND_MATRICES})}addJoint(e){return this.addRef("joints",e)}removeJoint(e){return this.removeRef("joints",e)}listJoints(){return this.listRefs("joints")}}class rd extends ht{init(){this.propertyType=X.TEXTURE}getDefaults(){return Object.assign(super.getDefaults(),{image:null,mimeType:"",uri:""})}getMimeType(){return this.get("mimeType")||Ot.extensionToMimeType(Ba.extension(this.get("uri")))}setMimeType(e){return this.set("mimeType",e)}getURI(){return this.get("uri")}setURI(e){this.set("uri",e);const t=Ot.extensionToMimeType(Ba.extension(e));return t&&this.set("mimeType",t),this}getImage(){return this.get("image")}setImage(e){return this.set("image",be.assertView(e))}getSize(){const e=this.get("image");return e?Ot.getSize(e,this.getMimeType()):null}}class sd extends ht{init(){this.propertyType=X.ROOT}getDefaults(){return Object.assign(super.getDefaults(),{asset:{generator:`glTF-Transform ${Yh}`,version:"2.0"},defaultScene:null,accessors:new Re,animations:new Re,buffers:new Re,cameras:new Re,materials:new Re,meshes:new Re,nodes:new Re,scenes:new Re,skins:new Re,textures:new Re})}constructor(e){super(e),this._extensions=new Set,e.addEventListener("node:create",t=>{this._addChildOfRoot(t.target)})}clone(){throw new Error("Root cannot be cloned.")}copy(e,t=xa){if(t===xa)throw new Error("Root cannot be copied.");this.set("asset",lt({},e.get("asset"))),this.setName(e.getName()),this.setExtras(lt({},e.getExtras())),this.setDefaultScene(e.getDefaultScene()?t(e.getDefaultScene()):null);for(const i of e.listRefMapKeys("extensions")){const r=e.getExtension(i);this.setExtension(i,t(r))}return this}_addChildOfRoot(e){return e instanceof ad?this.addRef("scenes",e):e instanceof td?this.addRef("nodes",e):e instanceof La?this.addRef("cameras",e):e instanceof id?this.addRef("skins",e):e instanceof ed?this.addRef("meshes",e):e instanceof Pa?this.addRef("materials",e):e instanceof rd?this.addRef("textures",e):e instanceof Zh?this.addRef("animations",e):e instanceof ie?this.addRef("accessors",e):e instanceof $h&&this.addRef("buffers",e),this}getAsset(){return this.get("asset")}listExtensionsUsed(){return Array.from(this._extensions)}listExtensionsRequired(){return this.listExtensionsUsed().filter(e=>e.isRequired())}_enableExtension(e){return this._extensions.add(e),this}_disableExtension(e){return this._extensions.delete(e),this}listScenes(){return this.listRefs("scenes")}setDefaultScene(e){return this.setRef("defaultScene",e)}getDefaultScene(){return this.getRef("defaultScene")}listNodes(){return this.listRefs("nodes")}listCameras(){return this.listRefs("cameras")}listSkins(){return this.listRefs("skins")}listMeshes(){return this.listRefs("meshes")}listMaterials(){return this.listRefs("materials")}listTextures(){return this.listRefs("textures")}listAnimations(){return this.listRefs("animations")}listAccessors(){return this.listRefs("accessors")}listBuffers(){return this.listRefs("buffers")}}class bs{static fromGraph(e){return bs._GRAPH_DOCUMENTS.get(e)||null}constructor(){this._graph=new W0,this._root=new sd(this._graph),this._logger=Dt.DEFAULT_INSTANCE,bs._GRAPH_DOCUMENTS.set(this._graph,this)}getRoot(){return this._root}getGraph(){return this._graph}getLogger(){return this._logger}setLogger(e){return this._logger=e,this}clone(){throw new Error("Use 'cloneDocument(source)' from '@gltf-transform/functions'.")}merge(e){throw new Error("Use 'mergeDocuments(target, source)' from '@gltf-transform/functions'.")}async transform(...e){const t=e.map(i=>i.name);for(const i of e)await i(this,{stack:t});return this}createExtension(e){const t=e.EXTENSION_NAME;return this.getRoot().listExtensionsUsed().find(r=>r.extensionName===t)||new e(this)}createScene(e=""){return new ad(this._graph,e)}createNode(e=""){return new td(this._graph,e)}createCamera(e=""){return new La(this._graph,e)}createSkin(e=""){return new id(this._graph,e)}createMesh(e=""){return new ed(this._graph,e)}createPrimitive(){return new Oa(this._graph)}createPrimitiveTarget(e=""){return new bm(this._graph,e)}createMaterial(e=""){return new Pa(this._graph,e)}createTexture(e=""){return new rd(this._graph,e)}createAnimation(e=""){return new Zh(this._graph,e)}createAnimationChannel(e=""){return new Lo(this._graph,e)}createAnimationSampler(e=""){return new ri(this._graph,e)}createAccessor(e="",t=null){return t||(t=this.getRoot().listBuffers()[0]),new ie(this._graph,e).setBuffer(t)}createBuffer(e=""){return new $h(this._graph,e)}}bs._GRAPH_DOCUMENTS=new WeakMap;class Ue{constructor(e){this.extensionName="",this.prereadTypes=[],this.prewriteTypes=[],this.readDependencies=[],this.writeDependencies=[],this.document=void 0,this.required=!1,this.properties=new Set,this._listener=void 0,this.document=e,e.getRoot()._enableExtension(this),this._listener=i=>{const r=i,s=r.target;s instanceof ze&&s.extensionName===this.extensionName&&(r.type==="node:create"&&this._addExtensionProperty(s),r.type==="node:dispose"&&this._removeExtensionProperty(s))};const t=e.getGraph();t.addEventListener("node:create",this._listener),t.addEventListener("node:dispose",this._listener)}dispose(){this.document.getRoot()._disableExtension(this);const e=this.document.getGraph();e.removeEventListener("node:create",this._listener),e.removeEventListener("node:dispose",this._listener);for(const t of this.properties)t.dispose()}static register(){}isRequired(){return this.required}setRequired(e){return this.required=e,this}listProperties(){return Array.from(this.properties)}_addExtensionProperty(e){return this.properties.add(e),this}_removeExtensionProperty(e){return this.properties.delete(e),this}install(e,t){return this}preread(e,t){return this}prewrite(e,t){return this}}Ue.EXTENSION_NAME=void 0;class pm{constructor(e){this.jsonDoc=void 0,this.buffers=[],this.bufferViews=[],this.bufferViewBuffers=[],this.accessors=[],this.textures=[],this.textureInfos=new Map,this.materials=[],this.meshes=[],this.cameras=[],this.nodes=[],this.skins=[],this.animations=[],this.scenes=[],this.jsonDoc=e}setTextureInfo(e,t){this.textureInfos.set(e,t),t.texCoord!==void 0&&e.setTexCoord(t.texCoord),t.extras!==void 0&&e.setExtras(t.extras);const i=this.jsonDoc.json.textures[t.index];if(i.sampler===void 0)return;const r=this.jsonDoc.json.samplers[i.sampler];r.magFilter!==void 0&&e.setMagFilter(r.magFilter),r.minFilter!==void 0&&e.setMinFilter(r.minFilter),r.wrapS!==void 0&&e.setWrapS(r.wrapS),r.wrapT!==void 0&&e.setWrapT(r.wrapT)}}const kl={logger:Dt.DEFAULT_INSTANCE,extensions:[],dependencies:{}},mm=new Set([X.BUFFER,X.TEXTURE,X.MATERIAL,X.MESH,X.PRIMITIVE,X.NODE,X.SCENE]);class gm{static read(e,t=kl){const i=lt({},kl,t),{json:r}=e,s=new bs().setLogger(i.logger);this.validate(e,i);const n=new pm(e),o=r.asset,c=s.getRoot().getAsset();o.copyright&&(c.copyright=o.copyright),o.extras&&(c.extras=o.extras),r.extras!==void 0&&s.getRoot().setExtras(lt({},r.extras));const l=r.extensionsUsed||[],h=r.extensionsRequired||[];i.extensions.sort((w,v)=>w.EXTENSION_NAME>v.EXTENSION_NAME?1:-1);for(const w of i.extensions)if(l.includes(w.EXTENSION_NAME)){const v=s.createExtension(w).setRequired(h.includes(w.EXTENSION_NAME)),M=v.prereadTypes.filter(C=>!mm.has(C));M.length&&i.logger.warn(`Preread hooks for some types (${M.join()}), requested by extension ${v.extensionName}, are unsupported. Please file an issue or a PR.`);for(const C of v.readDependencies)v.install(C,i.dependencies[C])}const d=r.buffers||[];s.getRoot().listExtensionsUsed().filter(w=>w.prereadTypes.includes(X.BUFFER)).forEach(w=>w.preread(n,X.BUFFER)),n.buffers=d.map(w=>{const v=s.createBuffer(w.name);return w.extras&&v.setExtras(w.extras),w.uri&&w.uri.indexOf("__")!==0&&v.setURI(w.uri),v});const f=r.bufferViews||[];n.bufferViewBuffers=f.map((w,v)=>{if(!n.bufferViews[v]){const M=e.json.buffers[w.buffer],C=M.uri?e.resources[M.uri]:e.resources[ai],D=w.byteOffset||0;n.bufferViews[v]=be.toView(C,D,w.byteLength)}return n.buffers[w.buffer]});const u=r.accessors||[];n.accessors=u.map(w=>{const v=n.bufferViewBuffers[w.bufferView],M=s.createAccessor(w.name,v).setType(w.type);return w.extras&&M.setExtras(w.extras),w.normalized!==void 0&&M.setNormalized(w.normalized),w.bufferView===void 0||M.setArray(cn(w,n)),M});const m=r.images||[],p=r.textures||[];s.getRoot().listExtensionsUsed().filter(w=>w.prereadTypes.includes(X.TEXTURE)).forEach(w=>w.preread(n,X.TEXTURE)),n.textures=m.map(w=>{const v=s.createTexture(w.name);if(w.extras&&v.setExtras(w.extras),w.bufferView!==void 0){const M=r.bufferViews[w.bufferView],C=e.json.buffers[M.buffer],D=C.uri?e.resources[C.uri]:e.resources[ai],S=M.byteOffset||0,k=M.byteLength,F=D.slice(S,S+k);v.setImage(F)}else w.uri!==void 0&&(v.setImage(e.resources[w.uri]),w.uri.indexOf("__")!==0&&v.setURI(w.uri));if(w.mimeType!==void 0)v.setMimeType(w.mimeType);else if(w.uri){const M=Ba.extension(w.uri);v.setMimeType(Ot.extensionToMimeType(M))}return v}),s.getRoot().listExtensionsUsed().filter(w=>w.prereadTypes.includes(X.MATERIAL)).forEach(w=>w.preread(n,X.MATERIAL));const g=r.materials||[];n.materials=g.map(w=>{const v=s.createMaterial(w.name);w.extras&&v.setExtras(w.extras),w.alphaMode!==void 0&&v.setAlphaMode(w.alphaMode),w.alphaCutoff!==void 0&&v.setAlphaCutoff(w.alphaCutoff),w.doubleSided!==void 0&&v.setDoubleSided(w.doubleSided);const M=w.pbrMetallicRoughness||{};if(M.baseColorFactor!==void 0&&v.setBaseColorFactor(M.baseColorFactor),w.emissiveFactor!==void 0&&v.setEmissiveFactor(w.emissiveFactor),M.metallicFactor!==void 0&&v.setMetallicFactor(M.metallicFactor),M.roughnessFactor!==void 0&&v.setRoughnessFactor(M.roughnessFactor),M.baseColorTexture!==void 0){const C=M.baseColorTexture,D=n.textures[p[C.index].source];v.setBaseColorTexture(D),n.setTextureInfo(v.getBaseColorTextureInfo(),C)}if(w.emissiveTexture!==void 0){const C=w.emissiveTexture,D=n.textures[p[C.index].source];v.setEmissiveTexture(D),n.setTextureInfo(v.getEmissiveTextureInfo(),C)}if(w.normalTexture!==void 0){const C=w.normalTexture,D=n.textures[p[C.index].source];v.setNormalTexture(D),n.setTextureInfo(v.getNormalTextureInfo(),C),w.normalTexture.scale!==void 0&&v.setNormalScale(w.normalTexture.scale)}if(w.occlusionTexture!==void 0){const C=w.occlusionTexture,D=n.textures[p[C.index].source];v.setOcclusionTexture(D),n.setTextureInfo(v.getOcclusionTextureInfo(),C),w.occlusionTexture.strength!==void 0&&v.setOcclusionStrength(w.occlusionTexture.strength)}if(M.metallicRoughnessTexture!==void 0){const C=M.metallicRoughnessTexture,D=n.textures[p[C.index].source];v.setMetallicRoughnessTexture(D),n.setTextureInfo(v.getMetallicRoughnessTextureInfo(),C)}return v}),s.getRoot().listExtensionsUsed().filter(w=>w.prereadTypes.includes(X.MESH)).forEach(w=>w.preread(n,X.MESH));const b=r.meshes||[];s.getRoot().listExtensionsUsed().filter(w=>w.prereadTypes.includes(X.PRIMITIVE)).forEach(w=>w.preread(n,X.PRIMITIVE)),n.meshes=b.map(w=>{const v=s.createMesh(w.name);return w.extras&&v.setExtras(w.extras),w.weights!==void 0&&v.setWeights(w.weights),(w.primitives||[]).forEach(C=>{const D=s.createPrimitive();C.extras&&D.setExtras(C.extras),C.material!==void 0&&D.setMaterial(n.materials[C.material]),C.mode!==void 0&&D.setMode(C.mode);for(const[F,B]of Object.entries(C.attributes||{}))D.setAttribute(F,n.accessors[B]);C.indices!==void 0&&D.setIndices(n.accessors[C.indices]);const S=w.extras&&w.extras.targetNames||[];(C.targets||[]).forEach((F,B)=>{const O=S[B]||B.toString(),L=s.createPrimitiveTarget(O);for(const[_,q]of Object.entries(F))L.setAttribute(_,n.accessors[q]);D.addTarget(L)}),v.addPrimitive(D)}),v});const A=r.cameras||[];n.cameras=A.map(w=>{const v=s.createCamera(w.name).setType(w.type);if(w.extras&&v.setExtras(w.extras),w.type===La.Type.PERSPECTIVE){const M=w.perspective;v.setYFov(M.yfov),v.setZNear(M.znear),M.zfar!==void 0&&v.setZFar(M.zfar),M.aspectRatio!==void 0&&v.setAspectRatio(M.aspectRatio)}else{const M=w.orthographic;v.setZNear(M.znear).setZFar(M.zfar).setXMag(M.xmag).setYMag(M.ymag)}return v});const y=r.nodes||[];s.getRoot().listExtensionsUsed().filter(w=>w.prereadTypes.includes(X.NODE)).forEach(w=>w.preread(n,X.NODE)),n.nodes=y.map(w=>{const v=s.createNode(w.name);if(w.extras&&v.setExtras(w.extras),w.translation!==void 0&&v.setTranslation(w.translation),w.rotation!==void 0&&v.setRotation(w.rotation),w.scale!==void 0&&v.setScale(w.scale),w.matrix!==void 0){const M=[0,0,0],C=[0,0,0,1],D=[1,1,1];De.decompose(w.matrix,M,C,D),v.setTranslation(M),v.setRotation(C),v.setScale(D)}return w.weights!==void 0&&v.setWeights(w.weights),v});const x=r.skins||[];n.skins=x.map(w=>{const v=s.createSkin(w.name);w.extras&&v.setExtras(w.extras),w.inverseBindMatrices!==void 0&&v.setInverseBindMatrices(n.accessors[w.inverseBindMatrices]),w.skeleton!==void 0&&v.setSkeleton(n.nodes[w.skeleton]);for(const M of w.joints)v.addJoint(n.nodes[M]);return v}),y.map((w,v)=>{const M=n.nodes[v];(w.children||[]).forEach(D=>M.addChild(n.nodes[D])),w.mesh!==void 0&&M.setMesh(n.meshes[w.mesh]),w.camera!==void 0&&M.setCamera(n.cameras[w.camera]),w.skin!==void 0&&M.setSkin(n.skins[w.skin])});const E=r.animations||[];n.animations=E.map(w=>{const v=s.createAnimation(w.name);w.extras&&v.setExtras(w.extras);const C=(w.samplers||[]).map(S=>{const k=s.createAnimationSampler().setInput(n.accessors[S.input]).setOutput(n.accessors[S.output]).setInterpolation(S.interpolation||ri.Interpolation.LINEAR);return S.extras&&k.setExtras(S.extras),v.addSampler(k),k});return(w.channels||[]).forEach(S=>{const k=s.createAnimationChannel().setSampler(C[S.sampler]).setTargetPath(S.target.path);S.target.node!==void 0&&k.setTargetNode(n.nodes[S.target.node]),S.extras&&k.setExtras(S.extras),v.addChannel(k)}),v});const I=r.scenes||[];return s.getRoot().listExtensionsUsed().filter(w=>w.prereadTypes.includes(X.SCENE)).forEach(w=>w.preread(n,X.SCENE)),n.scenes=I.map(w=>{const v=s.createScene(w.name);return w.extras&&v.setExtras(w.extras),(w.nodes||[]).map(C=>n.nodes[C]).forEach(C=>v.addChild(C)),v}),r.scene!==void 0&&s.getRoot().setDefaultScene(n.scenes[r.scene]),s.getRoot().listExtensionsUsed().forEach(w=>w.read(n)),u.forEach((w,v)=>{const M=n.accessors[v],C=!!w.sparse,D=!w.bufferView&&!M.getArray();(C||D)&&M.setSparse(!0).setArray(ym(w,n))}),s}static validate(e,t){const i=e.json;if(i.asset.version!=="2.0")throw new Error(`Unsupported glTF version, "${i.asset.version}".`);if(i.extensionsRequired){for(const r of i.extensionsRequired)if(!t.extensions.find(s=>s.EXTENSION_NAME===r))throw new Error(`Missing required extension, "${r}".`)}if(i.extensionsUsed)for(const r of i.extensionsUsed)t.extensions.find(s=>s.EXTENSION_NAME===r)||t.logger.warn(`Missing optional extension, "${r}".`)}}function Am(a,e){const t=e.jsonDoc,i=e.bufferViews[a.bufferView],r=t.json.bufferViews[a.bufferView],s=In[a.componentType],n=ie.getElementSize(a.type),o=s.BYTES_PER_ELEMENT,c=a.byteOffset||0,l=new s(a.count*n),h=new DataView(i.buffer,i.byteOffset,i.byteLength),d=r.byteStride;for(let f=0;f<a.count;f++)for(let u=0;u<n;u++){const m=c+f*d+u*o;let p;switch(a.componentType){case ie.ComponentType.FLOAT:p=h.getFloat32(m,!0);break;case ie.ComponentType.UNSIGNED_INT:p=h.getUint32(m,!0);break;case ie.ComponentType.UNSIGNED_SHORT:p=h.getUint16(m,!0);break;case ie.ComponentType.UNSIGNED_BYTE:p=h.getUint8(m);break;case ie.ComponentType.SHORT:p=h.getInt16(m,!0);break;case ie.ComponentType.BYTE:p=h.getInt8(m);break;default:throw new Error(`Unexpected componentType "${a.componentType}".`)}l[f*n+u]=p}return l}function cn(a,e){const t=e.jsonDoc,i=e.bufferViews[a.bufferView],r=t.json.bufferViews[a.bufferView],s=In[a.componentType],n=ie.getElementSize(a.type),o=s.BYTES_PER_ELEMENT,c=n*o;if(r.byteStride!==void 0&&r.byteStride!==c)return Am(a,e);const l=i.byteOffset+(a.byteOffset||0),h=a.count*n*o;return new s(i.buffer.slice(l,l+h))}function ym(a,e){const t=In[a.componentType],i=ie.getElementSize(a.type);let r;a.bufferView!==void 0?r=cn(a,e):r=new t(a.count*i);const s=a.sparse;if(!s)return r;const n=s.count,o=lt({},a,s.indices,{count:n,type:"SCALAR"}),c=lt({},a,s.values,{count:n}),l=cn(o,e),h=cn(c,e);for(let d=0;d<o.count;d++)for(let f=0;f<i;f++)r[l[d]*i+f]=h[d*i+f];return r}var ps;(function(a){a[a.ARRAY_BUFFER=34962]="ARRAY_BUFFER",a[a.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER"})(ps||(ps={}));class Vt{constructor(e,t,i){this._doc=void 0,this.jsonDoc=void 0,this.options=void 0,this.accessorIndexMap=new Map,this.animationIndexMap=new Map,this.bufferIndexMap=new Map,this.cameraIndexMap=new Map,this.skinIndexMap=new Map,this.materialIndexMap=new Map,this.meshIndexMap=new Map,this.nodeIndexMap=new Map,this.imageIndexMap=new Map,this.textureDefIndexMap=new Map,this.textureInfoDefMap=new Map,this.samplerDefIndexMap=new Map,this.sceneIndexMap=new Map,this.imageBufferViews=[],this.otherBufferViews=new Map,this.otherBufferViewsIndexMap=new Map,this.extensionData={},this.bufferURIGenerator=void 0,this.imageURIGenerator=void 0,this.logger=void 0,this._accessorUsageMap=new Map,this.accessorUsageGroupedByParent=new Set(["ARRAY_BUFFER"]),this.accessorParents=new Map,this._doc=e,this.jsonDoc=t,this.options=i;const r=e.getRoot(),s=r.listBuffers().length,n=r.listTextures().length;this.bufferURIGenerator=new Ul(s>1,()=>i.basename||"buffer"),this.imageURIGenerator=new Ul(n>1,o=>xm(e,o)||i.basename||"texture"),this.logger=e.getLogger()}createTextureInfoDef(e,t){const i={magFilter:t.getMagFilter()||void 0,minFilter:t.getMinFilter()||void 0,wrapS:t.getWrapS(),wrapT:t.getWrapT()},r=JSON.stringify(i);this.samplerDefIndexMap.has(r)||(this.samplerDefIndexMap.set(r,this.jsonDoc.json.samplers.length),this.jsonDoc.json.samplers.push(i));const s={source:this.imageIndexMap.get(e),sampler:this.samplerDefIndexMap.get(r)},n=JSON.stringify(s);this.textureDefIndexMap.has(n)||(this.textureDefIndexMap.set(n,this.jsonDoc.json.textures.length),this.jsonDoc.json.textures.push(s));const o={index:this.textureDefIndexMap.get(n)};return t.getTexCoord()!==0&&(o.texCoord=t.getTexCoord()),Object.keys(t.getExtras()).length>0&&(o.extras=t.getExtras()),this.textureInfoDefMap.set(t,o),o}createPropertyDef(e){const t={};return e.getName()&&(t.name=e.getName()),Object.keys(e.getExtras()).length>0&&(t.extras=e.getExtras()),t}createAccessorDef(e){const t=this.createPropertyDef(e);return t.type=e.getType(),t.componentType=e.getComponentType(),t.count=e.getCount(),this._doc.getGraph().listParentEdges(e).some(r=>r.getName()==="attributes"&&r.getAttributes().key==="POSITION"||r.getName()==="input")&&(t.max=e.getMax([]).map(Math.fround),t.min=e.getMin([]).map(Math.fround)),e.getNormalized()&&(t.normalized=e.getNormalized()),t}createImageData(e,t,i){if(this.options.format===ia.GLB)this.imageBufferViews.push(t),e.bufferView=this.jsonDoc.json.bufferViews.length,this.jsonDoc.json.bufferViews.push({buffer:0,byteOffset:-1,byteLength:t.byteLength});else{const r=Ot.mimeTypeToExtension(i.getMimeType());e.uri=this.imageURIGenerator.createURI(i,r),this.assignResourceURI(e.uri,t,!1)}}assignResourceURI(e,t,i){const r=this.jsonDoc.resources;if(!(e in r)){r[e]=t;return}if(t===r[e]){this.logger.warn(`Duplicate resource URI, "${e}".`);return}const s=`Resource URI "${e}" already assigned to different data.`;if(!i){this.logger.warn(s);return}throw new Error(s)}getAccessorUsage(e){const t=this._accessorUsageMap.get(e);if(t)return t;if(e.getSparse())return wt.SPARSE;for(const i of this._doc.getGraph().listParentEdges(e)){const{usage:r}=i.getAttributes();if(r)return r;i.getParent().propertyType!==X.ROOT&&this.logger.warn(`Missing attribute ".usage" on edge, "${i.getName()}".`)}return wt.OTHER}addAccessorToUsageGroup(e,t){const i=this._accessorUsageMap.get(e);if(i&&i!==t)throw new Error(`Accessor with usage "${i}" cannot be reused as "${t}".`);return this._accessorUsageMap.set(e,t),this}}Vt.BufferViewTarget=ps;Vt.BufferViewUsage=wt;Vt.USAGE_TO_TARGET={[wt.ARRAY_BUFFER]:ps.ARRAY_BUFFER,[wt.ELEMENT_ARRAY_BUFFER]:ps.ELEMENT_ARRAY_BUFFER};class Ul{constructor(e,t){this.multiple=void 0,this.basename=void 0,this.counter={},this.multiple=e,this.basename=t}createURI(e,t){if(e.getURI())return e.getURI();if(this.multiple){const i=this.basename(e);return this.counter[i]=this.counter[i]||1,`${i}_${this.counter[i]++}.${t}`}else return`${this.basename(e)}.${t}`}}function xm(a,e){const t=a.getGraph().listParentEdges(e).find(i=>i.getParent()!==a.getRoot());return t?t.getName().replace(/texture$/i,""):""}const{BufferViewUsage:Zs}=Vt,{UNSIGNED_INT:wm,UNSIGNED_SHORT:vm,UNSIGNED_BYTE:Em}=ie.ComponentType,Tm=new Set([X.ACCESSOR,X.BUFFER,X.MATERIAL,X.MESH]);class Im{static write(e,t){const i=e.getGraph(),r=e.getRoot(),s={asset:lt({generator:`glTF-Transform ${Yh}`},r.getAsset()),extras:lt({},r.getExtras())},n={json:s,resources:{}},o=new Vt(e,n,t),c=t.logger||Dt.DEFAULT_INSTANCE,l=new Set(t.extensions.map(b=>b.EXTENSION_NAME)),h=e.getRoot().listExtensionsUsed().filter(b=>l.has(b.extensionName)).sort((b,A)=>b.extensionName>A.extensionName?1:-1),d=e.getRoot().listExtensionsRequired().filter(b=>l.has(b.extensionName)).sort((b,A)=>b.extensionName>A.extensionName?1:-1);h.length<e.getRoot().listExtensionsUsed().length&&c.warn("Some extensions were not registered for I/O, and will not be written.");for(const b of h){const A=b.prewriteTypes.filter(y=>!Tm.has(y));A.length&&c.warn(`Prewrite hooks for some types (${A.join()}), requested by extension ${b.extensionName}, are unsupported. Please file an issue or a PR.`);for(const y of b.writeDependencies)b.install(y,t.dependencies[y])}function f(b,A,y,x){const E=[];let I=0;for(const M of b){const C=o.createAccessorDef(M);C.bufferView=s.bufferViews.length;const D=M.getArray(),S=be.pad(be.toView(D));C.byteOffset=I,I+=S.byteLength,E.push(S),o.accessorIndexMap.set(M,s.accessors.length),s.accessors.push(C)}const w=be.concat(E),v={buffer:A,byteOffset:y,byteLength:w.byteLength};return x&&(v.target=x),s.bufferViews.push(v),{buffers:E,byteLength:I}}function u(b,A,y){const x=b[0].getCount();let E=0;for(const C of b){const D=o.createAccessorDef(C);D.bufferView=s.bufferViews.length,D.byteOffset=E;const S=C.getElementSize(),k=C.getComponentSize();E+=be.padNumber(S*k),o.accessorIndexMap.set(C,s.accessors.length),s.accessors.push(D)}const I=x*E,w=new ArrayBuffer(I),v=new DataView(w);for(let C=0;C<x;C++){let D=0;for(const S of b){const k=S.getElementSize(),F=S.getComponentSize(),B=S.getComponentType(),O=S.getArray();for(let L=0;L<k;L++){const _=C*E+D+L*F,q=O[C*k+L];switch(B){case ie.ComponentType.FLOAT:v.setFloat32(_,q,!0);break;case ie.ComponentType.BYTE:v.setInt8(_,q);break;case ie.ComponentType.SHORT:v.setInt16(_,q,!0);break;case ie.ComponentType.UNSIGNED_BYTE:v.setUint8(_,q);break;case ie.ComponentType.UNSIGNED_SHORT:v.setUint16(_,q,!0);break;case ie.ComponentType.UNSIGNED_INT:v.setUint32(_,q,!0);break;default:throw new Error("Unexpected component type: "+B)}}D+=be.padNumber(k*F)}}const M={buffer:A,byteOffset:y,byteLength:I,byteStride:E,target:Vt.BufferViewTarget.ARRAY_BUFFER};return s.bufferViews.push(M),{byteLength:I,buffers:[new Uint8Array(w)]}}function m(b,A,y){const x=[];let E=0;const I=new Map;let w=-1/0,v=!1;for(const B of b){const O=o.createAccessorDef(B);s.accessors.push(O),o.accessorIndexMap.set(B,s.accessors.length-1);const L=[],_=[],q=[],J=new Array(B.getElementSize()).fill(0);for(let T=0,ne=B.getCount();T<ne;T++)if(B.getElement(T,q),!De.eq(q,J,0)){w=Math.max(T,w),L.push(T);for(let le=0;le<q.length;le++)_.push(q[le])}const Z=L.length,Y={accessorDef:O,count:Z};if(I.set(B,Y),Z===0)continue;Z>B.getCount()/2&&(v=!0);const W=In[B.getComponentType()];Y.indices=L,Y.values=new W(_)}if(!Number.isFinite(w))return{buffers:x,byteLength:E};v&&c.warn("Some sparse accessors have >50% non-zero elements, which may increase file size.");const M=w<255?Uint8Array:w<65535?Uint16Array:Uint32Array,C=w<255?Em:w<65535?vm:wm,D={buffer:A,byteOffset:y+E,byteLength:0};for(const B of b){const O=I.get(B);if(O.count===0)continue;O.indicesByteOffset=D.byteLength;const L=be.pad(be.toView(new M(O.indices)));x.push(L),E+=L.byteLength,D.byteLength+=L.byteLength}s.bufferViews.push(D);const S=s.bufferViews.length-1,k={buffer:A,byteOffset:y+E,byteLength:0};for(const B of b){const O=I.get(B);if(O.count===0)continue;O.valuesByteOffset=k.byteLength;const L=be.pad(be.toView(O.values));x.push(L),E+=L.byteLength,k.byteLength+=L.byteLength}s.bufferViews.push(k);const F=s.bufferViews.length-1;for(const B of b){const O=I.get(B);O.count!==0&&(O.accessorDef.sparse={count:O.count,indices:{bufferView:S,byteOffset:O.indicesByteOffset,componentType:C},values:{bufferView:F,byteOffset:O.valuesByteOffset}})}return{buffers:x,byteLength:E}}if(s.accessors=[],s.bufferViews=[],s.samplers=[],s.textures=[],s.images=r.listTextures().map((b,A)=>{const y=o.createPropertyDef(b);b.getMimeType()&&(y.mimeType=b.getMimeType());const x=b.getImage();return x&&o.createImageData(y,x,b),o.imageIndexMap.set(b,A),y}),h.filter(b=>b.prewriteTypes.includes(X.ACCESSOR)).forEach(b=>b.prewrite(o,X.ACCESSOR)),r.listAccessors().forEach(b=>{const A=o.accessorUsageGroupedByParent,y=o.accessorParents;if(o.accessorIndexMap.has(b))return;const x=o.getAccessorUsage(b);if(o.addAccessorToUsageGroup(b,x),A.has(x)){const E=i.listParents(b).find(I=>I.propertyType!==X.ROOT);y.set(b,E)}}),h.filter(b=>b.prewriteTypes.includes(X.BUFFER)).forEach(b=>b.prewrite(o,X.BUFFER)),(r.listAccessors().length>0||o.otherBufferViews.size>0||r.listTextures().length>0&&t.format===ia.GLB)&&r.listBuffers().length===0)throw new Error("Buffer required for Document resources, but none was found.");s.buffers=[],r.listBuffers().forEach((b,A)=>{const y=o.createPropertyDef(b),x=o.accessorUsageGroupedByParent,E=b.listParents().filter(k=>k instanceof ie),I=new Set(E.map(k=>o.accessorParents.get(k))),w=new Map(Array.from(I).map((k,F)=>[k,F])),v={};for(const k of E){var M;if(o.accessorIndexMap.has(k))continue;const F=o.getAccessorUsage(k);let B=F;if(x.has(F)){const O=o.accessorParents.get(k);B+=`:${w.get(O)}`}v[M=B]||(v[M]={usage:F,accessors:[]}),v[B].accessors.push(k)}const C=[],D=s.buffers.length;let S=0;for(const{usage:k,accessors:F}of Object.values(v))if(k===Zs.ARRAY_BUFFER&&t.vertexLayout===mn.INTERLEAVED){const B=u(F,D,S);S+=B.byteLength;for(const O of B.buffers)C.push(O)}else if(k===Zs.ARRAY_BUFFER)for(const B of F){const O=u([B],D,S);S+=O.byteLength;for(const L of O.buffers)C.push(L)}else if(k===Zs.SPARSE){const B=m(F,D,S);S+=B.byteLength;for(const O of B.buffers)C.push(O)}else if(k===Zs.ELEMENT_ARRAY_BUFFER){const B=Vt.BufferViewTarget.ELEMENT_ARRAY_BUFFER,O=f(F,D,S,B);S+=O.byteLength;for(const L of O.buffers)C.push(L)}else{const B=f(F,D,S);S+=B.byteLength;for(const O of B.buffers)C.push(O)}if(o.imageBufferViews.length&&A===0){for(let k=0;k<o.imageBufferViews.length;k++)if(s.bufferViews[s.images[k].bufferView].byteOffset=S,S+=o.imageBufferViews[k].byteLength,C.push(o.imageBufferViews[k]),S%8){const F=8-S%8;S+=F,C.push(new Uint8Array(F))}}if(o.otherBufferViews.has(b))for(const k of o.otherBufferViews.get(b))s.bufferViews.push({buffer:D,byteOffset:S,byteLength:k.byteLength}),o.otherBufferViewsIndexMap.set(k,s.bufferViews.length-1),S+=k.byteLength,C.push(k);if(S){let k;t.format===ia.GLB?k=ai:(k=o.bufferURIGenerator.createURI(b,"bin"),y.uri=k),y.byteLength=S,o.assignResourceURI(k,be.concat(C),!0)}s.buffers.push(y),o.bufferIndexMap.set(b,A)}),r.listAccessors().find(b=>!b.getBuffer())&&c.warn("Skipped writing one or more Accessors: no Buffer assigned."),h.filter(b=>b.prewriteTypes.includes(X.MATERIAL)).forEach(b=>b.prewrite(o,X.MATERIAL)),s.materials=r.listMaterials().map((b,A)=>{const y=o.createPropertyDef(b);if(b.getAlphaMode()!==Pa.AlphaMode.OPAQUE&&(y.alphaMode=b.getAlphaMode()),b.getAlphaMode()===Pa.AlphaMode.MASK&&(y.alphaCutoff=b.getAlphaCutoff()),b.getDoubleSided()&&(y.doubleSided=!0),y.pbrMetallicRoughness={},De.eq(b.getBaseColorFactor(),[1,1,1,1])||(y.pbrMetallicRoughness.baseColorFactor=b.getBaseColorFactor()),De.eq(b.getEmissiveFactor(),[0,0,0])||(y.emissiveFactor=b.getEmissiveFactor()),b.getRoughnessFactor()!==1&&(y.pbrMetallicRoughness.roughnessFactor=b.getRoughnessFactor()),b.getMetallicFactor()!==1&&(y.pbrMetallicRoughness.metallicFactor=b.getMetallicFactor()),b.getBaseColorTexture()){const x=b.getBaseColorTexture(),E=b.getBaseColorTextureInfo();y.pbrMetallicRoughness.baseColorTexture=o.createTextureInfoDef(x,E)}if(b.getEmissiveTexture()){const x=b.getEmissiveTexture(),E=b.getEmissiveTextureInfo();y.emissiveTexture=o.createTextureInfoDef(x,E)}if(b.getNormalTexture()){const x=b.getNormalTexture(),E=b.getNormalTextureInfo(),I=o.createTextureInfoDef(x,E);b.getNormalScale()!==1&&(I.scale=b.getNormalScale()),y.normalTexture=I}if(b.getOcclusionTexture()){const x=b.getOcclusionTexture(),E=b.getOcclusionTextureInfo(),I=o.createTextureInfoDef(x,E);b.getOcclusionStrength()!==1&&(I.strength=b.getOcclusionStrength()),y.occlusionTexture=I}if(b.getMetallicRoughnessTexture()){const x=b.getMetallicRoughnessTexture(),E=b.getMetallicRoughnessTextureInfo();y.pbrMetallicRoughness.metallicRoughnessTexture=o.createTextureInfoDef(x,E)}return o.materialIndexMap.set(b,A),y}),h.filter(b=>b.prewriteTypes.includes(X.MESH)).forEach(b=>b.prewrite(o,X.MESH)),s.meshes=r.listMeshes().map((b,A)=>{const y=o.createPropertyDef(b);let x=null;return y.primitives=b.listPrimitives().map(E=>{const I={attributes:{}};I.mode=E.getMode();const w=E.getMaterial();w&&(I.material=o.materialIndexMap.get(w)),Object.keys(E.getExtras()).length&&(I.extras=E.getExtras());const v=E.getIndices();v&&(I.indices=o.accessorIndexMap.get(v));for(const M of E.listSemantics())I.attributes[M]=o.accessorIndexMap.get(E.getAttribute(M));for(const M of E.listTargets()){const C={};for(const D of M.listSemantics())C[D]=o.accessorIndexMap.get(M.getAttribute(D));I.targets=I.targets||[],I.targets.push(C)}return E.listTargets().length&&!x&&(x=E.listTargets().map(M=>M.getName())),I}),b.getWeights().length&&(y.weights=b.getWeights()),x&&(y.extras=y.extras||{},y.extras.targetNames=x),o.meshIndexMap.set(b,A),y}),s.cameras=r.listCameras().map((b,A)=>{const y=o.createPropertyDef(b);if(y.type=b.getType(),y.type===La.Type.PERSPECTIVE){y.perspective={znear:b.getZNear(),zfar:b.getZFar(),yfov:b.getYFov()};const x=b.getAspectRatio();x!==null&&(y.perspective.aspectRatio=x)}else y.orthographic={znear:b.getZNear(),zfar:b.getZFar(),xmag:b.getXMag(),ymag:b.getYMag()};return o.cameraIndexMap.set(b,A),y}),s.nodes=r.listNodes().map((b,A)=>{const y=o.createPropertyDef(b);return De.eq(b.getTranslation(),[0,0,0])||(y.translation=b.getTranslation()),De.eq(b.getRotation(),[0,0,0,1])||(y.rotation=b.getRotation()),De.eq(b.getScale(),[1,1,1])||(y.scale=b.getScale()),b.getWeights().length&&(y.weights=b.getWeights()),o.nodeIndexMap.set(b,A),y}),s.skins=r.listSkins().map((b,A)=>{const y=o.createPropertyDef(b),x=b.getInverseBindMatrices();x&&(y.inverseBindMatrices=o.accessorIndexMap.get(x));const E=b.getSkeleton();return E&&(y.skeleton=o.nodeIndexMap.get(E)),y.joints=b.listJoints().map(I=>o.nodeIndexMap.get(I)),o.skinIndexMap.set(b,A),y}),r.listNodes().forEach((b,A)=>{const y=s.nodes[A],x=b.getMesh();x&&(y.mesh=o.meshIndexMap.get(x));const E=b.getCamera();E&&(y.camera=o.cameraIndexMap.get(E));const I=b.getSkin();I&&(y.skin=o.skinIndexMap.get(I)),b.listChildren().length>0&&(y.children=b.listChildren().map(w=>o.nodeIndexMap.get(w)))}),s.animations=r.listAnimations().map((b,A)=>{const y=o.createPropertyDef(b),x=new Map;return y.samplers=b.listSamplers().map((E,I)=>{const w=o.createPropertyDef(E);return w.input=o.accessorIndexMap.get(E.getInput()),w.output=o.accessorIndexMap.get(E.getOutput()),w.interpolation=E.getInterpolation(),x.set(E,I),w}),y.channels=b.listChannels().map(E=>{const I=o.createPropertyDef(E);return I.sampler=x.get(E.getSampler()),I.target={node:o.nodeIndexMap.get(E.getTargetNode()),path:E.getTargetPath()},I}),o.animationIndexMap.set(b,A),y}),s.scenes=r.listScenes().map((b,A)=>{const y=o.createPropertyDef(b);return y.nodes=b.listChildren().map(x=>o.nodeIndexMap.get(x)),o.sceneIndexMap.set(b,A),y});const g=r.getDefaultScene();return g&&(s.scene=r.listScenes().indexOf(g)),s.extensionsUsed=h.map(b=>b.extensionName),s.extensionsRequired=d.map(b=>b.extensionName),h.forEach(b=>b.write(o)),Mm(s),n}}function Mm(a){const e=[];for(const t in a){const i=a[t];(Array.isArray(i)&&i.length===0||i===null||i===""||i&&typeof i=="object"&&Object.keys(i).length===0)&&e.push(t)}for(const t of e)delete a[t]}var An;(function(a){a[a.JSON=1313821514]="JSON",a[a.BIN=5130562]="BIN"})(An||(An={}));class nd{constructor(){this._logger=Dt.DEFAULT_INSTANCE,this._extensions=new Set,this._dependencies={},this._vertexLayout=mn.INTERLEAVED,this.lastReadBytes=0,this.lastWriteBytes=0}setLogger(e){return this._logger=e,this}registerExtensions(e){for(const t of e)this._extensions.add(t),t.register();return this}registerDependencies(e){return Object.assign(this._dependencies,e),this}setVertexLayout(e){return this._vertexLayout=e,this}async read(e){return await this.readJSON(await this.readAsJSON(e))}async readAsJSON(e){const t=await this.readURI(e,"view");this.lastReadBytes=t.byteLength;const i=jl(t)?this._binaryToJSON(t):{json:JSON.parse(be.decodeText(t)),resources:{}};return await this._readResourcesExternal(i,this.dirname(e)),this._readResourcesInternal(i),i}async readJSON(e){return e=this._copyJSON(e),this._readResourcesInternal(e),gm.read(e,{extensions:Array.from(this._extensions),dependencies:this._dependencies,logger:this._logger})}async binaryToJSON(e){const t=this._binaryToJSON(be.assertView(e));this._readResourcesInternal(t);const i=t.json;if(i.buffers&&i.buffers.some(r=>Cm(t,r)))throw new Error("Cannot resolve external buffers with binaryToJSON().");if(i.images&&i.images.some(r=>Dm(t,r)))throw new Error("Cannot resolve external images with binaryToJSON().");return t}async readBinary(e){return this.readJSON(await this.binaryToJSON(be.assertView(e)))}async writeJSON(e,t={}){if(t.format===ia.GLB&&e.getRoot().listBuffers().length>1)throw new Error("GLB must have 01 buffers.");return Im.write(e,{format:t.format||ia.GLTF,basename:t.basename||"",logger:this._logger,vertexLayout:this._vertexLayout,dependencies:lt({},this._dependencies),extensions:Array.from(this._extensions)})}async writeBinary(e){const{json:t,resources:i}=await this.writeJSON(e,{format:ia.GLB}),r=new Uint32Array([1179937895,2,12]),s=JSON.stringify(t),n=be.pad(be.encodeText(s),32),o=be.toView(new Uint32Array([n.byteLength,1313821514])),c=be.concat([o,n]);r[r.length-1]+=c.byteLength;const l=Object.values(i)[0];if(!l||!l.byteLength)return be.concat([be.toView(r),c]);const h=be.pad(l,0),d=be.toView(new Uint32Array([h.byteLength,5130562])),f=be.concat([d,h]);return r[r.length-1]+=f.byteLength,be.concat([be.toView(r),c,f])}async _readResourcesExternal(e,t){var i=this;const r=e.json.images||[],s=e.json.buffers||[],n=[...r,...s].map(async function(o){const c=o.uri;if(!c||c.match(/data:/))return Promise.resolve();e.resources[c]=await i.readURI(i.resolve(t,c),"view"),i.lastReadBytes+=e.resources[c].byteLength});await Promise.all(n)}_readResourcesInternal(e){function t(s){if(s.uri){if(s.uri in e.resources){be.assertView(e.resources[s.uri]);return}if(s.uri.match(/data:/)){const n=`__${hm()}.${Ba.extension(s.uri)}`;e.resources[n]=be.createBufferFromDataURI(s.uri),s.uri=n}}}(e.json.images||[]).forEach(s=>{if(s.bufferView===void 0&&s.uri===void 0)throw new Error("Missing resource URI or buffer view.");t(s)}),(e.json.buffers||[]).forEach(t)}_copyJSON(e){const{images:t,buffers:i}=e.json;return e={json:lt({},e.json),resources:lt({},e.resources)},t&&(e.json.images=t.map(r=>lt({},r))),i&&(e.json.buffers=i.map(r=>lt({},r))),e}_binaryToJSON(e){if(!jl(e))throw new Error("Invalid glTF 2.0 binary.");const t=new Uint32Array(e.buffer,e.byteOffset+12,2);if(t[1]!==An.JSON)throw new Error("Missing required GLB JSON chunk.");const i=20,r=t[0],s=be.decodeText(be.toView(e,i,r)),n=JSON.parse(s),o=i+r;if(e.byteLength<=o)return{json:n,resources:{}};const c=new Uint32Array(e.buffer,e.byteOffset+o,2);if(c[1]!==An.BIN)return{json:n,resources:{}};const l=c[0],h=be.toView(e,o+8,l);return{json:n,resources:{[ai]:h}}}}function Cm(a,e){return e.uri!==void 0&&!(e.uri in a.resources)}function Dm(a,e){return e.uri!==void 0&&!(e.uri in a.resources)&&e.bufferView===void 0}function jl(a){if(a.byteLength<3*Uint32Array.BYTES_PER_ELEMENT)return!1;const e=new Uint32Array(a.buffer,a.byteOffset,3);return e[0]===1179937895&&e[1]===2}class _m extends nd{constructor(e=null,t=ut.DEFAULT_INIT){super(),this._fetch=void 0,this._fetchConfig=void 0,this._init=void 0,this._fetchEnabled=!1,this._fetch=e,this._fetchConfig=t,this._init=this.init()}async init(){return this._init?this._init:Promise.all([cs(()=>Promise.resolve().then(()=>yo),void 0,import.meta.url),cs(()=>Promise.resolve().then(()=>yo),void 0,import.meta.url)]).then(([e,t])=>{this._fs=e.promises,this._path=t})}setAllowNetwork(e){if(e&&!this._fetch)throw new Error("NodeIO requires a Fetch API implementation for HTTP requests.");return this._fetchEnabled=e,this}async readURI(e,t){if(await this.init(),ut.isAbsoluteURL(e)){if(!this._fetchEnabled||!this._fetch)throw new Error("Network request blocked. Allow HTTP requests explicitly, if needed.");const i=await this._fetch(e,this._fetchConfig);switch(t){case"view":return new Uint8Array(await i.arrayBuffer());case"text":return i.text()}}else switch(t){case"view":return this._fs.readFile(e);case"text":return this._fs.readFile(e,"utf8")}}resolve(e,t){return ut.isAbsoluteURL(e)||ut.isAbsoluteURL(t)?ut.resolve(e,t):this._path.resolve(e,decodeURIComponent(t))}dirname(e){return ut.isAbsoluteURL(e)?ut.dirname(e):this._path.dirname(e)}async write(e,t){await this.init(),await(!!e.match(/\.glb$/)?this._writeGLB(e,t):this._writeGLTF(e,t))}async _writeGLTF(e,t){var i=this;this.lastWriteBytes=0;const{json:r,resources:s}=await this.writeJSON(t,{format:ia.GLTF,basename:Ba.basename(e)}),{_fs:n,_path:o}=this,c=o.dirname(e),l=JSON.stringify(r,null,2);await n.writeFile(e,l),this.lastWriteBytes+=l.length;for(const h of Sm(Object.keys(s),10))await Promise.all(h.map(async function(d){if(ut.isAbsoluteURL(d)){if(ut.extension(d)==="bin")throw new Error(`Cannot write buffer to path "${d}".`);return}const f=o.join(c,decodeURIComponent(d));await n.mkdir(o.dirname(f),{recursive:!0}),await n.writeFile(f,s[d]),i.lastWriteBytes+=s[d].byteLength}))}async _writeGLB(e,t){const i=await this.writeBinary(t);await this._fs.writeFile(e,i),this.lastWriteBytes=i.byteLength}}function Sm(a,e){const t=[];for(let i=0,r=a.length;i<r;i+=e){const s=[];for(let n=0;n<e&&i+n<r;n++)s.push(a[i+n]);t.push(s)}return t}class Fm extends nd{constructor(e=ut.DEFAULT_INIT){super(),this._fetchConfig=void 0,this._fetchConfig=e}async readURI(e,t){const i=await fetch(e,this._fetchConfig);switch(t){case"view":return new Uint8Array(await i.arrayBuffer());case"text":return i.text()}}resolve(e,t){return ut.resolve(e,t)}dirname(e){return ut.dirname(e)}}const Rm=0,Nm=0,km=0,Um=2,jm=0,Bm=163,Pm=166,Om=0,Vm=2,Lm=1,Gm=64,zm=0;function Km(){return{vkFormat:zm,typeSize:1,pixelWidth:0,pixelHeight:0,pixelDepth:0,layerCount:0,faceCount:1,levelCount:0,supercompressionScheme:Rm,levels:[],dataFormatDescriptor:[{vendorId:km,descriptorType:Nm,versionNumber:Um,colorModel:jm,colorPrimaries:Lm,transferFunction:Vm,flags:Om,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],keyValue:{},globalData:null}}class Zr{constructor(e,t,i,r){this._dataView=void 0,this._littleEndian=void 0,this._offset=void 0,this._dataView=new DataView(e.buffer,e.byteOffset+t,i),this._littleEndian=r,this._offset=0}_nextUint8(){const e=this._dataView.getUint8(this._offset);return this._offset+=1,e}_nextUint16(){const e=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,e}_nextUint32(){const e=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint64(){const e=this._dataView.getUint32(this._offset,this._littleEndian),t=this._dataView.getUint32(this._offset+4,this._littleEndian),i=e+2**32*t;return this._offset+=8,i}_nextInt32(){const e=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint8Array(e){const t=new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+this._offset,e);return this._offset+=e,t}_skip(e){return this._offset+=e,this}_scan(e,t=0){const i=this._offset;let r=0;for(;this._dataView.getUint8(this._offset)!==t&&r<e;)r++,this._offset++;return r<e&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+i,r)}}const nt=[171,75,84,88,32,50,48,187,13,10,26,10];function Bl(a){return new TextDecoder().decode(a)}function Yn(a){const e=new Uint8Array(a.buffer,a.byteOffset,nt.length);if(e[0]!==nt[0]||e[1]!==nt[1]||e[2]!==nt[2]||e[3]!==nt[3]||e[4]!==nt[4]||e[5]!==nt[5]||e[6]!==nt[6]||e[7]!==nt[7]||e[8]!==nt[8]||e[9]!==nt[9]||e[10]!==nt[10]||e[11]!==nt[11])throw new Error("Missing KTX 2.0 identifier.");const t=Km(),i=17*Uint32Array.BYTES_PER_ELEMENT,r=new Zr(a,nt.length,i,!0);t.vkFormat=r._nextUint32(),t.typeSize=r._nextUint32(),t.pixelWidth=r._nextUint32(),t.pixelHeight=r._nextUint32(),t.pixelDepth=r._nextUint32(),t.layerCount=r._nextUint32(),t.faceCount=r._nextUint32(),t.levelCount=r._nextUint32(),t.supercompressionScheme=r._nextUint32();const s=r._nextUint32(),n=r._nextUint32(),o=r._nextUint32(),c=r._nextUint32(),l=r._nextUint64(),h=r._nextUint64(),d=Math.max(t.levelCount,1)*3*8,f=new Zr(a,nt.length+i,d,!0);for(let ge=0,Ae=Math.max(t.levelCount,1);ge<Ae;ge++)t.levels.push({levelData:new Uint8Array(a.buffer,a.byteOffset+f._nextUint64(),f._nextUint64()),uncompressedByteLength:f._nextUint64()});const u=new Zr(a,s,n,!0);u._skip(4);const m=u._nextUint16(),p=u._nextUint16(),g=u._nextUint16(),b=u._nextUint16(),A=u._nextUint8(),y=u._nextUint8(),x=u._nextUint8(),E=u._nextUint8(),I=[u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8()],w=[u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8()],M={vendorId:m,descriptorType:p,versionNumber:g,colorModel:A,colorPrimaries:y,transferFunction:x,flags:E,texelBlockDimension:I,bytesPlane:w,samples:[]},S=(b/4-6)/4;for(let ge=0;ge<S;ge++){const Ae={bitOffset:u._nextUint16(),bitLength:u._nextUint8(),channelType:u._nextUint8(),samplePosition:[u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8()],sampleLower:Number.NEGATIVE_INFINITY,sampleUpper:Number.POSITIVE_INFINITY};Ae.channelType&Gm?(Ae.sampleLower=u._nextInt32(),Ae.sampleUpper=u._nextInt32()):(Ae.sampleLower=u._nextUint32(),Ae.sampleUpper=u._nextUint32()),M.samples[ge]=Ae}t.dataFormatDescriptor.length=0,t.dataFormatDescriptor.push(M);const k=new Zr(a,o,c,!0);for(;k._offset<c;){const ge=k._nextUint32(),Ae=k._scan(ge),_e=Bl(Ae);if(t.keyValue[_e]=k._nextUint8Array(ge-Ae.byteLength-1),_e.match(/^ktx/i)){const pt=Bl(t.keyValue[_e]);t.keyValue[_e]=pt.substring(0,pt.lastIndexOf("\0"))}const Pe=ge%4?4-ge%4:0;k._skip(Pe)}if(h<=0)return t;const F=new Zr(a,l,h,!0),B=F._nextUint16(),O=F._nextUint16(),L=F._nextUint32(),_=F._nextUint32(),q=F._nextUint32(),J=F._nextUint32(),Z=[];for(let ge=0,Ae=Math.max(t.levelCount,1);ge<Ae;ge++)Z.push({imageFlags:F._nextUint32(),rgbSliceByteOffset:F._nextUint32(),rgbSliceByteLength:F._nextUint32(),alphaSliceByteOffset:F._nextUint32(),alphaSliceByteLength:F._nextUint32()});const Y=l+F._offset,W=Y+L,T=W+_,ne=T+q,le=new Uint8Array(a.buffer,a.byteOffset+Y,L),de=new Uint8Array(a.buffer,a.byteOffset+W,_),Me=new Uint8Array(a.buffer,a.byteOffset+T,q),Ne=new Uint8Array(a.buffer,a.byteOffset+ne,J);return t.globalData={endpointCount:B,selectorCount:O,imageDescs:Z,endpointsData:le,selectorsData:de,tablesData:Me,extendedData:Ne},t}const Gt="EXT_mesh_gpu_instancing",Ze="EXT_meshopt_compression",is="EXT_texture_webp",rs="EXT_texture_avif",Ve="KHR_draco_mesh_compression",Et="KHR_lights_punctual",zt="KHR_materials_anisotropy",Kt="KHR_materials_clearcoat",Ht="KHR_materials_diffuse_transmission",qt="KHR_materials_dispersion",Wt="KHR_materials_emissive_strength",Yt="KHR_materials_ior",Xt="KHR_materials_iridescence",Qt="KHR_materials_pbrSpecularGlossiness",Jt="KHR_materials_sheen",Zt="KHR_materials_specular",$t="KHR_materials_transmission",ua="KHR_materials_unlit",ea="KHR_materials_volume",at="KHR_materials_variants",od="KHR_mesh_quantization",ss="KHR_texture_basisu",ta="KHR_texture_transform",Tt="KHR_xmp_json_ld",po="INSTANCE_ATTRIBUTE";class cd extends ze{init(){this.extensionName=Gt,this.propertyType="InstancedMesh",this.parentTypes=[X.NODE]}getDefaults(){return Object.assign(super.getDefaults(),{attributes:new kt})}getAttribute(e){return this.getRefMap("attributes",e)}setAttribute(e,t){return this.setRefMap("attributes",e,t,{usage:po})}listAttributes(){return this.listRefMapValues("attributes")}listSemantics(){return this.listRefMapKeys("attributes")}}cd.EXTENSION_NAME=Gt;class ld extends Ue{constructor(...e){super(...e),this.extensionName=Gt,this.provideTypes=[X.NODE],this.prewriteTypes=[X.ACCESSOR]}createInstancedMesh(){return new cd(this.document.getGraph())}read(e){return(e.jsonDoc.json.nodes||[]).forEach((r,s)=>{if(!r.extensions||!r.extensions[Gt])return;const n=r.extensions[Gt],o=this.createInstancedMesh();for(const c in n.attributes)o.setAttribute(c,e.accessors[n.attributes[c]]);e.nodes[s].setExtension(Gt,o)}),this}prewrite(e){e.accessorUsageGroupedByParent.add(po);for(const t of this.properties)for(const i of t.listAttributes())e.addAccessorToUsageGroup(i,po);return this}write(e){const t=e.jsonDoc;return this.document.getRoot().listNodes().forEach(i=>{const r=i.getExtension(Gt);if(r){const s=e.nodeIndexMap.get(i),n=t.json.nodes[s],o={attributes:{}};r.listSemantics().forEach(c=>{const l=r.getAttribute(c);o.attributes[c]=e.accessorIndexMap.get(l)}),n.extensions=n.extensions||{},n.extensions[Gt]=o}}),this}}ld.EXTENSION_NAME=Gt;function ra(){return ra=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(a[i]=t[i])}return a},ra.apply(null,arguments)}var ms;(function(a){a.QUANTIZE="quantize",a.FILTER="filter"})(ms||(ms={}));var Za;(function(a){a.ATTRIBUTES="ATTRIBUTES",a.TRIANGLES="TRIANGLES",a.INDICES="INDICES"})(Za||(Za={}));var Ge;(function(a){a.NONE="NONE",a.OCTAHEDRAL="OCTAHEDRAL",a.QUATERNION="QUATERNION",a.EXPONENTIAL="EXPONENTIAL"})(Ge||(Ge={}));function Hm(a){return!a.extensions||!a.extensions[Ze]?!1:!!a.extensions[Ze].fallback}const{BYTE:qm,SHORT:Pl,FLOAT:Wm}=ie.ComponentType,{encodeNormalizedInt:Ol,decodeNormalizedInt:mo}=De;function Ym(a,e,t,i){const{filter:r,bits:s}=i,n={array:a.getArray(),byteStride:a.getElementSize()*a.getComponentSize(),componentType:a.getComponentType(),normalized:a.getNormalized()};if(t!==Za.ATTRIBUTES)return n;if(r!==Ge.NONE){let o=a.getNormalized()?Xm(a):new Float32Array(n.array);switch(r){case Ge.EXPONENTIAL:n.byteStride=a.getElementSize()*4,n.componentType=Wm,n.normalized=!1,n.array=e.encodeFilterExp(o,a.getCount(),n.byteStride,s);break;case Ge.OCTAHEDRAL:n.byteStride=s>8?8:4,n.componentType=s>8?Pl:qm,n.normalized=!0,o=a.getElementSize()===3?Jm(o):o,n.array=e.encodeFilterOct(o,a.getCount(),n.byteStride,s);break;case Ge.QUATERNION:n.byteStride=8,n.componentType=Pl,n.normalized=!0,n.array=e.encodeFilterQuat(o,a.getCount(),n.byteStride,s);break;default:throw new Error("Invalid filter.")}n.min=a.getMin([]),n.max=a.getMax([]),a.getNormalized()&&(n.min=n.min.map(c=>mo(c,a.getComponentType())),n.max=n.max.map(c=>mo(c,a.getComponentType()))),n.normalized&&(n.min=n.min.map(c=>Ol(c,n.componentType)),n.max=n.max.map(c=>Ol(c,n.componentType)))}else n.byteStride%4&&(n.array=Qm(n.array,a.getElementSize()),n.byteStride=n.array.byteLength/a.getCount());return n}function Xm(a){const e=a.getComponentType(),t=a.getArray(),i=new Float32Array(t.length);for(let r=0;r<t.length;r++)i[r]=mo(t[r],e);return i}function Qm(a,e){const i=be.padNumber(a.BYTES_PER_ELEMENT*e)/a.BYTES_PER_ELEMENT,r=a.length/e,s=new a.constructor(r*i);for(let n=0;n*e<a.length;n++)for(let o=0;o<e;o++)s[n*i+o]=a[n*e+o];return s}function Jm(a){const e=new Float32Array(a.length*4/3);for(let t=0,i=a.length/3;t<i;t++)e[t*4]=a[t*3],e[t*4+1]=a[t*3+1],e[t*4+2]=a[t*3+2];return e}function Zm(a,e){return e===Vt.BufferViewUsage.ELEMENT_ARRAY_BUFFER?a.listParents().some(i=>i instanceof Oa&&i.getMode()===Oa.Mode.TRIANGLES)?Za.TRIANGLES:Za.INDICES:Za.ATTRIBUTES}function $m(a,e){const t=e.getGraph().listParentEdges(a).filter(i=>!(i.getParent()instanceof sd));for(const i of t){const r=i.getName(),s=i.getAttributes().key||"",n=i.getParent().propertyType===X.PRIMITIVE_TARGET;if(r==="indices")return{filter:Ge.NONE};if(r==="attributes"){if(s==="POSITION")return{filter:Ge.NONE};if(s==="TEXCOORD_0")return{filter:Ge.NONE};if(s.startsWith("JOINTS_"))return{filter:Ge.NONE};if(s.startsWith("WEIGHTS_"))return{filter:Ge.NONE};if(s==="NORMAL"||s==="TANGENT")return n?{filter:Ge.NONE}:{filter:Ge.OCTAHEDRAL,bits:8}}if(r==="output"){const o=hd(a);return o==="rotation"?{filter:Ge.QUATERNION,bits:16}:o==="translation"?{filter:Ge.EXPONENTIAL,bits:12}:o==="scale"?{filter:Ge.EXPONENTIAL,bits:12}:{filter:Ge.NONE}}if(r==="input")return{filter:Ge.NONE};if(r==="inverseBindMatrices")return{filter:Ge.NONE}}return{filter:Ge.NONE}}function hd(a){for(const e of a.listParents())if(e instanceof ri){for(const t of e.listParents())if(t instanceof Lo)return t.getTargetPath()}return null}const Vl={method:ms.QUANTIZE};class Go extends Ue{constructor(...e){super(...e),this.extensionName=Ze,this.prereadTypes=[X.BUFFER,X.PRIMITIVE],this.prewriteTypes=[X.BUFFER,X.ACCESSOR],this.readDependencies=["meshopt.decoder"],this.writeDependencies=["meshopt.encoder"],this._decoder=null,this._decoderFallbackBufferMap=new Map,this._encoder=null,this._encoderOptions=Vl,this._encoderFallbackBuffer=null,this._encoderBufferViews={},this._encoderBufferViewData={},this._encoderBufferViewAccessors={}}install(e,t){return e==="meshopt.decoder"&&(this._decoder=t),e==="meshopt.encoder"&&(this._encoder=t),this}setEncoderOptions(e){return this._encoderOptions=ra({},Vl,e),this}preread(e,t){if(!this._decoder){if(!this.isRequired())return this;throw new Error(`[${Ze}] Please install extension dependency, "meshopt.decoder".`)}if(!this._decoder.supported){if(!this.isRequired())return this;throw new Error(`[${Ze}]: Missing WASM support.`)}return t===X.BUFFER?this._prereadBuffers(e):t===X.PRIMITIVE&&this._prereadPrimitives(e),this}_prereadBuffers(e){const t=e.jsonDoc;(t.json.bufferViews||[]).forEach((r,s)=>{if(!r.extensions||!r.extensions[Ze])return;const n=r.extensions[Ze],o=n.byteOffset||0,c=n.byteLength||0,l=n.count,h=n.byteStride,d=new Uint8Array(l*h),f=t.json.buffers[n.buffer],u=f.uri?t.resources[f.uri]:t.resources[ai],m=be.toView(u,o,c);this._decoder.decodeGltfBuffer(d,l,h,m,n.mode,n.filter),e.bufferViews[s]=d})}_prereadPrimitives(e){const t=e.jsonDoc;(t.json.bufferViews||[]).forEach(r=>{if(!r.extensions||!r.extensions[Ze])return;const s=r.extensions[Ze],n=e.buffers[s.buffer],o=e.buffers[r.buffer],c=t.json.buffers[r.buffer];Hm(c)&&this._decoderFallbackBufferMap.set(o,n)})}read(e){if(!this.isRequired())return this;for(const[t,i]of this._decoderFallbackBufferMap){for(const r of t.listParents())r instanceof ie&&r.swap(t,i);t.dispose()}return this}prewrite(e,t){return t===X.ACCESSOR?this._prewriteAccessors(e):t===X.BUFFER&&this._prewriteBuffers(e),this}_prewriteAccessors(e){const t=e.jsonDoc.json,i=this._encoder,r=this._encoderOptions,s=this.document.getGraph(),n=this.document.createBuffer(),o=this.document.getRoot().listBuffers().indexOf(n);let c=1;const l=new Map,h=d=>{for(const f of s.listParents(d)){if(f.propertyType===X.ROOT)continue;let u=l.get(d);return u===void 0&&l.set(d,u=c++),u}return-1};this._encoderFallbackBuffer=n,this._encoderBufferViews={},this._encoderBufferViewData={},this._encoderBufferViewAccessors={};for(const d of this.document.getRoot().listAccessors()){if(hd(d)==="weights"||d.getSparse())continue;const f=e.getAccessorUsage(d),u=e.accessorUsageGroupedByParent.has(f)?h(d):null,m=Zm(d,f),p=r.method===ms.FILTER?$m(d,this.document):{filter:Ge.NONE},g=Ym(d,i,m,p),{array:b,byteStride:A}=g,y=d.getBuffer();if(!y)throw new Error(`${Ze}: Missing buffer for accessor.`);const x=this.document.getRoot().listBuffers().indexOf(y),E=[f,u,m,p.filter,A,x].join(":");let I=this._encoderBufferViews[E],w=this._encoderBufferViewData[E],v=this._encoderBufferViewAccessors[E];(!I||!w)&&(v=this._encoderBufferViewAccessors[E]=[],w=this._encoderBufferViewData[E]=[],I=this._encoderBufferViews[E]={buffer:o,target:Vt.USAGE_TO_TARGET[f],byteOffset:0,byteLength:0,byteStride:f===Vt.BufferViewUsage.ARRAY_BUFFER?A:void 0,extensions:{[Ze]:{buffer:x,byteOffset:0,byteLength:0,mode:m,filter:p.filter!==Ge.NONE?p.filter:void 0,byteStride:A,count:0}}});const M=e.createAccessorDef(d);M.componentType=g.componentType,M.normalized=g.normalized,M.byteOffset=I.byteLength,M.min&&g.min&&(M.min=g.min),M.max&&g.max&&(M.max=g.max),e.accessorIndexMap.set(d,t.accessors.length),t.accessors.push(M),v.push(M),w.push(new Uint8Array(b.buffer,b.byteOffset,b.byteLength)),I.byteLength+=b.byteLength,I.extensions.EXT_meshopt_compression.count+=d.getCount()}}_prewriteBuffers(e){const t=this._encoder;for(const i in this._encoderBufferViews){const r=this._encoderBufferViews[i],s=this._encoderBufferViewData[i],n=this.document.getRoot().listBuffers()[r.extensions[Ze].buffer],o=e.otherBufferViews.get(n)||[],{count:c,byteStride:l,mode:h}=r.extensions[Ze],d=be.concat(s),f=t.encodeGltfBuffer(d,c,l,h),u=be.pad(f);r.extensions[Ze].byteLength=f.byteLength,s.length=0,s.push(u),o.push(u),e.otherBufferViews.set(n,o)}}write(e){let t=0;for(const n in this._encoderBufferViews){const o=this._encoderBufferViews[n],c=this._encoderBufferViewData[n][0],l=e.otherBufferViewsIndexMap.get(c),h=this._encoderBufferViewAccessors[n];for(const m of h)m.bufferView=l;const d=e.jsonDoc.json.bufferViews[l],f=d.byteOffset||0;Object.assign(d,o),d.byteOffset=t;const u=d.extensions[Ze];u.byteOffset=f,t+=be.padNumber(o.byteLength)}const i=this._encoderFallbackBuffer,r=e.bufferIndexMap.get(i),s=e.jsonDoc.json.buffers[r];return s.byteLength=t,s.extensions={[Ze]:{fallback:!0}},i.dispose(),this}}Go.EXTENSION_NAME=Ze;Go.EncoderMethod=ms;class eg{match(e){return e.length>=12&&be.decodeText(e.slice(4,12))==="ftypavif"}getSize(e){if(!this.match(e))return null;const t=new DataView(e.buffer,e.byteOffset,e.byteLength);let i=Ll(t,0);if(!i)return null;let r=i.end;for(;i=Ll(t,r);)if(i.type==="meta")r=i.start+4;else if(i.type==="iprp"||i.type==="ipco")r=i.start;else{if(i.type==="ispe")return[t.getUint32(i.start+4),t.getUint32(i.start+8)];if(i.type==="mdat")break;r=i.end}return null}getChannels(e){return 4}}class dd extends Ue{constructor(...e){super(...e),this.extensionName=rs,this.prereadTypes=[X.TEXTURE]}static register(){Ot.registerFormat("image/avif",new eg)}preread(e){return(e.jsonDoc.json.textures||[]).forEach(i=>{i.extensions&&i.extensions[rs]&&(i.source=i.extensions[rs].source)}),this}read(e){return this}write(e){const t=e.jsonDoc;return this.document.getRoot().listTextures().forEach(i=>{if(i.getMimeType()==="image/avif"){const r=e.imageIndexMap.get(i);(t.json.textures||[]).forEach(n=>{n.source===r&&(n.extensions=n.extensions||{},n.extensions[rs]={source:n.source},delete n.source)})}}),this}}dd.EXTENSION_NAME=rs;function Ll(a,e){if(a.byteLength<4+e)return null;const t=a.getUint32(e);return a.byteLength<t+e||t<8?null:{type:be.decodeText(new Uint8Array(a.buffer,a.byteOffset+e+4,4)),start:e+8,end:e+t}}class tg{match(e){return e.length>=12&&e[8]===87&&e[9]===69&&e[10]===66&&e[11]===80}getSize(e){const t=be.decodeText(e.slice(0,4)),i=be.decodeText(e.slice(8,12));if(t!=="RIFF"||i!=="WEBP")return null;const r=new DataView(e.buffer,e.byteOffset);let s=12;for(;s<r.byteLength;){const n=be.decodeText(new Uint8Array([r.getUint8(s),r.getUint8(s+1),r.getUint8(s+2),r.getUint8(s+3)])),o=r.getUint32(s+4,!0);if(n==="VP8 "){const c=r.getInt16(s+14,!0)&16383,l=r.getInt16(s+16,!0)&16383;return[c,l]}else if(n==="VP8L"){const c=r.getUint8(s+9),l=r.getUint8(s+10),h=r.getUint8(s+11),d=r.getUint8(s+12),f=1+((l&63)<<8|c),u=1+((d&15)<<10|h<<2|(l&192)>>6);return[f,u]}s+=8+o+o%2}return null}getChannels(e){return 4}}class fd extends Ue{constructor(...e){super(...e),this.extensionName=is,this.prereadTypes=[X.TEXTURE]}static register(){Ot.registerFormat("image/webp",new tg)}preread(e){return(e.jsonDoc.json.textures||[]).forEach(i=>{i.extensions&&i.extensions[is]&&(i.source=i.extensions[is].source)}),this}read(e){return this}write(e){const t=e.jsonDoc;return this.document.getRoot().listTextures().forEach(i=>{if(i.getMimeType()==="image/webp"){const r=e.imageIndexMap.get(i);(t.json.textures||[]).forEach(n=>{n.source===r&&(n.extensions=n.extensions||{},n.extensions[is]={source:n.source},delete n.source)})}}),this}}fd.EXTENSION_NAME=is;let We,ud,bd;function ag(a,e){const t=new We.DecoderBuffer;try{if(t.Init(e,e.length),a.GetEncodedGeometryType(t)!==We.TRIANGULAR_MESH)throw new Error(`[${Ve}] Unknown geometry type.`);const r=new We.Mesh;if(!a.DecodeBufferToMesh(t,r).ok()||r.ptr===0)throw new Error(`[${Ve}] Decoding failure.`);return r}finally{We.destroy(t)}}function ig(a,e){const i=e.num_faces()*3;let r,s;if(e.num_points()<=65534){const n=i*Uint16Array.BYTES_PER_ELEMENT;r=We._malloc(n),a.GetTrianglesUInt16Array(e,n,r),s=new Uint16Array(We.HEAPU16.buffer,r,i).slice()}else{const n=i*Uint32Array.BYTES_PER_ELEMENT;r=We._malloc(n),a.GetTrianglesUInt32Array(e,n,r),s=new Uint32Array(We.HEAPU32.buffer,r,i).slice()}return We._free(r),s}function rg(a,e,t,i){const r=bd[i.componentType],s=ud[i.componentType],n=t.num_components(),c=e.num_points()*n,l=c*s.BYTES_PER_ELEMENT,h=We._malloc(l);a.GetAttributeDataArrayForAllPoints(e,t,r,l,h);const d=new s(We.HEAPF32.buffer,h,c).slice();return We._free(h),d}function sg(a){We=a,ud={[ie.ComponentType.FLOAT]:Float32Array,[ie.ComponentType.UNSIGNED_INT]:Uint32Array,[ie.ComponentType.UNSIGNED_SHORT]:Uint16Array,[ie.ComponentType.UNSIGNED_BYTE]:Uint8Array,[ie.ComponentType.SHORT]:Int16Array,[ie.ComponentType.BYTE]:Int8Array},bd={[ie.ComponentType.FLOAT]:We.DT_FLOAT32,[ie.ComponentType.UNSIGNED_INT]:We.DT_UINT32,[ie.ComponentType.UNSIGNED_SHORT]:We.DT_UINT16,[ie.ComponentType.UNSIGNED_BYTE]:We.DT_UINT8,[ie.ComponentType.SHORT]:We.DT_INT16,[ie.ComponentType.BYTE]:We.DT_INT8}}let vt;var gs;(function(a){a[a.EDGEBREAKER=1]="EDGEBREAKER",a[a.SEQUENTIAL=0]="SEQUENTIAL"})(gs||(gs={}));var Mt;(function(a){a.POSITION="POSITION",a.NORMAL="NORMAL",a.COLOR="COLOR",a.TEX_COORD="TEX_COORD",a.GENERIC="GENERIC"})(Mt||(Mt={}));const pd={[Mt.POSITION]:14,[Mt.NORMAL]:10,[Mt.COLOR]:8,[Mt.TEX_COORD]:12,[Mt.GENERIC]:12},Gl={decodeSpeed:5,encodeSpeed:5,method:gs.EDGEBREAKER,quantizationBits:pd,quantizationVolume:"mesh"};function ng(a){vt=a}function og(a,e=Gl){const t=ra({},Gl,e);t.quantizationBits=ra({},pd,e.quantizationBits);const i=new vt.MeshBuilder,r=new vt.Mesh,s=new vt.ExpertEncoder(r),n={},o=new vt.DracoInt8Array,c=a.listTargets().length>0;let l=!1;for(const p of a.listSemantics()){const g=a.getAttribute(p);if(g.getSparse()){l=!0;continue}const b=cg(p),A=lg(i,g.getComponentType(),r,vt[b],g.getCount(),g.getElementSize(),g.getArray());if(A===-1)throw new Error(`Error compressing "${p}" attribute.`);if(n[p]=A,t.quantizationVolume==="mesh"||p!=="POSITION")s.SetAttributeQuantization(A,t.quantizationBits[b]);else if(typeof t.quantizationVolume=="object"){const{quantizationVolume:y}=t,x=Math.max(y.max[0]-y.min[0],y.max[1]-y.min[1],y.max[2]-y.min[2]);s.SetAttributeExplicitQuantization(A,t.quantizationBits[b],g.getElementSize(),y.min,x)}else throw new Error("Invalid quantization volume state.")}const h=a.getIndices();if(!h)throw new go("Primitive must have indices.");i.AddFacesToMesh(r,h.getCount()/3,h.getArray()),s.SetSpeedOptions(t.encodeSpeed,t.decodeSpeed),s.SetTrackEncodedProperties(!0),t.method===gs.SEQUENTIAL||c||l?s.SetEncodingMethod(vt.MESH_SEQUENTIAL_ENCODING):s.SetEncodingMethod(vt.MESH_EDGEBREAKER_ENCODING);const d=s.EncodeToDracoBuffer(!(c||l),o);if(d<=0)throw new go("Error applying Draco compression.");const f=new Uint8Array(d);for(let p=0;p<d;++p)f[p]=o.GetValue(p);const u=s.GetNumberOfEncodedPoints(),m=s.GetNumberOfEncodedFaces()*3;return vt.destroy(o),vt.destroy(r),vt.destroy(i),vt.destroy(s),{numVertices:u,numIndices:m,data:f,attributeIDs:n}}function cg(a){return a==="POSITION"?Mt.POSITION:a==="NORMAL"?Mt.NORMAL:a.startsWith("COLOR_")?Mt.COLOR:a.startsWith("TEXCOORD_")?Mt.TEX_COORD:Mt.GENERIC}function lg(a,e,t,i,r,s,n){switch(e){case ie.ComponentType.UNSIGNED_BYTE:return a.AddUInt8Attribute(t,i,r,s,n);case ie.ComponentType.BYTE:return a.AddInt8Attribute(t,i,r,s,n);case ie.ComponentType.UNSIGNED_SHORT:return a.AddUInt16Attribute(t,i,r,s,n);case ie.ComponentType.SHORT:return a.AddInt16Attribute(t,i,r,s,n);case ie.ComponentType.UNSIGNED_INT:return a.AddUInt32Attribute(t,i,r,s,n);case ie.ComponentType.FLOAT:return a.AddFloatAttribute(t,i,r,s,n);default:throw new Error(`Unexpected component type, "${e}".`)}}class go extends Error{}class zo extends Ue{constructor(...e){super(...e),this.extensionName=Ve,this.prereadTypes=[X.PRIMITIVE],this.prewriteTypes=[X.ACCESSOR],this.readDependencies=["draco3d.decoder"],this.writeDependencies=["draco3d.encoder"],this._decoderModule=null,this._encoderModule=null,this._encoderOptions={}}install(e,t){return e==="draco3d.decoder"&&(this._decoderModule=t,sg(this._decoderModule)),e==="draco3d.encoder"&&(this._encoderModule=t,ng(this._encoderModule)),this}setEncoderOptions(e){return this._encoderOptions=e,this}preread(e){if(!this._decoderModule)throw new Error(`[${Ve}] Please install extension dependency, "draco3d.decoder".`);const t=this.document.getLogger(),i=e.jsonDoc,r=new Map;try{const s=i.json.meshes||[];for(const n of s)for(const o of n.primitives){if(!o.extensions||!o.extensions[Ve])continue;const c=o.extensions[Ve];let[l,h]=r.get(c.bufferView)||[];if(!h||!l){const d=i.json.bufferViews[c.bufferView],f=i.json.buffers[d.buffer],u=f.uri?i.resources[f.uri]:i.resources[ai],m=d.byteOffset||0,p=d.byteLength,g=be.toView(u,m,p);l=new this._decoderModule.Decoder,h=ag(l,g),r.set(c.bufferView,[l,h]),t.debug(`[${Ve}] Decompressed ${g.byteLength} bytes.`)}for(const d in c.attributes){const f=e.jsonDoc.json.accessors[o.attributes[d]],u=l.GetAttributeByUniqueId(h,c.attributes[d]),m=rg(l,h,u,f);e.accessors[o.attributes[d]].setArray(m)}o.indices!==void 0&&e.accessors[o.indices].setArray(ig(l,h))}}finally{for(const[s,n]of Array.from(r.values()))this._decoderModule.destroy(s),this._decoderModule.destroy(n)}return this}read(e){return this}prewrite(e,t){if(!this._encoderModule)throw new Error(`[${Ve}] Please install extension dependency, "draco3d.encoder".`);const i=this.document.getLogger();i.debug(`[${Ve}] Compression options: ${JSON.stringify(this._encoderOptions)}`);const r=hg(this.document),s=new Map;let n="mesh";this._encoderOptions.quantizationVolume==="scene"&&(this.document.getRoot().listScenes().length!==1?i.warn(`[${Ve}]: quantizationVolume=scene requires exactly 1 scene.`):n=Z0(this.document.getRoot().listScenes().pop()));for(const o of Array.from(r.keys())){const c=r.get(o);if(!c)throw new Error("Unexpected primitive.");if(s.has(c)){s.set(c,s.get(c));continue}const l=o.getIndices(),h=e.jsonDoc.json.accessors;let d;try{d=og(o,ra({},this._encoderOptions,{quantizationVolume:n}))}catch(m){if(m instanceof go){i.warn(`[${Ve}]: ${m.message} Skipping primitive compression.`);continue}throw m}s.set(c,d);const f=e.createAccessorDef(l);f.count=d.numIndices,e.accessorIndexMap.set(l,h.length),h.push(f),d.numVertices>65534&&ie.getComponentSize(f.componentType)<=2?f.componentType=ie.ComponentType.UNSIGNED_INT:d.numVertices>254&&ie.getComponentSize(f.componentType)<=1&&(f.componentType=ie.ComponentType.UNSIGNED_SHORT);for(const m of o.listSemantics()){const p=o.getAttribute(m);if(d.attributeIDs[m]===void 0)continue;const g=e.createAccessorDef(p);g.count=d.numVertices,e.accessorIndexMap.set(p,h.length),h.push(g)}const u=o.getAttribute("POSITION").getBuffer()||this.document.getRoot().listBuffers()[0];e.otherBufferViews.has(u)||e.otherBufferViews.set(u,[]),e.otherBufferViews.get(u).push(d.data)}return i.debug(`[${Ve}] Compressed ${r.size} primitives.`),e.extensionData[Ve]={primitiveHashMap:r,primitiveEncodingMap:s},this}write(e){const t=e.extensionData[Ve];for(const i of this.document.getRoot().listMeshes()){const r=e.jsonDoc.json.meshes[e.meshIndexMap.get(i)];for(let s=0;s<i.listPrimitives().length;s++){const n=i.listPrimitives()[s],o=r.primitives[s],c=t.primitiveHashMap.get(n);if(!c)continue;const l=t.primitiveEncodingMap.get(c);l&&(o.extensions=o.extensions||{},o.extensions[Ve]={bufferView:e.otherBufferViewsIndexMap.get(l.data),attributes:l.attributeIDs})}}if(!t.primitiveHashMap.size){const i=e.jsonDoc.json;i.extensionsUsed=(i.extensionsUsed||[]).filter(r=>r!==Ve),i.extensionsRequired=(i.extensionsRequired||[]).filter(r=>r!==Ve)}return this}}zo.EXTENSION_NAME=Ve;zo.EncoderMethod=gs;function hg(a){const e=a.getLogger(),t=new Set,i=new Set;let r=0,s=0;for(const d of a.getRoot().listMeshes())for(const f of d.listPrimitives())f.getIndices()?f.getMode()!==Oa.Mode.TRIANGLES?(i.add(f),s++):t.add(f):(i.add(f),r++);r>0&&e.warn(`[${Ve}] Skipping Draco compression of ${r} non-indexed primitives.`),s>0&&e.warn(`[${Ve}] Skipping Draco compression of ${s} non-TRIANGLES primitives.`);const n=a.getRoot().listAccessors(),o=new Map;for(let d=0;d<n.length;d++)o.set(n[d],d);const c=new Map,l=new Set,h=new Map;for(const d of Array.from(t)){let f=zl(d,o);if(l.has(f)){h.set(d,f);continue}if(c.has(d.getIndices())){const u=d.getIndices(),m=u.clone();o.set(m,a.getRoot().listAccessors().length-1),d.swap(u,m)}for(const u of d.listAttributes())if(c.has(u)){const m=u.clone();o.set(m,a.getRoot().listAccessors().length-1),d.swap(u,m)}f=zl(d,o),l.add(f),h.set(d,f),c.set(d.getIndices(),f);for(const u of d.listAttributes())c.set(u,f)}for(const d of Array.from(c.keys())){const f=new Set(d.listParents().map(u=>u.propertyType));if(f.size!==2||!f.has(X.PRIMITIVE)||!f.has(X.ROOT))throw new Error(`[${Ve}] Compressed accessors must only be used as indices or vertex attributes.`)}for(const d of Array.from(t)){const f=h.get(d),u=d.getIndices();if(c.get(u)!==f||d.listAttributes().some(m=>c.get(m)!==f))throw new Error(`[${Ve}] Draco primitives must share all, or no, accessors.`)}for(const d of Array.from(i)){const f=d.getIndices();if(c.has(f)||d.listAttributes().some(u=>c.has(u)))throw new Error(`[${Ve}] Accessor cannot be shared by compressed and uncompressed primitives.`)}return h}function zl(a,e){const t=[],i=a.getIndices();t.push(e.get(i));for(const r of a.listAttributes())t.push(e.get(r));return t.sort().join("|")}class ii extends ze{init(){this.extensionName=Et,this.propertyType="Light",this.parentTypes=[X.NODE]}getDefaults(){return Object.assign(super.getDefaults(),{color:[1,1,1],intensity:1,type:ii.Type.POINT,range:null,innerConeAngle:0,outerConeAngle:Math.PI/4})}getColor(){return this.get("color")}setColor(e){return this.set("color",e)}getIntensity(){return this.get("intensity")}setIntensity(e){return this.set("intensity",e)}getType(){return this.get("type")}setType(e){return this.set("type",e)}getRange(){return this.get("range")}setRange(e){return this.set("range",e)}getInnerConeAngle(){return this.get("innerConeAngle")}setInnerConeAngle(e){return this.set("innerConeAngle",e)}getOuterConeAngle(){return this.get("outerConeAngle")}setOuterConeAngle(e){return this.set("outerConeAngle",e)}}ii.EXTENSION_NAME=Et;ii.Type={POINT:"point",SPOT:"spot",DIRECTIONAL:"directional"};class md extends Ue{constructor(...e){super(...e),this.extensionName=Et}createLight(e=""){return new ii(this.document.getGraph(),e)}read(e){const t=e.jsonDoc;if(!t.json.extensions||!t.json.extensions[Et])return this;const s=(t.json.extensions[Et].lights||[]).map(n=>{var o,c;const l=this.createLight().setName(n.name||"").setType(n.type);return n.color!==void 0&&l.setColor(n.color),n.intensity!==void 0&&l.setIntensity(n.intensity),n.range!==void 0&&l.setRange(n.range),((o=n.spot)==null?void 0:o.innerConeAngle)!==void 0&&l.setInnerConeAngle(n.spot.innerConeAngle),((c=n.spot)==null?void 0:c.outerConeAngle)!==void 0&&l.setOuterConeAngle(n.spot.outerConeAngle),l});return t.json.nodes.forEach((n,o)=>{if(!n.extensions||!n.extensions[Et])return;const c=n.extensions[Et];e.nodes[o].setExtension(Et,s[c.light])}),this}write(e){const t=e.jsonDoc;if(this.properties.size===0)return this;const i=[],r=new Map;for(const s of this.properties){const n=s,o={type:n.getType()};De.eq(n.getColor(),[1,1,1])||(o.color=n.getColor()),n.getIntensity()!==1&&(o.intensity=n.getIntensity()),n.getRange()!=null&&(o.range=n.getRange()),n.getName()&&(o.name=n.getName()),n.getType()===ii.Type.SPOT&&(o.spot={innerConeAngle:n.getInnerConeAngle(),outerConeAngle:n.getOuterConeAngle()}),i.push(o),r.set(n,i.length-1)}return this.document.getRoot().listNodes().forEach(s=>{const n=s.getExtension(Et);if(n){const o=e.nodeIndexMap.get(s),c=t.json.nodes[o];c.extensions=c.extensions||{},c.extensions[Et]={light:r.get(n)}}}),t.json.extensions=t.json.extensions||{},t.json.extensions[Et]={lights:i},this}}md.EXTENSION_NAME=Et;const{R:dg,G:fg,B:ug}=_t;class gd extends ze{init(){this.extensionName=zt,this.propertyType="Anisotropy",this.parentTypes=[X.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{anisotropyStrength:0,anisotropyRotation:0,anisotropyTexture:null,anisotropyTextureInfo:new Se(this.graph,"anisotropyTextureInfo")})}getAnisotropyStrength(){return this.get("anisotropyStrength")}setAnisotropyStrength(e){return this.set("anisotropyStrength",e)}getAnisotropyRotation(){return this.get("anisotropyRotation")}setAnisotropyRotation(e){return this.set("anisotropyRotation",e)}getAnisotropyTexture(){return this.getRef("anisotropyTexture")}getAnisotropyTextureInfo(){return this.getRef("anisotropyTexture")?this.getRef("anisotropyTextureInfo"):null}setAnisotropyTexture(e){return this.setRef("anisotropyTexture",e,{channels:dg|fg|ug})}}gd.EXTENSION_NAME=zt;class Ad extends Ue{constructor(...e){super(...e),this.extensionName=zt,this.prereadTypes=[X.MESH],this.prewriteTypes=[X.MESH]}createAnisotropy(){return new gd(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){const t=e.jsonDoc,i=t.json.materials||[],r=t.json.textures||[];return i.forEach((s,n)=>{if(s.extensions&&s.extensions[zt]){const o=this.createAnisotropy();e.materials[n].setExtension(zt,o);const c=s.extensions[zt];if(c.anisotropyStrength!==void 0&&o.setAnisotropyStrength(c.anisotropyStrength),c.anisotropyRotation!==void 0&&o.setAnisotropyRotation(c.anisotropyRotation),c.anisotropyTexture!==void 0){const l=c.anisotropyTexture,h=e.textures[r[l.index].source];o.setAnisotropyTexture(h),e.setTextureInfo(o.getAnisotropyTextureInfo(),l)}}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(i=>{const r=i.getExtension(zt);if(r){const s=e.materialIndexMap.get(i),n=t.json.materials[s];n.extensions=n.extensions||{};const o=n.extensions[zt]={};if(r.getAnisotropyStrength()>0&&(o.anisotropyStrength=r.getAnisotropyStrength()),r.getAnisotropyRotation()!==0&&(o.anisotropyRotation=r.getAnisotropyRotation()),r.getAnisotropyTexture()){const c=r.getAnisotropyTexture(),l=r.getAnisotropyTextureInfo();o.anisotropyTexture=e.createTextureInfoDef(c,l)}}}),this}}Ad.EXTENSION_NAME=zt;const{R:Kl,G:Hl,B:bg}=_t;class yd extends ze{init(){this.extensionName=Kt,this.propertyType="Clearcoat",this.parentTypes=[X.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{clearcoatFactor:0,clearcoatTexture:null,clearcoatTextureInfo:new Se(this.graph,"clearcoatTextureInfo"),clearcoatRoughnessFactor:0,clearcoatRoughnessTexture:null,clearcoatRoughnessTextureInfo:new Se(this.graph,"clearcoatRoughnessTextureInfo"),clearcoatNormalScale:1,clearcoatNormalTexture:null,clearcoatNormalTextureInfo:new Se(this.graph,"clearcoatNormalTextureInfo")})}getClearcoatFactor(){return this.get("clearcoatFactor")}setClearcoatFactor(e){return this.set("clearcoatFactor",e)}getClearcoatTexture(){return this.getRef("clearcoatTexture")}getClearcoatTextureInfo(){return this.getRef("clearcoatTexture")?this.getRef("clearcoatTextureInfo"):null}setClearcoatTexture(e){return this.setRef("clearcoatTexture",e,{channels:Kl})}getClearcoatRoughnessFactor(){return this.get("clearcoatRoughnessFactor")}setClearcoatRoughnessFactor(e){return this.set("clearcoatRoughnessFactor",e)}getClearcoatRoughnessTexture(){return this.getRef("clearcoatRoughnessTexture")}getClearcoatRoughnessTextureInfo(){return this.getRef("clearcoatRoughnessTexture")?this.getRef("clearcoatRoughnessTextureInfo"):null}setClearcoatRoughnessTexture(e){return this.setRef("clearcoatRoughnessTexture",e,{channels:Hl})}getClearcoatNormalScale(){return this.get("clearcoatNormalScale")}setClearcoatNormalScale(e){return this.set("clearcoatNormalScale",e)}getClearcoatNormalTexture(){return this.getRef("clearcoatNormalTexture")}getClearcoatNormalTextureInfo(){return this.getRef("clearcoatNormalTexture")?this.getRef("clearcoatNormalTextureInfo"):null}setClearcoatNormalTexture(e){return this.setRef("clearcoatNormalTexture",e,{channels:Kl|Hl|bg})}}yd.EXTENSION_NAME=Kt;class xd extends Ue{constructor(...e){super(...e),this.extensionName=Kt,this.prereadTypes=[X.MESH],this.prewriteTypes=[X.MESH]}createClearcoat(){return new yd(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){const t=e.jsonDoc,i=t.json.materials||[],r=t.json.textures||[];return i.forEach((s,n)=>{if(s.extensions&&s.extensions[Kt]){const o=this.createClearcoat();e.materials[n].setExtension(Kt,o);const c=s.extensions[Kt];if(c.clearcoatFactor!==void 0&&o.setClearcoatFactor(c.clearcoatFactor),c.clearcoatRoughnessFactor!==void 0&&o.setClearcoatRoughnessFactor(c.clearcoatRoughnessFactor),c.clearcoatTexture!==void 0){const l=c.clearcoatTexture,h=e.textures[r[l.index].source];o.setClearcoatTexture(h),e.setTextureInfo(o.getClearcoatTextureInfo(),l)}if(c.clearcoatRoughnessTexture!==void 0){const l=c.clearcoatRoughnessTexture,h=e.textures[r[l.index].source];o.setClearcoatRoughnessTexture(h),e.setTextureInfo(o.getClearcoatRoughnessTextureInfo(),l)}if(c.clearcoatNormalTexture!==void 0){const l=c.clearcoatNormalTexture,h=e.textures[r[l.index].source];o.setClearcoatNormalTexture(h),e.setTextureInfo(o.getClearcoatNormalTextureInfo(),l),l.scale!==void 0&&o.setClearcoatNormalScale(l.scale)}}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(i=>{const r=i.getExtension(Kt);if(r){const s=e.materialIndexMap.get(i),n=t.json.materials[s];n.extensions=n.extensions||{};const o=n.extensions[Kt]={clearcoatFactor:r.getClearcoatFactor(),clearcoatRoughnessFactor:r.getClearcoatRoughnessFactor()};if(r.getClearcoatTexture()){const c=r.getClearcoatTexture(),l=r.getClearcoatTextureInfo();o.clearcoatTexture=e.createTextureInfoDef(c,l)}if(r.getClearcoatRoughnessTexture()){const c=r.getClearcoatRoughnessTexture(),l=r.getClearcoatRoughnessTextureInfo();o.clearcoatRoughnessTexture=e.createTextureInfoDef(c,l)}if(r.getClearcoatNormalTexture()){const c=r.getClearcoatNormalTexture(),l=r.getClearcoatNormalTextureInfo();o.clearcoatNormalTexture=e.createTextureInfoDef(c,l),r.getClearcoatNormalScale()!==1&&(o.clearcoatNormalTexture.scale=r.getClearcoatNormalScale())}}}),this}}xd.EXTENSION_NAME=Kt;const{R:pg,G:mg,B:gg,A:Ag}=_t;class wd extends ze{init(){this.extensionName=Ht,this.propertyType="DiffuseTransmission",this.parentTypes=[X.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{diffuseTransmissionFactor:0,diffuseTransmissionTexture:null,diffuseTransmissionTextureInfo:new Se(this.graph,"diffuseTransmissionTextureInfo"),diffuseTransmissionColorFactor:[1,1,1],diffuseTransmissionColorTexture:null,diffuseTransmissionColorTextureInfo:new Se(this.graph,"diffuseTransmissionColorTextureInfo")})}getDiffuseTransmissionFactor(){return this.get("diffuseTransmissionFactor")}setDiffuseTransmissionFactor(e){return this.set("diffuseTransmissionFactor",e)}getDiffuseTransmissionTexture(){return this.getRef("diffuseTransmissionTexture")}getDiffuseTransmissionTextureInfo(){return this.getRef("diffuseTransmissionTexture")?this.getRef("diffuseTransmissionTextureInfo"):null}setDiffuseTransmissionTexture(e){return this.setRef("diffuseTransmissionTexture",e,{channels:Ag})}getDiffuseTransmissionColorFactor(){return this.get("diffuseTransmissionColorFactor")}setDiffuseTransmissionColorFactor(e){return this.set("diffuseTransmissionColorFactor",e)}getDiffuseTransmissionColorTexture(){return this.getRef("diffuseTransmissionColorTexture")}getDiffuseTransmissionColorTextureInfo(){return this.getRef("diffuseTransmissionColorTexture")?this.getRef("diffuseTransmissionColorTextureInfo"):null}setDiffuseTransmissionColorTexture(e){return this.setRef("diffuseTransmissionColorTexture",e,{channels:pg|mg|gg})}}wd.EXTENSION_NAME=Ht;class vd extends Ue{constructor(...e){super(...e),this.extensionName=Ht}createDiffuseTransmission(){return new wd(this.document.getGraph())}read(e){const t=e.jsonDoc,i=t.json.materials||[],r=t.json.textures||[];return i.forEach((s,n)=>{if(s.extensions&&s.extensions[Ht]){const o=this.createDiffuseTransmission();e.materials[n].setExtension(Ht,o);const c=s.extensions[Ht];if(c.diffuseTransmissionFactor!==void 0&&o.setDiffuseTransmissionFactor(c.diffuseTransmissionFactor),c.diffuseTransmissionColorFactor!==void 0&&o.setDiffuseTransmissionColorFactor(c.diffuseTransmissionColorFactor),c.diffuseTransmissionTexture!==void 0){const l=c.diffuseTransmissionTexture,h=e.textures[r[l.index].source];o.setDiffuseTransmissionTexture(h),e.setTextureInfo(o.getDiffuseTransmissionTextureInfo(),l)}if(c.diffuseTransmissionColorTexture!==void 0){const l=c.diffuseTransmissionColorTexture,h=e.textures[r[l.index].source];o.setDiffuseTransmissionColorTexture(h),e.setTextureInfo(o.getDiffuseTransmissionColorTextureInfo(),l)}}}),this}write(e){const t=e.jsonDoc;for(const i of this.document.getRoot().listMaterials()){const r=i.getExtension(Ht);if(!r)continue;const s=e.materialIndexMap.get(i),n=t.json.materials[s];n.extensions=n.extensions||{};const o=n.extensions[Ht]={diffuseTransmissionFactor:r.getDiffuseTransmissionFactor(),diffuseTransmissionColorFactor:r.getDiffuseTransmissionColorFactor()};if(r.getDiffuseTransmissionTexture()){const c=r.getDiffuseTransmissionTexture(),l=r.getDiffuseTransmissionTextureInfo();o.diffuseTransmissionTexture=e.createTextureInfoDef(c,l)}if(r.getDiffuseTransmissionColorTexture()){const c=r.getDiffuseTransmissionColorTexture(),l=r.getDiffuseTransmissionColorTextureInfo();o.diffuseTransmissionColorTexture=e.createTextureInfoDef(c,l)}}return this}}vd.EXTENSION_NAME=Ht;class Ed extends ze{init(){this.extensionName=qt,this.propertyType="Dispersion",this.parentTypes=[X.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{dispersion:0})}getDispersion(){return this.get("dispersion")}setDispersion(e){return this.set("dispersion",e)}}Ed.EXTENSION_NAME=qt;class Td extends Ue{constructor(...e){super(...e),this.extensionName=qt,this.prereadTypes=[X.MESH],this.prewriteTypes=[X.MESH]}createDispersion(){return new Ed(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){return(e.jsonDoc.json.materials||[]).forEach((r,s)=>{if(r.extensions&&r.extensions[qt]){const n=this.createDispersion();e.materials[s].setExtension(qt,n);const o=r.extensions[qt];o.dispersion!==void 0&&n.setDispersion(o.dispersion)}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(i=>{const r=i.getExtension(qt);if(r){const s=e.materialIndexMap.get(i),n=t.json.materials[s];n.extensions=n.extensions||{},n.extensions[qt]={dispersion:r.getDispersion()}}}),this}}Td.EXTENSION_NAME=qt;class Id extends ze{init(){this.extensionName=Wt,this.propertyType="EmissiveStrength",this.parentTypes=[X.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{emissiveStrength:1})}getEmissiveStrength(){return this.get("emissiveStrength")}setEmissiveStrength(e){return this.set("emissiveStrength",e)}}Id.EXTENSION_NAME=Wt;class Md extends Ue{constructor(...e){super(...e),this.extensionName=Wt,this.prereadTypes=[X.MESH],this.prewriteTypes=[X.MESH]}createEmissiveStrength(){return new Id(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){return(e.jsonDoc.json.materials||[]).forEach((r,s)=>{if(r.extensions&&r.extensions[Wt]){const n=this.createEmissiveStrength();e.materials[s].setExtension(Wt,n);const o=r.extensions[Wt];o.emissiveStrength!==void 0&&n.setEmissiveStrength(o.emissiveStrength)}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(i=>{const r=i.getExtension(Wt);if(r){const s=e.materialIndexMap.get(i),n=t.json.materials[s];n.extensions=n.extensions||{},n.extensions[Wt]={emissiveStrength:r.getEmissiveStrength()}}}),this}}Md.EXTENSION_NAME=Wt;class Cd extends ze{init(){this.extensionName=Yt,this.propertyType="IOR",this.parentTypes=[X.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{ior:1.5})}getIOR(){return this.get("ior")}setIOR(e){return this.set("ior",e)}}Cd.EXTENSION_NAME=Yt;class Dd extends Ue{constructor(...e){super(...e),this.extensionName=Yt,this.prereadTypes=[X.MESH],this.prewriteTypes=[X.MESH]}createIOR(){return new Cd(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){return(e.jsonDoc.json.materials||[]).forEach((r,s)=>{if(r.extensions&&r.extensions[Yt]){const n=this.createIOR();e.materials[s].setExtension(Yt,n);const o=r.extensions[Yt];o.ior!==void 0&&n.setIOR(o.ior)}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(i=>{const r=i.getExtension(Yt);if(r){const s=e.materialIndexMap.get(i),n=t.json.materials[s];n.extensions=n.extensions||{},n.extensions[Yt]={ior:r.getIOR()}}}),this}}Dd.EXTENSION_NAME=Yt;const{R:yg,G:xg}=_t;class _d extends ze{init(){this.extensionName=Xt,this.propertyType="Iridescence",this.parentTypes=[X.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{iridescenceFactor:0,iridescenceTexture:null,iridescenceTextureInfo:new Se(this.graph,"iridescenceTextureInfo"),iridescenceIOR:1.3,iridescenceThicknessMinimum:100,iridescenceThicknessMaximum:400,iridescenceThicknessTexture:null,iridescenceThicknessTextureInfo:new Se(this.graph,"iridescenceThicknessTextureInfo")})}getIridescenceFactor(){return this.get("iridescenceFactor")}setIridescenceFactor(e){return this.set("iridescenceFactor",e)}getIridescenceTexture(){return this.getRef("iridescenceTexture")}getIridescenceTextureInfo(){return this.getRef("iridescenceTexture")?this.getRef("iridescenceTextureInfo"):null}setIridescenceTexture(e){return this.setRef("iridescenceTexture",e,{channels:yg})}getIridescenceIOR(){return this.get("iridescenceIOR")}setIridescenceIOR(e){return this.set("iridescenceIOR",e)}getIridescenceThicknessMinimum(){return this.get("iridescenceThicknessMinimum")}setIridescenceThicknessMinimum(e){return this.set("iridescenceThicknessMinimum",e)}getIridescenceThicknessMaximum(){return this.get("iridescenceThicknessMaximum")}setIridescenceThicknessMaximum(e){return this.set("iridescenceThicknessMaximum",e)}getIridescenceThicknessTexture(){return this.getRef("iridescenceThicknessTexture")}getIridescenceThicknessTextureInfo(){return this.getRef("iridescenceThicknessTexture")?this.getRef("iridescenceThicknessTextureInfo"):null}setIridescenceThicknessTexture(e){return this.setRef("iridescenceThicknessTexture",e,{channels:xg})}}_d.EXTENSION_NAME=Xt;class Sd extends Ue{constructor(...e){super(...e),this.extensionName=Xt,this.prereadTypes=[X.MESH],this.prewriteTypes=[X.MESH]}createIridescence(){return new _d(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){const t=e.jsonDoc,i=t.json.materials||[],r=t.json.textures||[];return i.forEach((s,n)=>{if(s.extensions&&s.extensions[Xt]){const o=this.createIridescence();e.materials[n].setExtension(Xt,o);const c=s.extensions[Xt];if(c.iridescenceFactor!==void 0&&o.setIridescenceFactor(c.iridescenceFactor),c.iridescenceIor!==void 0&&o.setIridescenceIOR(c.iridescenceIor),c.iridescenceThicknessMinimum!==void 0&&o.setIridescenceThicknessMinimum(c.iridescenceThicknessMinimum),c.iridescenceThicknessMaximum!==void 0&&o.setIridescenceThicknessMaximum(c.iridescenceThicknessMaximum),c.iridescenceTexture!==void 0){const l=c.iridescenceTexture,h=e.textures[r[l.index].source];o.setIridescenceTexture(h),e.setTextureInfo(o.getIridescenceTextureInfo(),l)}if(c.iridescenceThicknessTexture!==void 0){const l=c.iridescenceThicknessTexture,h=e.textures[r[l.index].source];o.setIridescenceThicknessTexture(h),e.setTextureInfo(o.getIridescenceThicknessTextureInfo(),l)}}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(i=>{const r=i.getExtension(Xt);if(r){const s=e.materialIndexMap.get(i),n=t.json.materials[s];n.extensions=n.extensions||{};const o=n.extensions[Xt]={};if(r.getIridescenceFactor()>0&&(o.iridescenceFactor=r.getIridescenceFactor()),r.getIridescenceIOR()!==1.3&&(o.iridescenceIor=r.getIridescenceIOR()),r.getIridescenceThicknessMinimum()!==100&&(o.iridescenceThicknessMinimum=r.getIridescenceThicknessMinimum()),r.getIridescenceThicknessMaximum()!==400&&(o.iridescenceThicknessMaximum=r.getIridescenceThicknessMaximum()),r.getIridescenceTexture()){const c=r.getIridescenceTexture(),l=r.getIridescenceTextureInfo();o.iridescenceTexture=e.createTextureInfoDef(c,l)}if(r.getIridescenceThicknessTexture()){const c=r.getIridescenceThicknessTexture(),l=r.getIridescenceThicknessTextureInfo();o.iridescenceThicknessTexture=e.createTextureInfoDef(c,l)}}}),this}}Sd.EXTENSION_NAME=Xt;const{R:ql,G:Wl,B:Yl,A:Xl}=_t;class Fd extends ze{init(){this.extensionName=Qt,this.propertyType="PBRSpecularGlossiness",this.parentTypes=[X.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{diffuseFactor:[1,1,1,1],diffuseTexture:null,diffuseTextureInfo:new Se(this.graph,"diffuseTextureInfo"),specularFactor:[1,1,1],glossinessFactor:1,specularGlossinessTexture:null,specularGlossinessTextureInfo:new Se(this.graph,"specularGlossinessTextureInfo")})}getDiffuseFactor(){return this.get("diffuseFactor")}setDiffuseFactor(e){return this.set("diffuseFactor",e)}getDiffuseTexture(){return this.getRef("diffuseTexture")}getDiffuseTextureInfo(){return this.getRef("diffuseTexture")?this.getRef("diffuseTextureInfo"):null}setDiffuseTexture(e){return this.setRef("diffuseTexture",e,{channels:ql|Wl|Yl|Xl,isColor:!0})}getSpecularFactor(){return this.get("specularFactor")}setSpecularFactor(e){return this.set("specularFactor",e)}getGlossinessFactor(){return this.get("glossinessFactor")}setGlossinessFactor(e){return this.set("glossinessFactor",e)}getSpecularGlossinessTexture(){return this.getRef("specularGlossinessTexture")}getSpecularGlossinessTextureInfo(){return this.getRef("specularGlossinessTexture")?this.getRef("specularGlossinessTextureInfo"):null}setSpecularGlossinessTexture(e){return this.setRef("specularGlossinessTexture",e,{channels:ql|Wl|Yl|Xl})}}Fd.EXTENSION_NAME=Qt;class Rd extends Ue{constructor(...e){super(...e),this.extensionName=Qt,this.prereadTypes=[X.MESH],this.prewriteTypes=[X.MESH]}createPBRSpecularGlossiness(){return new Fd(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){const t=e.jsonDoc,i=t.json.materials||[],r=t.json.textures||[];return i.forEach((s,n)=>{if(s.extensions&&s.extensions[Qt]){const o=this.createPBRSpecularGlossiness();e.materials[n].setExtension(Qt,o);const c=s.extensions[Qt];if(c.diffuseFactor!==void 0&&o.setDiffuseFactor(c.diffuseFactor),c.specularFactor!==void 0&&o.setSpecularFactor(c.specularFactor),c.glossinessFactor!==void 0&&o.setGlossinessFactor(c.glossinessFactor),c.diffuseTexture!==void 0){const l=c.diffuseTexture,h=e.textures[r[l.index].source];o.setDiffuseTexture(h),e.setTextureInfo(o.getDiffuseTextureInfo(),l)}if(c.specularGlossinessTexture!==void 0){const l=c.specularGlossinessTexture,h=e.textures[r[l.index].source];o.setSpecularGlossinessTexture(h),e.setTextureInfo(o.getSpecularGlossinessTextureInfo(),l)}}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(i=>{const r=i.getExtension(Qt);if(r){const s=e.materialIndexMap.get(i),n=t.json.materials[s];n.extensions=n.extensions||{};const o=n.extensions[Qt]={diffuseFactor:r.getDiffuseFactor(),specularFactor:r.getSpecularFactor(),glossinessFactor:r.getGlossinessFactor()};if(r.getDiffuseTexture()){const c=r.getDiffuseTexture(),l=r.getDiffuseTextureInfo();o.diffuseTexture=e.createTextureInfoDef(c,l)}if(r.getSpecularGlossinessTexture()){const c=r.getSpecularGlossinessTexture(),l=r.getSpecularGlossinessTextureInfo();o.specularGlossinessTexture=e.createTextureInfoDef(c,l)}}}),this}}Rd.EXTENSION_NAME=Qt;const{R:wg,G:vg,B:Eg,A:Tg}=_t;class Nd extends ze{init(){this.extensionName=Jt,this.propertyType="Sheen",this.parentTypes=[X.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{sheenColorFactor:[0,0,0],sheenColorTexture:null,sheenColorTextureInfo:new Se(this.graph,"sheenColorTextureInfo"),sheenRoughnessFactor:0,sheenRoughnessTexture:null,sheenRoughnessTextureInfo:new Se(this.graph,"sheenRoughnessTextureInfo")})}getSheenColorFactor(){return this.get("sheenColorFactor")}setSheenColorFactor(e){return this.set("sheenColorFactor",e)}getSheenColorTexture(){return this.getRef("sheenColorTexture")}getSheenColorTextureInfo(){return this.getRef("sheenColorTexture")?this.getRef("sheenColorTextureInfo"):null}setSheenColorTexture(e){return this.setRef("sheenColorTexture",e,{channels:wg|vg|Eg,isColor:!0})}getSheenRoughnessFactor(){return this.get("sheenRoughnessFactor")}setSheenRoughnessFactor(e){return this.set("sheenRoughnessFactor",e)}getSheenRoughnessTexture(){return this.getRef("sheenRoughnessTexture")}getSheenRoughnessTextureInfo(){return this.getRef("sheenRoughnessTexture")?this.getRef("sheenRoughnessTextureInfo"):null}setSheenRoughnessTexture(e){return this.setRef("sheenRoughnessTexture",e,{channels:Tg})}}Nd.EXTENSION_NAME=Jt;class kd extends Ue{constructor(...e){super(...e),this.extensionName=Jt,this.prereadTypes=[X.MESH],this.prewriteTypes=[X.MESH]}createSheen(){return new Nd(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){const t=e.jsonDoc,i=t.json.materials||[],r=t.json.textures||[];return i.forEach((s,n)=>{if(s.extensions&&s.extensions[Jt]){const o=this.createSheen();e.materials[n].setExtension(Jt,o);const c=s.extensions[Jt];if(c.sheenColorFactor!==void 0&&o.setSheenColorFactor(c.sheenColorFactor),c.sheenRoughnessFactor!==void 0&&o.setSheenRoughnessFactor(c.sheenRoughnessFactor),c.sheenColorTexture!==void 0){const l=c.sheenColorTexture,h=e.textures[r[l.index].source];o.setSheenColorTexture(h),e.setTextureInfo(o.getSheenColorTextureInfo(),l)}if(c.sheenRoughnessTexture!==void 0){const l=c.sheenRoughnessTexture,h=e.textures[r[l.index].source];o.setSheenRoughnessTexture(h),e.setTextureInfo(o.getSheenRoughnessTextureInfo(),l)}}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(i=>{const r=i.getExtension(Jt);if(r){const s=e.materialIndexMap.get(i),n=t.json.materials[s];n.extensions=n.extensions||{};const o=n.extensions[Jt]={sheenColorFactor:r.getSheenColorFactor(),sheenRoughnessFactor:r.getSheenRoughnessFactor()};if(r.getSheenColorTexture()){const c=r.getSheenColorTexture(),l=r.getSheenColorTextureInfo();o.sheenColorTexture=e.createTextureInfoDef(c,l)}if(r.getSheenRoughnessTexture()){const c=r.getSheenRoughnessTexture(),l=r.getSheenRoughnessTextureInfo();o.sheenRoughnessTexture=e.createTextureInfoDef(c,l)}}}),this}}kd.EXTENSION_NAME=Jt;const{R:Ig,G:Mg,B:Cg,A:Dg}=_t;class Ud extends ze{init(){this.extensionName=Zt,this.propertyType="Specular",this.parentTypes=[X.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{specularFactor:1,specularTexture:null,specularTextureInfo:new Se(this.graph,"specularTextureInfo"),specularColorFactor:[1,1,1],specularColorTexture:null,specularColorTextureInfo:new Se(this.graph,"specularColorTextureInfo")})}getSpecularFactor(){return this.get("specularFactor")}setSpecularFactor(e){return this.set("specularFactor",e)}getSpecularColorFactor(){return this.get("specularColorFactor")}setSpecularColorFactor(e){return this.set("specularColorFactor",e)}getSpecularTexture(){return this.getRef("specularTexture")}getSpecularTextureInfo(){return this.getRef("specularTexture")?this.getRef("specularTextureInfo"):null}setSpecularTexture(e){return this.setRef("specularTexture",e,{channels:Dg})}getSpecularColorTexture(){return this.getRef("specularColorTexture")}getSpecularColorTextureInfo(){return this.getRef("specularColorTexture")?this.getRef("specularColorTextureInfo"):null}setSpecularColorTexture(e){return this.setRef("specularColorTexture",e,{channels:Ig|Mg|Cg,isColor:!0})}}Ud.EXTENSION_NAME=Zt;class jd extends Ue{constructor(...e){super(...e),this.extensionName=Zt,this.prereadTypes=[X.MESH],this.prewriteTypes=[X.MESH]}createSpecular(){return new Ud(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){const t=e.jsonDoc,i=t.json.materials||[],r=t.json.textures||[];return i.forEach((s,n)=>{if(s.extensions&&s.extensions[Zt]){const o=this.createSpecular();e.materials[n].setExtension(Zt,o);const c=s.extensions[Zt];if(c.specularFactor!==void 0&&o.setSpecularFactor(c.specularFactor),c.specularColorFactor!==void 0&&o.setSpecularColorFactor(c.specularColorFactor),c.specularTexture!==void 0){const l=c.specularTexture,h=e.textures[r[l.index].source];o.setSpecularTexture(h),e.setTextureInfo(o.getSpecularTextureInfo(),l)}if(c.specularColorTexture!==void 0){const l=c.specularColorTexture,h=e.textures[r[l.index].source];o.setSpecularColorTexture(h),e.setTextureInfo(o.getSpecularColorTextureInfo(),l)}}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(i=>{const r=i.getExtension(Zt);if(r){const s=e.materialIndexMap.get(i),n=t.json.materials[s];n.extensions=n.extensions||{};const o=n.extensions[Zt]={};if(r.getSpecularFactor()!==1&&(o.specularFactor=r.getSpecularFactor()),De.eq(r.getSpecularColorFactor(),[1,1,1])||(o.specularColorFactor=r.getSpecularColorFactor()),r.getSpecularTexture()){const c=r.getSpecularTexture(),l=r.getSpecularTextureInfo();o.specularTexture=e.createTextureInfoDef(c,l)}if(r.getSpecularColorTexture()){const c=r.getSpecularColorTexture(),l=r.getSpecularColorTextureInfo();o.specularColorTexture=e.createTextureInfoDef(c,l)}}}),this}}jd.EXTENSION_NAME=Zt;const{R:_g}=_t;class Bd extends ze{init(){this.extensionName=$t,this.propertyType="Transmission",this.parentTypes=[X.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{transmissionFactor:0,transmissionTexture:null,transmissionTextureInfo:new Se(this.graph,"transmissionTextureInfo")})}getTransmissionFactor(){return this.get("transmissionFactor")}setTransmissionFactor(e){return this.set("transmissionFactor",e)}getTransmissionTexture(){return this.getRef("transmissionTexture")}getTransmissionTextureInfo(){return this.getRef("transmissionTexture")?this.getRef("transmissionTextureInfo"):null}setTransmissionTexture(e){return this.setRef("transmissionTexture",e,{channels:_g})}}Bd.EXTENSION_NAME=$t;class Pd extends Ue{constructor(...e){super(...e),this.extensionName=$t,this.prereadTypes=[X.MESH],this.prewriteTypes=[X.MESH]}createTransmission(){return new Bd(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){const t=e.jsonDoc,i=t.json.materials||[],r=t.json.textures||[];return i.forEach((s,n)=>{if(s.extensions&&s.extensions[$t]){const o=this.createTransmission();e.materials[n].setExtension($t,o);const c=s.extensions[$t];if(c.transmissionFactor!==void 0&&o.setTransmissionFactor(c.transmissionFactor),c.transmissionTexture!==void 0){const l=c.transmissionTexture,h=e.textures[r[l.index].source];o.setTransmissionTexture(h),e.setTextureInfo(o.getTransmissionTextureInfo(),l)}}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(i=>{const r=i.getExtension($t);if(r){const s=e.materialIndexMap.get(i),n=t.json.materials[s];n.extensions=n.extensions||{};const o=n.extensions[$t]={transmissionFactor:r.getTransmissionFactor()};if(r.getTransmissionTexture()){const c=r.getTransmissionTexture(),l=r.getTransmissionTextureInfo();o.transmissionTexture=e.createTextureInfoDef(c,l)}}}),this}}Pd.EXTENSION_NAME=$t;class Od extends ze{init(){this.extensionName=ua,this.propertyType="Unlit",this.parentTypes=[X.MATERIAL]}}Od.EXTENSION_NAME=ua;class Vd extends Ue{constructor(...e){super(...e),this.extensionName=ua,this.prereadTypes=[X.MESH],this.prewriteTypes=[X.MESH]}createUnlit(){return new Od(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){return(e.jsonDoc.json.materials||[]).forEach((i,r)=>{i.extensions&&i.extensions[ua]&&e.materials[r].setExtension(ua,this.createUnlit())}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(i=>{if(i.getExtension(ua)){const r=e.materialIndexMap.get(i),s=t.json.materials[r];s.extensions=s.extensions||{},s.extensions[ua]={}}}),this}}Vd.EXTENSION_NAME=ua;class Ld extends ze{init(){this.extensionName=at,this.propertyType="Mapping",this.parentTypes=["MappingList"]}getDefaults(){return Object.assign(super.getDefaults(),{material:null,variants:new Re})}getMaterial(){return this.getRef("material")}setMaterial(e){return this.setRef("material",e)}addVariant(e){return this.addRef("variants",e)}removeVariant(e){return this.removeRef("variants",e)}listVariants(){return this.listRefs("variants")}}Ld.EXTENSION_NAME=at;class Gd extends ze{init(){this.extensionName=at,this.propertyType="MappingList",this.parentTypes=[X.PRIMITIVE]}getDefaults(){return Object.assign(super.getDefaults(),{mappings:new Re})}addMapping(e){return this.addRef("mappings",e)}removeMapping(e){return this.removeRef("mappings",e)}listMappings(){return this.listRefs("mappings")}}Gd.EXTENSION_NAME=at;class Ao extends ze{init(){this.extensionName=at,this.propertyType="Variant",this.parentTypes=["MappingList"]}}Ao.EXTENSION_NAME=at;class zd extends Ue{constructor(...e){super(...e),this.extensionName=at}createMappingList(){return new Gd(this.document.getGraph())}createVariant(e=""){return new Ao(this.document.getGraph(),e)}createMapping(){return new Ld(this.document.getGraph())}listVariants(){return Array.from(this.properties).filter(e=>e instanceof Ao)}read(e){const t=e.jsonDoc;if(!t.json.extensions||!t.json.extensions[at])return this;const s=(t.json.extensions[at].variants||[]).map(o=>this.createVariant().setName(o.name||""));return(t.json.meshes||[]).forEach((o,c)=>{const l=e.meshes[c];(o.primitives||[]).forEach((d,f)=>{if(!d.extensions||!d.extensions[at])return;const u=this.createMappingList(),m=d.extensions[at];for(const p of m.mappings){const g=this.createMapping();p.material!==void 0&&g.setMaterial(e.materials[p.material]);for(const b of p.variants||[])g.addVariant(s[b]);u.addMapping(g)}l.listPrimitives()[f].setExtension(at,u)})}),this}write(e){const t=e.jsonDoc,i=this.listVariants();if(!i.length)return this;const r=[],s=new Map;for(const n of i)s.set(n,r.length),r.push(e.createPropertyDef(n));for(const n of this.document.getRoot().listMeshes()){const o=e.meshIndexMap.get(n);n.listPrimitives().forEach((c,l)=>{const h=c.getExtension(at);if(!h)return;const d=e.jsonDoc.json.meshes[o].primitives[l],f=h.listMappings().map(u=>{const m=e.createPropertyDef(u),p=u.getMaterial();return p&&(m.material=e.materialIndexMap.get(p)),m.variants=u.listVariants().map(g=>s.get(g)),m});d.extensions=d.extensions||{},d.extensions[at]={mappings:f}})}return t.json.extensions=t.json.extensions||{},t.json.extensions[at]={variants:r},this}}zd.EXTENSION_NAME=at;const{G:Sg}=_t;class Kd extends ze{init(){this.extensionName=ea,this.propertyType="Volume",this.parentTypes=[X.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{thicknessFactor:0,thicknessTexture:null,thicknessTextureInfo:new Se(this.graph,"thicknessTexture"),attenuationDistance:1/0,attenuationColor:[1,1,1]})}getThicknessFactor(){return this.get("thicknessFactor")}setThicknessFactor(e){return this.set("thicknessFactor",e)}getThicknessTexture(){return this.getRef("thicknessTexture")}getThicknessTextureInfo(){return this.getRef("thicknessTexture")?this.getRef("thicknessTextureInfo"):null}setThicknessTexture(e){return this.setRef("thicknessTexture",e,{channels:Sg})}getAttenuationDistance(){return this.get("attenuationDistance")}setAttenuationDistance(e){return this.set("attenuationDistance",e)}getAttenuationColor(){return this.get("attenuationColor")}setAttenuationColor(e){return this.set("attenuationColor",e)}}Kd.EXTENSION_NAME=ea;class Hd extends Ue{constructor(...e){super(...e),this.extensionName=ea,this.prereadTypes=[X.MESH],this.prewriteTypes=[X.MESH]}createVolume(){return new Kd(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){const t=e.jsonDoc,i=t.json.materials||[],r=t.json.textures||[];return i.forEach((s,n)=>{if(s.extensions&&s.extensions[ea]){const o=this.createVolume();e.materials[n].setExtension(ea,o);const c=s.extensions[ea];if(c.thicknessFactor!==void 0&&o.setThicknessFactor(c.thicknessFactor),c.attenuationDistance!==void 0&&o.setAttenuationDistance(c.attenuationDistance),c.attenuationColor!==void 0&&o.setAttenuationColor(c.attenuationColor),c.thicknessTexture!==void 0){const l=c.thicknessTexture,h=e.textures[r[l.index].source];o.setThicknessTexture(h),e.setTextureInfo(o.getThicknessTextureInfo(),l)}}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(i=>{const r=i.getExtension(ea);if(r){const s=e.materialIndexMap.get(i),n=t.json.materials[s];n.extensions=n.extensions||{};const o=n.extensions[ea]={};if(r.getThicknessFactor()>0&&(o.thicknessFactor=r.getThicknessFactor()),Number.isFinite(r.getAttenuationDistance())&&(o.attenuationDistance=r.getAttenuationDistance()),De.eq(r.getAttenuationColor(),[1,1,1])||(o.attenuationColor=r.getAttenuationColor()),r.getThicknessTexture()){const c=r.getThicknessTexture(),l=r.getThicknessTextureInfo();o.thicknessTexture=e.createTextureInfoDef(c,l)}}}),this}}Hd.EXTENSION_NAME=ea;class qd extends Ue{constructor(...e){super(...e),this.extensionName=od}read(e){return this}write(e){return this}}qd.EXTENSION_NAME=od;class Fg{match(e){return e[0]===171&&e[1]===75&&e[2]===84&&e[3]===88&&e[4]===32&&e[5]===50&&e[6]===48&&e[7]===187&&e[8]===13&&e[9]===10&&e[10]===26&&e[11]===10}getSize(e){const t=Yn(e);return[t.pixelWidth,t.pixelHeight]}getChannels(e){const i=Yn(e).dataFormatDescriptor[0];if(i.colorModel===Bm)return i.samples.length===2&&(i.samples[1].channelType&15)===15?4:3;if(i.colorModel===Pm)return(i.samples[0].channelType&15)===3?4:3;throw new Error(`Unexpected KTX2 colorModel, "${i.colorModel}".`)}getVRAMByteLength(e){const t=Yn(e),i=this.getChannels(e)>3;let r=0;for(let s=0;s<t.levels.length;s++){const n=t.levels[s];if(n.uncompressedByteLength)r+=n.uncompressedByteLength;else{const o=Math.max(1,Math.floor(t.pixelWidth/Math.pow(2,s))),c=Math.max(1,Math.floor(t.pixelHeight/Math.pow(2,s))),l=i?16:8;r+=o/4*(c/4)*l}}return r}}class Wd extends Ue{constructor(...e){super(...e),this.extensionName=ss,this.prereadTypes=[X.TEXTURE]}static register(){Ot.registerFormat("image/ktx2",new Fg)}preread(e){return e.jsonDoc.json.textures.forEach(t=>{if(t.extensions&&t.extensions[ss]){const i=t.extensions[ss];t.source=i.source}}),this}read(e){return this}write(e){const t=e.jsonDoc;return this.document.getRoot().listTextures().forEach(i=>{if(i.getMimeType()==="image/ktx2"){const r=e.imageIndexMap.get(i);t.json.textures.forEach(s=>{s.source===r&&(s.extensions=s.extensions||{},s.extensions[ss]={source:s.source},delete s.source)})}}),this}}Wd.EXTENSION_NAME=ss;class Yd extends ze{init(){this.extensionName=ta,this.propertyType="Transform",this.parentTypes=[X.TEXTURE_INFO]}getDefaults(){return Object.assign(super.getDefaults(),{offset:[0,0],rotation:0,scale:[1,1],texCoord:null})}getOffset(){return this.get("offset")}setOffset(e){return this.set("offset",e)}getRotation(){return this.get("rotation")}setRotation(e){return this.set("rotation",e)}getScale(){return this.get("scale")}setScale(e){return this.set("scale",e)}getTexCoord(){return this.get("texCoord")}setTexCoord(e){return this.set("texCoord",e)}}Yd.EXTENSION_NAME=ta;class Xd extends Ue{constructor(...e){super(...e),this.extensionName=ta}createTransform(){return new Yd(this.document.getGraph())}read(e){for(const[t,i]of Array.from(e.textureInfos.entries())){if(!i.extensions||!i.extensions[ta])continue;const r=this.createTransform(),s=i.extensions[ta];s.offset!==void 0&&r.setOffset(s.offset),s.rotation!==void 0&&r.setRotation(s.rotation),s.scale!==void 0&&r.setScale(s.scale),s.texCoord!==void 0&&r.setTexCoord(s.texCoord),t.setExtension(ta,r)}return this}write(e){const t=Array.from(e.textureInfoDefMap.entries());for(const[i,r]of t){const s=i.getExtension(ta);if(!s)continue;r.extensions=r.extensions||{};const n={},o=De.eq;o(s.getOffset(),[0,0])||(n.offset=s.getOffset()),s.getRotation()!==0&&(n.rotation=s.getRotation()),o(s.getScale(),[1,1])||(n.scale=s.getScale()),s.getTexCoord()!=null&&(n.texCoord=s.getTexCoord()),r.extensions[ta]=n}return this}}Xd.EXTENSION_NAME=ta;const Rg=[X.ROOT,X.SCENE,X.NODE,X.MESH,X.MATERIAL,X.TEXTURE,X.ANIMATION];class Qd extends ze{init(){this.extensionName=Tt,this.propertyType="Packet",this.parentTypes=Rg}getDefaults(){return Object.assign(super.getDefaults(),{context:{},properties:{}})}getContext(){return this.get("context")}setContext(e){return this.set("context",ra({},e))}listProperties(){return Object.keys(this.get("properties"))}getProperty(e){const t=this.get("properties");return e in t?t[e]:null}setProperty(e,t){this._assertContext(e);const i=ra({},this.get("properties"));return t?i[e]=t:delete i[e],this.set("properties",i)}toJSONLD(){const e=Xn(this.get("context")),t=Xn(this.get("properties"));return ra({"@context":e},t)}fromJSONLD(e){e=Xn(e);const t=e["@context"];return t&&this.set("context",t),delete e["@context"],this.set("properties",e)}_assertContext(e){if(!(e.split(":")[0]in this.get("context")))throw new Error(`${Tt}: Missing context for term, "${e}".`)}}Qd.EXTENSION_NAME=Tt;function Xn(a){return JSON.parse(JSON.stringify(a))}class Jd extends Ue{constructor(...e){super(...e),this.extensionName=Tt}createPacket(){return new Qd(this.document.getGraph())}listPackets(){return Array.from(this.properties)}read(e){var t;const i=(t=e.jsonDoc.json.extensions)==null?void 0:t[Tt];if(!i||!i.packets)return this;const r=e.jsonDoc.json,s=this.document.getRoot(),n=i.packets.map(l=>this.createPacket().fromJSONLD(l)),o=[[r.asset],r.scenes,r.nodes,r.meshes,r.materials,r.images,r.animations],c=[[s],s.listScenes(),s.listNodes(),s.listMeshes(),s.listMaterials(),s.listTextures(),s.listAnimations()];for(let l=0;l<o.length;l++){const h=o[l]||[];for(let d=0;d<h.length;d++){const f=h[d];if(f.extensions&&f.extensions[Tt]){const u=f.extensions[Tt];c[l][d].setExtension(Tt,n[u.packet])}}}return this}write(e){const{json:t}=e.jsonDoc,i=[];for(const r of this.properties){i.push(r.toJSONLD());for(const s of r.listParents()){let n;switch(s.propertyType){case X.ROOT:n=t.asset;break;case X.SCENE:n=t.scenes[e.sceneIndexMap.get(s)];break;case X.NODE:n=t.nodes[e.nodeIndexMap.get(s)];break;case X.MESH:n=t.meshes[e.meshIndexMap.get(s)];break;case X.MATERIAL:n=t.materials[e.materialIndexMap.get(s)];break;case X.TEXTURE:n=t.images[e.imageIndexMap.get(s)];break;case X.ANIMATION:n=t.animations[e.animationIndexMap.get(s)];break;default:n=null,this.document.getLogger().warn(`[${Tt}]: Unsupported parent property, "${s.propertyType}"`);break}n&&(n.extensions=n.extensions||{},n.extensions[Tt]={packet:i.length-1})}}return i.length>0&&(t.extensions=t.extensions||{},t.extensions[Tt]={packets:i}),this}}Jd.EXTENSION_NAME=Tt;const Ng=[zo,md,Ad,xd,vd,Td,Md,Dd,Sd,Rd,jd,kd,Pd,Vd,zd,Hd,qd,Wd,Xd,Jd],Ql=[ld,Go,dd,fd,...Ng];(function(){var a="b9H79Tebbbe9ok9Geueu9Geub9Gbb9Gruuuuuuueu9Gvuuuuueu9Gduueu9Gluuuueu9Gvuuuuub9Gouuuuuub9Gluuuub9GiuuueuiE8AdilveoveovrrwrrrDDoDrbqqbelve9Weiiviebeoweuec;G:Qdkr:PlCo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8F9TW79O9V9Wt9FW9U9J9V9KW9wWVtW949c919M9MWV9mW4W2be8A9TW79O9V9Wt9FW9U9J9V9KW9wWVtW949c919M9MWVbd8F9TW79O9V9Wt9FW9U9J9V9KW9wWVtW949c919M9MWV9c9V919U9KbiE9TW79O9V9Wt9FW9U9J9V9KW9wWVtW949wWV79P9V9UblY9TW79O9V9Wt9FW9U9J9V9KW69U9KW949c919M9MWVbv8E9TW79O9V9Wt9FW9U9J9V9KW69U9KW949c919M9MWV9c9V919U9Kbo8A9TW79O9V9Wt9FW9U9J9V9KW69U9KW949wWV79P9V9UbrE9TW79O9V9Wt9FW9U9J9V9KW69U9KW949tWG91W9U9JWbwa9TW79O9V9Wt9FW9U9J9V9KW69U9KW949tWG91W9U9JW9c9V919U9KbDL9TW79O9V9Wt9FW9U9J9V9KWS9P2tWV9p9JtbqK9TW79O9V9Wt9FW9U9J9V9KWS9P2tWV9r919HtbkL9TW79O9V9Wt9FW9U9J9V9KWS9P2tWVT949WbxY9TW79O9V9Wt9FW9U9J9V9KWS9P2tWVJ9V29VVbmE9TW79O9V9Wt9F9V9Wt9P9T9P96W9wWVtW94J9H9J9OWbza9TW79O9V9Wt9F9V9Wt9P9T9P96W9wWVtW94J9H9J9OW9ttV9P9WbHa9TW79O9V9Wt9F9V9Wt9P9T9P96W9wWVtW94SWt9J9O9sW9T9H9WbOK9TW79O9V9Wt9F79W9Ht9P9H29t9VVt9sW9T9H9WbAl79IV9RbXDwebcekdKYq;i28Adbk:Bhdhud9:8Jjjjjbc;qw9Rgr8KjjjjbcbhwdnaeTmbabcbyd;C:kjjbaoaocb9iEgDc:GeV86bbarc;adfcbcjdz:xjjjb8AdnaiTmbarc;adfadalz:wjjjb8Akarc;abfalfcbcbcjdal9RalcFe0Ez:xjjjb8Aarc;abfarc;adfalz:wjjjb8AarcUf9cb83ibarc8Wf9cb83ibarcyf9cb83ibarcaf9cb83ibarcKf9cb83ibarczf9cb83ibar9cb83iwar9cb83ibcj;abal9Uc;WFbGcjdalca0Ehqdnaicd6mbavcd9imbaDTmbadcefhkaqci2gxal2hmarc;alfclfhParc;qlfceVhsarc;qofclVhzarc;qofcKfhHarc;qofczfhOcbhAincdhCcbhodnavci6mbaH9cb83ibaO9cb83ibar9cb83i;yoar9cb83i;qoadaAfgoybbhXcbhQincbhwcbhLdninaoalfhKaoybbgYaX7aLVhLawcP0meaKhoaYhXawcefgwaQfai6mbkkcbhXarc;qofhwincwh8AcwhEdnaLaX93gocFeGg3cs0mbclhEa3ci0mba3cb9hcethEkdnaocw4cFeGg3cs0mbclh8Aa3ci0mba3cb9hceth8Aka8AaEfh3awydbh5cwh8AcwhEdnaocz4cFeGg8Ecs0mbclhEa8Eci0mba8Ecb9hcethEka3a5fh3dnaocFFFFb0mbclh8AaocFFF8F0mbaocFFFr0ceth8Akawa3aEfa8AfBdbawclfhwaXcefgXcw9hmbkaKhoaYhXaQczfgQai6mbkcbhocehwazhLinawaoaLydbarc;qofaocdtfydb6EhoaLclfhLawcefgwcw9hmbkcihCkcbh3arc;qlfcbcjdz:xjjjb8Aarc;alfcwfcbBdbar9cb83i;alaoclth8Fadhaaqhhakh5inarc;qlfadcba3cufgoaoa30Eal2falz:wjjjb8Aaiahaiah6Ehgdnaqaia39Ra3aqfai6EgYcsfc9WGgoaY9nmbarc;qofaYfcbaoaY9Rz:xjjjb8Akada3al2fh8Jcbh8Kina8Ka8FVcl4hQarc;alfa8Kcdtfh8LaAh8Mcbh8Nina8NaAfhwdndndndndndna8KPldebidkasa8Mc98GgLfhoa5aLfh8Aarc;qlfawc98GgLfRbbhXcwhwinaoRbbawtaXVhXaocefhoawcwfgwca9hmbkaYTmla8Ncith8Ea8JaLfhEcbhKinaERbbhLcwhoa8AhwinawRbbaotaLVhLawcefhwaocwfgoca9hmbkarc;qofaKfaLaX7aQ93a8E486bba8Aalfh8AaEalfhEaLhXaKcefgKaY9hmbxlkkaYTmia8Mc9:Ghoa8NcitcwGhEarc;qlfawceVfRbbcwtarc;qlfawc9:GfRbbVhLarc;qofhwaghXinawa5aofRbbcwtaaaofRbbVg8AaL9RgLcetaLcztcz91cs47cFFiGaE486bbaoalfhoawcefhwa8AhLa3aXcufgX9hmbxikkaYTmda8Jawfhoarc;qlfawfRbbhLarc;qofhwaghXinawaoRbbg8AaL9RgLcetaLcKtcK91cr4786bbawcefhwaoalfhoa8AhLa3aXcufgX9hmbxdkkaYTmeka8LydbhEcbhKarc;qofhoincdhLcbhwinaLaoawfRbbcb9hfhLawcefgwcz9hmbkclhXcbhwinaXaoawfRbbcd0fhXawcefgwcz9hmbkcwh8Acbhwina8AaoawfRbbcP0fh8Aawcefgwcz9hmbkaLaXaLaX6Egwa8Aawa8A6Egwczawcz6EaEfhEaoczfhoaKczfgKaY6mbka8LaEBdbka8Mcefh8Ma8Ncefg8Ncl9hmbka8Kcefg8KaC9hmbkaaamfhaahaxfhha5amfh5a3axfg3ai6mbkcbhocehwaPhLinawaoaLydbarc;alfaocdtfydb6EhoaLclfhLawcefgXhwaCaX9hmbkaraAcd4fa8FcdVaoaocdSE86bbaAclfgAal6mbkkabaefh8Kabcefhoalcd4gecbaDEhkadcefhOarc;abfceVhHcbhmdndninaiam9nmearc;qofcbcjdz:xjjjb8Aa8Kao9Rak6mdadamal2gwfhxcbh8JaOawfhzaocbakz:xjjjbghakfh5aqaiam9Ramaqfai6Egscsfgocl4cifcd4hCaoc9WGg8LThPindndndndndndndndndndnaDTmbara8Jcd4fRbbgLciGPlbedlbkasTmdaxa8Jfhoarc;abfa8JfRbbhLarc;qofhwashXinawaoRbbg8AaL9RgLcetaLcKtcK91cr4786bbawcefhwaoalfhoa8AhLaXcufgXmbxikkasTmia8JcitcwGhEarc;abfa8JceVfRbbcwtarc;abfa8Jc9:GgofRbbVhLaxaofhoarc;qofhwashXinawao8Vbbg8AaL9RgLcetaLcztcz91cs47cFFiGaE486bbawcefhwaoalfhoa8AhLaXcufgXmbxdkkaHa8Jc98GgEfhoazaEfh8Aarc;abfaEfRbbhXcwhwinaoRbbawtaXVhXaocefhoawcwfgwca9hmbkasTmbaLcl4hYa8JcitcKGh3axaEfhEcbhKinaERbbhLcwhoa8AhwinawRbbaotaLVhLawcefhwaocwfgoca9hmbkarc;qofaKfaLaX7aY93a3486bba8Aalfh8AaEalfhEaLhXaKcefgKas9hmbkkaDmbcbhoxlka8LTmbcbhodninarc;qofaofgwcwf8Pibaw8Pib:e9qTmeaoczfgoa8L9pmdxbkkdnavmbcehoxikcbhEaChKaChYinarc;qofaEfgocwf8Pibhyao8Pibh8PcdhLcbhwinaLaoawfRbbcb9hfhLawcefgwcz9hmbkclhXcbhwinaXaoawfRbbcd0fhXawcefgwcz9hmbkcwh8Acbhwina8AaoawfRbbcP0fh8Aawcefgwcz9hmbkaLaXaLaX6Egoa8Aaoa8A6Egoczaocz6EaYfhYaocucbaya8P:e9cb9sEgwaoaw6EaKfhKaEczfgEa8L9pmdxbkkaha8Jcd4fgoaoRbbcda8JcetcoGtV86bbxikdnaKas6mbaYas6mbaha8Jcd4fgoaoRbbcia8JcetcoGtV86bba8Ka59Ras6mra5arc;qofasz:wjjjbasfh5xikaKaY9phokaha8Jcd4fgwawRbbaoa8JcetcoGtV86bbka8Ka59RaC6mla5cbaCz:xjjjbgAaCfhYdndna8LmbaPhoxekdna8KaY9RcK9pmbaPhoxekaocdtc:q1jjbfcj1jjbaDEg5ydxggcetc;:FFFeGh8Fcuh3cuagtcu7cFeGhacbh8Marc;qofhLinarc;qofa8MfhQczhEdndndnagPDbeeeeeeedekcucbaQcwf8PibaQ8Pib:e9cb9sEhExekcbhoa8FhEinaEaaaLaofRbb9nfhEaocefgocz9hmbkkcih8Ecbh8Ainczhwdndndna5a8AcdtfydbgKPDbeeeeeeedekcucbaQcwf8PibaQ8Pib:e9cb9sEhwxekaKcetc;:FFFeGhwcuaKtcu7cFeGhXcbhoinawaXaLaofRbb9nfhwaocefgocz9hmbkkdndnawaE6mbaKa39hmeawaE9hmea5a8EcdtfydbcwSmeka8Ah8EawhEka8Acefg8Aci9hmbkaAa8Mco4fgoaoRbba8Ea8Mci4coGtV86bbdndndna5a8Ecdtfydbg3PDdbbbbbbbebkdncwa39Tg8ETmbcua3tcu7hwdndna3ceSmbcbh8NaLhQinaQhoa8Eh8AcbhXinaoRbbgEawcFeGgKaEaK6EaXa3tVhXaocefhoa8Acufg8AmbkaYaX86bbaQa8EfhQaYcefhYa8Na8Efg8Ncz6mbxdkkcbh8NaLhQinaQhoa8Eh8AcbhXinaoRbbgEawcFeGgKaEaK6EaXcetVhXaocefhoa8Acufg8AmbkaYaX:T9cFe:d9c:c:qj:bw9:9c:q;c1:I1e:d9c:b:c:e1z9:9ca188bbaQa8EfhQaYcefhYa8Na8Efg8Ncz6mbkkcbhoinaYaLaofRbbgX86bbaYaXawcFeG9pfhYaocefgocz9hmbxikkdna3ceSmbinaYcb86bbaYcefhYxbkkinaYcb86bbaYcefhYxbkkaYaQ8Pbb83bbaYcwfaQcwf8Pbb83bbaYczfhYka8Mczfg8Ma8L9pgomeaLczfhLa8KaY9RcK9pmbkkaoTmlaYh5aYTmlka8Jcefg8Jal9hmbkarc;abfaxascufal2falz:wjjjb8Aasamfhma5hoa5mbkcbhwxdkdna8Kao9RakalfgwcKcaaDEgLawaL0EgX9pmbcbhwxdkdnawaL9pmbaocbaXaw9Rgwz:xjjjbawfhokaoarc;adfalz:wjjjbalfhodnaDTmbaoaraez:wjjjbaefhokaoab9Rhwxekcbhwkarc;qwf8Kjjjjbawk5babaeadaialcdcbyd;C:kjjbz:bjjjbk9reduaecd4gdaefgicaaica0Eabcj;abae9Uc;WFbGcjdaeca0Egifcufai9Uae2aiadfaicl4cifcd4f2fcefkmbcbabBd;C:kjjbk:Ese5u8Jjjjjbc;ae9Rgl8Kjjjjbcbhvdnaici9UgocHfae0mbabcbyd;m:kjjbgrc;GeV86bbalc;abfcFecjez:xjjjb8AalcUfgw9cu83ibalc8WfgD9cu83ibalcyfgq9cu83ibalcafgk9cu83ibalcKfgx9cu83ibalczfgm9cu83ibal9cu83iwal9cu83ibabaefc9WfhPabcefgsaofhednaiTmbcmcsarcb9kgzEhHcbhOcbhAcbhCcbhXcbhQindnaeaP9nmbcbhvxikaQcufhvadaCcdtfgLydbhKaLcwfydbhYaLclfydbh8AcbhEdndndninalc;abfavcsGcitfgoydlh3dndndnaoydbgoaK9hmba3a8ASmekdnaoa8A9hmba3aY9hmbaEcefhExekaoaY9hmea3aK9hmeaEcdfhEkaEc870mdaXcufhvaLaEciGcx2goc;i1jjbfydbcdtfydbh3aLaoc;e1jjbfydbcdtfydbh8AaLaoc;a1jjbfydbcdtfydbhKcbhodnindnalavcsGcdtfydba39hmbaohYxdkcuhYavcufhvaocefgocz9hmbkkaOa3aOSgvaYce9iaYaH9oVgoGfhOdndndncbcsavEaYaoEgvcs9hmbarce9imba3a3aAa3cefaASgvEgAcefSmecmcsavEhvkasavaEcdtc;WeGV86bbavcs9hmea3aA9Rgvcetavc8F917hvinaeavcFb0crtavcFbGV86bbaecefheavcje6hoavcr4hvaoTmbka3hAxvkcPhvasaEcdtcPV86bba3hAkavTmiavaH9omicdhocehEaQhYxlkavcufhvaEclfgEc;ab9hmbkkdnaLceaYaOSceta8AaOSEcx2gvc;a1jjbfydbcdtfydbgKTaLavc;e1jjbfydbcdtfydbg8AceSGaLavc;i1jjbfydbcdtfydbg3cdSGaOcb9hGazGg5ce9hmbaw9cu83ibaD9cu83ibaq9cu83ibak9cu83ibax9cu83ibam9cu83ibal9cu83iwal9cu83ibcbhOkcbhEaXcufgvhodnindnalaocsGcdtfydba8A9hmbaEhYxdkcuhYaocufhoaEcefgEcz9hmbkkcbhodnindnalavcsGcdtfydba39hmbaohExdkcuhEavcufhvaocefgocz9hmbkkaOaKaOSg8EfhLdndnaYcm0mbaYcefhYxekcbcsa8AaLSgvEhYaLavfhLkdndnaEcm0mbaEcefhExekcbcsa3aLSgvEhEaLavfhLkc9:cua8EEh8FcbhvaEaYcltVgacFeGhodndndninavc:W1jjbfRbbaoSmeavcefgvcz9hmbxdkka5aKaO9havcm0VVmbasavc;WeV86bbxekasa8F86bbaeaa86bbaecefhekdna8EmbaKaA9Rgvcetavc8F917hvinaeavcFb0gocrtavcFbGV86bbavcr4hvaecefheaombkaKhAkdnaYcs9hmba8AaA9Rgvcetavc8F917hvinaeavcFb0gocrtavcFbGV86bbavcr4hvaecefheaombka8AhAkdnaEcs9hmba3aA9Rgvcetavc8F917hvinaeavcFb0gocrtavcFbGV86bbavcr4hvaecefheaombka3hAkalaXcdtfaKBdbaXcefcsGhvdndnaYPzbeeeeeeeeeeeeeebekalavcdtfa8ABdbaXcdfcsGhvkdndnaEPzbeeeeeeeeeeeeeebekalavcdtfa3BdbavcefcsGhvkcihoalc;abfaQcitfgEaKBdlaEa8ABdbaQcefcsGhYcdhEavhXaLhOxekcdhoalaXcdtfa3BdbcehEaXcefcsGhXaQhYkalc;abfaYcitfgva8ABdlava3Bdbalc;abfaQaEfcsGcitfgva3BdlavaKBdbascefhsaQaofcsGhQaCcifgCai6mbkkdnaeaP9nmbcbhvxekcbhvinaeavfavc:W1jjbfRbb86bbavcefgvcz9hmbkaeab9Ravfhvkalc;aef8KjjjjbavkZeeucbhddninadcefgdc8F0meceadtae6mbkkadcrfcFeGcr9Uci2cdfabci9U2cHfkmbcbabBd;m:kjjbk:Adewu8Jjjjjbcz9Rhlcbhvdnaicvfae0mbcbhvabcbRb;m:kjjbc;qeV86bbal9cb83iwabcefhoabaefc98fhrdnaiTmbcbhwcbhDindnaoar6mbcbskadaDcdtfydbgqalcwfawaqav9Rgvavc8F91gv7av9Rc507gwcdtfgkydb9Rgvc8E91c9:Gavcdt7awVhvinaoavcFb0gecrtavcFbGV86bbavcr4hvaocefhoaembkakaqBdbaqhvaDcefgDai9hmbkkdnaoar9nmbcbskaocbBbbaoab9RclfhvkavkBeeucbhddninadcefgdc8F0meceadtae6mbkkadcwfcFeGcr9Uab2cvfk:bvli99dui99ludnaeTmbcuadcetcuftcu7:Zhvdndncuaicuftcu7:ZgoJbbbZMgr:lJbbb9p9DTmbar:Ohwxekcjjjj94hwkcbhicbhDinalclfIdbgrJbbbbJbbjZalIdbgq:lar:lMalcwfIdbgk:lMgr:varJbbbb9BEgrNhxaqarNhrdndnakJbbbb9GTmbaxhqxekJbbjZar:l:tgqaq:maxJbbbb9GEhqJbbjZax:l:tgxax:marJbbbb9GEhrkdndnalcxfIdbgxJbbj:;axJbbj:;9GEgkJbbjZakJbbjZ9FEavNJbbbZJbbb:;axJbbbb9GEMgx:lJbbb9p9DTmbax:Ohmxekcjjjj94hmkdndnaqJbbj:;aqJbbj:;9GEgxJbbjZaxJbbjZ9FEaoNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:OhPxekcjjjj94hPkdndnarJbbj:;arJbbj:;9GEgqJbbjZaqJbbjZ9FEaoNJbbbZJbbb:;arJbbbb9GEMgr:lJbbb9p9DTmbar:Ohsxekcjjjj94hskdndnadcl9hmbabaifgzas86bbazcifam86bbazcdfaw86bbazcefaP86bbxekabaDfgzas87ebazcofam87ebazclfaw87ebazcdfaP87ebkalczfhlaiclfhiaDcwfhDaecufgembkkk;hlld99eud99eudnaeTmbdndncuaicuftcu7:ZgvJbbbZMgo:lJbbb9p9DTmbao:Ohixekcjjjj94hikaic;8FiGhrinabcofcicdalclfIdb:lalIdb:l9EgialcwfIdb:lalaicdtfIdb:l9EEgialcxfIdb:lalaicdtfIdb:l9EEgiarV87ebdndnJbbj:;JbbjZalaicdtfIdbJbbbb9DEgoalaicd7cdtfIdbJ;Zl:1ZNNgwJbbj:;awJbbj:;9GEgDJbbjZaDJbbjZ9FEavNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohqxekcjjjj94hqkabcdfaq87ebdndnalaicefciGcdtfIdbJ;Zl:1ZNaoNgwJbbj:;awJbbj:;9GEgDJbbjZaDJbbjZ9FEavNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohqxekcjjjj94hqkabaq87ebdndnaoalaicufciGcdtfIdbJ;Zl:1ZNNgoJbbj:;aoJbbj:;9GEgwJbbjZawJbbjZ9FEavNJbbbZJbbb:;aoJbbbb9GEMgo:lJbbb9p9DTmbao:Ohixekcjjjj94hikabclfai87ebabcwfhbalczfhlaecufgembkkk;3viDue99eu8Jjjjjbcjd9Rgo8Kjjjjbadcd4hrdndndndnavcd9hmbadcl6meaohwarhDinawc:CuBdbawclfhwaDcufgDmbkaeTmiadcl6mdarcdthqalhkcbhxinaohwakhDarhminawawydbgPcbaDIdbgs:8cL4cFeGc:cufasJbbbb9BEgzaPaz9kEBdbaDclfhDawclfhwamcufgmmbkakaqfhkaxcefgxaeSmixbkkaeTmdxekaeTmekarcdthkavce9hhqadcl6hdcbhxindndndnaqmbadmdc:CuhDalhwarhminaDcbawIdbgs:8cL4cFeGc:cufasJbbbb9BEgPaDaP9kEhDawclfhwamcufgmmbxdkkc:CuhDdndnavPleddbdkadmdaohwalhmarhPinawcbamIdbgs:8cL4cFeGgzc;:bazc;:b0Ec:cufasJbbbb9BEBdbamclfhmawclfhwaPcufgPmbxdkkadmecbhwarhminaoawfcbalawfIdbgs:8cL4cFeGgPc8AaPc8A0Ec:cufasJbbbb9BEBdbawclfhwamcufgmmbkkadmbcbhwarhPinaDhmdnavceSmbaoawfydbhmkdndnalawfIdbgscjjj;8iamai9RcefgmcLt9R::NJbbbZJbbb:;asJbbbb9GEMgs:lJbbb9p9DTmbas:Ohzxekcjjjj94hzkabawfazcFFFrGamcKtVBdbawclfhwaPcufgPmbkkabakfhbalakfhlaxcefgxae9hmbkkaocjdf8Kjjjjbk:Ylvdud99due99iudnaeTmbceaicufgvthocuaitcu7:Zhrcuavtcu7:Zhwcbhvadcl9hhDcbhqindndnalcwfIdbgkJbbbbakJbbbb9GEgkJbbjZakJbbjZ9FEarNJbbbZMgk:lJbbb9p9DTmbak:Ohixekcjjjj94hikdndnalIdbgkJbbbbakJbbbb9GEgkJbbjZakJbbjZ9FEarNJbbbZMgk:lJbbb9p9DTmbak:Ohdxekcjjjj94hdkadai9Rcd9TgxaifhidndnalclfIdbgkJbbbbakJbbbb9GEgkJbbjZakJbbjZ9FEarNJbbbZMgk:lJbbb9p9DTmbak:Ohdxekcjjjj94hdkadai9Rcd9ThddndnalcxfIdbgkJbbbbakJbbbb9GEgkJbbjZakJbbjZ9FEawNJbbbZMgk:lJbbb9p9DTmbak:Ohmxekcjjjj94hmkadaifhiaoamVhmdndnaDmbabavfgPai86bbaPcifam86bbaPcdfad86bbaPcefax86bbxekabaqfgPai87ebaPcofam87ebaPclfad87ebaPcdfax87ebkalczfhlavclfhvaqcwfhqaecufgembkkk;YqdXui998Jjjjjbc:qd9Rgv8Kjjjjbavc:Sefcbc;Kbz:xjjjb8AcbhodnadTmbcbhoaiTmbdndnabaeSmbaehrxekavcuadcdtgwadcFFFFi0Ecbyd;q:kjjbHjjjjbbgrBd:SeavceBd:mdaraeawz:wjjjb8Akavc:GefcwfcbBdbav9cb83i:Geavc:Gefaradaiavc:Sefz:pjjjbavyd:GehDadci9Ugqcbyd;q:kjjbHjjjjbbheavc:Sefavyd:mdgkcdtfaeBdbavakcefgwBd:mdaecbaqz:xjjjbhxavc:SefawcdtfcuaicdtaicFFFFi0Ecbyd;q:kjjbHjjjjbbgmBdbavakcdfgPBd:mdalc;ebfhsaDheamhwinawalIdbasaeydbgzcwazcw6EcdtfIdbMUdbaeclfheawclfhwaicufgimbkavc:SefaPcdtfcuaqcdtadcFFFF970Ecbyd;q:kjjbHjjjjbbgPBdbdnadci6mbarheaPhwaqhiinawamaeydbcdtfIdbamaeclfydbcdtfIdbMamaecwfydbcdtfIdbMUdbaecxfheawclfhwaicufgimbkkakcifhoalc;ebfhHavc;qbfhOavheavyd:KehAavyd:OehCcbhzcbhwcbhXcehQinaehLcihkarawci2gKcdtfgeydbhsaeclfydbhdabaXcx2fgicwfaecwfydbgYBdbaiclfadBdbaiasBdbaxawfce86bbaOaYBdwaOadBdlaOasBdbaPawcdtfcbBdbdnazTmbcihkaLhiinaOakcdtfaiydbgeBdbakaeaY9haeas9haead9hGGfhkaiclfhiazcufgzmbkkaXcefhXcbhzinaCaAarazaKfcdtfydbcdtgifydbcdtfgYheaDaifgdydbgshidnasTmbdninaeydbawSmeaeclfheaicufgiTmdxbkkaeaYascdtfc98fydbBdbadadydbcufBdbkazcefgzci9hmbkdndnakTmbcuhwJbbbbh8Acbhdavyd:KehYavyd:OehKindndnaDaOadcdtfydbcdtgzfydbgembadcefhdxekadcs0hiamazfgsIdbhEasalcbadcefgdaiEcdtfIdbaHaecwaecw6EcdtfIdbMg3Udba3aE:th3aecdthiaKaYazfydbcdtfheinaPaeydbgzcdtfgsa3asIdbMgEUdbaEa8Aa8AaE9DgsEh8AazawasEhwaeclfheaic98fgimbkkadak9hmbkawcu9hmekaQaq9pmdindnaxaQfRbbmbaQhwxdkaqaQcefgQ9hmbxikkakczakcz6EhzaOheaLhOawcu9hmbkkaocdtavc:Seffc98fhedninaoTmeaeydbcbyd;u:kjjbH:bjjjbbaec98fheaocufhoxbkkavc:qdf8Kjjjjbk;IlevucuaicdtgvaicFFFFi0Egocbyd;q:kjjbHjjjjbbhralalyd9GgwcdtfarBdbalawcefBd9GabarBdbaocbyd;q:kjjbHjjjjbbhralalyd9GgocdtfarBdbalaocefBd9GabarBdlcuadcdtadcFFFFi0Ecbyd;q:kjjbHjjjjbbhralalyd9GgocdtfarBdbalaocefBd9GabarBdwabydbcbavz:xjjjb8Aadci9UhDdnadTmbabydbhoaehladhrinaoalydbcdtfgvavydbcefBdbalclfhlarcufgrmbkkdnaiTmbabydbhlabydlhrcbhvaihoinaravBdbarclfhralydbavfhvalclfhlaocufgombkkdnadci6mbabydlhrabydwhvcbhlinaecwfydbhoaeclfydbhdaraeydbcdtfgwawydbgwcefBdbavawcdtfalBdbaradcdtfgdadydbgdcefBdbavadcdtfalBdbaraocdtfgoaoydbgocefBdbavaocdtfalBdbaecxfheaDalcefgl9hmbkkdnaiTmbabydlheabydbhlinaeaeydbalydb9RBdbalclfhlaeclfheaicufgimbkkkQbabaeadaic;K1jjbz:ojjjbkQbabaeadaic;m:jjjbz:ojjjbk9DeeuabcFeaicdtz:xjjjbhlcbhbdnadTmbindnalaeydbcdtfgiydbcu9hmbaiabBdbabcefhbkaeclfheadcufgdmbkkabk:Vvioud9:du8Jjjjjbc;Wa9Rgl8Kjjjjbcbhvalcxfcbc;Kbz:xjjjb8AalcuadcitgoadcFFFFe0Ecbyd;q:kjjbHjjjjbbgrBdxalceBd2araeadaicezNjjjbalcuaoadcjjjjoGEcbyd;q:kjjbHjjjjbbgwBdzadcdthednadTmbabhiinaiavBdbaiclfhiadavcefgv9hmbkkawaefhDalabBdwalawBdl9cbhqindnadTmbaq9cq9:hkarhvaDhiadheinaiav8Pibak1:NcFrG87ebavcwfhvaicdfhiaecufgembkkalclfaq:NceGcdtfydbhxalclfaq9ce98gq:NceGcdtfydbhmalc;Wbfcbcjaz:xjjjb8AaDhvadhidnadTmbinalc;Wbfav8VebcdtfgeaeydbcefBdbavcdfhvaicufgimbkkcbhvcbhiinalc;WbfavfgeydbhoaeaiBdbaoaifhiavclfgvcja9hmbkadhvdndnadTmbinalc;WbfaDamydbgicetf8VebcdtfgeaeydbgecefBdbaxaecdtfaiBdbamclfhmavcufgvmbkaq9cv9smdcbhvinabawydbcdtfavBdbawclfhwadavcefgv9hmbxdkkaq9cv9smekkclhvdninavc98Smealcxfavfydbcbyd;u:kjjbH:bjjjbbavc98fhvxbkkalc;Waf8Kjjjjbk:Jwliuo99iud9:cbhv8Jjjjjbca9Rgoczfcwfcbyd:8:kjjbBdbaocb8Pd:0:kjjb83izaocwfcbyd;i:kjjbBdbaocb8Pd;a:kjjb83ibaicd4hrdndnadmbJFFuFhwJFFuuhDJFFuuhqJFFuFhkJFFuuhxJFFuFhmxekarcdthPaehsincbhiinaoczfaifgzasaifIdbgwazIdbgDaDaw9EEUdbaoaifgzawazIdbgDaDaw9DEUdbaiclfgicx9hmbkasaPfhsavcefgvad9hmbkaoIdKhDaoIdwhwaoIdChqaoIdlhkaoIdzhxaoIdbhmkdnadTmbJbbbbJbFu9hJbbbbamax:tgmamJbbbb9DEgmakaq:tgkakam9DEgkawaD:tgwawak9DEgw:vawJbbbb9BEhwdnalmbarcdthoindndnaeclfIdbaq:tawNJbbbZMgk:lJbbb9p9DTmbak:Ohixekcjjjj94hikai:S9cC:ghHdndnaeIdbax:tawNJbbbZMgk:lJbbb9p9DTmbak:Ohixekcjjjj94hikaHai:S:ehHdndnaecwfIdbaD:tawNJbbbZMgk:lJbbb9p9DTmbak:Ohixekcjjjj94hikabaHai:T9cy:g:e83ibaeaofheabcwfhbadcufgdmbxdkkarcdthoindndnaeIdbax:tawNJbbbZMgk:lJbbb9p9DTmbak:Ohixekcjjjj94hikai:SgH9ca:gaH9cz:g9cjjj;4s:d:eaH9cFe:d:e9cF:bj;4:pj;ar:d9c:bd9:9c:p;G:d;4j:E;ar:d9cH9:9c;d;H:W:y:m:g;d;Hb:d9cv9:9c;j:KM;j:KM;j:Kd:dhOdndnaeclfIdbaq:tawNJbbbZMgk:lJbbb9p9DTmbak:Ohixekcjjjj94hikai:SgH9ca:gaH9cz:g9cjjj;4s:d:eaH9cFe:d:e9cF:bj;4:pj;ar:d9c:bd9:9c:p;G:d;4j:E;ar:d9cH9:9c;d;H:W:y:m:g;d;Hb:d9cq9:9cM;j:KM;j:KM;jl:daO:ehOdndnaecwfIdbaD:tawNJbbbZMgk:lJbbb9p9DTmbak:Ohixekcjjjj94hikabaOai:SgH9ca:gaH9cz:g9cjjj;4s:d:eaH9cFe:d:e9cF:bj;4:pj;ar:d9c:bd9:9c:p;G:d;4j:E;ar:d9cH9:9c;d;H:W:y:m:g;d;Hb:d9cC9:9c:KM;j:KM;j:KMD:d:e83ibaeaofheabcwfhbadcufgdmbkkk9teiucbcbyd;y:kjjbgeabcifc98GfgbBd;y:kjjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;teeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiaeydlBdlaiaeydwBdwaiaeydxBdxaeczfheaiczfhiadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk:3eedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdxaialBdwaialBdlaialBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabk9teiucbcbyd;y:kjjbgeabcrfc94GfgbBd;y:kjjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik9:eiuZbhedndncbyd;y:kjjbgdaecztgi9nmbcuheadai9RcFFifcz4nbcuSmekadhekcbabae9Rcifc98Gcbyd;y:kjjbfgdBd;y:kjjbdnadZbcztge9nmbadae9RcFFifcz4nb8Akkk;Qddbcjwk;mdbbbbdbbblbbbwbbbbbbbebbbdbbblbbbwbbbbbbbbbbbbbbbb4:h9w9N94:P:gW:j9O:ye9Pbbbbbbebbbdbbbebbbdbbbbbbbdbbbbbbbebbbbbbb:l29hZ;69:9kZ;N;76Z;rg97Z;z;o9xZ8J;B85Z;:;u9yZ;b;k9HZ:2;Z9DZ9e:l9mZ59A8KZ:r;T3Z:A:zYZ79OHZ;j4::8::Y:D9V8:bbbb9s:49:Z8R:hBZ9M9M;M8:L;z;o8:;8:PG89q;x:J878R:hQ8::M:B;e87bbbbbbjZbbjZbbjZ:E;V;N8::Y:DsZ9i;H;68:xd;R8:;h0838:;W:NoZbbbb:WV9O8:uf888:9i;H;68:9c9G;L89;n;m9m89;D8Ko8:bbbbf:8tZ9m836ZS:2AZL;zPZZ818EZ9e:lxZ;U98F8:819E;68:FFuuFFuuFFuuFFuFFFuFFFuFbc;mqkzebbbebbbdbbb9G:vbb",e=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if(typeof WebAssembly!="object")return{supported:!1};var t,i=WebAssembly.instantiate(r(a),{}).then(function(u){t=u.instance,t.exports.__wasm_call_ctors(),t.exports.meshopt_encodeVertexVersion(0),t.exports.meshopt_encodeIndexVersion(1)});function r(u){for(var m=new Uint8Array(u.length),p=0;p<u.length;++p){var g=u.charCodeAt(p);m[p]=g>96?g-97:g>64?g-39:g+4}for(var b=0,p=0;p<u.length;++p)m[b++]=m[p]<60?e[m[p]]:(m[p]-60)*64+m[++p];return m.buffer.slice(0,b)}function s(u){if(!u)throw new Error("Assertion failed")}function n(u){return new Uint8Array(u.buffer,u.byteOffset,u.byteLength)}function o(u,m,p,g){var b=t.exports.sbrk,A=b(m.length*4),y=b(p*4),x=new Uint8Array(t.exports.memory.buffer),E=n(m);x.set(E,A),g&&g(A,A,m.length,p);var I=u(y,A,m.length,p);x=new Uint8Array(t.exports.memory.buffer);var w=new Uint32Array(p);new Uint8Array(w.buffer).set(x.subarray(y,y+p*4)),E.set(x.subarray(A,A+m.length*4)),b(A-b(0));for(var v=0;v<m.length;++v)m[v]=w[m[v]];return[w,I]}function c(u,m,p,g){var b=t.exports.sbrk,A=b(p*4),y=b(p*g),x=new Uint8Array(t.exports.memory.buffer);x.set(n(m),y),u(A,y,p,g),x=new Uint8Array(t.exports.memory.buffer);var E=new Uint32Array(p);return new Uint8Array(E.buffer).set(x.subarray(A,A+p*4)),b(A-b(0)),E}function l(u,m,p,g,b,A,y){var x=t.exports.sbrk,E=x(m),I=x(g*b),w=new Uint8Array(t.exports.memory.buffer);w.set(n(p),I);var v=u(E,m,I,g,b,A,y),M=new Uint8Array(v);return M.set(w.subarray(E,E+v)),x(E-x(0)),M}function h(u){for(var m=0,p=0;p<u.length;++p){var g=u[p];m=m<g?g:m}return m}function d(u,m){if(s(m==2||m==4),m==4)return new Uint32Array(u.buffer,u.byteOffset,u.byteLength/4);var p=new Uint16Array(u.buffer,u.byteOffset,u.byteLength/2);return new Uint32Array(p)}function f(u,m,p,g,b,A,y){var x=t.exports.sbrk,E=x(p*g),I=x(p*A),w=new Uint8Array(t.exports.memory.buffer);w.set(n(m),I),u(E,p,g,b,I,y);var v=new Uint8Array(p*g);return v.set(w.subarray(E,E+p*g)),x(E-x(0)),v}return{ready:i,supported:!0,reorderMesh:function(u,m,p){var g=m?p?t.exports.meshopt_optimizeVertexCacheStrip:t.exports.meshopt_optimizeVertexCache:void 0;return o(t.exports.meshopt_optimizeVertexFetchRemap,u,h(u)+1,g)},reorderPoints:function(u,m){return s(u instanceof Float32Array),s(u.length%m==0),s(m>=3),c(t.exports.meshopt_spatialSortRemap,u,u.length/m,m*4)},encodeVertexBuffer:function(u,m,p){s(p>0&&p<=256),s(p%4==0);var g=t.exports.meshopt_encodeVertexBufferBound(m,p);return l(t.exports.meshopt_encodeVertexBuffer,g,u,m,p)},encodeVertexBufferLevel:function(u,m,p,g,b){s(p>0&&p<=256),s(p%4==0),s(g>=0&&g<=3),s(b===void 0||b==0||b==1);var A=t.exports.meshopt_encodeVertexBufferBound(m,p);return l(t.exports.meshopt_encodeVertexBufferLevel,A,u,m,p,g,b||0)},encodeIndexBuffer:function(u,m,p){s(p==2||p==4),s(m%3==0);var g=d(u,p),b=t.exports.meshopt_encodeIndexBufferBound(m,h(g)+1);return l(t.exports.meshopt_encodeIndexBuffer,b,g,m,4)},encodeIndexSequence:function(u,m,p){s(p==2||p==4);var g=d(u,p),b=t.exports.meshopt_encodeIndexSequenceBound(m,h(g)+1);return l(t.exports.meshopt_encodeIndexSequence,b,g,m,4)},encodeGltfBuffer:function(u,m,p,g){var b={ATTRIBUTES:this.encodeVertexBuffer,TRIANGLES:this.encodeIndexBuffer,INDICES:this.encodeIndexSequence};return s(b[g]),b[g](u,m,p)},encodeFilterOct:function(u,m,p,g){return s(p==4||p==8),s(g>=1&&g<=16),f(t.exports.meshopt_encodeFilterOct,u,m,p,g,16)},encodeFilterQuat:function(u,m,p,g){return s(p==8),s(g>=4&&g<=16),f(t.exports.meshopt_encodeFilterQuat,u,m,p,g,16)},encodeFilterExp:function(u,m,p,g,b){s(p>0&&p%4==0),s(g>=1&&g<=24);var A={Separate:0,SharedVector:1,SharedComponent:2,Clamped:3};return f(t.exports.meshopt_encodeFilterExp,u,m,p,g,p,b?A[b]:1)},encodeFilterColor:function(u,m,p,g){return s(p==4||p==8),s(g>=2&&g<=16),f(t.exports.meshopt_encodeFilterColor,u,m,p,g,16)}}})();var Qn=(function(){var a="b9H79Tebbbe8Fv9Gbb9Gvuuuuueu9Giuuub9Geueu9Giuuueuixkbeeeddddillviebeoweuec:W:Odkr;Neqo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbeY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVbdE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbiL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtblK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949WboY9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVJ9V29VVbrl79IV9Rbwq;BZkdbk;jYi5ud9:du8Jjjjjbcj;kb9Rgv8Kjjjjbc9:hodnalTmbcuhoaiRbbgrc;WeGc:Ge9hmbarcsGgwce0mbc9:hoalcufadcd4cbawEgDadfgrcKcaawEgqaraq0Egk6mbaicefhxcj;abad9Uc;WFbGcjdadca0EhmaialfgPar9Rgoadfhsavaoadz:jjjjbgzceVhHcbhOdndninaeaO9nmeaPax9RaD6mdamaeaO9RaOamfgoae6EgAcsfglc9WGhCabaOad2fhXaAcethQaxaDfhiaOaeaoaeao6E9RhLalcl4cifcd4hKazcj;cbfaAfhYcbh8AazcjdfhEaHh3incbhodnawTmbaxa8Acd4fRbbhokaocFeGh5cbh8Eazcj;cbfhqinaih8Fdndndndna5a8Ecet4ciGgoc9:fPdebdkaPa8F9RaA6mrazcj;cbfa8EaA2fa8FaAz:jjjjb8Aa8FaAfhixdkazcj;cbfa8EaA2fcbaAz:kjjjb8Aa8FhixekaPa8F9RaK6mva8FaKfhidnaCTmbaPai9RcK6mbaocdtc:q1jjbfcj1jjbawEhaczhrcbhlinargoc9Wfghaqfhrdndndndndndnaaa8Fahco4fRbbalcoG4ciGcdtfydbPDbedvivvvlvkar9cb83bbarcwf9cb83bbxlkarcbaiRbdai8Xbb9c:c:qj:bw9:9c:q;c1:I1e:d9c:b:c:e1z9:gg9cjjjjjz:dg8J9qE86bbaqaofgrcGfag9c8F1:NghcKtc8F91aicdfa8J9c8N1:Nfg8KRbbG86bbarcVfcba8KahcjeGcr4fghRbbag9cjjjjjl:dg8J9qE86bbarc7fcbaha8J9c8L1:NfghRbbag9cjjjjjd:dg8J9qE86bbarctfcbaha8J9c8K1:NfghRbbag9cjjjjje:dg8J9qE86bbarc91fcbaha8J9c8J1:NfghRbbag9cjjjj;ab:dg8J9qE86bbarc4fcbaha8J9cg1:NfghRbbag9cjjjja:dg8J9qE86bbarc93fcbaha8J9ch1:NfghRbbag9cjjjjz:dgg9qE86bbarc94fcbahag9ca1:NfghRbbai8Xbe9c:c:qj:bw9:9c:q;c1:I1e:d9c:b:c:e1z9:gg9cjjjjjz:dg8J9qE86bbarc95fag9c8F1:NgicKtc8F91aha8J9c8N1:NfghRbbG86bbarc96fcbahaicjeGcr4fgiRbbag9cjjjjjl:dg8J9qE86bbarc97fcbaia8J9c8L1:NfgiRbbag9cjjjjjd:dg8J9qE86bbarc98fcbaia8J9c8K1:NfgiRbbag9cjjjjje:dg8J9qE86bbarc99fcbaia8J9c8J1:NfgiRbbag9cjjjj;ab:dg8J9qE86bbarc9:fcbaia8J9cg1:NfgiRbbag9cjjjja:dg8J9qE86bbarcufcbaia8J9ch1:NfgiRbbag9cjjjjz:dgg9qE86bbaiag9ca1:NfhixikaraiRblaiRbbghco4g8Ka8KciSg8KE86bbaqaofgrcGfaiclfa8Kfg8KRbbahcl4ciGg8La8LciSg8LE86bbarcVfa8Ka8Lfg8KRbbahcd4ciGg8La8LciSg8LE86bbarc7fa8Ka8Lfg8KRbbahciGghahciSghE86bbarctfa8Kahfg8KRbbaiRbeghco4g8La8LciSg8LE86bbarc91fa8Ka8Lfg8KRbbahcl4ciGg8La8LciSg8LE86bbarc4fa8Ka8Lfg8KRbbahcd4ciGg8La8LciSg8LE86bbarc93fa8Ka8Lfg8KRbbahciGghahciSghE86bbarc94fa8Kahfg8KRbbaiRbdghco4g8La8LciSg8LE86bbarc95fa8Ka8Lfg8KRbbahcl4ciGg8La8LciSg8LE86bbarc96fa8Ka8Lfg8KRbbahcd4ciGg8La8LciSg8LE86bbarc97fa8Ka8Lfg8KRbbahciGghahciSghE86bbarc98fa8KahfghRbbaiRbigico4g8Ka8KciSg8KE86bbarc99faha8KfghRbbaicl4ciGg8Ka8KciSg8KE86bbarc9:faha8KfghRbbaicd4ciGg8Ka8KciSg8KE86bbarcufaha8KfgrRbbaiciGgiaiciSgiE86bbaraifhixdkaraiRbwaiRbbghcl4g8Ka8KcsSg8KE86bbaqaofgrcGfaicwfa8Kfg8KRbbahcsGghahcsSghE86bbarcVfa8KahfghRbbaiRbeg8Kcl4g8La8LcsSg8LE86bbarc7faha8LfghRbba8KcsGg8Ka8KcsSg8KE86bbarctfaha8KfghRbbaiRbdg8Kcl4g8La8LcsSg8LE86bbarc91faha8LfghRbba8KcsGg8Ka8KcsSg8KE86bbarc4faha8KfghRbbaiRbig8Kcl4g8La8LcsSg8LE86bbarc93faha8LfghRbba8KcsGg8Ka8KcsSg8KE86bbarc94faha8KfghRbbaiRblg8Kcl4g8La8LcsSg8LE86bbarc95faha8LfghRbba8KcsGg8Ka8KcsSg8KE86bbarc96faha8KfghRbbaiRbvg8Kcl4g8La8LcsSg8LE86bbarc97faha8LfghRbba8KcsGg8Ka8KcsSg8KE86bbarc98faha8KfghRbbaiRbog8Kcl4g8La8LcsSg8LE86bbarc99faha8LfghRbba8KcsGg8Ka8KcsSg8KE86bbarc9:faha8KfghRbbaiRbrgicl4g8Ka8KcsSg8KE86bbarcufaha8KfgrRbbaicsGgiaicsSgiE86bbaraifhixekarai8Pbb83bbarcwfaicwf8Pbb83bbaiczfhikdnaoaC9pmbalcdfhlaoczfhraPai9RcL0mekkaoaC6moaimexokaCmva8FTmvkaqaAfhqa8Ecefg8Ecl9hmbkdndndndnawTmbasa8Acd4fRbbgociGPlbedrbkaATmdaza8Afh8Fazcj;cbfhhcbh8EaEhaina8FRbbhraahocbhlinaoahalfRbbgqce4cbaqceG9R7arfgr86bbaoadfhoaAalcefgl9hmbkaacefhaa8Fcefh8FahaAfhha8Ecefg8Ecl9hmbxikkaATmeaza8Afhaazcj;cbfhhcbhoceh8EaYh8FinaEaofhlaa8Vbbhrcbhoinala8FaofRbbcwtahaofRbbgqVc;:FiGce4cbaqceG9R7arfgr87bbaladfhlaLaocefgofmbka8FaQfh8FcdhoaacdfhaahaQfhha8EceGhlcbh8EalmbxdkkaATmbcbaocl49Rh8Eaza8AfRbbhqcwhoa3hlinalRbbaotaqVhqalcefhlaocwfgoca9hmbkcbhhaEh8FaYhainazcj;cbfahfRbbhrcwhoaahlinalRbbaotarVhralaAfhlaocwfgoca9hmbkara8E93aq7hqcbhoa8Fhlinalaqao486bbalcefhlaocwfgoca9hmbka8Fadfh8FaacefhaahcefghaA9hmbkkaEclfhEa3clfh3a8Aclfg8Aad6mbkaXazcjdfaAad2z:jjjjb8AazazcjdfaAcufad2fadz:jjjjb8AaAaOfhOaihxaimbkc9:hoxdkcbc99aPax9RakSEhoxekc9:hokavcj;kbf8Kjjjjbaok:XseHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgDce0mbavc;abfcFecjez:kjjjb8AavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhqaicefgwarfhldnaeTmbcmcsaDceSEhkcbhxcbhmcbhrcbhicbhoindnalaq9nmbc9:hoxikdndnawRbbgDc;Ve0mbavc;abfaoaDcu7gPcl4fcsGcitfgsydlhzasydbhHdndnaDcsGgsak9pmbavaiaPfcsGcdtfydbaxasEhDaxasTgOfhxxekdndnascsSmbcehOasc987asamffcefhDxekalcefhDal8SbbgscFeGhPdndnascu9mmbaDhlxekalcvfhlaPcFbGhPcrhsdninaD8SbbgOcFbGastaPVhPaOcu9kmeaDcefhDascrfgsc8J9hmbxdkkaDcefhlkcehOaPce4cbaPceG9R7amfhDkaDhmkavc;abfaocitfgsaDBdbasazBdlavaicdtfaDBdbavc;abfaocefcsGcitfgsaHBdbasaDBdlaocdfhoaOaifhidnadcd9hmbabarcetfgsaH87ebasclfaD87ebascdfaz87ebxdkabarcdtfgsaHBdbascwfaDBdbasclfazBdbxekdnaDcpe0mbaxcefgOavaiaqaDcsGfRbbgscl49RcsGcdtfydbascz6gPEhDavaias9RcsGcdtfydbaOaPfgzascsGgOEhsaOThOdndnadcd9hmbabarcetfgHax87ebaHclfas87ebaHcdfaD87ebxekabarcdtfgHaxBdbaHcwfasBdbaHclfaDBdbkavaicdtfaxBdbavc;abfaocitfgHaDBdbaHaxBdlavaicefgicsGcdtfaDBdbavc;abfaocefcsGcitfgHasBdbaHaDBdlavaiaPfgicsGcdtfasBdbavc;abfaocdfcsGcitfgDaxBdbaDasBdlaocifhoaiaOfhiazaOfhxxekaxcbalRbbgHEgAaDc;:eSgDfhzaHcsGhCaHcl4hXdndnaHcs0mbazcefhOxekazhOavaiaX9RcsGcdtfydbhzkdndnaCmbaOcefhxxekaOhxavaiaH9RcsGcdtfydbhOkdndnaDTmbalcefhDxekalcdfhDal8SbegPcFeGhsdnaPcu9kmbalcofhAascFbGhscrhldninaD8SbbgPcFbGaltasVhsaPcu9kmeaDcefhDalcrfglc8J9hmbkaAhDxekaDcefhDkasce4cbasceG9R7amfgmhAkdndnaXcsSmbaDhsxekaDcefhsaD8SbbglcFeGhPdnalcu9kmbaDcvfhzaPcFbGhPcrhldninas8SbbgDcFbGaltaPVhPaDcu9kmeascefhsalcrfglc8J9hmbkazhsxekascefhskaPce4cbaPceG9R7amfgmhzkdndnaCcsSmbashlxekascefhlas8SbbgDcFeGhPdnaDcu9kmbascvfhOaPcFbGhPcrhDdninal8SbbgscFbGaDtaPVhPascu9kmealcefhlaDcrfgDc8J9hmbkaOhlxekalcefhlkaPce4cbaPceG9R7amfgmhOkdndnadcd9hmbabarcetfgDaA87ebaDclfaO87ebaDcdfaz87ebxekabarcdtfgDaABdbaDcwfaOBdbaDclfazBdbkavc;abfaocitfgDazBdbaDaABdlavaicdtfaABdbavc;abfaocefcsGcitfgDaOBdbaDazBdlavaicefgicsGcdtfazBdbavc;abfaocdfcsGcitfgDaABdbaDaOBdlavaiaHcz6aXcsSVfgicsGcdtfaOBdbaiaCTaCcsSVfhiaocifhokawcefhwaocsGhoaicsGhiarcifgrae6mbkkcbc99alaqSEhokavc;aef8Kjjjjbaok:clevu8Jjjjjbcz9Rhvdnaecvfal9nmbc9:skdnaiRbbc;:eGc;qeSmbcuskav9cb83iwaicefhoaialfc98fhrdnaeTmbdnadcdSmbcbhwindnaoar6mbc9:skaocefhlao8SbbgicFeGhddndnaicu9mmbalhoxekaocvfhoadcFbGhdcrhidninal8SbbgDcFbGaitadVhdaDcu9kmealcefhlaicrfgic8J9hmbxdkkalcefhokabawcdtfadc8Etc8F91adcd47avcwfadceGcdtVglydbfgiBdbalaiBdbawcefgwae9hmbxdkkcbhwindnaoar6mbc9:skaocefhlao8SbbgicFeGhddndnaicu9mmbalhoxekaocvfhoadcFbGhdcrhidninal8SbbgDcFbGaitadVhdaDcu9kmealcefhlaicrfgic8J9hmbxdkkalcefhokabawcetfadc8Etc8F91adcd47avcwfadceGcdtVglydbfgi87ebalaiBdbawcefgwae9hmbkkcbc99aoarSEk:Lvoeue99dud99eud99dndnadcl9hmbaeTmeindndnabcdfgd8Sbb:Yab8Sbbgi:Ygl:l:tabcefgv8Sbbgo:Ygr:l:tgwJbb;:9cawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai86bbdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad86bbdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad86bbabclfhbaecufgembxdkkaeTmbindndnabclfgd8Ueb:Yab8Uebgi:Ygl:l:tabcdfgv8Uebgo:Ygr:l:tgwJb;:FSawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai87ebdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad87ebdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad87ebabcwfhbaecufgembkkk;oiliui99iue99dnaeTmbcbhiabhlindndnJ;Zl81Zalcof8UebgvciV:Y:vgoal8Ueb:YNgrJb;:FSNJbbbZJbbb:;arJbbbb9GEMgw:lJbbb9p9DTmbaw:OhDxekcjjjj94hDkalclf8Uebhqalcdf8UebhkabaiavcefciGfcetfaD87ebdndnaoak:YNgwJb;:FSNJbbbZJbbb:;awJbbbb9GEMgx:lJbbb9p9DTmbax:OhDxekcjjjj94hDkabaiavciGfgkcd7cetfaD87ebdndnaoaq:YNgoJb;:FSNJbbbZJbbb:;aoJbbbb9GEMgx:lJbbb9p9DTmbax:OhDxekcjjjj94hDkabaiavcufciGfcetfaD87ebdndnJbbjZararN:tawawN:taoaoN:tgrJbbbbarJbbbb9GE:rJb;:FSNJbbbZMgr:lJbbb9p9DTmbar:Ohvxekcjjjj94hvkabakcetfav87ebalcwfhlaiclfhiaecufgembkkk9mbdnadcd4ae2gdTmbinababydbgecwtcw91:Yaece91cjjj98Gcjjj;8if::NUdbabclfhbadcufgdmbkkk:Tvirud99eudndnadcl9hmbaeTmeindndnabRbbgiabcefgl8Sbbgvabcdfgo8Sbbgrf9R:YJbbuJabcifgwRbbgdce4adVgDcd4aDVgDcl4aDVgD:Z:vgqNJbbbZMgk:lJbbb9p9DTmbak:Ohxxekcjjjj94hxkaoax86bbdndnaraif:YaqNJbbbZMgk:lJbbb9p9DTmbak:Ohoxekcjjjj94hokalao86bbdndnavaifar9R:YaqNJbbbZMgk:lJbbb9p9DTmbak:Ohixekcjjjj94hikabai86bbdndnaDadcetGadceGV:ZaqNJbbbZMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkawad86bbabclfhbaecufgembxdkkaeTmbindndnab8Vebgiabcdfgl8Uebgvabclfgo8Uebgrf9R:YJbFu9habcofgw8Vebgdce4adVgDcd4aDVgDcl4aDVgDcw4aDVgD:Z:vgqNJbbbZMgk:lJbbb9p9DTmbak:Ohxxekcjjjj94hxkaoax87ebdndnaraif:YaqNJbbbZMgk:lJbbb9p9DTmbak:Ohoxekcjjjj94hokalao87ebdndnavaifar9R:YaqNJbbbZMgk:lJbbb9p9DTmbak:Ohixekcjjjj94hikabai87ebdndnaDadcetGadceGV:ZaqNJbbbZMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkawad87ebabcwfhbaecufgembkkk9teiucbcbyd:K1jjbgeabcifc98GfgbBd:K1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;teeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiaeydlBdlaiaeydwBdwaiaeydxBdxaeczfheaiczfhiadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk:3eedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdxaialBdwaialBdlaialBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabkk81dbcjwk8Kbbbbdbbblbbbwbbbbbbbebbbdbbblbbbwbbbbc:Kwkl8WNbb",e="b9H79TebbbeKl9Gbb9Gvuuuuueu9Giuuub9Geueuixkbbebeeddddilve9Weeeviebeoweuec:q:6dkr;Neqo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbdY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVblE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtboK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbrL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949WbwY9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVJ9V29VVbDl79IV9Rbqq;Ctklbzik9:evu8Jjjjjbcz9Rhbcbheincbhdcbhiinabcwfadfaicjuaead4ceGglE86bbaialfhiadcefgdcw9hmbkaec:q:yjjbfai86bbaecitc:q1jjbfab8Piw83ibaecefgecjd9hmbkk:183lYud97dur978Jjjjjbcj;kb9Rgv8Kjjjjbc9:hodnalTmbcuhoaiRbbgrc;WeGc:Ge9hmbarcsGgwce0mbc9:hoalcufadcd4cbawEgDadfgrcKcaawEgqaraq0Egk6mbaicefhxavaialfgmar9Rgoad;8qbbcj;abad9Uc;WFbGcjdadca0EhPdndndnadTmbaoadfhscbhzinaeaz9nmdamax9RaD6miabazad2fhHaxaDfhOaPaeaz9RazaPfae6EgAcsfgocl4cifcd4hCavcj;cbfaoc9WGgXcetfhQavcj;cbfaXci2fhLavcj;cbfaXfhKcbhYaoc;ab6h8AincbhodnawTmbaxaYcd4fRbbhokaocFeGhEcbh3avcj;cbfh5indndndndnaEa3cet4ciGgoc9:fPdebdkamaO9RaX6mwavcj;cbfa3aX2faOaX;8qbbaOaAfhOxdkavcj;cbfa3aX2fcbaX;8kbxekamaO9RaC6moaoclVcbawEhraOaCfhocbhidna8Ambamao9Rc;Gb6mbcbhlina5alfhidndndndndndnaOalco4fRbbgqciGarfPDbedibledibkaipxbbbbbbbbbbbbbbbbpklbxlkaiaopbblaopbbbg8Eclp:mea8EpmbzeHdOiAlCvXoQrLg8Ecdp:mea8EpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9og8Fpxiiiiiiiiiiiiiiiip8Jg8Ep5b9cjF;8;4;W;G;ab9:9cU1:Ngacitc:q1jjbfpbibaac:q:yjjbfRbbgapsa8Ep5e9cjF;8;4;W;G;ab9:9cU1:Nghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPa8Fa8Ep9spklbaaaoclffahc:q:yjjbfRbbfhoxikaiaopbbwaopbbbg8Eclp:mea8EpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9og8Fpxssssssssssssssssp8Jg8Ep5b9cjF;8;4;W;G;ab9:9cU1:Ngacitc:q1jjbfpbibaac:q:yjjbfRbbgapsa8Ep5e9cjF;8;4;W;G;ab9:9cU1:Nghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPa8Fa8Ep9spklbaaaocwffahc:q:yjjbfRbbfhoxdkaiaopbbbpklbaoczfhoxekaiaopbbdaoRbbgacitc:q1jjbfpbibaac:q:yjjbfRbbgapsaoRbeghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPpklbaaaocdffahc:q:yjjbfRbbfhokdndndndndndnaqcd4ciGarfPDbedibledibkaiczfpxbbbbbbbbbbbbbbbbpklbxlkaiczfaopbblaopbbbg8Eclp:mea8EpmbzeHdOiAlCvXoQrLg8Ecdp:mea8EpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9og8Fpxiiiiiiiiiiiiiiiip8Jg8Ep5b9cjF;8;4;W;G;ab9:9cU1:Ngacitc:q1jjbfpbibaac:q:yjjbfRbbgapsa8Ep5e9cjF;8;4;W;G;ab9:9cU1:Nghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPa8Fa8Ep9spklbaaaoclffahc:q:yjjbfRbbfhoxikaiczfaopbbwaopbbbg8Eclp:mea8EpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9og8Fpxssssssssssssssssp8Jg8Ep5b9cjF;8;4;W;G;ab9:9cU1:Ngacitc:q1jjbfpbibaac:q:yjjbfRbbgapsa8Ep5e9cjF;8;4;W;G;ab9:9cU1:Nghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPa8Fa8Ep9spklbaaaocwffahc:q:yjjbfRbbfhoxdkaiczfaopbbbpklbaoczfhoxekaiczfaopbbdaoRbbgacitc:q1jjbfpbibaac:q:yjjbfRbbgapsaoRbeghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPpklbaaaocdffahc:q:yjjbfRbbfhokdndndndndndnaqcl4ciGarfPDbedibledibkaicafpxbbbbbbbbbbbbbbbbpklbxlkaicafaopbblaopbbbg8Eclp:mea8EpmbzeHdOiAlCvXoQrLg8Ecdp:mea8EpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9og8Fpxiiiiiiiiiiiiiiiip8Jg8Ep5b9cjF;8;4;W;G;ab9:9cU1:Ngacitc:q1jjbfpbibaac:q:yjjbfRbbgapsa8Ep5e9cjF;8;4;W;G;ab9:9cU1:Nghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPa8Fa8Ep9spklbaaaoclffahc:q:yjjbfRbbfhoxikaicafaopbbwaopbbbg8Eclp:mea8EpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9og8Fpxssssssssssssssssp8Jg8Ep5b9cjF;8;4;W;G;ab9:9cU1:Ngacitc:q1jjbfpbibaac:q:yjjbfRbbgapsa8Ep5e9cjF;8;4;W;G;ab9:9cU1:Nghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPa8Fa8Ep9spklbaaaocwffahc:q:yjjbfRbbfhoxdkaicafaopbbbpklbaoczfhoxekaicafaopbbdaoRbbgacitc:q1jjbfpbibaac:q:yjjbfRbbgapsaoRbeghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPpklbaaaocdffahc:q:yjjbfRbbfhokdndndndndndnaqco4arfPDbedibledibkaic8Wfpxbbbbbbbbbbbbbbbbpklbxlkaic8Wfaopbblaopbbbg8Eclp:mea8EpmbzeHdOiAlCvXoQrLg8Ecdp:mea8EpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9og8Fpxiiiiiiiiiiiiiiiip8Jg8Ep5b9cjF;8;4;W;G;ab9:9cU1:Ngicitc:q1jjbfpbibaic:q:yjjbfRbbgipsa8Ep5e9cjF;8;4;W;G;ab9:9cU1:Ngqcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPa8Fa8Ep9spklbaiaoclffaqc:q:yjjbfRbbfhoxikaic8Wfaopbbwaopbbbg8Eclp:mea8EpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9og8Fpxssssssssssssssssp8Jg8Ep5b9cjF;8;4;W;G;ab9:9cU1:Ngicitc:q1jjbfpbibaic:q:yjjbfRbbgipsa8Ep5e9cjF;8;4;W;G;ab9:9cU1:Ngqcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPa8Fa8Ep9spklbaiaocwffaqc:q:yjjbfRbbfhoxdkaic8Wfaopbbbpklbaoczfhoxekaic8WfaopbbdaoRbbgicitc:q1jjbfpbibaic:q:yjjbfRbbgipsaoRbegqcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPpklbaiaocdffaqc:q:yjjbfRbbfhokalc;abfhialcjefaX0meaihlamao9Rc;Fb0mbkkdnaiaX9pmbaici4hlinamao9RcK6mwa5aifhqdndndndndndnaOaico4fRbbalcoG4ciGarfPDbedibledibkaqpxbbbbbbbbbbbbbbbbpkbbxlkaqaopbblaopbbbg8Eclp:mea8EpmbzeHdOiAlCvXoQrLg8Ecdp:mea8EpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9og8Fpxiiiiiiiiiiiiiiiip8Jg8Ep5b9cjF;8;4;W;G;ab9:9cU1:Ngacitc:q1jjbfpbibaac:q:yjjbfRbbgapsa8Ep5e9cjF;8;4;W;G;ab9:9cU1:Nghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPa8Fa8Ep9spkbbaaaoclffahc:q:yjjbfRbbfhoxikaqaopbbwaopbbbg8Eclp:mea8EpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9og8Fpxssssssssssssssssp8Jg8Ep5b9cjF;8;4;W;G;ab9:9cU1:Ngacitc:q1jjbfpbibaac:q:yjjbfRbbgapsa8Ep5e9cjF;8;4;W;G;ab9:9cU1:Nghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPa8Fa8Ep9spkbbaaaocwffahc:q:yjjbfRbbfhoxdkaqaopbbbpkbbaoczfhoxekaqaopbbdaoRbbgacitc:q1jjbfpbibaac:q:yjjbfRbbgapsaoRbeghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPpkbbaaaocdffahc:q:yjjbfRbbfhokalcdfhlaiczfgiaX6mbkkaohOaoTmoka5aXfh5a3cefg3cl9hmbkdndndndnawTmbasaYcd4fRbbglciGPlbedwbkaXTmdavcjdfaYfhlavaYfpbdbhgcbhoinalavcj;cbfaofpblbg8JaKaofpblbg8KpmbzeHdOiAlCvXoQrLg8LaQaofpblbg8MaLaofpblbg8NpmbzeHdOiAlCvXoQrLgypmbezHdiOAlvCXorQLg8Ecep9Ta8Epxeeeeeeeeeeeeeeeeg8Fp9op9Hp9rg8Eagp9Uggp9Abbbaladfglaga8Ea8Epmlvorlvorlvorlvorp9Uggp9Abbbaladfglaga8Ea8EpmwDqkwDqkwDqkwDqkp9Uggp9Abbbaladfglaga8Ea8EpmxmPsxmPsxmPsxmPsp9Uggp9Abbbaladfglaga8LaypmwDKYqk8AExm35Ps8E8Fg8Ecep9Ta8Ea8Fp9op9Hp9rg8Ep9Uggp9Abbbaladfglaga8Ea8Epmlvorlvorlvorlvorp9Uggp9Abbbaladfglaga8Ea8EpmwDqkwDqkwDqkwDqkp9Uggp9Abbbaladfglaga8Ea8EpmxmPsxmPsxmPsxmPsp9Uggp9Abbbaladfglaga8Ja8KpmwKDYq8AkEx3m5P8Es8Fg8Ja8Ma8NpmwKDYq8AkEx3m5P8Es8Fg8KpmbezHdiOAlvCXorQLg8Ecep9Ta8Ea8Fp9op9Hp9rg8Ep9Uggp9Abbbaladfglaga8Ea8Epmlvorlvorlvorlvorp9Uggp9Abbbaladfglaga8Ea8EpmwDqkwDqkwDqkwDqkp9Uggp9Abbbaladfglaga8Ea8EpmxmPsxmPsxmPsxmPsp9Uggp9Abbbaladfglaga8Ja8KpmwDKYqk8AExm35Ps8E8Fg8Ecep9Ta8Ea8Fp9op9Hp9rg8Ep9Ug8Fp9Abbbaladfgla8Fa8Ea8Epmlvorlvorlvorlvorp9Ug8Fp9Abbbaladfgla8Fa8Ea8EpmwDqkwDqkwDqkwDqkp9Ug8Fp9Abbbaladfgla8Fa8Ea8EpmxmPsxmPsxmPsxmPsp9Uggp9AbbbaladfhlaoczfgoaX6mbxikkaXTmeavcjdfaYfhlavaYfpbdbhgcbhoinalavcj;cbfaofpblbg8JaKaofpblbg8KpmbzeHdOiAlCvXoQrLg8LaQaofpblbg8MaLaofpblbg8NpmbzeHdOiAlCvXoQrLgypmbezHdiOAlvCXorQLg8Ecep:nea8Epxebebebebebebebebg8Fp9op:bep9rg8Eagp:oeggp9Abbbaladfglaga8Ea8Epmlvorlvorlvorlvorp:oeggp9Abbbaladfglaga8Ea8EpmwDqkwDqkwDqkwDqkp:oeggp9Abbbaladfglaga8Ea8EpmxmPsxmPsxmPsxmPsp:oeggp9Abbbaladfglaga8LaypmwDKYqk8AExm35Ps8E8Fg8Ecep:nea8Ea8Fp9op:bep9rg8Ep:oeggp9Abbbaladfglaga8Ea8Epmlvorlvorlvorlvorp:oeggp9Abbbaladfglaga8Ea8EpmwDqkwDqkwDqkwDqkp:oeggp9Abbbaladfglaga8Ea8EpmxmPsxmPsxmPsxmPsp:oeggp9Abbbaladfglaga8Ja8KpmwKDYq8AkEx3m5P8Es8Fg8Ja8Ma8NpmwKDYq8AkEx3m5P8Es8Fg8KpmbezHdiOAlvCXorQLg8Ecep:nea8Ea8Fp9op:bep9rg8Ep:oeggp9Abbbaladfglaga8Ea8Epmlvorlvorlvorlvorp:oeggp9Abbbaladfglaga8Ea8EpmwDqkwDqkwDqkwDqkp:oeggp9Abbbaladfglaga8Ea8EpmxmPsxmPsxmPsxmPsp:oeggp9Abbbaladfglaga8Ja8KpmwDKYqk8AExm35Ps8E8Fg8Ecep:nea8Ea8Fp9op:bep9rg8Ep:oeg8Fp9Abbbaladfgla8Fa8Ea8Epmlvorlvorlvorlvorp:oeg8Fp9Abbbaladfgla8Fa8Ea8EpmwDqkwDqkwDqkwDqkp:oeg8Fp9Abbbaladfgla8Fa8Ea8EpmxmPsxmPsxmPsxmPsp:oeggp9AbbbaladfhlaoczfgoaX6mbxdkkaXTmbcbhocbalcl4gl9Rc8FGhiavcjdfaYfhravaYfpbdbh8Finaravcj;cbfaofpblbggaKaofpblbg8JpmbzeHdOiAlCvXoQrLg8KaQaofpblbg8LaLaofpblbg8MpmbzeHdOiAlCvXoQrLg8NpmbezHdiOAlvCXorQLg8Eaip:Rea8Ealp:Sep9qg8Ea8Fp9rg8Fp9Abbbaradfgra8Fa8Ea8Epmlvorlvorlvorlvorp9rg8Fp9Abbbaradfgra8Fa8Ea8EpmwDqkwDqkwDqkwDqkp9rg8Fp9Abbbaradfgra8Fa8Ea8EpmxmPsxmPsxmPsxmPsp9rg8Fp9Abbbaradfgra8Fa8Ka8NpmwDKYqk8AExm35Ps8E8Fg8Eaip:Rea8Ealp:Sep9qg8Ep9rg8Fp9Abbbaradfgra8Fa8Ea8Epmlvorlvorlvorlvorp9rg8Fp9Abbbaradfgra8Fa8Ea8EpmwDqkwDqkwDqkwDqkp9rg8Fp9Abbbaradfgra8Fa8Ea8EpmxmPsxmPsxmPsxmPsp9rg8Fp9Abbbaradfgra8Faga8JpmwKDYq8AkEx3m5P8Es8Fgga8La8MpmwKDYq8AkEx3m5P8Es8Fg8JpmbezHdiOAlvCXorQLg8Eaip:Rea8Ealp:Sep9qg8Ep9rg8Fp9Abbbaradfgra8Fa8Ea8Epmlvorlvorlvorlvorp9rg8Fp9Abbbaradfgra8Fa8Ea8EpmwDqkwDqkwDqkwDqkp9rg8Fp9Abbbaradfgra8Fa8Ea8EpmxmPsxmPsxmPsxmPsp9rg8Fp9Abbbaradfgra8Faga8JpmwDKYqk8AExm35Ps8E8Fg8Eaip:Rea8Ealp:Sep9qg8Ep9rg8Fp9Abbbaradfgra8Fa8Ea8Epmlvorlvorlvorlvorp9rg8Fp9Abbbaradfgra8Fa8Ea8EpmwDqkwDqkwDqkwDqkp9rg8Fp9Abbbaradfgra8Fa8Ea8EpmxmPsxmPsxmPsxmPsp9rg8Fp9AbbbaradfhraoczfgoaX6mbkkaYclfgYad6mbkaHavcjdfaAad2;8qbbavavcjdfaAcufad2fad;8qbbaAazfhzc9:hoaOhxaOmbxlkkaeTmbaDalfhrcbhocuhlinaralaD9RglfaD6mdaPaeao9RaoaPfae6Eaofgoae6mbkaial9Rhxkcbc99amax9RakSEhoxekc9:hokavcj;kbf8Kjjjjbaokwbz:bjjjbk:TseHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgDce0mbavc;abfcFecje;8kbavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhqaicefgwarfhldnaeTmbcmcsaDceSEhkcbhxcbhmcbhrcbhicbhoindnalaq9nmbc9:hoxikdndnawRbbgDc;Ve0mbavc;abfaoaDcu7gPcl4fcsGcitfgsydlhzasydbhHdndnaDcsGgsak9pmbavaiaPfcsGcdtfydbaxasEhDaxasTgOfhxxekdndnascsSmbcehOasc987asamffcefhDxekalcefhDal8SbbgscFeGhPdndnascu9mmbaDhlxekalcvfhlaPcFbGhPcrhsdninaD8SbbgOcFbGastaPVhPaOcu9kmeaDcefhDascrfgsc8J9hmbxdkkaDcefhlkcehOaPce4cbaPceG9R7amfhDkaDhmkavc;abfaocitfgsaDBdbasazBdlavaicdtfaDBdbavc;abfaocefcsGcitfgsaHBdbasaDBdlaocdfhoaOaifhidnadcd9hmbabarcetfgsaH87ebasclfaD87ebascdfaz87ebxdkabarcdtfgsaHBdbascwfaDBdbasclfazBdbxekdnaDcpe0mbaxcefgOavaiaqaDcsGfRbbgscl49RcsGcdtfydbascz6gPEhDavaias9RcsGcdtfydbaOaPfgzascsGgOEhsaOThOdndnadcd9hmbabarcetfgHax87ebaHclfas87ebaHcdfaD87ebxekabarcdtfgHaxBdbaHcwfasBdbaHclfaDBdbkavaicdtfaxBdbavc;abfaocitfgHaDBdbaHaxBdlavaicefgicsGcdtfaDBdbavc;abfaocefcsGcitfgHasBdbaHaDBdlavaiaPfgicsGcdtfasBdbavc;abfaocdfcsGcitfgDaxBdbaDasBdlaocifhoaiaOfhiazaOfhxxekaxcbalRbbgHEgAaDc;:eSgDfhzaHcsGhCaHcl4hXdndnaHcs0mbazcefhOxekazhOavaiaX9RcsGcdtfydbhzkdndnaCmbaOcefhxxekaOhxavaiaH9RcsGcdtfydbhOkdndnaDTmbalcefhDxekalcdfhDal8SbegPcFeGhsdnaPcu9kmbalcofhAascFbGhscrhldninaD8SbbgPcFbGaltasVhsaPcu9kmeaDcefhDalcrfglc8J9hmbkaAhDxekaDcefhDkasce4cbasceG9R7amfgmhAkdndnaXcsSmbaDhsxekaDcefhsaD8SbbglcFeGhPdnalcu9kmbaDcvfhzaPcFbGhPcrhldninas8SbbgDcFbGaltaPVhPaDcu9kmeascefhsalcrfglc8J9hmbkazhsxekascefhskaPce4cbaPceG9R7amfgmhzkdndnaCcsSmbashlxekascefhlas8SbbgDcFeGhPdnaDcu9kmbascvfhOaPcFbGhPcrhDdninal8SbbgscFbGaDtaPVhPascu9kmealcefhlaDcrfgDc8J9hmbkaOhlxekalcefhlkaPce4cbaPceG9R7amfgmhOkdndnadcd9hmbabarcetfgDaA87ebaDclfaO87ebaDcdfaz87ebxekabarcdtfgDaABdbaDcwfaOBdbaDclfazBdbkavc;abfaocitfgDazBdbaDaABdlavaicdtfaABdbavc;abfaocefcsGcitfgDaOBdbaDazBdlavaicefgicsGcdtfazBdbavc;abfaocdfcsGcitfgDaABdbaDaOBdlavaiaHcz6aXcsSVfgicsGcdtfaOBdbaiaCTaCcsSVfhiaocifhokawcefhwaocsGhoaicsGhiarcifgrae6mbkkcbc99alaqSEhokavc;aef8Kjjjjbaok:clevu8Jjjjjbcz9Rhvdnaecvfal9nmbc9:skdnaiRbbc;:eGc;qeSmbcuskav9cb83iwaicefhoaialfc98fhrdnaeTmbdnadcdSmbcbhwindnaoar6mbc9:skaocefhlao8SbbgicFeGhddndnaicu9mmbalhoxekaocvfhoadcFbGhdcrhidninal8SbbgDcFbGaitadVhdaDcu9kmealcefhlaicrfgic8J9hmbxdkkalcefhokabawcdtfadc8Etc8F91adcd47avcwfadceGcdtVglydbfgiBdbalaiBdbawcefgwae9hmbxdkkcbhwindnaoar6mbc9:skaocefhlao8SbbgicFeGhddndnaicu9mmbalhoxekaocvfhoadcFbGhdcrhidninal8SbbgDcFbGaitadVhdaDcu9kmealcefhlaicrfgic8J9hmbxdkkalcefhokabawcetfadc8Etc8F91adcd47avcwfadceGcdtVglydbfgi87ebalaiBdbawcefgwae9hmbkkcbc99aoarSEk:2Pliur97eue978Jjjjjbc8W9Rhiaec98Ghldndnadcl9hmbdnalTmbcbhvabhdinadadpbbbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpkbbadczfhdavclfgval6mbkkalaeSmeaipxbbbbbbbbbbbbbbbbgqpklbaiabalcdtfgdaeciGglcdtgv;8qbbdnalTmbaiaipblbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDaqp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpklbkadaiav;8qbbskaipxFubbFubbFubbFubbgxpklbdnalTmbcbhvabhdinadczfgmampbbbgopxbbbbbbFFbbbbbbFFgkp9oadpbbbgDaopmbediwDqkzHOAKY8AEgwczp:Reczp:Sep;6egraipblbaDaopmlvorxmPsCXQL358E8Fp9op;6eawczp:Sep;6egwp;Gearp;Gep;Kep;Legopxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgPp9op9rp;Kegrpxb;:FSb;:FSb;:FSb;:FSararp;Meaoaop;MeawaqawaPp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFFbbFFbbFFbbFFbbp9oaoawp;Meaqp;Keczp:Rep9qgoarawp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogrpmwDKYqk8AExm35Ps8E8Fp9qpkbbadaDakp9oaoarpmbezHdiOAlvCXorQLp9qpkbbadcafhdavclfgval6mbkkalaeSmbaiczfpxbbbbbbbbbbbbbbbbgopklbaiaopklbaiabalcitfgdaeciGglcitgv;8qbbaiaxpkladnalTmbaiaipblzgopxbbbbbbFFbbbbbbFFgkp9oaipblbgDaopmbediwDqkzHOAKY8AEgwczp:Reczp:Sep;6egraipblaaDaopmlvorxmPsCXQL358E8Fp9op;6eawczp:Sep;6egwp;Gearp;Gep;Kep;Legopxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgPp9op9rp;Kegrpxb;:FSb;:FSb;:FSb;:FSararp;Meaoaop;MeawaqawaPp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFFbbFFbbFFbbFFbbp9oaoawp;Meaqp;Keczp:Rep9qgoarawp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogrpmwDKYqk8AExm35Ps8E8Fp9qpklzaiaDakp9oaoarpmbezHdiOAlvCXorQLp9qpklbkadaiav;8qbbkk;Iwllue97euo978Jjjjjbca9Rhidnaec98GglTmbcbhvabhoinaocKfpxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81ZaopbbbgraoczfgwpbbbgDpmlvorxmPsCXQL358E8Fgqczp:Segkpxibbbibbbibbbibbbp9qp;6ep;NegxaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meaxarczp:Sep;6ep;Megmamp;Meaxaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgxp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgPp9oamaxp;Mearp;Keczp:Rep9qgmaDaxp;Mearp;KeaPp9oaqaxp;Mearp;Keczp:Rep9qgrpmwDKYqk8AExm35Ps8E8FgDp5eakclp:RegxpEi:T:j83ibawaDp5baxpEd:T:j83ibaocwfamarpmbezHdiOAlvCXorQLgrp5eaxpEe:T:j83ibaoarp5baxpEb:T:j83ibaocafhoavclfgval6mbkkdnalaeSmbaiczfpxbbbbbbbbbbbbbbbbgxpklbaiaxpklbaiabalcitfgoaeciGgvcitgw;8qbbdnavTmbaipxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81ZaipblbgraipblzgDpmlvorxmPsCXQL358E8Fgqczp:Segkpxibbbibbbibbbibbbp9qp;6ep;NegxaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meaxarczp:Sep;6ep;Megmamp;Meaxaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgxp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgPp9oamaxp;Mearp;Keczp:Rep9qgmaDaxp;Mearp;KeaPp9oaqaxp;Mearp;Keczp:Rep9qgrpmwDKYqk8AExm35Ps8E8FgDp5eakclp:RegxpEi:T:j83iKaiaDp5baxpEd:T:j83izaiamarpmbezHdiOAlvCXorQLgrp5eaxpEe:T:j83iwaiarp5baxpEb:T:j83ibkaoaiaw;8qbbkk;uddiue978Jjjjjbc;ab9Rhidnadcd4ae2glc98GgvTmbcbheabhdinadadpbbbgocwp:Recwp:Sep;6eaocep:SepxbbjFbbjFbbjFbbjFp9opxbbjZbbjZbbjZbbjZp:Uep;Mepkbbadczfhdaeclfgeav6mbkkdnavalSmbaic8WfpxbbbbbbbbbbbbbbbbgopklbaicafaopklbaiczfaopklbaiaopklbaiabavcdtfgdalciGgecdtgv;8qbbdnaeTmbaiaipblbgocwp:Recwp:Sep;6eaocep:SepxbbjFbbjFbbjFbbjFp9opxbbjZbbjZbbjZbbjZp:Uep;Mepklbkadaiav;8qbbkk:CPvdue97euw97eu8Jjjjjbc8W9Rhiaec98Ghldndnadcl9hmbaipxbbbbbbbbbbbbbbbbgvpklbdnalTmbcbhoabhdinadpbbbhradpxbbuJbbuJbbuJbbuJaipblbarcKp:Tep9qgwcep:Seawp9qgDcdp:SeaDp9qgDclp:SeaDp9qgqp;6ep;NegDarcwp:RecKp:SegkarpxFbbbFbbbFbbbFbbbgxp9ogmp:Uep;6ep;Mepxbbn0bbn0bbn0bbn0gPp;Kecwp:RepxbFbbbFbbbFbbbFbbp9oaDamakp:Xearczp:RecKp:Segrp:Uep;6ep;MeaPp;Keaxp9op9qaDamakarp:Uep:Xep;6ep;MeaPp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qaDaqawcep:Rep9oawpxebbbebbbebbbebbbp9op9qp;6ep;MeaPp;KecKp:Rep9qpkbbadczfhdaoclfgoal6mbkkalaeSmeaiavpklaaicafabalcdtfgdaeciGglcdtgo;8qbbaiavpklbdnalTmbaipblahraipxbbuJbbuJbbuJbbuJaipblbarcKp:Tep9qgwcep:Seawp9qgDcdp:SeaDp9qgDclp:SeaDp9qgqp;6ep;NegDarcwp:RecKp:SegkarpxFbbbFbbbFbbbFbbbgxp9ogmp:Uep;6ep;Mepxbbn0bbn0bbn0bbn0gPp;Kecwp:RepxbFbbbFbbbFbbbFbbp9oaDamakp:Xearczp:RecKp:Segrp:Uep;6ep;MeaPp;Keaxp9op9qaDamakarp:Uep:Xep;6ep;MeaPp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qaDaqawcep:Rep9oawpxebbbebbbebbbebbbp9op9qp;6ep;MeaPp;KecKp:Rep9qpklakadaicafao;8qbbskaipxbbbbbbbbbbbbbbbbgvpklbdnalTmbcbhoabhdinadczfgspxbFu9hbFu9hbFu9hbFu9hadpbbbgDaspbbbgPpmlvorxmPsCXQL358E8Fgmczp:Teaipblbp9qgrcep:Searp9qgwcdp:Seawp9qgwclp:Seawp9qgwcwp:Seawp9qgqp;6ep;NegwaDaPpmbediwDqkzHOAKY8AEgDpxFFbbFFbbFFbbFFbbgPp9ogkaDczp:Segxp:Ueamczp:Reczp:Segmp:Xep;6ep;Mepxbbn0bbn0bbn0bbn0gDp;KeaPp9oawakaxamp:Uep:Xep;6ep;MeaDp;Keczp:Rep9qgxawaqarcep:Rep9oarpxebbbebbbebbbebbbp9op9qp;6ep;MeaDp;Keczp:Reawamakp:Uep;6ep;MeaDp;KeaPp9op9qgrpmwDKYqk8AExm35Ps8E8FpkbbadaxarpmbezHdiOAlvCXorQLpkbbadcafhdaoclfgoal6mbkkalaeSmbaiczfpxbbbbbbbbbbbbbbbbgrpklbaiarpklbaiabalcitfgdaeciGglcitgo;8qbbaiavpkladnalTmbaipxbFu9hbFu9hbFu9hbFu9haipblbgDaipblzgPpmlvorxmPsCXQL358E8Fgmczp:Teaipblap9qgrcep:Searp9qgwcdp:Seawp9qgwclp:Seawp9qgwcwp:Seawp9qgqp;6ep;NegwaDaPpmbediwDqkzHOAKY8AEgDpxFFbbFFbbFFbbFFbbgPp9ogkaDczp:Segxp:Ueamczp:Reczp:Segmp:Xep;6ep;Mepxbbn0bbn0bbn0bbn0gDp;KeaPp9oawakaxamp:Uep:Xep;6ep;MeaDp;Keczp:Rep9qgxawaqarcep:Rep9oarpxebbbebbbebbbebbbp9op9qp;6ep;MeaDp;Keczp:Reawamakp:Uep;6ep;MeaDp;KeaPp9op9qgrpmwDKYqk8AExm35Ps8E8FpklzaiaxarpmbezHdiOAlvCXorQLpklbkadaiao;8qbbkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaikkkebcjwklz:Dbb",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),i=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if(typeof WebAssembly!="object")return{supported:!1};var r=WebAssembly.validate(t)?o(e):o(a),s,n=WebAssembly.instantiate(r,{}).then(function(b){s=b.instance,s.exports.__wasm_call_ctors()});function o(b){for(var A=new Uint8Array(b.length),y=0;y<b.length;++y){var x=b.charCodeAt(y);A[y]=x>96?x-97:x>64?x-39:x+4}for(var E=0,y=0;y<b.length;++y)A[E++]=A[y]<60?i[A[y]]:(A[y]-60)*64+A[++y];return A.buffer.slice(0,E)}function c(b,A,y,x,E,I,w){var v=b.exports.sbrk,M=x+3&-4,C=v(M*E),D=v(I.length),S=new Uint8Array(b.exports.memory.buffer);S.set(I,D);var k=A(C,x,E,D,I.length);if(k==0&&w&&w(C,M,E),y.set(S.subarray(C,C+x*E)),v(C-v(0)),k!=0)throw new Error("Malformed buffer data: "+k)}var l={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp",COLOR:"meshopt_decodeFilterColor"},h={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"},d=[],f=0;function u(b){var A={object:new Worker(b),pending:0,requests:{}};return A.object.onmessage=function(y){var x=y.data;A.pending-=x.count,A.requests[x.id][x.action](x.value),delete A.requests[x.id]},A}function m(b){for(var A="self.ready = WebAssembly.instantiate(new Uint8Array(["+new Uint8Array(r)+"]), {}).then(function(result) { result.instance.exports.__wasm_call_ctors(); return result.instance; });self.onmessage = "+g.name+";"+c.toString()+g.toString(),y=new Blob([A],{type:"text/javascript"}),x=URL.createObjectURL(y),E=d.length;E<b;++E)d[E]=u(x);for(var E=b;E<d.length;++E)d[E].object.postMessage({});d.length=b,URL.revokeObjectURL(x)}function p(b,A,y,x,E){for(var I=d[0],w=1;w<d.length;++w)d[w].pending<I.pending&&(I=d[w]);return new Promise(function(v,M){var C=new Uint8Array(y),D=++f;I.pending+=b,I.requests[D]={resolve:v,reject:M},I.object.postMessage({id:D,count:b,size:A,source:C,mode:x,filter:E},[C.buffer])})}function g(b){var A=b.data;if(!A.id)return self.close();self.ready.then(function(y){try{var x=new Uint8Array(A.count*A.size);c(y,y.exports[A.mode],x,A.count,A.size,A.source,y.exports[A.filter]),self.postMessage({id:A.id,count:A.count,action:"resolve",value:x},[x.buffer])}catch(E){self.postMessage({id:A.id,count:A.count,action:"reject",value:E})}})}return{ready:n,supported:!0,useWorkers:function(b){m(b)},decodeVertexBuffer:function(b,A,y,x,E){c(s,s.exports.meshopt_decodeVertexBuffer,b,A,y,x,s.exports[l[E]])},decodeIndexBuffer:function(b,A,y,x){c(s,s.exports.meshopt_decodeIndexBuffer,b,A,y,x)},decodeIndexSequence:function(b,A,y,x){c(s,s.exports.meshopt_decodeIndexSequence,b,A,y,x)},decodeGltfBuffer:function(b,A,y,x,E,I){c(s,s.exports[h[E]],b,A,y,x,s.exports[l[I]])},decodeGltfBufferAsync:function(b,A,y,x,E){return d.length>0?p(b,A,y,h[x],l[E]):n.then(function(){var I=new Uint8Array(b*A);return c(s,s.exports[h[x]],I,b,A,y,s.exports[l[E]]),I})}}})();(function(){var a="b9H79Tebbbe:Gez9Geueu9Geub9Gbb9Gsuuuuuuuuuuuu99uueu9Gvuuuuub9Gruuuuuuub9Gouuuuuue999Gvuuuuueu9Gquuuuuuu99uueu9GPuuuuuuuuuuu99uueu9Gquuuuuuuu99ueu9Gruuuuuu99eu9Gwuuuuuu99ueu9Giuuue999Gluuuueu9GiuuueuiXCdilvorlwiDqkxmPbssbelve9Weiiviebeoweuec:G:Pdkr;7eko9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bbz9TW79O9V9Wt9F79P9T9W29P9M95br8E9TW79O9V9Wt9F79P9T9W29P9M959x9Pt9OcttV9P9I91tW7bw8A9TW79O9V9Wt9F79P9T9W29P9M959x9Pt9O9v9W9K9HtWbDQ9TW79O9V9Wt9F79P9T9W29P9M959t29V9W9W95bqX9TW79O9V9Wt9F79P9T9W29P9M959qV919UWbkQ9TW79O9V9Wt9F79P9T9W29P9M959q9V9P9Ut7bxX9TW79O9V9Wt9F79P9T9W29P9M959t9J9H2Wbma9TW79O9V9Wt9F9V9Wt9P9T9P96W9wWVtW94SWt9J9O9sW9T9H9WbPl79IV9RbsDwebcekdOAq:d;OeCdbk:J1eo3ue99euE99Cue9:8Jjjjjbcj;sb9Rgs8Kjjjjbcbhzasc:Cefcbc;Kbz:rjjjb8AdnabaeSmbabaeadcdtz:qjjjb8AkdnamcdGTmbalcrfci4gHcbyd1:jjjbHjjjjbbheasc:Cefasyd;8egOcdtfaeBdbasaOcefBd;8eaecbaHz:rjjjbhAcbhlcbhednadTmbcbhlabheadhHinaAaeydbgOci4fgCaCRbbgCceaOcrGgOtV86bbaCcu7aO4ceGalfhlaeclfheaHcufgHmbkcualcdtalcFFFFi0Ehekaecbyd1:jjjbHjjjjbbhzasc:Cefasyd;8egecdtfazBdbasaecefBd;8ealcd4alfhOcehHinaHgecethHaeaO6mbkcbhXcuaecdtgOaecFFFFi0Ecbyd1:jjjbHjjjjbbhHasc:Cefasyd;8egCcdtfaHBdbasaCcefBd;8eaHcFeaOz:rjjjbhQdnadTmbaecufhLcbhKindndnaQabaXcdtfgYydbgCc:v;t;h;Ev2aLGgOcdtfgAydbgHcuSmbceheinazaHcdtfydbaCSmdaOaefhHaecefheaQaHaLGgOcdtfgAydbgHcu9hmbkkazaKcdtfaCBdbaAaKBdbaKhHaKcefhKkaYaHBdbaXcefgXad9hmbkkaQcbyd:m:jjjbH:bjjjbbasasyd;8ecufBd;8ekcbh8AcualcefgecdtaecFFFFi0Ecbyd1:jjjbHjjjjbbhKasc:Cefasyd;8egecdtfaKBdbasaKBdNeasaecefBd;8ecuadcitadcFFFFe0Ecbyd1:jjjbHjjjjbbhEasc:Cefasyd;8egecdtfaEBdbasaEBd:yeasaecefBd;8eascNefabadalcbz:cjjjbcualcdtgealcFFFFi0Eg3cbyd1:jjjbHjjjjbbhCasc:Cefasyd;8egHcdtfaCBdbasaHcefBd;8ea3cbyd1:jjjbHjjjjbbhYasc:Cefasyd;8egHcdtfaYBdbasaHcefBd;8eaCaYaialavazasc:Cefz:djjjbalcbyd1:jjjbHjjjjbbh5asc:Cefasyd;8egHcdtfa5BdbasaHcefBd;8ea3cbyd1:jjjbHjjjjbbhHasc:Cefasyd;8egOcdtfaHBdbasaOcefBd;8ea3cbyd1:jjjbHjjjjbbhOasc:Cefasyd;8egAcdtfaOBdbasaAcefBd;8eaHcFeaez:rjjjbh8EaOcFeaez:rjjjbh8FdnalTmbaEcwfhaindnaKa8AgOcefg8AcdtfydbgAaKaOcdtgefydbgHSmbaAaH9RhhaEaHcitfhga8Faefh8Ja8Eaefh8KcbhQindndnagaQcitfydbgLaO9hmba8KaOBdba8JaOBdbxekdnaKaLcdtg8LfgeclfydbgHaeydbgeSmbaEaecitgAfydbaOSmeaHae9Rh8Maecu7aHfhXaaaAfhHcbheinaXaeSmeaecefheaHydbhAaHcwfhHaAaO9hmbkaea8M6meka8Fa8LfgeaOaLaeydbcuSEBdba8KaLaOa8KydbcuSEBdbkaQcefgQah9hmbkka8Aal9hmbkaChHaYhOa8FhAa8EhQcbheindndnaeaHydbgL9hmbdnaeaOydbgL9hmbaQydbhLdnaAydbgXcu9hmbaLcu9hmba5aefcb86bbxikdnaXcuSmbaLcuSmbaeaXSmbaCaXcdtfydbaCaLcdtfydb9hmba5aefcd86bbxika5aefh8KdnaeaXSmbaeaLSmba8Kce86bbxika8Kcl86bbxdkdnaeaYaLcdtgXfydb9hmbdnaAydbg8KcuSmbaea8KSmbaQydbghcuSmbaeahSmba8FaXfydbggcuSmbagaLSmba8EaXfydbgXcuSmbaXaLSmbdnaCa8KcdtfydbgLaCaXcdtfydb9hmbaLaCahcdtfydbgXSmbaXaCagcdtfydb9hmba5aefcd86bbxlka5aefcl86bbxika5aefcl86bbxdka5aefcl86bbxeka5aefa5aLfRbb86bbkaHclfhHaOclfhOaAclfhAaQclfhQalaecefge9hmbkdnamcaGTmbaEcwfh8Jcbh8Nindndna5a8NfgyRbbg8Pc9:fPibebekdndndnaCa8Ncdtfydbgea8N9hmbdnaqmbcbhgxdkdnazTmbcbhga8NheinagaqazaecdtgefydbfRbbcdGce4VhgaYaefydbgea8N9hmbxikkcbhga8NheinagaqaefRbbcdGce4VhgaYaecdtfydbgea8N9hmbxdkka5aefRbbhexeka8NheindnaKaecdtgafgeclfydbgHaeydbgeSmbaHae9Rh8AaEaecitfh8MaCaafh8Lcbh8Kina8Ma8KcitfydbgXhednindnaKaecdtgLfgeclfydbgHaeydbgeSmbdnaCaEaecitgOfydbcdtfydba8LydbgQ9hmbcehexikaHae9Rhhaecu7aHfhAa8JaOfhHcbheinaAaeSmeaecefheaHydbhOaHcwfhHaCaOcdtfydbaQ9hmbkaeah6hexdkaYaLfydbgeaX9hmbkcbhekagaece7Vhga8Kcefg8Ka8A9hmbkkaYaafydbgea8N9hmbka8PciagceGEhekayae86bbka8Ncefg8Nal9hmbkkdnaqTmbdndnazTmbazheaChHalhOindnaqaeydbfRbbceGTmba5aHydbfcl86bbkaeclfheaHclfhHaOcufgOmbxdkkaChealhHindnaqRbbceGTmba5aeydbfcl86bbkaqcefhqaeclfheaHcufgHmbkkaChealhOa5hHindna5aeydbfRbbcl9hmbaHcl86bbkaeclfheaHcefhHaOcufgOmbkkamceGTmba5healhHindnaeRbbce9hmbaecl86bbkaecefheaHcufgHmbkkcbhIcualcx2alc;v:Q;v:Qe0Ecbyd1:jjjbHjjjjbbhaasc:Cefasyd;8egecdtfaaBdbasaecefBd;8easc:qefcbBdbas9cb83i1eaaaialavazasc1efz:ejjjbh8RdndnaDmbcbh8Scbh8Lxekcbh8LawhecbhHindnaeIdbJbbbb9ETmbasa8LcdtfaHBdba8Lcefh8LkaeclfheaDaHcefgH9hmbkcua8Lal2gecdtaecFFFFi0Ecbyd1:jjjbHjjjjbbh8Sasc:Cefasyd;8egecdtfa8SBdbasaecefBd;8ealTmbdna8Lmbcbh8Lxekarcd4hXdnazTmba8Lcdth8KcbhLa8ShKinaoazaLcdtfydbaX2cdtfhQasheaKhHa8LhOinaHaQaeydbcdtgAfIdbawaAfIdbNUdbaeclfheaHclfhHaOcufgOmbkaKa8KfhKaLcefgLal9hmbxdkka8Lcdth8KcbhLa8ShKinaoaLaX2cdtfhQasheaKhHa8LhOinaHaQaeydbcdtgAfIdbawaAfIdbNUdbaeclfheaHclfhHaOcufgOmbkaKa8KfhKaLcefgLal9hmbkkcualc8S2gHalc;D;O;f8U0EgAcbyd1:jjjbHjjjjbbheasc:Cefasyd;8egOcdtfaeBdbasaOcefBd;8eaecbaHz:rjjjbhycbhqcbh8Ndna8LTmbcbhIaAcbyd1:jjjbHjjjjbbh8Nasc:Cefasyd;8egecdtfa8NBdbasaecefBd;8ea8NcbaHz:rjjjb8Acua8Lal2gecltgHaecFFFFb0Ecbyd1:jjjbHjjjjbbhqasc:Cefasyd;8egecdtfaqBdbasaecefBd;8eaqcbaHz:rjjjb8AamcjjjjdGTmbcualcltgealcFFFFb0Ecbyd1:jjjbHjjjjbbhIasc:Cefasyd;8egHcdtfaIBdbasaHcefBd;8eaIcbaez:rjjjb8AkdnadTmbcbhQabhHinaaaHclfydbgLcx2fgeIdbaaaHydbgKcx2fgOIdbgR:tg8UaaaHcwfydbgXcx2fgAIdlaOIdlg8V:tg8WNaAIdbaR:tg8XaeIdla8V:tg8YN:tg8Zh80aeIdwaOIdwg81:tgBa8XNaAIdwa81:tg83a8UN:tgUh8Xa8Ya83Na8WaBN:tg8Yh8Udna8Za8ZNa8Ya8YNaUaUNMM:rgBJbbbb9EgOTmba8ZaB:vh80aUaB:vh8Xa8YaB:vh8UkayaCaKcdtfydbgAc8S2fgea8UaB:rg8Wa8UNNg85aeIdbMUdbaea8Xa8Wa8XNg86Ng87aeIdlMUdlaea80a8Wa80Ng83Ng88aeIdwMUdwaea86a8UNg86aeIdxMUdxaea83a8UNg89aeIdzMUdzaea83a8XNg8:aeIdCMUdCaea8Ua8Wa80a81Na8UaRNa8Va8XNMM:mgZNg83Ng8UaeIdKMUdKaea8Xa83Ng8XaeId3MUd3aea80a83Ng80aeIdaMUdaaea83aZNg83aeId8KMUd8Kaea8WaeIdyMUdyayaCaLcdtfydbgLc8S2fgea85aeIdbMUdbaea87aeIdlMUdlaea88aeIdwMUdwaea86aeIdxMUdxaea89aeIdzMUdzaea8:aeIdCMUdCaea8UaeIdKMUdKaea8XaeId3MUd3aea80aeIdaMUdaaea83aeId8KMUd8Kaea8WaeIdyMUdyayaCaXcdtfydbgKc8S2fgea85aeIdbMUdbaea87aeIdlMUdlaea88aeIdwMUdwaea86aeIdxMUdxaea89aeIdzMUdzaea8:aeIdCMUdCaea8UaeIdKMUdKaea8XaeId3MUd3aea80aeIdaMUdaaea83aeId8KMUd8Kaea8WaeIdyMUdydnaITmbdnaOTmba8ZaB:vh8ZaUaB:vhUa8YaB:vh8YkaIaAcltfgeaBJbbbZNg8UaUNg8WaeIdlMUdlaea8Ua8ZNg8XaeIdwMUdwaea8Ua8YNg80aeIdbMUdbaea8UaR:ma8YNaUa8VN:ta81a8ZN:tNg8UaeIdxMUdxaIaLcltfgea8WaeIdlMUdlaea8XaeIdwMUdwaea80aeIdbMUdbaea8UaeIdxMUdxaIaKcltfgea8WaeIdlMUdlaea8XaeIdwMUdwaea80aeIdbMUdbaea8UaeIdxMUdxkaHcxfhHaQcifgQad6mbkkdnalTmbJ;n;m;m89J:v:;;w8ZamczGEh8YcbhOaChAaahHayheindnaOaAydb9hmbaecxfgQaQIdbJbbbbMUdbaeczfgQaQIdbJbbbbMUdbaecCfgQaQIdbJbbbbMUdbaea8YaecyfgQIdbg8ZNg8UaeIdbMUdbaeclfgLa8UaLIdbMUdbaecwfgLa8UaLIdbMUdbaecKfgLaLIdbaHIdbg8Xa8UN:tUdbaHcwfIdbh8Waec3fgLaLIdba8UaHclfIdbg80N:tUdbaecafgLaLIdba8Ua8WN:tUdbaec8KfgLIdbhUaQa8Za8UMUdbaLaUa8Ua8Wa8WNa8Xa8XNa80a80NMMNMUdbkaAclfhAaHcxfhHaec8SfhealaOcefgO9hmbkkdnadTmbcbhXabhKinabaXcdtfhLcbhHina5aLaHc:G1jjbfydbcdtfydbgOfRbbhedndna5aKaHfydbgAfRbbgQc99fcFeGcpe0mbaec99fcFeGc;:e6mekdnaQcufcFeGce0mba8EaAcdtfydbaO9hmekdnaecufcFeGce0mba8FaOcdtfydbaA9hmekJbbacJbbacJbbbZaecFeGceSEaQcFeGceSEh88aaaOcx2fgeIdwaaaAcx2fgQIdwgB:tg80:mh86aeIdlaQIdlg83:tg8Z:mh89aeIdbaQIdbgR:tgU:mh8:dnaaaLaHc:K1jjbfydbcdtfydbcx2fgeIdwaB:tg8Va80a80NaUaUNa8Za8ZNMMg8YNa8Va80NaeIdbaR:tg81aUNa8ZaeIdla83:tg85NMMg8Wa80N:tg8Xa8XNa81a8YNa8WaUN:tg8Ua8UNa85a8YNa8Wa8ZN:tg8Wa8WNMM:rg87Jbbbb9ETmba8Xa87:vh8Xa8Wa87:vh8Wa8Ua87:vh8Uka88a8Y:rNg8Ya8XaBNa8UaRNa83a8WNMM:mgZNg87aZNhZa8Xa87Nhna8Wa87Nhca8Ua87Nh9ca8Ya8XNg87a8WNhJa87a8UNh9ea8Ya8WNgTa8UNhSa8Xa87Nh87a8WaTNhTa8Ua8Ya8UNNh9hdnaUa85Na81a89NMg8Xa8XNa8Za8VNa85a86NMg8Ua8UNa80a81Na8Va8:NMg8Wa8WNMM:rg80Jbbbb9ETmba8Xa80:vh8Xa8Wa80:vh8Wa8Ua80:vh8UkayaCaAcdtfydbc8S2fgeaeIdba9ha8Ua88a80:rNg80a8UNNMgUMUdbaeaTa8Wa80a8WNg8VNMg81aeIdlMUdlaea87a8Xa80a8XNg8ZNMg85aeIdwMUdwaeaSa8Va8UNMg8VaeIdxMUdxaea9ea8Za8UNMg87aeIdzMUdzaeaJa8Za8WNMg8ZaeIdCMUdCaea9ca8Ua80a8XaBNa8UaRNa83a8WNMMgB:mNg80NMg8UaeIdKMUdKaeaca8Wa80NMg8WaeId3MUd3aeana8Xa80NMg8XaeIdaMUdaaeaZaBa80N:tg80aeId8KMUd8Kaea8YJbbbbMg8YaeIdyMUdyayaCaOcdtfydbc8S2fgeaUaeIdbMUdbaea81aeIdlMUdlaea85aeIdwMUdwaea8VaeIdxMUdxaea87aeIdzMUdzaea8ZaeIdCMUdCaea8UaeIdKMUdKaea8WaeId3MUd3aea8XaeIdaMUdaaea80aeId8KMUd8Kaea8YaeIdyMUdykaHclfgHcx9hmbkaKcxfhKaXcifgXad6mbka8LTmbcbhKinJbbbbh8YaaabaKcdtfgeclfydbgXcx2fgHIdwaaaeydbg8Kcx2fgOIdwg81:tg8Wa8WNaHIdbaOIdbg85:tg8Xa8XNaHIdlaOIdlg87:tg80a80NMMgRaaaecwfydbghcx2fgeIdwa81:tg8ZNa8Wa8Wa8ZNa8XaeIdba85:tgUNa80aeIdla87:tgBNMMg8UN:tJbbbbJbbjZaRa8Za8ZNaUaUNaBaBNMMg8VNa8Ua8UN:tg83:va83Jbbbb9BEg83Nh89a8Va8WNa8Za8UN:ta83Nh8:aRaBNa80a8UN:ta83NhZa8Va80NaBa8UN:ta83NhnaRaUNa8Xa8UN:ta83Nhca8Va8XNaUa8UN:ta83Nh9ca8XaBNaUa80N:tg8Ua8UNa80a8ZNaBa8WN:tg8Ua8UNa8WaUNa8Za8XN:tg8Ua8UNMM:rJbbbZNh8Ua8Sa8Ka8L2ggcdtfhHa8Saha8L2gEcdtfhOa8SaXa8L2g8JcdtfhAa81:mhJa87:mh9ea85:mhTcbhQa8LhLJbbbbhBJbbbbh83JbbbbhRJbbbbh8VJbbbbh81Jbbbbh85Jbbbbh87Jbbbbh88Jbbbbh86inascjdfaQfgecwfa8Ua8:aAIdbaHIdbg8Z:tg80Na89aOIdba8Z:tgUNMg8WNUdbaeclfa8Uana80NaZaUNMg8XNUdbaea8Ua9ca80NacaUNMg80NUdbaecxfa8UaJa8WNa9ea8XNa8ZaTa80NMMMg8ZNUdba8Ua8Wa8XNNa8VMh8Va8Ua8Wa80NNa81Mh81a8Ua8Xa80NNa85Mh85a8Ua8Za8ZNNa8YMh8Ya8Ua8Wa8ZNNaBMhBa8Ua8Xa8ZNNa83Mh83a8Ua80a8ZNNaRMhRa8Ua8Wa8WNNa87Mh87a8Ua8Xa8XNNa88Mh88a8Ua80a80NNa86Mh86aHclfhHaAclfhAaOclfhOaQczfhQaLcufgLmbka8Na8Kc8S2fgea86aeIdbMUdbaea88aeIdlMUdlaea87aeIdwMUdwaea85aeIdxMUdxaea81aeIdzMUdzaea8VaeIdCMUdCaeaRaeIdKMUdKaea83aeId3MUd3aeaBaeIdaMUdaaea8YaeId8KMUd8Kaea8UaeIdyMUdya8NaXc8S2fgea86aeIdbMUdbaea88aeIdlMUdlaea87aeIdwMUdwaea85aeIdxMUdxaea81aeIdzMUdzaea8VaeIdCMUdCaeaRaeIdKMUdKaea83aeId3MUd3aeaBaeIdaMUdaaea8YaeId8KMUd8Kaea8UaeIdyMUdya8Nahc8S2fgea86aeIdbMUdbaea88aeIdlMUdlaea87aeIdwMUdwaea85aeIdxMUdxaea81aeIdzMUdzaea8VaeIdCMUdCaeaRaeIdKMUdKaea83aeId3MUd3aeaBaeIdaMUdaaea8YaeId8KMUd8Kaea8UaeIdyMUdyaqagcltfhLcbhHa8LhAinaLaHfgeascjdfaHfgOIdbaeIdbMUdbaeclfgQaOclfIdbaQIdbMUdbaecwfgQaOcwfIdbaQIdbMUdbaecxfgeaOcxfIdbaeIdbMUdbaHczfhHaAcufgAmbkaqa8JcltfhLcbhHa8LhAinaLaHfgeascjdfaHfgOIdbaeIdbMUdbaeclfgQaOclfIdbaQIdbMUdbaecwfgQaOcwfIdbaQIdbMUdbaecxfgeaOcxfIdbaeIdbMUdbaHczfhHaAcufgAmbkaqaEcltfhLcbhHa8LhAinaLaHfgeascjdfaHfgOIdbaeIdbMUdbaeclfgQaOclfIdbaQIdbMUdbaecwfgQaOcwfIdbaQIdbMUdbaecxfgeaOcxfIdbaeIdbMUdbaHczfhHaAcufgAmbkaKcifgKad6mbkkcbhOdndnamcwGg9imbJbbbbh85cbh6cbh9kcbh0xekcbh6a3cbyd1:jjjbHjjjjbbh0asc:Cefasyd;8egecdtfa0BdbasaecefBd;8ecua0alabadaCz:fjjjbgAcltaAcjjjjiGEcbyd1:jjjbHjjjjbbh9kasc:Cefasyd;8egecdtfa9kBdbasaecefBd;8ea9kaAa0aaalz:gjjjbJFFuuh85aATmba9kheaAhHinaeIdbg8Ua85a85a8U9EEh85aeclfheaHcufgHmbkaAh6kasydNeh9mdnalTmba9mclfhea9mydbhAa5hHalhQcbhOincbaeydbgLaA9RaHRbbcpeGEaOfhOaHcefhHaeclfheaLhAaQcufgQmbkaOce4hOkcuadaO9Rcifg9ncx2a9nc;v:Q;v:Qe0Ecbyd1:jjjbHjjjjbbh8Pasc:Cefasyd;8egecdtfa8PBdbasaecefBd;8ecua9ncdta9ncFFFFi0Ecbyd1:jjjbHjjjjbbh9oasc:Cefasyd;8egecdtfa9oBdbasaecefBd;8ea3cbyd1:jjjbHjjjjbbhDasc:Cefasyd;8egecdtfaDBdbasaecefBd;8ealcbyd1:jjjbHjjjjbbh9pasc:Cefasyd;8egecdtfa9pBdbasaecefBd;8eaxaxNa8RJbbjZamclGEgnanN:vh88Jbbbbh86dnadak9nmbdna9nci6mbasyd:yeh9qa8Lclth9ra8Pcwfh9sJbbbbh87Jbbbbh86inascNefabadalaCz:cjjjbabh8Kcbh8Mcbh3inaba3cdtfhgcbheindnaCa8KaefydbgOcdtgXfydbgAaCagaec:W1jjbfydbcdtfydbgHcdtghfydbgQSmba5aHfRbbgKcv2a5aOfRbbgLfc;a1jjbfRbbg8JaLcv2aKfgEc;a1jjbfRbbg8AVcFeGTmbdnaQaA9nmbaEc;G1jjbfRbbcFeGmekdnaLcufcFeGce0mbaKTmba8EaXfydbaH9hmekdnaLTmbaKcufcFeGce0mba8FahfydbaO9hmeka8Pa8Mcx2fgAaHaOa8AcFeGgQEBdlaAaOaHaQEBdbaAaQa8JGcb9hBdwa8Mcefh8Mkaeclfgecx9hmbkdna3cifg3ad9pmba8Kcxfh8Ka8Mcifa9n9nmekka8MTmdcbhhinayaCa8Pahcx2fgKydbgQcdtgAfydbc8S2fgeIdwaaaKydlgLcx2fgHIdwg8XNaeIdzaHIdbg80NaeIdaMg8Ua8UMMa8XNaeIdlaHIdlg8ZNaeIdCa8XNaeId3Mg8Ua8UMMa8ZNaeIdba80NaeIdxa8ZNaeIdKMg8Ua8UMMa80NaeId8KMMM:lh8UJbbbbJbbjZaeIdyg8W:va8WJbbbb9BEh8WdndnaKydwg8KmbJFFuuh81xekJbbbbJbbjZayaCaLcdtfydbc8S2fgeIdygU:vaUJbbbb9BEaeIdwaaaQcx2fgHIdwgUNaeIdzaHIdbg8YNaeIdaMgBaBMMaUNaeIdlaHIdlgBNaeIdCaUNaeId3MgUaUMMaBNaeIdba8YNaeIdxaBNaeIdKMgUaUMMa8YNaeId8KMMM:lNh81ka8Wa8UNh8Vdna8LTmba8NaQc8S2fgHIdwa8XNaHIdza80NaHIdaMg8Ua8UMMa8XNaHIdla8ZNaHIdCa8XNaHId3Mg8Ua8UMMa8ZNaHIdba80NaHIdxa8ZNaHIdKMg8Ua8UMMa80NaHId8KMMMh8UaqaQa8L2ggcltfheaHIdyhUa8SaLa8L2gEcdtfgXhHa8LhOinaHIdbg8Wa8WaUNaecxfIdba8XaecwfIdbNa80aeIdbNa8ZaeclfIdbNMMMg8Wa8WM:tNa8UMh8UaHclfhHaeczfheaOcufgOmbkdndna8KmbJbbbbh8Wxeka8NaLc8S2fgOIdwaaaQcx2fgeIdwg8YNaOIdzaeIdbgBNaOIdaMg8Wa8WMMa8YNaOIdlaeIdlg83NaOIdCa8YNaOId3Mg8Wa8WMMa83NaOIdbaBNaOIdxa83NaOIdKMg8Wa8WMMaBNaOId8KMMMh8Wa8SagcdtfhHaqaEcltfheaOIdyhRa8LhOinaHIdbgUaUaRNaecxfIdba8YaecwfIdbNaBaeIdbNa83aeclfIdbNMMMgUaUM:tNa8WMh8WaHclfhHaeczfheaOcufgOmbka8W:lh8Wka8Va8U:lMh8Va81a8WMh81dndndna5aQfRbbc9:fPdbedkdna8Fa8Ea8EaAfydbaLSEaYaAfydbgXcdtfydbgAcu9hmbaYaLcdtfydbhAka8NaXc8S2fgOIdwaaaAcx2fgeIdwg8XNaOIdzaeIdbg80NaOIdaMg8Ua8UMMa8XNaOIdlaeIdlg8ZNaOIdCa8XNaOId3Mg8Ua8UMMa8ZNaOIdba80NaOIdxa8ZNaOIdKMg8Ua8UMMa80NaOId8KMMMh8Ua8SaAa8L2ggcdtfhHaqaXa8L2gEcltfheaOIdyhUa8LhOinaHIdbg8Wa8WaUNaecxfIdba8XaecwfIdbNa80aeIdbNa8ZaeclfIdbNMMMg8Wa8WM:tNa8UMh8UaHclfhHaeczfheaOcufgOmbkdndna8KmbJbbbbh8Wxeka8NaAc8S2fgOIdwaaaXcx2fgeIdwg80NaOIdzaeIdbg8ZNaOIdaMg8Wa8WMMa80NaOIdlaeIdlgUNaOIdCa80NaOId3Mg8Wa8WMMaUNaOIdba8ZNaOIdxaUNaOIdKMg8Wa8WMMa8ZNaOId8KMMMh8Wa8SaEcdtfhHaqagcltfheaOIdyh8Ya8LhOinaHIdbg8Xa8Xa8YNaecxfIdba80aecwfIdbNa8ZaeIdbNaUaeclfIdbNMMMg8Xa8XM:tNa8WMh8WaHclfhHaeczfheaOcufgOmbka8W:lh8Wka8Va8U:lMh8Va81a8WMh81xdkaYaAfydbgAaQSmbina8NaAc8S2fgHIdwa8XNaHIdza80NaHIdaMg8Ua8UMMa8XNaHIdla8ZNaHIdCa8XNaHId3Mg8Ua8UMMa8ZNaHIdba80NaHIdxa8ZNaHIdKMg8Ua8UMMa80NaHId8KMMMh8UaqaAa8L2cltfheaHIdyhUaXhHa8LhOinaHIdbg8Wa8WaUNaecxfIdba8XaecwfIdbNa80aeIdbNa8ZaeclfIdbNMMMg8Wa8WM:tNa8UMh8UaHclfhHaeczfheaOcufgOmbka8Va8U:lMh8VaYaAcdtfydbgAaQ9hmbkka5aLfRbbci9hmba8KTmbaYaLcdtfydbgAaLSmba8SagcdtfhXaaaQcx2fgeIdbh8XaeIdwh80aeIdlh8Zina8NaAc8S2fgHIdwa80NaHIdza8XNaHIdaMg8Ua8UMMa80NaHIdla8ZNaHIdCa80NaHId3Mg8Ua8UMMa8ZNaHIdba8XNaHIdxa8ZNaHIdKMg8Ua8UMMa8XNaHId8KMMMh8UaqaAa8L2cltfheaHIdyhUaXhHa8LhOinaHIdbg8Wa8WaUNaecxfIdba80aecwfIdbNa8XaeIdbNa8ZaeclfIdbNMMMg8Wa8WM:tNa8UMh8UaHclfhHaeczfheaOcufgOmbka81a8U:lMh81aYaAcdtfydbgAaL9hmbkkaKa81a8Va81a8V9DgeEUdwaKaQaLaea8Kcb9hGgeEBdlaKaLaQaeEBdbahcefgha8M9hmbkascjdfcbcj;qbz:rjjjb8Aa9shea8MhHinascjdfaeydbcA4cF8FGgOcFAaOcFA6EcdtfgOaOydbcefBdbaecxfheaHcufgHmbkcbhecbhHinascjdfaefgOydbhAaOaHBdbaAaHfhHaeclfgecj;qb9hmbkcbhea9shHinascjdfaHydbcA4cF8FGgOcFAaOcFA6EcdtfgOaOydbgOcefBdba9oaOcdtfaeBdbaHcxfhHa8Maecefge9hmbkadak9RgOci9Uh9tdnalTmbcbheaDhHinaHaeBdbaHclfhHalaecefge9hmbkkcbh9ua9pcbalz:rjjjbh3aOcO9Uh9va9tce4h9wcbh8Acbh8Jdnina8Pa9oa8Jcdtfydbcx2fgEIdwg8Ua889Emea8Aa9t9pmeJFFuuh8Wdna9wa8M9pmba8Pa9oa9wcdtfydbcx2fIdwJbb;aZNh8Wkdna8Ua8W9ETmba8Ua869ETmba8Aa9v0mdkdna3aCaEydlghcdtg9xfydbgAfg9yRbba3aCaEydbg8Kcdtg9zfydbgefg9ARbbVmba5a8KfRbbh9Bdna9maecdtfgHclfydbgOaHydbgHSmbaOaH9RhQaaaAcx2fhKaaaecx2fhXa9qaHcitfhecbhHcehgdnindnaDaeydbcdtfydbgOaASmbaDaeclfydbcdtfydbgLaASmbaOaLSmbaaaLcx2fgLIdbaaaOcx2fgOIdbg8X:tg8UaXIdlaOIdlg80:tg8YNaXIdba8X:tgBaLIdla80:tg8WN:tg8Za8UaKIdla80:tg83NaKIdba8X:tgRa8WN:tg80Na8WaXIdwaOIdwgU:tg8VNa8YaLIdwaU:tg8XN:tg8Ya8WaKIdwaU:tg81Na83a8XN:tg8WNa8XaBNa8Va8UN:tgUa8XaRNa81a8UN:tg8UNMMa8Za8ZNa8Ya8YNaUaUNMMa80a80Na8Wa8WNa8Ua8UNMMN:rJbbj8:N9FmdkaecwfheaHcefgHaQ6hgaQaH9hmbkkagceGTmba9wcefh9wxekdndndndna9Bc9:fPdebdka8KheinaDaecdtgefahBdbaYaefydbgea8K9hmbxikkdna8Fa8Ea8Ea9zfydbahSEaYa9zfydbg8Kcdtfydbgecu9hmbaYa9xfydbhekaDa9zfahBdbaehhkaDa8KcdtfahBdbka9Ace86bba9yce86bbaEIdwg8Ua86a86a8U9DEh86a9ucefh9ucecda9BceSEa8Afh8Aka8Jcefg8Ja8M9hmbkka9uTmddnalTmbcbhLcbhXindnaDaXcdtgefydbgOaXSmbaCaOcdtfydbh8KdnaXaCaefydb9hghmbaya8Kc8S2fgeayaXc8S2fgHIdbaeIdbMUdbaeaHIdlaeIdlMUdlaeaHIdwaeIdwMUdwaeaHIdxaeIdxMUdxaeaHIdzaeIdzMUdzaeaHIdCaeIdCMUdCaeaHIdKaeIdKMUdKaeaHId3aeId3MUd3aeaHIdaaeIdaMUdaaeaHId8KaeId8KMUd8KaeaHIdyaeIdyMUdyaITmbaIa8KcltfgeaIaXcltfgHIdbaeIdbMUdbaeaHIdlaeIdlMUdlaeaHIdwaeIdwMUdwaeaHIdxaeIdxMUdxka8LTmba8NaOc8S2fgea8NaXc8S2ggfgHIdbaeIdbMUdbaeaHIdlaeIdlMUdlaeaHIdwaeIdwMUdwaeaHIdxaeIdxMUdxaeaHIdzaeIdzMUdzaeaHIdCaeIdCMUdCaeaHIdKaeIdKMUdKaeaHId3aeId3MUd3aeaHIdaaeIdaMUdaaeaHId8KaeId8KMUd8KaeaHIdyaeIdyMUdya9raO2hKaqhHa8LhAinaHaKfgeaHaLfgOIdbaeIdbMUdbaeclfgQaOclfIdbaQIdbMUdbaecwfgQaOcwfIdbaQIdbMUdbaecxfgeaOcxfIdbaeIdbMUdbaHczfhHaAcufgAmbkahmbJbbbbJbbjZayagfgeIdyg8U:va8UJbbbb9BEaeIdwaaa8Kcx2fgHIdwg8UNaeIdzaHIdbg8WNaeIdaMg8Xa8XMMa8UNaeIdlaHIdlg8XNaeIdCa8UNaeId3Mg8Ua8UMMa8XNaeIdba8WNaeIdxa8XNaeIdKMg8Ua8UMMa8WNaeId8KMMM:lNg8Ua87a87a8U9DEh87kaLa9rfhLaXcefgXal9hmbkcbhHa8EheindnaeydbgOcuSmbdnaHaDaOcdtgAfydbgO9hmbcuhOa8EaAfydbgAcuSmbaDaAcdtfydbhOkaeaOBdbkaeclfhealaHcefgH9hmbkcbhHa8FheindnaeydbgOcuSmbdnaHaDaOcdtgAfydbgO9hmbcuhOa8FaAfydbgAcuSmbaDaAcdtfydbhOkaeaOBdbkaeclfhealaHcefgH9hmbkka87a86a8LEh87cbhHabhecbhOindnaCaDaeydbcdtfydbgLcdtfydbgAaCaDaeclfydbcdtfydbgKcdtfydbgQSmbaAaCaDaecwfydbcdtfydbg8KcdtfydbgXSmbaQaXSmbabaHcdtfgAaLBdbaAcwfa8KBdbaAclfaKBdbaHcifhHkaecxfheaOcifgOad6mbkdndna9imbaHhdxekdnaHak0mbaHhdxekdna85a879FmbaHhdxekJFFuuh85cbhdabhecbhOindna9ka0aeydbgAcdtfydbcdtfIdbg8Ua879ETmbaeclf8Pdbh9CabadcdtfgQaABdbaQclfa9C83dba8Ua85a85a8U9EEh85adcifhdkaecxfheaOcifgOaH6mbkkadak0mbxdkkascNefabadalaCz:cjjjbkdndnadak0mbadhOxekdna9imbadhOxekdna85a889FmbadhOxekcehLina85Jbb;aZNg8Ua88a8Ua889DEh8XJbbbbh8Udna6Tmba9khea6hHinaeIdbg8Wa8Ua8Wa8X9FEa8Ua8Wa8U9EEh8UaeclfheaHcufgHmbkkJFFuuh85cbhOabhecbhHindna9ka0aeydbgAcdtfydbcdtfIdbg8Wa8X9ETmbaeclf8Pdbh9CabaOcdtfgQaABdbaQclfa9C83dba8Wa85a85a8W9EEh85aOcifhOkaecxfheaHcifgHad6mbkdnaLaOad9hVceGmbadhOxdka8Ua86a86a8U9DEh86aOak9nmecbhLaOhda85a889FmbkkdnamcjjjjdGTmba9pcbalz:rjjjbhLdnaOTmbabheaOhHinaLaeydbgAfa5aAfRbbcl9h86bbaeclfheaHcufgHmbkkascNefabaOalaCz:cjjjbalTmbcbhQasyd:yehgindnaLaQfRbbTmbdna5aQfRbbgecl0mbceaetcQGmekdnaCaQcdtgKfydbgeaQSmbaaaQcx2fgHaaaecx2fge8Pdb83dbaHcwfaecwfydbBdbxekayaQc8S2fgeIdyg8Ua8UJL:3;rUNg8UMh88aeIdwa8UMhRaeIdla8UMh8VaeIdba8UMhUaeIdaa8UaaaQcx2fg8KIdwg89N:th81aeId3a8Ua8KIdlg8:N:th85aeIdKa8KIdbgZa8UN:th8YJbbbbhcaeIdCJbbbbMh87aeIdzJbbbbMhBaeIdxJbbbbMh83dndna8LTmbaQhAinJbbbba88a8NaAc8S2fgHIdyg8U:va8UJbbbb9BEh8UaqaAa8L2cltfheaHIdaa88Na81Mh81aHId3a88Na85Mh85aHIdKa88Na8YMh8YaHIdCa88Na87Mh87aHIdza88NaBMhBaHIdxa88Na83Mh83aHIdwa88NaRMhRaHIdla88Na8VMh8VaHIdba88NaUMhUa8LhHina81aecxfIdbg8ZaecwfIdbg8WNa8UN:th81a85a8ZaeclfIdbg8XNa8UN:th85a87a8Wa8XNa8UN:th87aUaeIdbg80a80Na8UN:thUa8Ya8Za80Na8UN:th8YaBa8Wa80Na8UN:thBa83a8Xa80Na8UN:th83aRa8Wa8WNa8UN:thRa8Va8Xa8XNa8UN:th8VaeczfheaHcufgHmbkaYaAcdtfydbgAaQ9hmbkaITmbaIaQcltfgeIdxhTaeIdwh9caeIdlhJaeIdbh8UxekJbbbbhTJbbbbh9cJbbbbhJJbbbbh8UkaBaU:vg8Xa8YNa81:ta87aBa83aU:vg8WN:tg81a8Va83a8WN:tg8Z:vg80a8Wa8YNa85:tg8VN:th85a9ca8Ua8XN:taJa8Ua8WN:tg83a80N:tg87aRaBa8XN:ta81a80N:tgB:vgR:mh81a83a8Z:vg9c:mhJdnJbbbba8Ua8UaU:vg9eN:ta83a9cN:ta87aRN:tg83:la88J:983:g81Ng8U9ETmba81a85NaJa8VNa9ea8YNaT:tMMa83:vhckaU:la8U9ETmba8Z:la8U9ETmbaB:la8U9ETmba9e:macNa8X:ma81acNa85aB:vMg85Na8W:maJacNa80:ma85Na8Va8Z:vMMg87Na8Y:maU:vMMMh88a9maKfgeclfydbgHaeydbge9RhXagaecitfhKJbbbbh8UdnaHaeSghmbJbbbbh8UaKheaXhAinaaaeclfydbcx2fgHIdwa89:tg8Wa8WNaHIdbaZ:tg8Wa8WNaHIdla8::tg8Wa8WNMMg8Waaaeydbcx2fgHIdwa89:tg8Xa8XNaHIdbaZ:tg8Xa8XNaHIdla8::tg8Xa8XNMMg8Xa8Ua8Ua8X9DEg8Ua8Ua8W9DEh8UaecwfheaAcufgAmbkka85a89:tg8Wa8WNa88aZ:tg8Wa8WNa87a8::tg8Wa8WNMMa8U:rg8Ua8UN9EmbdnahmbcbhAcehhdninaaaKclfydbcx2fgeIdbaaaKydbcx2fgHIdbg8X:tg8Ua8:aHIdlg80:tg8YNaZa8X:tgBaeIdla80:tg8WN:tg8Za8Ua87a80:tg83Na88a8X:tgRa8WN:tg80Na8Wa89aHIdwgU:tg8VNa8YaeIdwaU:tg8XN:tg8Ya8Wa85aU:tg81Na83a8XN:tg8WNa8XaBNa8Va8UN:tgUa8XaRNa81a8UN:tg8UNMMa8Za8ZNa8Ya8YNaUaUNMMa80a80Na8Wa8WNa8Ua8UNMMN:rJbbj8:N9FmeaKcwfhKaAcefgAaX6hhaXaA9hmbkkahceGmeka8Ka85Udwa8Ka87Udla8Ka88UdbkaQcefgQal9hmbkdndna8LTmba8LclthYa8Lcdth8KcbhKa8ShXindnaLaKfRbbTmba5aKfRbbclSmbJbbbbJbbjZa8NaKc8S2fIdyg8U:va8UJbbbb9BEh8UaaaCaKcdtfydbcx2fhHaqheaXhAa8LhQinaAa8UaecwfIdbaHIdwNaeIdbaHIdbNaeclfIdbaHIdlNMMaecxfIdbMNUdbaeczfheaAclfhAaQcufgQmbkkaqaYfhqaXa8KfhXaKcefgKal9hmbkarcd4hXavcd4hYasId:qeh8UasId:meh8WasId1eh8XazTmea8Lcdth8KcbhKindnaLaKfRbbTmbaiazaKcdtfydbgCaY2cdtfgeaaaKcx2fgHIdba8RNa8XMUdbaeaHIdla8RNa8WMUdlaeaHIdwa8RNa8UMUdwaoaCaX2cdtfhQashea8ShHa8LhCinaQaeydbcdtgAfaHIdbawaAfIdb:vUdbaeclfheaHclfhHaCcufgCmbkka8Sa8Kfh8SaKcefgKal9hmbxikkavcd4hCasId:qeh8UasId:meh8WasId1eh8XdnazTmbazheindna9pRbbTmbaiaeydbaC2cdtfgHaaIdba8RNa8XMUdbaHaaclfIdba8RNa8WMUdlaHaacwfIdba8RNa8UMUdwka9pcefh9paeclfheaacxfhaalcufglmbxikkaCcdtheindna9pRbbTmbaiaaIdba8RNa8XMUdbaiclfaaclfIdba8RNa8WMUdbaicwfaacwfIdba8RNa8UMUdbka9pcefh9paacxfhaaiaefhialcufglmbxdkka8Lcdth8KcbhKindnaLaKfRbbTmbaiaKaY2cdtfgeaaaKcx2fgHIdba8RNa8XMUdbaeaHIdla8RNa8WMUdlaeaHIdwa8RNa8UMUdwaoaKaX2cdtfhQashea8ShHa8LhCinaQaeydbcdtgAfaHIdbawaAfIdb:vUdbaeclfheaHclfhHaCcufgCmbkka8Sa8Kfh8SaKcefgKal9hmbkkdnamcjjjjlGTmbazmbaOTmbcbhLabheina5aeydbgAfRbbc3thKaecwfgXydbhHdndna8EaAcdtg8KfydbaeclfgYydbgCSmbcbhQa8FaCcdtfydbaA9hmekcjjjj94hQkaeaKaQVaAVBdba5aCfRbbc3thKdndna8EaCcdtfydbaHSmbcbhQa8FaHcdtfydbaC9hmekcjjjj94hQkaYaKaQVaCVBdba5aHfRbbc3thQdndna8EaHcdtfydbaASmbcbhCa8Fa8KfydbaH9hmekcjjjj94hCkaXaQaCVaHVBdbaecxfheaLcifgLaO6mbkkdnazTmbaOTmbaOheinabazabydbcdtfydbBdbabclfhbaecufgembkkdnaPTmbaPana86:rNUdbkasyd;8egecdtasc:Ceffc98fhHdninaeTmeaHydbcbyd:m:jjjbH:bjjjbbaHc98fhHaecufhexbkkascj;sbf8KjjjjbaOk;Yieouabydlhvabydbclfcbaicdtz:rjjjbhoadci9UhrdnadTmbdnalTmbaehwadhDinaoalawydbcdtfydbcdtfgqaqydbcefBdbawclfhwaDcufgDmbxdkkaehwadhDinaoawydbcdtfgqaqydbcefBdbawclfhwaDcufgDmbkkdnaiTmbcbhDaohwinawydbhqawaDBdbawclfhwaqaDfhDaicufgimbkkdnadci6mbinaecwfydbhwaeclfydbhDaeydbhidnalTmbalawcdtfydbhwalaDcdtfydbhDalaicdtfydbhikavaoaicdtfgqydbcitfaDBdbavaqydbcitfawBdlaqaqydbcefBdbavaoaDcdtfgqydbcitfawBdbavaqydbcitfaiBdlaqaqydbcefBdbavaoawcdtfgwydbcitfaiBdbavawydbcitfaDBdlawawydbcefBdbaecxfhearcufgrmbkkabydbcbBdbk:todDue99aicd4aifhrcehwinawgDcethwaDar6mbkcuaDcdtgraDcFFFFi0Ecbyd1:jjjbHjjjjbbhwaoaoyd9GgqcefBd9GaoaqcdtfawBdbawcFearz:rjjjbhkdnaiTmbalcd4hlaDcufhxcbhminamhDdnavTmbavamcdtfydbhDkcbadaDal2cdtfgDydlgwawcjjjj94SEgwcH4aw7c:F:b:DD2cbaDydbgwawcjjjj94SEgwcH4aw7c;D;O:B8J27cbaDydwgDaDcjjjj94SEgDcH4aD7c:3F;N8N27axGhwamcdthPdndndnavTmbakawcdtfgrydbgDcuSmeadavaPfydbal2cdtfgsIdbhzcehqinaqhrdnadavaDcdtfydbal2cdtfgqIdbaz9CmbaqIdlasIdl9CmbaqIdwasIdw9BmlkarcefhqakawarfaxGgwcdtfgrydbgDcu9hmbxdkkakawcdtfgrydbgDcuSmbadamal2cdtfgsIdbhzcehqinaqhrdnadaDal2cdtfgqIdbaz9CmbaqIdlasIdl9CmbaqIdwasIdw9BmikarcefhqakawarfaxGgwcdtfgrydbgDcu9hmbkkaramBdbamhDkabaPfaDBdbamcefgmai9hmbkkakcbyd:m:jjjbH:bjjjbbaoaoyd9GcufBd9GdnaeTmbaiTmbcbhDaehwinawaDBdbawclfhwaiaDcefgD9hmbkcbhDaehwindnaDabydbgrSmbawaearcdtfgrydbBdbaraDBdbkawclfhwabclfhbaiaDcefgD9hmbkkk:hrdvuv998Jjjjjbca9Rgoczfcwfcbyd11jjbBdbaocb8Pdj1jjb83izaocwfcbydN1jjbBdbaocb8Pd:m1jjb83ibdnadTmbaicd4hrdnabmbdnalTmbcbhwinaealawcdtfydbar2cdtfhDcbhiinaoczfaifgqaDaifIdbgkaqIdbgxaxak9EEUdbaoaifgqakaqIdbgxaxak9DEUdbaiclfgicx9hmbkawcefgwad9hmbxikkarcdthwcbhDincbhiinaoczfaifgqaeaifIdbgkaqIdbgxaxak9EEUdbaoaifgqakaqIdbgxaxak9DEUdbaiclfgicx9hmbkaeawfheaDcefgDad9hmbxdkkdnalTmbcbhwinabawcx2fgiaealawcdtfydbar2cdtfgDIdbUdbaiaDIdlUdlaiaDIdwUdwcbhiinaoczfaifgqaDaifIdbgkaqIdbgxaxak9EEUdbaoaifgqakaqIdbgxaxak9DEUdbaiclfgicx9hmbkawcefgwad9hmbxdkkarcdthlcbhwaehDinabawcx2fgiaeawar2cdtfgqIdbUdbaiaqIdlUdlaiaqIdwUdwcbhiinaoczfaifgqaDaifIdbgkaqIdbgxaxak9EEUdbaoaifgqakaqIdbgxaxak9DEUdbaiclfgicx9hmbkaDalfhDawcefgwad9hmbkkJbbbbaoIdbaoIdzgx:tgkakJbbbb9DEgkaoIdlaoIdCgm:tgPaPak9DEgkaoIdwaoIdKgP:tgsasak9DEhsdnabTmbadTmbJbbbbJbbjZas:vasJbbbb9BEhkinabakabIdbax:tNUdbabclfgoakaoIdbam:tNUdbabcwfgoakaoIdbaP:tNUdbabcxfhbadcufgdmbkkdnavTmbavaPUdwavamUdlavaxUdbkask:ZlewudnaeTmbcbhvabhoinaoavBdbaoclfhoaeavcefgv9hmbkkdnaiTmbcbhrinadarcdtfhwcbhDinalawaDcdtgvc:G1jjbfydbcdtfydbcdtfydbhodnabalawavfydbcdtfydbgqcdtfgkydbgvaqSmbinakabavgqcdtfgxydbgvBdbaxhkaqav9hmbkkdnabaocdtfgkydbgvaoSmbinakabavgocdtfgxydbgvBdbaxhkaoav9hmbkkdnaqaoSmbabaqaoaqao0Ecdtfaqaoaqao6EBdbkaDcefgDci9hmbkarcifgrai6mbkkdnaembcbskcbhxindnalaxcdtgvfydbax9hmbaxhodnabavfgDydbgvaxSmbaDhqinaqabavgocdtfgkydbgvBdbakhqaoav9hmbkkaDaoBdbkaxcefgxae9hmbkcbhvabhocbhkindndnavalydbgq9hmbdnavaoydbgq9hmbaoakBdbakcefhkxdkaoabaqcdtfydbBdbxekaoabaqcdtfydbBdbkaoclfhoalclfhlaeavcefgv9hmbkakk;Jiilud99duabcbaecltz:rjjjbhvdnalTmbadhoaihralhwinarcwfIdbhDarclfIdbhqavaoydbcltfgkarIdbakIdbMUdbakclfgxaqaxIdbMUdbakcwfgxaDaxIdbMUdbakcxfgkakIdbJbbjZMUdbaoclfhoarcxfhrawcufgwmbkkdnaeTmbavhraehkinarcxfgoIdbhDaocbBdbararIdbJbbbbJbbjZaD:vaDJbbbb9BEgDNUdbarclfgoaDaoIdbNUdbarcwfgoaDaoIdbNUdbarczfhrakcufgkmbkkdnalTmbinavadydbcltfgrcxfgkaicwfIdbarcwfIdb:tgDaDNaiIdbarIdb:tgDaDNaiclfIdbarclfIdb:tgDaDNMMgDakIdbgqaqaD9DEUdbadclfhdaicxfhialcufglmbkkdnaeTmbavcxfhrinabarIdbUdbarczfhrabclfhbaecufgembkkk8MbabaeadaialavcbcbcbcbcbaoarawaDz:bjjjbk8MbabaeadaialavaoarawaDaqakaxamaPz:bjjjbkRbababaeadaialavaoarawaDaqakaxcjjjjdVamz:bjjjbk:p8Koque99due99iuq998Jjjjjbc;Wb9Rgq8Kjjjjbcbhkaqcxfcbc;Kbz:rjjjb8Aaqcualcx2alc;v:Q;v:Qe0Ecbyd1:jjjbHjjjjbbgxBdxaqceBd2axaialavcbcbz:ejjjb8AaqcualcdtalcFFFFi0Egmcbyd1:jjjbHjjjjbbgiBdzaqcdBd2dndnJFF959eJbbjZawJbbjZawJbbjZ9DE:vawJ9VO:d869DEgw:lJbbb9p9DTmbaw:OhPxekcjjjj94hPkadci9Uhsarco9UhzdndnaombaPcd9imekdnalTmbaPcuf:YhwdnaoTmbcbhvaihHaxhOindndnaoavfRbbceGTmbavcjjjjlVhAxekdndnaOclfIdbawNJbbbZMgC:lJbbb9p9DTmbaC:OhAxekcjjjj94hAkaAcqthAdndnaOcwfIdbawNJbbbZMgC:lJbbb9p9DTmbaC:OhXxekcjjjj94hXkaAaXVhAdndnaOIdbawNJbbbZMgC:lJbbb9p9DTmbaC:OhXxekcjjjj94hXkaAaXcCtVhAkaHaABdbaHclfhHaOcxfhOalavcefgv9hmbxdkkaxhvaihOalhHindndnavIdbawNJbbbZMgC:lJbbb9p9DTmbaC:OhAxekcjjjj94hAkaAcCthAdndnavclfIdbawNJbbbZMgC:lJbbb9p9DTmbaC:OhXxekcjjjj94hXkaXcqtaAVhAdndnavcwfIdbawNJbbbZMgC:lJbbb9p9DTmbaC:OhXxekcjjjj94hXkaOaAaXVBdbavcxfhvaOclfhOaHcufgHmbkkadTmbcbhkaehvcbhOinakaiavclfydbcdtfydbgHaiavcwfydbcdtfydbgA9haiavydbcdtfydbgXaH9haXaA9hGGfhkavcxfhvaOcifgOad6mbkkarci9UhQdndnaz:Z:rJbbbZMgw:lJbbb9p9DTmbaw:Ohvxekcjjjj94hvkaQ:ZhLcbhKc:bwhHdndninashYaHhXaPhrakg8AaQ9pmeaXar9Rcd9imeavaXcufavaX9iEarcefavar9kEhzdnalTmbazcuf:YhwdnaoTmbcbhOaihPaxhvindndnaoaOfRbbceGTmbaOcjjjjlVhHxekdndnavclfIdbawNJbbbZMgC:lJbbb9p9DTmbaC:OhHxekcjjjj94hHkaHcqthHdndnavcwfIdbawNJbbbZMgC:lJbbb9p9DTmbaC:Ohsxekcjjjj94hskaHasVhHdndnavIdbawNJbbbZMgC:lJbbb9p9DTmbaC:Ohsxekcjjjj94hskaHascCtVhHkaPaHBdbaPclfhPavcxfhvalaOcefgO9hmbxdkkaxhvaihOalhPindndnavIdbawNJbbbZMgC:lJbbb9p9DTmbaC:OhHxekcjjjj94hHkaHcCthHdndnavclfIdbawNJbbbZMgC:lJbbb9p9DTmbaC:Ohsxekcjjjj94hskascqtaHVhHdndnavcwfIdbawNJbbbZMgC:lJbbb9p9DTmbaC:Ohsxekcjjjj94hskaOaHasVBdbavcxfhvaOclfhOaPcufgPmbkkcbhOdnadTmbaehvcbhPinaOaiavclfydbcdtfydbgHaiavcwfydbcdtfydbgs9haiavydbcdtfydbgAaH9haAas9hGGfhOavcxfhvaPcifgPad6mbkkaYhsaOhkaXhHazhPdnaOaQ9nmbaOhsa8AhkazhHarhPkdndnaKcl0mbdnaY:Zgwa8A:ZgC:taz:YgEar:Y:tg3aEaX:Y:tg5aO:Zg8EaL:tNNNawaL:ta5NaCa8E:tNaCaL:ta3Na8Eaw:tNM:vaEMJbbbZMgw:lJbbb9p9DTmbaw:Ohvxdkcjjjj94hvxekaPaHfcd9ThvkaKcefgKcs9hmbxdkka8AhkarhPkdndndnakmbJbbjZhwcbhicdhvaDmexdkalcd4alfhHcehOinaOgvcethOavaH6mbkcbhOaqcuavcdtgravcFFFFi0Ecbyd1:jjjbHjjjjbbgzBdCaqciBd2aqamcbyd1:jjjbHjjjjbbgXBdKaqclBd2dndndndnalTmbaPcuf:YhwaoTmecbhOaihHaxhPindndnaoaOfRbbceGTmbaOcjjjjlVhsxekdndnaPclfIdbawNJbbbZMgC:lJbbb9p9DTmbaC:Ohsxekcjjjj94hskascqthsdndnaPcwfIdbawNJbbbZMgC:lJbbb9p9DTmbaC:OhAxekcjjjj94hAkasaAVhsdndnaPIdbawNJbbbZMgC:lJbbb9p9DTmbaC:OhAxekcjjjj94hAkasaAcCtVhskaHasBdbaHclfhHaPcxfhPalaOcefgO9hmbxikkazcFearz:rjjjb8AcbhrcbhvxdkaxhOaihPalhHindndnaOIdbawNJbbbZMgC:lJbbb9p9DTmbaC:Ohsxekcjjjj94hskascCthsdndnaOclfIdbawNJbbbZMgC:lJbbb9p9DTmbaC:OhAxekcjjjj94hAkaAcqtasVhsdndnaOcwfIdbawNJbbbZMgC:lJbbb9p9DTmbaC:OhAxekcjjjj94hAkaPasaAVBdbaOcxfhOaPclfhPaHcufgHmbkkazcFearz:rjjjbhAavcufhocbhrcbhzindndndnaAaiazcdtgKfydbgHcm4aH7c:v;t;h;Ev2gvcs4av7aoGgPcdtfgsydbgOcuSmbcehvinaiaOcdtgOfydbaHSmdaPavfhOavcefhvaAaOaoGgPcdtfgsydbgOcu9hmbkkasazBdbarhvarcefhrxekaXaOfydbhvkaXaKfavBdbazcefgzal9hmbkcuarc8S2gOarc;D;O;f8U0EhvkcbhAaqavcbyd1:jjjbHjjjjbbgvBd3aqcvBd2avcbaOz:rjjjbhOdnadTmbaehiinJbbnnJbbjZaXaiydbgHcdtfydbgvaXaiclfydbgPcdtfydbgzSavaXaicwfydbgscdtfydbgKSGgoEh8FdnaxaPcx2fgPIdbaxaHcx2fgHIdbg8E:tgCaxascx2fgsIdlaHIdlg3:tgwNasIdba8E:tgEaPIdla3:tgaN:tgLaLNaaasIdwaHIdwg5:tghNawaPIdwa5:tgaN:tgwawNaaaENahaCN:tgCaCNMM:rgEJbbbb9ETmbaLaE:vhLaCaE:vhCawaE:vhwkaOavc8S2fgvavIdbawa8FaE:rNgEawNNgaMUdbavaCaEaCNghNggavIdlMUdlavaLaEaLNg8FNg8JavIdwMUdwavahawNghavIdxMUdxava8FawNg8KavIdzMUdzava8FaCNg8FavIdCMUdCavawaEaLa5Nawa8ENa3aCNMM:mg3Ng8ENgwavIdKMUdKavaCa8ENgCavId3MUd3avaLa8ENgLavIdaMUdaava8Ea3Ng8EavId8KMUd8KavaEavIdyMUdydnaombaOazc8S2fgvaaavIdbMUdbavagavIdlMUdlava8JavIdwMUdwavahavIdxMUdxava8KavIdzMUdzava8FavIdCMUdCavawavIdKMUdKavaCavId3MUd3avaLavIdaMUdaava8EavId8KMUd8KavaEavIdyMUdyaOaKc8S2fgvaaavIdbMUdbavagavIdlMUdlava8JavIdwMUdwavahavIdxMUdxava8KavIdzMUdzava8FavIdCMUdCavawavIdKMUdKavaCavId3MUd3avaLavIdaMUdaava8EavId8KMUd8KavaEavIdyMUdykaicxfhiaAcifgAad6mbkkcbhHaqcuarcdtgvarcFFFFi0Egicbyd1:jjjbHjjjjbbgPBdaaqcoBd2aqaicbyd1:jjjbHjjjjbbgiBd8KaqcrBd2aPcFeavz:rjjjbhzdnalTmbaXhPinJbbbbJbbjZaOaPydbgsc8S2fgvIdygw:vawJbbbb9BEavIdwaxcwfIdbgwNavIdzaxIdbgCNavIdaMgLaLMMawNavIdlaxclfIdbgLNavIdCawNavId3MgwawMMaLNavIdbaCNavIdxaLNavIdKMgwawMMaCNavId8KMMM:lNhwdndnazascdtgvfgsydbcuSmbaiavfIdbaw9ETmekasaHBdbaiavfawUdbkaPclfhPaxcxfhxalaHcefgH9hmbkkJbbbbhwdnarTmbinaiIdbgCawawaC9DEhwaiclfhiarcufgrmbkkakcd4akfhOcehiinaigvcethiavaO6mbkcbhiaqcuavcdtgOavcFFFFi0Ecbyd1:jjjbHjjjjbbgPBdyaPcFeaOz:rjjjbhsdnadTmbavcufhAcbhrcbhxindnaXaeaxcdtfgvydbcdtfydbgiaXavclfydbcdtfydbgOSmbaiaXavcwfydbcdtfydbgvSmbaOavSmbazavcdtfydbhHdndnazaOcdtfydbgvazaicdtfydbgi9pmbavaH9pmbaHhlaihoavhHxekdnaHai9pmbaHav9pmbaihlavhoxekavhlaHhoaihHkabarcx2fgvaHBdbavcwfaoBdbavclfalBdbdnasaoc:3F;N8N2alc:F:b:DD27aHc;D;O:B8J27aAGgOcdtfgvydbgicuSmbcehPinaPhvdnabaicx2fgiydbaH9hmbaiydlal9hmbaiydwaoSmikavcefhPasaOavfaAGgOcdtfgvydbgicu9hmbkkavarBdbarcefhrkaxcifgxad6mbkarci2hikdnaDmbcwhvxdkaw:rhwcwhvkaDawUdbkavcdthvdninavTmeavc98fgvaqcxffydbcbyd:m:jjjbH:bjjjbbxbkkaqc;Wbf8Kjjjjbaik:2ldwue9:8Jjjjjbc;Wb9Rgr8Kjjjjbcbhwarcxfcbc;Kbz:rjjjb8AdnabaeSmbabaeadcdtz:qjjjb8AkarcualcdtalcFFFFi0EgDcbyd1:jjjbHjjjjbbgqBdxarceBd2aqcbaialavcbarcxfz:djjjbcualcx2alc;v:Q;v:Qe0Ecbyd1:jjjbHjjjjbbhkarcxfaryd2gxcdtgmfakBdbaraxcefgPBd2akaialavcbcbz:ejjjb8AarcxfaPcdtfaDcbyd1:jjjbHjjjjbbgvBdbaraxcdfgiBd2arcxfaicdtfcuavalaeadaqz:fjjjbgecltaecjjjjiGEcbyd1:jjjbHjjjjbbgiBdbaiaeavakalz:gjjjbdnadTmbaoaoNhocbhwabhlcbhkindnaiavalydbgecdtfydbcdtfIdbao9ETmbalclf8PdbhsabawcdtfgqaeBdbaqclfas83dbawcifhwkalcxfhlakcifgkad6mbkkaxcifhlamarcxffcwfhkdninalTmeakydbcbyd:m:jjjbH:bjjjbbakc98fhkalcufhlxbkkarc;Wbf8Kjjjjbawk:FCoDud99rue99iul998Jjjjjbc;Wb9Rgw8KjjjjbdndnarmbcbhDxekawcxfcbc;Kbz:rjjjb8Aawcuadcx2adc;v:Q;v:Qe0Ecbyd1:jjjbHjjjjbbgqBdxawceBd2aqaeadaicbcbz:ejjjb8AawcuadcdtadcFFFFi0Egkcbyd1:jjjbHjjjjbbgxBdzawcdBd2adcd4adfhmceheinaegicetheaiam6mbkcbhPawcuaicdtgsaicFFFFi0Ecbyd1:jjjbHjjjjbbgzBdCawciBd2dndnar:ZgH:rJbbbZMgO:lJbbb9p9DTmbaO:Ohexekcjjjj94hekaicufhAc:bwhmcbhCadhXcbhQinaChLaeamgKcufaeaK9iEaPgDcefaeaD9kEhYdndnadTmbaYcuf:YhOaqhiaxheadhmindndnaiIdbaONJbbbZMg8A:lJbbb9p9DTmba8A:OhCxekcjjjj94hCkaCcCthCdndnaiclfIdbaONJbbbZMg8A:lJbbb9p9DTmba8A:OhExekcjjjj94hEkaEcqtaCVhCdndnaicwfIdbaONJbbbZMg8A:lJbbb9p9DTmba8A:OhExekcjjjj94hEkaeaCaEVBdbaicxfhiaeclfheamcufgmmbkazcFeasz:rjjjbh3cbh5cbhPindna3axaPcdtfydbgCcm4aC7c:v;t;h;Ev2gics4ai7aAGgmcdtfgEydbgecuSmbaeaCSmbcehiina3amaifaAGgmcdtfgEydbgecuSmeaicefhiaeaC9hmbkkaEaCBdba5aecuSfh5aPcefgPad9hmbxdkkazcFeasz:rjjjb8Acbh5kaDaYa5ar0giEhPaLa5aiEhCdna5arSmbaYaKaiEgmaP9Rcd9imbdndnaQcl0mbdnaX:ZgOaL:Zg8A:taY:Yg8EaD:Y:tg8Fa8EaK:Y:tgaa5:ZghaH:tNNNaOaH:taaNa8Aah:tNa8AaH:ta8FNahaO:tNM:va8EMJbbbZMgO:lJbbb9p9DTmbaO:Ohexdkcjjjj94hexekaPamfcd9Theka5aXaiEhXaQcefgQcs9hmekkdndnaCmbcihicbhDxekcbhiawakcbyd1:jjjbHjjjjbbg5BdKawclBd2aPcuf:Yh8AdndnadTmbaqhiaxheadhmindndnaiIdba8ANJbbbZMgO:lJbbb9p9DTmbaO:OhCxekcjjjj94hCkaCcCthCdndnaiclfIdba8ANJbbbZMgO:lJbbb9p9DTmbaO:OhExekcjjjj94hEkaEcqtaCVhCdndnaicwfIdba8ANJbbbZMgO:lJbbb9p9DTmbaO:OhExekcjjjj94hEkaeaCaEVBdbaicxfhiaeclfheamcufgmmbkazcFeasz:rjjjbh3cbhDcbhYindndndna3axaYcdtgKfydbgCcm4aC7c:v;t;h;Ev2gics4ai7aAGgmcdtfgEydbgecuSmbcehiinaxaecdtgefydbaCSmdamaifheaicefhia3aeaAGgmcdtfgEydbgecu9hmbkkaEaYBdbaDhiaDcefhDxeka5aefydbhika5aKfaiBdbaYcefgYad9hmbkcuaDc32giaDc;j:KM;jb0EhexekazcFeasz:rjjjb8AcbhDcbhekawaecbyd1:jjjbHjjjjbbgeBd3awcvBd2aecbaiz:rjjjbhEavcd4hKdnadTmbdnalTmbaKcdth3a5hCaqhealhmadhAinaEaCydbc32fgiaeIdbaiIdbMUdbaiaeclfIdbaiIdlMUdlaiaecwfIdbaiIdwMUdwaiamIdbaiIdxMUdxaiamclfIdbaiIdzMUdzaiamcwfIdbaiIdCMUdCaiaiIdKJbbjZMUdKaCclfhCaecxfheama3fhmaAcufgAmbxdkka5hmaqheadhCinaEamydbc32fgiaeIdbaiIdbMUdbaiaeclfIdbaiIdlMUdlaiaecwfIdbaiIdwMUdwaiaiIdxJbbbbMUdxaiaiIdzJbbbbMUdzaiaiIdCJbbbbMUdCaiaiIdKJbbjZMUdKamclfhmaecxfheaCcufgCmbkkdnaDTmbaEhiaDheinaiaiIdbJbbbbJbbjZaicKfIdbgO:vaOJbbbb9BEgONUdbaiclfgmaOamIdbNUdbaicwfgmaOamIdbNUdbaicxfgmaOamIdbNUdbaiczfgmaOamIdbNUdbaicCfgmaOamIdbNUdbaic3fhiaecufgembkkcbhCawcuaDcdtgYaDcFFFFi0Egicbyd1:jjjbHjjjjbbgeBdaawcoBd2awaicbyd1:jjjbHjjjjbbg3Bd8KaecFeaYz:rjjjbhxdnadTmbJbbjZJbbjZa8A:vaPceSEaoNgOaONh8AaKcdthPalheina8Aaec;81jjbalEgmIdwaEa5ydbgAc32fgiIdC:tgOaONamIdbaiIdx:tgOaONamIdlaiIdz:tgOaONMMNaqcwfIdbaiIdw:tgOaONaqIdbaiIdb:tgOaONaqclfIdbaiIdl:tgOaONMMMhOdndnaxaAcdtgifgmydbcuSmba3aifIdbaO9ETmekamaCBdba3aifaOUdbka5clfh5aqcxfhqaeaPfheadaCcefgC9hmbkkabaxaYz:qjjjb8AcrhikaicdthiinaiTmeaic98fgiawcxffydbcbyd:m:jjjbH:bjjjbbxbkkawc;Wbf8KjjjjbaDk:Ydidui99ducbhi8Jjjjjbca9Rglczfcwfcbyd11jjbBdbalcb8Pdj1jjb83izalcwfcbydN1jjbBdbalcb8Pd:m1jjb83ibdndnaembJbbjFhvJbbjFhoJbbjFhrxekadcd4cdthwincbhdinalczfadfgDabadfIdbgvaDIdbgoaoav9EEUdbaladfgDavaDIdbgoaoav9DEUdbadclfgdcx9hmbkabawfhbaicefgiae9hmbkalIdwalIdK:thralIdlalIdC:thoalIdbalIdz:thvkJbbbbavavJbbbb9DEgvaoaoav9DEgvararav9DEk9DeeuabcFeaicdtz:rjjjbhlcbhbdnadTmbindnalaeydbcdtfgiydbcu9hmbaiabBdbabcefhbkaeclfheadcufgdmbkkabk9teiucbcbyd:q:jjjbgeabcifc98GfgbBd:q:jjjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;teeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiaeydlBdlaiaeydwBdwaiaeydxBdxaeczfheaiczfhiadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk:3eedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdxaialBdwaialBdlaialBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabk9teiucbcbyd:q:jjjbgeabcrfc94GfgbBd:q:jjjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik9:eiuZbhedndncbyd:q:jjjbgdaecztgi9nmbcuheadai9RcFFifcz4nbcuSmekadhekcbabae9Rcifc98Gcbyd:q:jjjbfgdBd:q:jjjbdnadZbcztge9nmbadae9RcFFifcz4nb8Akkk:Iedbcjwk1eFFuuFFuuFFuuFFuFFFuFFFuFbbbbbbbbebbbdbbbbbbbebbbebbbdbbbbbbbbbbbeeeeebebbebbebebbbeebbbbbbbbbbbbeeeeeebebbeeebeebbbbebebbbbbbbbbbbbbbbbbbc1Dkxebbbdbbb:GNbb",e=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if(typeof WebAssembly!="object")return{supported:!1};var t,i=WebAssembly.instantiate(r(a),{}).then(function(b){t=b.instance,t.exports.__wasm_call_ctors()});function r(b){for(var A=new Uint8Array(b.length),y=0;y<b.length;++y){var x=b.charCodeAt(y);A[y]=x>96?x-97:x>64?x-39:x+4}for(var E=0,y=0;y<b.length;++y)A[E++]=A[y]<60?e[A[y]]:(A[y]-60)*64+A[++y];return A.buffer.slice(0,E)}function s(b){if(!b)throw new Error("Assertion failed")}function n(b){return new Uint8Array(b.buffer,b.byteOffset,b.byteLength)}function o(b,A,y){var x=t.exports.sbrk,E=x(A.length*4),I=x(y*4),w=new Uint8Array(t.exports.memory.buffer),v=n(A);w.set(v,E);var M=b(I,E,A.length,y);w=new Uint8Array(t.exports.memory.buffer);var C=new Uint32Array(y);new Uint8Array(C.buffer).set(w.subarray(I,I+y*4)),v.set(w.subarray(E,E+A.length*4)),x(E-x(0));for(var D=0;D<A.length;++D)A[D]=C[A[D]];return[C,M]}function c(b){for(var A=0,y=0;y<b.length;++y){var x=b[y];A=A<x?x:A}return A}function l(b,A,y,x,E,I,w,v,M){var C=t.exports.sbrk,D=C(4),S=C(y*4),k=C(E*I),F=C(y*4),B=new Uint8Array(t.exports.memory.buffer);B.set(n(x),k),B.set(n(A),F);var O=b(S,F,y,k,E,I,w,v,M,D);B=new Uint8Array(t.exports.memory.buffer);var L=new Uint32Array(O);n(L).set(B.subarray(S,S+O*4));var _=new Float32Array(1);return n(_).set(B.subarray(D,D+4)),C(D-C(0)),[L,_[0]]}function h(b,A,y,x,E,I,w,v,M,C,D,S,k){var F=t.exports.sbrk,B=F(4),O=F(y*4),L=F(E*I),_=F(E*v),q=F(M.length*4),J=F(y*4),Z=C?F(E):0,Y=new Uint8Array(t.exports.memory.buffer);Y.set(n(x),L),Y.set(n(w),_),Y.set(n(M),q),Y.set(n(A),J),C&&Y.set(n(C),Z);var W=b(O,J,y,L,E,I,_,v,q,M.length,Z,D,S,k,B);Y=new Uint8Array(t.exports.memory.buffer);var T=new Uint32Array(W);n(T).set(Y.subarray(O,O+W*4));var ne=new Float32Array(1);return n(ne).set(Y.subarray(B,B+4)),F(B-F(0)),[T,ne[0]]}function d(b,A,y,x,E,I,w,v,M,C,D,S,k){var F=t.exports.sbrk,B=F(4),O=F(E*I),L=F(E*v),_=F(M.length*4),q=F(y*4),J=C?F(E):0,Z=new Uint8Array(t.exports.memory.buffer);Z.set(n(x),O),Z.set(n(w),L),Z.set(n(M),_),Z.set(n(A),q),C&&Z.set(n(C),J);var Y=b(q,y,O,E,I,L,v,_,M.length,J,D,S,k,B);Z=new Uint8Array(t.exports.memory.buffer),n(A).set(Z.subarray(q,q+Y*4)),n(x).set(Z.subarray(O,O+E*I)),n(w).set(Z.subarray(L,L+E*v));var W=new Float32Array(1);return n(W).set(Z.subarray(B,B+4)),F(B-F(0)),[Y,W[0]]}function f(b,A,y,x){var E=t.exports.sbrk,I=E(y*x),w=new Uint8Array(t.exports.memory.buffer);w.set(n(A),I);var v=b(I,y,x);return E(I-E(0)),v}function u(b,A,y,x,E,I,w,v){var M=t.exports.sbrk,C=M(v*4),D=M(y*x),S=M(y*I),k=new Uint8Array(t.exports.memory.buffer);k.set(n(A),D),E&&k.set(n(E),S);var F=b(C,D,y,x,S,I,w,v);k=new Uint8Array(t.exports.memory.buffer);var B=new Uint32Array(F);return n(B).set(k.subarray(C,C+F*4)),M(C-M(0)),B}function m(b,A,y,x,E,I,w,v,M){var C=t.exports.sbrk,D=C(4),S=C(y*4),k=C(E*I),F=C(y*4),B=w?C(E):0,O=new Uint8Array(t.exports.memory.buffer);O.set(n(x),k),O.set(n(A),F),w&&O.set(n(w),B);var L=b(S,F,y,k,E,I,B,v,M,D);O=new Uint8Array(t.exports.memory.buffer);var _=new Uint32Array(L);n(_).set(O.subarray(S,S+L*4));var q=new Float32Array(1);return n(q).set(O.subarray(D,D+4)),C(D-C(0)),[_,q[0]]}function p(b,A,y,x,E,I,w){var v=t.exports.sbrk,M=v(y*4),C=v(E*I),D=v(y*4),S=new Uint8Array(t.exports.memory.buffer);S.set(n(x),C),S.set(n(A),D);var k=b(M,D,y,C,E,I,w);S=new Uint8Array(t.exports.memory.buffer);var F=new Uint32Array(k);return n(F).set(S.subarray(M,M+k*4)),v(M-v(0)),F}var g={LockBorder:1,Sparse:2,ErrorAbsolute:4,Prune:8,Regularize:16,Permissive:32,_InternalDebug:1<<30};return{ready:i,supported:!0,compactMesh:function(b){s(b instanceof Uint32Array||b instanceof Int32Array||b instanceof Uint16Array||b instanceof Int16Array),s(b.length%3==0);var A=b.BYTES_PER_ELEMENT==4?b:new Uint32Array(b);return o(t.exports.meshopt_optimizeVertexFetchRemap,A,c(b)+1)},simplify:function(b,A,y,x,E,I){s(b instanceof Uint32Array||b instanceof Int32Array||b instanceof Uint16Array||b instanceof Int16Array),s(b.length%3==0),s(A instanceof Float32Array),s(A.length%y==0),s(y>=3),s(x>=0&&x<=b.length),s(x%3==0),s(E>=0);for(var w=0,v=0;v<(I?I.length:0);++v)s(I[v]in g),w|=g[I[v]];var M=b.BYTES_PER_ELEMENT==4?b:new Uint32Array(b),C=l(t.exports.meshopt_simplify,M,b.length,A,A.length/y,y*4,x,E,w);return C[0]=b instanceof Uint32Array?C[0]:new b.constructor(C[0]),C},simplifyWithAttributes:function(b,A,y,x,E,I,w,v,M,C){s(b instanceof Uint32Array||b instanceof Int32Array||b instanceof Uint16Array||b instanceof Int16Array),s(b.length%3==0),s(A instanceof Float32Array),s(A.length%y==0),s(y>=3),s(x instanceof Float32Array),s(x.length==E*(A.length/y)),s(E>=0),s(w==null||w instanceof Uint8Array),s(w==null||w.length==A.length/y),s(v>=0&&v<=b.length),s(v%3==0),s(M>=0),s(Array.isArray(I)),s(E>=I.length),s(I.length<=32);for(var D=0;D<I.length;++D)s(I[D]>=0);for(var S=0,D=0;D<(C?C.length:0);++D)s(C[D]in g),S|=g[C[D]];var k=b.BYTES_PER_ELEMENT==4?b:new Uint32Array(b),F=h(t.exports.meshopt_simplifyWithAttributes,k,b.length,A,A.length/y,y*4,x,E*4,new Float32Array(I),w,v,M,S);return F[0]=b instanceof Uint32Array?F[0]:new b.constructor(F[0]),F},simplifyWithUpdate:function(b,A,y,x,E,I,w,v,M,C){s(b instanceof Uint32Array||b instanceof Int32Array||b instanceof Uint16Array||b instanceof Int16Array),s(b.length%3==0),s(A instanceof Float32Array),s(A.length%y==0),s(y>=3),s(x instanceof Float32Array),s(x.length==E*(A.length/y)),s(E>=0),s(w==null||w instanceof Uint8Array),s(w==null||w.length==A.length/y),s(v>=0&&v<=b.length),s(v%3==0),s(M>=0),s(Array.isArray(I)),s(E>=I.length),s(I.length<=32);for(var D=0;D<I.length;++D)s(I[D]>=0);for(var S=0,D=0;D<(C?C.length:0);++D)s(C[D]in g),S|=g[C[D]];var k=b.BYTES_PER_ELEMENT==4?b:new Uint32Array(b),F=d(t.exports.meshopt_simplifyWithUpdate,k,b.length,A,A.length/y,y*4,x,E*4,new Float32Array(I),w,v,M,S);if(b!==k)for(var D=0;D<F[0];++D)b[D]=k[D];return F},getScale:function(b,A){return s(b instanceof Float32Array),s(b.length%A==0),s(A>=3),f(t.exports.meshopt_simplifyScale,b,b.length/A,A*4)},simplifyPoints:function(b,A,y,x,E,I){return s(b instanceof Float32Array),s(b.length%A==0),s(A>=3),s(y>=0&&y<=b.length/A),x?(s(x instanceof Float32Array),s(x.length%E==0),s(E>=3),s(b.length/A==x.length/E),u(t.exports.meshopt_simplifyPoints,b,b.length/A,A*4,x,E*4,I,y)):u(t.exports.meshopt_simplifyPoints,b,b.length/A,A*4,void 0,0,0,y)},simplifySloppy:function(b,A,y,x,E,I){s(b instanceof Uint32Array||b instanceof Int32Array||b instanceof Uint16Array||b instanceof Int16Array),s(b.length%3==0),s(A instanceof Float32Array),s(A.length%y==0),s(y>=3),s(x==null||x instanceof Uint8Array),s(x==null||x.length==A.length/y),s(E>=0&&E<=b.length),s(E%3==0),s(I>=0);var w=b.BYTES_PER_ELEMENT==4?b:new Uint32Array(b),v=m(t.exports.meshopt_simplifySloppy,w,b.length,A,A.length/y,y*4,x,E,I);return v[0]=b instanceof Uint32Array?v[0]:new b.constructor(v[0]),v},simplifyPrune:function(b,A,y,x){s(b instanceof Uint32Array||b instanceof Int32Array||b instanceof Uint16Array||b instanceof Int16Array),s(b.length%3==0),s(A instanceof Float32Array),s(A.length%y==0),s(y>=3),s(x>=0);var E=b.BYTES_PER_ELEMENT==4?b:new Uint32Array(b),I=p(t.exports.meshopt_simplifyPrune,E,b.length,A,A.length/y,y*4,x);return I=b instanceof Uint32Array?I:new b.constructor(I),I}}})();(function(){var a="b9H79TebbbeVx9Geueu9Geub9Gbb9Giuuueu9Gmuuuuuuuuuuu9999eu9Gvuuuuueu9Gwuuuuuuuub9Gxuuuuuuuuuuuueu9Gkuuuuuuuuuu99eu9Gouuuuuub9Gruuuuuuub9GluuuubiAOdilvorwDqqDkbiibeilve9Weiiviebeoweuec;G:Odkr;qeDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9I919P29K9nW79O2Wt79c9V919U9KbeX9TW79O9V9Wt9F9I919P29K9nW79O2Wt7bo39TW79O9V9Wt9F9J9V9T9W91tWJ2917tWV9c9V919U9K7br39TW79O9V9Wt9F9J9V9T9W91tW9nW79O2Wt9c9V919U9K7bDE9TW79O9V9Wt9F9J9V9T9W91tW9t9W9OWVW9c9V919U9K7bqL9TW79O9V9Wt9F9V9Wt9P9T9P96W9nW79O2Wtbkl79IV9RbxDwebcekdszq:x9DOdbkIbabaec9:fgefcufae9Ugeabci9Uadfcufad9Ugbaeab0Ek:w8KDPue99eux99dui99euo99iu8Jjjjjbc:WD9Rgm8KjjjjbdndnalmbcbhPxekamc:Cwfcbc;Kbz:ojjjb8Adndnalcb9imbaoal9nmbamcuaocdtaocFFFFi0Egscbyd;u1jjbHjjjjbbgzBd:CwamceBd;8wamascbyd;u1jjbHjjjjbbgHBd:GwamcdBd;8wamcualcdtalcFFFFi0Ecbyd;u1jjbHjjjjbbgOBd:KwamciBd;8waihsalhAinazasydbcdtfcbBdbasclfhsaAcufgAmbkaihsalhAinazasydbcdtfgCaCydbcefBdbasclfhsaAcufgAmbkaihsalhCcbhXindnazasydbcdtgQfgAydbcb9imbaHaQfaXBdbaAaAydbgQcjjjj94VBdbaQaXfhXkasclfhsaCcufgCmbkalci9UhLdnalci6mbcbhsaihAinaAcwfydbhCaAclfydbhXaHaAydbcdtfgQaQydbgQcefBdbaOaQcdtfasBdbaHaXcdtfgXaXydbgXcefBdbaOaXcdtfasBdbaHaCcdtfgCaCydbgCcefBdbaOaCcdtfasBdbaAcxfhAaLascefgs9hmbkkaihsalhAindnazasydbcdtgCfgXydbgQcu9kmbaXaQcFFFFrGgQBdbaHaCfgCaCydbaQ9RBdbkasclfhsaAcufgAmbxdkkamcuaocdtgsaocFFFFi0EgAcbyd;u1jjbHjjjjbbgzBd:CwamceBd;8wamaAcbyd;u1jjbHjjjjbbgHBd:GwamcdBd;8wamcualcdtalcFFFFi0Ecbyd;u1jjbHjjjjbbgOBd:KwamciBd;8wazcbasz:ojjjbhXalci9UhLaihsalhAinaXasydbcdtfgCaCydbcefBdbasclfhsaAcufgAmbkdnaoTmbcbhsaHhAaXhCaohQinaAasBdbaAclfhAaCydbasfhsaCclfhCaQcufgQmbkkdnalci6mbcbhsaihAinaAcwfydbhCaAclfydbhQaHaAydbcdtfgKaKydbgKcefBdbaOaKcdtfasBdbaHaQcdtfgQaQydbgQcefBdbaOaQcdtfasBdbaHaCcdtfgCaCydbgCcefBdbaOaCcdtfasBdbaAcxfhAaLascefgs9hmbkkaoTmbcbhsaohAinaHasfgCaCydbaXasfydb9RBdbasclfhsaAcufgAmbkkamaLcbyd;u1jjbHjjjjbbgsBd:OwamclBd;8wascbaLz:ojjjbhYamcuaLcK2alcjjjjd0Ecbyd;u1jjbHjjjjbbg8ABd:SwamcvBd;8wJbbbbhEdnalci6g3mbarcd4hKaihAa8AhsaLhrJbbbbh5inavaAclfydbaK2cdtfgCIdlh8EavaAydbaK2cdtfgXIdlhEavaAcwfydbaK2cdtfgQIdlh8FaCIdwhaaXIdwhhaQIdwhgasaCIdbg8JaXIdbg8KMaQIdbg8LMJbbnn:vUdbasclfaXIdlaCIdlMaQIdlMJbbnn:vUdbaQIdwh8MaCIdwh8NaXIdwhyascxfa8EaE:tg8Eagah:tggNa8FaE:tg8Faaah:tgaN:tgEJbbbbJbbjZa8Ja8K:tg8Ja8FNa8La8K:tg8Ka8EN:tghahNaEaENaaa8KNaga8JN:tgEaENMM:rg8K:va8KJbbbb9BEg8ENUdbasczfaEa8ENUdbascCfaha8ENUdbascwfa8Maya8NMMJbbnn:vUdba5a8KMh5aAcxfhAascKfhsarcufgrmbka5aL:Z:vJbbbZNhEkamcuaLcdtalcFFFF970Ecbyd;u1jjbHjjjjbbgCBd:WwamcoBd;8waEaq:ZNhEdna3mbcbhsaChAinaAasBdbaAclfhAaLascefgs9hmbkkaE:rhhcuh8PamcuaLcltalcFFFFd0Ecbyd;u1jjbHjjjjbbgIBd:0wamcrBd;8wcbaIa8AaCaLz:djjjb8AJFFuuhyJFFuuh8RJFFuuh8Sdnalci6gXmbJFFuuh8Sa8AhsaLhAJFFuuh8RJFFuuhyinascwfIdbgEayayaE9EEhyasclfIdbgEa8Ra8RaE9EEh8RasIdbgEa8Sa8SaE9EEh8SascKfhsaAcufgAmbkkahJbbbZNhgamaocetgscuaocu9kEcbyd;u1jjbHjjjjbbgABd:4waAcFeasz:ojjjbhCdnaXmbcbhAJFFuuhEa8Ahscuh8PinascwfIdbay:tghahNasIdba8S:tghahNasclfIdba8R:tghahNMM:rghaEa8PcuSahaE9DVgXEhEaAa8PaXEh8PascKfhsaLaAcefgA9hmbkkamczfcbcjwz:ojjjb8Aamcwf9cb83ibam9cb83ibagaxNhRJbbjZak:th8Ncbh8UJbbbbh8VJbbbbh8WJbbbbh8XJbbbbh8YJbbbbh8ZJbbbbh80cbh81cbhPinJbbbbhEdna8UTmbJbbjZa8U:Z:vhEkJbbbbhhdna80a80Na8Ya8YNa8Za8ZNMMg8KJbbbb9BmbJbbjZa8K:r:vhhka8XaENh5a8WaENh8Fa8VaENhaa8PhQdndndndndna8UaPVTmbamydwgBTmea80ahNh8Ja8ZahNh8La8YahNh8Maeamydbcdtfh83cbh3JFFuuhEcvhXcuhQindnaza83a3cdtfydbcdtgsfydbgvTmbaOaHasfydbcdtfhAindndnaCaiaAydbgKcx2fgsclfydbgrcetf8Vebcs4aCasydbgLcetf8Vebcs4faCascwfydbglcetf8Vebcs4fgombcbhsxekcehsazaLcdtfydbgLceSmbcehsazarcdtfydbgrceSmbcehsazalcdtfydbglceSmbdnarcdSaLcdSfalcdSfcd6mbaocefhsxekaocdfhskdnasaX9kmba8AaKcK2fgLIdwa5:thhaLIdla8F:th8KaLIdbaa:th8EdndnakJbbbb9DTmba8E:lg8Ea8K:lg8Ka8Ea8K9EEg8Kah:lgha8Kah9EEag:vJbbjZMhhxekahahNa8Ea8ENa8Ka8KNMM:rag:va8NNJbbjZMJ9VO:d86JbbjZaLIdCa8JNaLIdxa8MNa8LaLIdzNMMakN:tghahJ9VO:d869DENhhkaKaQasaX6ahaE9DVgLEhQasaXaLEhXahaEaLEhEkaAclfhAavcufgvmbkka3cefg3aB9hmbkkaQcu9hmekama5Ud:ODama8FUd:KDamaaUd:GDamcuBd:qDamcFFF;7rBdjDaIcba8AaYamc:GDfakJbbbb9Damc:qDfamcjDfz:ejjjbamyd:qDhQdndnaxJbbbb9ETmba8UaD6mbaQcuSmeceh3amIdjDaR9EmixdkaQcu9hmekdna8UTmbdnamydlgza8Uci2fgsciGTmbadasfcba8Uazcu7fciGcefz:ojjjb8AkabaPcltfgzam8Pib83dbazcwfamcwf8Pib83dbaPcefhPkc3hzinazc98Smvamc:Cwfazfydbcbyd;y1jjbH:bjjjbbazc98fhzxbkkcbh3a8Uaq9pmbamydwaCaiaQcx2fgsydbcetf8Vebcs4aCascwfydbcetf8Vebcs4faCasclfydbcetf8Vebcs4ffaw9nmekcbhscbhAdna81TmbcbhAamczfhXinamczfaAcdtfaXydbgLBdbaXclfhXaAaYaLfRbbTfhAa81cufg81mbkkamydwhlamydbhXam9cu83i:GDam9cu83i:ODam9cu83i:qDam9cu83i:yDaAc;8eaAclfc:bd6Eh81inamcjDfasfcFFF;7rBdbasclfgscz9hmbka81cdthBdnalTmbaeaXcdtfhocbhrindnazaoarcdtfydbcdtgsfydbgvTmbaOaHasfydbcdtfhAcuhLcuhsinazaiaAydbgKcx2fgXclfydbcdtfydbazaXydbcdtfydbfazaXcwfydbcdtfydbfgXasaXas6gXEhsaKaLaXEhLaAclfhAavcufgvmbkaLcuSmba8AaLcK2fgAIdway:tgEaENaAIdba8S:tgEaENaAIdla8R:tgEaENMM:rhEcbhAindndnasamc:qDfaAfgvydbgX6mbasaX9hmeaEamcjDfaAfIdb9FTmekavasBdbamc:GDfaAfaLBdbamcjDfaAfaEUdbxdkaAclfgAcz9hmbkkarcefgral9hmbkkamczfaBfhLcbhscbhAindnamc:GDfasfydbgXcuSmbaLaAcdtfaXBdbaAcefhAkasclfgscz9hmbkaAa81fg81TmbJFFuuhhcuhKamczfhsa81hvcuhLina8AasydbgXcK2fgAIdway:tgEaENaAIdba8S:tgEaENaAIdla8R:tgEaENMM:rhEdndnazaiaXcx2fgAclfydbcdtfydbazaAydbcdtfydbfazaAcwfydbcdtfydbfgAaL6mbaAaL9hmeaEah9DTmekaEhhaAhLaXhKkasclfhsavcufgvmbkaKcuSmbaKhQkdnamaiaQcx2fgrydbarclfydbarcwfydbaCabaeadaPawaqa3z:fjjjbTmbaPcefhPJbbbbh8VJbbbbh8WJbbbbh8XJbbbbh8YJbbbbh8ZJbbbbh80kcbhXinaOaHaraXcdtfydbcdtgAfydbcdtfgKhsazaAfgvydbgLhAdnaLTmbdninasydbaQSmeasclfhsaAcufgATmdxbkkasaKaLcdtfc98fydbBdbavavydbcufBdbkaXcefgXci9hmbka8AaQcK2fgsIdbhEasIdlhhasIdwh8KasIdxh8EasIdzh5asIdCh8FaYaQfce86bba80a8FMh80a8Za5Mh8Za8Ya8EMh8Ya8Xa8KMh8Xa8WahMh8Wa8VaEMh8Vamydxh8Uxbkkamc:WDf8KjjjjbaPk;Vvivuv99lu8Jjjjjbca9Rgv8Kjjjjbdndnalcw0mbaiydbhoaeabcitfgralcdtcufBdlaraoBdbdnalcd6mbaiclfhoalcufhwarcxfhrinaoydbhDarcuBdbarc98faDBdbarcwfhraoclfhoawcufgwmbkkalabfhrxekcbhDavczfcwfcbBdbav9cb83izavcwfcbBdbav9cb83ibJbbjZhqJbbjZhkinadaiaDcdtfydbcK2fhwcbhrinavczfarfgoawarfIdbgxaoIdbgm:tgPakNamMgmUdbavarfgoaPaxam:tNaoIdbMUdbarclfgrcx9hmbkJbbjZaqJbbjZMgq:vhkaDcefgDal9hmbkcbhoadcbcecdavIdlgxavIdwgm9GEgravIdbgPam9GEaraPax9GEgscdtgrfhzavczfarfIdbhxaihralhwinaiaocdtfgDydbhHaDarydbgOBdbaraHBdbarclfhraoazaOcK2fIdbax9Dfhoawcufgwmbkaeabcitfhrdndnaocv6mbaoalc98f6mekaraiydbBdbaralcdtcufBdlaiclfhoalcufhwarcxfhrinaoydbhDarcuBdbarc98faDBdbarcwfhraoclfhoawcufgwmbkalabfhrxekaraxUdbararydlc98GasVBdlabcefaeadaiaoz:djjjbhwararydlciGawabcu7fcdtVBdlawaeadaiaocdtfalao9Rz:djjjbhrkavcaf8Kjjjjbark:;idiud99dndnabaecitfgwydlgDciGgqciSmbinabcbaDcd4gDalaqcdtfIdbawIdb:tgkJbbbb9FEgwaecefgefadaialavaoarz:ejjjbak:larIdb9FTmdabawaD7aefgecitfgwydlgDciGgqci9hmbkkabaecitfgeclfhbdnavmbcuhwindnaiaeydbgDfRbbmbadaDcK2fgqIdwalIdw:tgkakNaqIdbalIdb:tgkakNaqIdlalIdl:tgkakNMM:rgkarIdb9DTmbarakUdbaoaDBdbkaecwfheawcefgwabydbcd46mbxdkkcuhwindnaiaeydbgDfRbbmbadaDcK2fgqIdbalIdb:t:lgkaqIdlalIdl:t:lgxakax9EEgkaqIdwalIdw:t:lgxakax9EEgkarIdb9DTmbarakUdbaoaDBdbkaecwfheawcefgwabydbcd46mbkkk;llevudnabydwgxaladcetfgm8Vebcs4alaecetfgP8Vebgscs4falaicetfgz8Vebcs4ffaD0abydxaq9pVakVgDce9hmbavawcltfgxab8Pdb83dbaxcwfabcwfgx8Pdb83dbdnaxydbgqTmbaoabydbcdtfhxaqhsinalaxydbcetfcFFi87ebaxclfhxascufgsmbkkdnabydxglci2gsabydlgxfgkciGTmbarakfcbalaxcu7fciGcefz:ojjjb8Aabydxci2hsabydlhxabydwhqkab9cb83dwababydbaqfBdbabascifc98GaxfBdlaP8Vebhscbhxkdnascztcz91cu9kmbabaxcefBdwaPax87ebaoabydbcdtfaxcdtfaeBdbkdnam8Uebcu9kmbababydwgxcefBdwamax87ebaoabydbcdtfaxcdtfadBdbkdnaz8Uebcu9kmbababydwgxcefBdwazax87ebaoabydbcdtfaxcdtfaiBdbkarabydlfabydxci2faPRbb86bbarabydlfabydxci2fcefamRbb86bbarabydlfabydxci2fcdfazRbb86bbababydxcefBdxaDk8LbabaeadaialavaoarawaDaDaqJbbbbz:cjjjbk;Nkovud99euv99eul998Jjjjjbc:W;ae9Rgo8KjjjjbdndnadTmbavcd4hrcbhwcbhDindnaiaeclfydbar2cdtfgvIdbaiaeydbar2cdtfgqIdbgk:tgxaiaecwfydbar2cdtfgmIdlaqIdlgP:tgsNamIdbak:tgzavIdlaP:tgPN:tgkakNaPamIdwaqIdwgH:tgONasavIdwaH:tgHN:tgPaPNaHazNaOaxN:tgxaxNMM:rgsJbbbb9Bmbaoc:W:qefawcx2fgAakas:vUdwaAaxas:vUdlaAaPas:vUdbaoc8Wfawc8K2fgAaq8Pdb83dbaAav8Pdb83dxaAam8Pdb83dKaAcwfaqcwfydbBdbaAcCfavcwfydbBdbaAcafamcwfydbBdbawcefhwkaecxfheaDcifgDad6mbkab9cb83dbabcyf9cb83dbabcaf9cb83dbabcKf9cb83dbabczf9cb83dbabcwf9cb83dbawTmeaocbBd8Sao9cb83iKao9cb83izaoczfaoc8Wfawci2cxaoc8Sfcbcrz1jjjbaoIdKhCaoIdChXaoIdzhQao9cb83iwao9cb83ibaoaoc:W:qefawcxaoc8Sfcbciz1jjjbJbbjZhkaoIdwgPJbbbbJbbjZaPaPNaoIdbgPaPNaoIdlgsasNMM:rgx:vaxJbbbb9BEgzNhxasazNhsaPazNhzaoc:W:qefheawhvinaecwfIdbaxNaeIdbazNasaeclfIdbNMMgPakaPak9DEhkaecxfheavcufgvmbkabaCUdwabaXUdlabaQUdbabaoId3UdxdndnakJ;n;m;m899FmbJbbbbhPaoc:W:qefheaoc8WfhvinaCavcwfIdb:taecwfIdbgHNaQavIdb:taeIdbgONaXavclfIdb:taeclfIdbgLNMMaxaHNazaONasaLNMM:vgHaPaHaP9EEhPavc8KfhvaecxfheawcufgwmbkabaxUd8KabasUdaabazUd3abaCaxaPN:tUdKabaXasaPN:tUdCabaQazaPN:tUdzabJbbjZakakN:t:rgkUdydndnaxJbbj:;axJbbj:;9GEgPJbbjZaPJbbjZ9FEJbb;:9cNJbbbZJbbb:;axJbbbb9GEMgP:lJbbb9p9DTmbaP:Ohexekcjjjj94hekabae86b8UdndnasJbbj:;asJbbj:;9GEgPJbbjZaPJbbjZ9FEJbb;:9cNJbbbZJbbb:;asJbbbb9GEMgP:lJbbb9p9DTmbaP:Ohvxekcjjjj94hvkabav86bRdndnazJbbj:;azJbbj:;9GEgPJbbjZaPJbbjZ9FEJbb;:9cNJbbbZJbbb:;azJbbbb9GEMgP:lJbbb9p9DTmbaP:Ohqxekcjjjj94hqkabaq86b8SdndnaecKtcK91:YJbb;:9c:vax:t:lavcKtcK91:YJbb;:9c:vas:t:laqcKtcK91:YJbb;:9c:vaz:t:lakMMMJbb;:9cNJbbjZMgk:lJbbb9p9DTmbak:Ohexekcjjjj94hekaecFbaecFb9iEhexekabcjjj;8iBdycFbhekabae86b8Vxekab9cb83dbabcyf9cb83dbabcaf9cb83dbabcKf9cb83dbabczf9cb83dbabcwf9cb83dbkaoc:W;aef8Kjjjjbk;Iwwvul99iud99eue99eul998Jjjjjbcje9Rgr8Kjjjjbavcd4hwaicd4hDdndnaoTmbarc;abfcbaocdtgvz:ojjjb8Aarc;Gbfcbavz:ojjjb8AarhvarcafhiaohqinavcFFF97BdbaicFFF;7rBdbaiclfhiavclfhvaqcufgqmbkdnadTmbcbhkinaeakaD2cdtfgvIdwhxavIdlhmavIdbhPalakaw2cdtfIdbhsarc;abfhzarhiarc;GbfhHarcafhqcj1jjbhvaohOinasavcwfIdbaxNavIdbaPNavclfIdbamNMMgAMhCakhXdnaAas:tgAaqIdbgQ9DgLmbaHydbhXkaHaXBdbakhXdnaCaiIdbgK9EmbazydbhXaKhCkazaXBdbaiaCUdbaqaAaQaLEUdbavcxfhvaqclfhqaHclfhHaiclfhiazclfhzaOcufgOmbkakcefgkad9hmbkkadThkJbbbbhCcbhXarc;abfhvarc;Gbfhicbhqinalavydbgzaw2cdtfIdbalaiydbgHaw2cdtfIdbaeazaD2cdtfgzIdwaeaHaD2cdtfgHIdw:tgsasNazIdbaHIdb:tgsasNazIdlaHIdl:tgsasNMM:rMMgsaCasaC9EgzEhCaqaXazEhXaiclfhiavclfhvaoaqcefgq9hmbkaCJbbbZNhKxekadThkcbhXJbbbbhKkJbbbbhCdnaearc;abfaXcdtgifydbgqaD2cdtfgvIdwaearc;GbfaifydbgzaD2cdtfgiIdwgm:tgsasNavIdbaiIdbgY:tgAaANavIdlaiIdlgP:tgQaQNMM:rgxJbbbb9ETmbaxalaqaw2cdtfIdbMalazaw2cdtfIdb:taxaxM:vhCkasaCNamMhmaQaCNaPMhPaAaCNaYMhYdnakmbaDcdthvawcdthiindnalIdbg8AaecwfIdbam:tgCaCNaeIdbaY:tgsasNaeclfIdbaP:tgAaANMM:rgQMgEaK9ETmbJbbbbhxdnaQJbbbb9ETmbaEaK:taQaQM:vhxkaxaCNamMhmaxaANaPMhPaxasNaYMhYa8AaKaQMMJbbbZNhKkaeavfhealaifhladcufgdmbkkabaKUdxabamUdwabaPUdlabaYUdbarcjef8Kjjjjbkjeeiu8Jjjjjbcj8W9Rgr8Kjjjjbaici2hwdnaiTmbawceawce0EhDarhiinaiaeadRbbcdtfydbBdbadcefhdaiclfhiaDcufgDmbkkabarawaladaoz:hjjjbarcj8Wf8Kjjjjbk:Reeeu8Jjjjjbca9Rgo8Kjjjjbab9cb83dbabcyf9cb83dbabcaf9cb83dbabcKf9cb83dbabczf9cb83dbabcwf9cb83dbdnadTmbaocbBd3ao9cb83iwao9cb83ibaoaeadaialaoc3falEavcbalEcrz1jjjbabao8Pib83dbabao8Piw83dwkaocaf8Kjjjjbk:3lequ8JjjjjbcjP9Rgl8Kjjjjbcbhvalcjxfcbaiz:ojjjb8AdndnadTmbcjehoaehrincuhwarhDcuhqavhkdninawakaoalcjxfaDcefRbbfRbb9RcFeGci6aoalcjxfaDRbbfRbb9RcFeGci6faoalcjxfaDcdfRbbfRbb9RcFeGci6fgxaq9mgmEhwdnammbaxce0mdkaxaqaxaq9kEhqaDcifhDadakcefgk9hmbkkaeawci2fgDcdfRbbhqaDcefRbbhxaDRbbhkaeavci2fgDcifaDawav9Rci2z:rjjjb8Aakalcjxffaocefgo86bbaxalcjxffao86bbaDcdfaq86bbaDcefax86bbaDak86bbaqalcjxffao86bbarcifhravcefgvad9hmbkalcFeaicetz:ojjjbhoadci2gDceaDce0EhqcbhxindnaoaeRbbgkcetfgw8UebgDcu9kmbawax87ebaocjlfaxcdtfabakcdtfydbBdbaxhDaxcefhxkaeaD86bbaecefheaqcufgqmbkaxcdthDxekcbhDkabalcjlfaDz:njjjb8AalcjPf8Kjjjjbk9teiucbcbyd;C1jjbgeabcifc98GfgbBd;C1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;teeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiaeydlBdlaiaeydwBdwaiaeydxBdxaeczfheaiczfhiadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk:3eedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdxaialBdwaialBdlaialBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabk9teiucbcbyd;C1jjbgeabcrfc94GfgbBd;C1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik9:eiuZbhedndncbyd;C1jjbgdaecztgi9nmbcuheadai9RcFFifcz4nbcuSmekadhekcbabae9Rcifc98Gcbyd;C1jjbfgdBd;C1jjbdnadZbcztge9nmbadae9RcFFifcz4nb8Akk:;Deludndndnadch9pmbabaeSmdaeabadfgi9Rcbadcet9R0mekabaead;8qbbxekaeab7ciGhldndndnabae9pmbdnalTmbadhvabhixikdnabciGmbadhvabhixdkadTmiabaeRbb86bbadcufhvdnabcefgiciGmbaecefhexdkavTmiabaeRbe86beadc9:fhvdnabcdfgiciGmbaecdfhexdkavTmiabaeRbd86bdadc99fhvdnabcifgiciGmbaecifhexdkavTmiabaeRbi86biabclfhiaeclfheadc98fhvxekdnalmbdnaiciGTmbadTmlabadcufgifglaeaifRbb86bbdnalciGmbaihdxekaiTmlabadc9:fgifglaeaifRbb86bbdnalciGmbaihdxekaiTmlabadc99fgifglaeaifRbb86bbdnalciGmbaihdxekaiTmlabadc98fgdfaeadfRbb86bbkadcl6mbdnadc98fgocd4cefciGgiTmbaec98fhlabc98fhvinavadfaladfydbBdbadc98fhdaicufgimbkkaocx6mbaec9Wfhvabc9WfhoinaoadfgicxfavadfglcxfydbBdbaicwfalcwfydbBdbaiclfalclfydbBdbaialydbBdbadc9Wfgdci0mbkkadTmdadhidnadciGglTmbaecufhvabcufhoadhiinaoaifavaifRbb86bbaicufhialcufglmbkkadcl6mdaec98fhlabc98fhvinavaifgecifalaifgdcifRbb86bbaecdfadcdfRbb86bbaecefadcefRbb86bbaeadRbb86bbaic98fgimbxikkavcl6mbdnavc98fglcd4cefcrGgdTmbavadcdt9RhvinaiaeydbBdbaeclfheaiclfhiadcufgdmbkkalc36mbinaiaeydbBdbaiaeydlBdlaiaeydwBdwaiaeydxBdxaiaeydzBdzaiaeydCBdCaiaeydKBdKaiaeyd3Bd3aecafheaicafhiavc9Gfgvci0mbkkavTmbdndnavcrGgdmbavhlxekavc94GhlinaiaeRbb86bbaicefhiaecefheadcufgdmbkkavcw6mbinaiaeRbb86bbaiaeRbe86beaiaeRbd86bdaiaeRbi86biaiaeRbl86blaiaeRbv86bvaiaeRbo86boaiaeRbr86braicwfhiaecwfhealc94fglmbkkabkk9Tdbcjwk9ubbjZbbbbbbbbbbbbbbjZbbbbbbbbbbbbbbjZ86;nAZ86;nAZ86;nAZ86;nA:;86;nAZ86;nAZ86;nAZ86;nA:;86;nAZ86;nAZ86;nAZ86;nA:;bc;uwkxebbbdbbb9GNbb",e=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if(typeof WebAssembly!="object")return{supported:!1};var t,i=WebAssembly.instantiate(r(a),{}).then(function(p){t=p.instance,t.exports.__wasm_call_ctors()});function r(p){for(var g=new Uint8Array(p.length),b=0;b<p.length;++b){var A=p.charCodeAt(b);g[b]=A>96?A-97:A>64?A-39:A+4}for(var y=0,b=0;b<p.length;++b)g[y++]=g[b]<60?e[g[b]]:(g[b]-60)*64+g[++b];return g.buffer.slice(0,y)}function s(p){if(!p)throw new Error("Assertion failed")}function n(p){return new Uint8Array(p.buffer,p.byteOffset,p.byteLength)}var o=48,c=16;function l(p,g){var b=p.meshlets[g*4+0],A=p.meshlets[g*4+1],y=p.meshlets[g*4+2],x=p.meshlets[g*4+3];return{vertices:p.vertices.subarray(b,b+y),triangles:p.triangles.subarray(A,A+x*3)}}function h(p,g,b,A,y,x,E){var I=t.exports.sbrk,w=t.exports.meshopt_buildMeshletsBound(p.length,y,x),v=I(w*c),M=I(w*y*4),C=I(w*x*3),D=I(p.byteLength),S=I(g.byteLength),k=new Uint8Array(t.exports.memory.buffer);k.set(n(p),D),k.set(n(g),S);var F=t.exports.meshopt_buildMeshlets(v,M,C,D,p.length,S,b,A,y,x,E);k=new Uint8Array(t.exports.memory.buffer);for(var B=k.subarray(v,v+F*c),O=new Uint32Array(B.buffer,B.byteOffset,B.byteLength/4).slice(),L=0;L<F;++L){var _=O[L*4+0],q=O[L*4+1],b=O[L*4+2],J=O[L*4+3];t.exports.meshopt_optimizeMeshlet(M+_*4,C+q,J,b)}var Z=O[(F-1)*4+0],Y=O[(F-1)*4+1],W=O[(F-1)*4+2],T=O[(F-1)*4+3],ne=Z+W,le=Y+(T*3+3&-4),de={meshlets:O,vertices:new Uint32Array(k.buffer,M,ne).slice(),triangles:new Uint8Array(k.buffer,C,le*3).slice(),meshletCount:F};return I(v-I(0)),de}function d(p){var g=new Float32Array(t.exports.memory.buffer,p,o/4);return{centerX:g[0],centerY:g[1],centerZ:g[2],radius:g[3],coneApexX:g[4],coneApexY:g[5],coneApexZ:g[6],coneAxisX:g[7],coneAxisY:g[8],coneAxisZ:g[9],coneCutoff:g[10]}}function f(p,g,b,A){var y=t.exports.sbrk,x=[],E=y(g.byteLength),I=y(p.vertices.byteLength),w=y(p.triangles.byteLength),v=y(o),M=new Uint8Array(t.exports.memory.buffer);M.set(n(g),E),M.set(n(p.vertices),I),M.set(n(p.triangles),w);for(var C=0;C<p.meshletCount;++C){var D=p.meshlets[C*4+0],S=p.meshlets[C*4+0+1],k=p.meshlets[C*4+0+3];t.exports.meshopt_computeMeshletBounds(v,I+D*4,w+S,k,E,b,A),x.push(d(v))}return y(E-y(0)),x}function u(p,g,b,A){var y=t.exports.sbrk,x=y(o),E=y(p.byteLength),I=y(g.byteLength),w=new Uint8Array(t.exports.memory.buffer);w.set(n(p),E),w.set(n(g),I),t.exports.meshopt_computeClusterBounds(x,E,p.length,I,b,A);var v=d(x);return y(x-y(0)),v}function m(p,g,b,A,y){var x=t.exports.sbrk,E=x(o),I=x(p.byteLength),w=A?x(A.byteLength):0,v=new Uint8Array(t.exports.memory.buffer);v.set(n(p),I),A&&v.set(n(A),w),t.exports.meshopt_computeSphereBounds(E,I,g,b,w,A?y:0);var M=d(E);return x(E-x(0)),M}return{ready:i,supported:!0,buildMeshlets:function(p,g,b,A,y,x){s(p.length%3==0),s(g instanceof Float32Array),s(g.length%b==0),s(b>=3),s(A<=256||A>0),s(y<=512),s(y%4==0),x=x||0;var E=p.BYTES_PER_ELEMENT==4?p:new Uint32Array(p);return h(E,g,g.length/b,b*4,A,y,x)},extractMeshlet:function(p,g){return s(g>=0&&g<p.meshletCount),l(p,g)},computeClusterBounds:function(p,g,b){s(p.length%3==0),s(p.length/3<=512),s(g instanceof Float32Array),s(g.length%b==0),s(b>=3);var A=p.BYTES_PER_ELEMENT==4?p:new Uint32Array(p);return u(A,g,g.length/b,b*4)},computeMeshletBounds:function(p,g,b){return s(p.meshletCount!=0),s(g instanceof Float32Array),s(g.length%b==0),s(b>=3),f(p,g,g.length/b,b*4)},computeSphereBounds:function(p,g,b,A){return s(p instanceof Float32Array),s(p.length%g==0),s(g>=3),s(!b||b instanceof Float32Array),s(!b||b.length%A==0),s(!b||A>=1),s(!b||p.length/g==b.length/A),A=A||0,m(p,p.length/g,g*4,b,A*4)}}})();var ln={exports:{}};const kg={},yo=Object.freeze(Object.defineProperty({__proto__:null,default:kg},Symbol.toStringTag,{value:"Module"})),yn=yf(yo);var Ug=ln.exports,Jl;function jg(){return Jl||(Jl=1,(function(a,e){var t=t||{};t.scope={},t.arrayIteratorImpl=function(r){var s=0;return function(){return s<r.length?{done:!1,value:r[s++]}:{done:!0}}},t.arrayIterator=function(r){return{next:t.arrayIteratorImpl(r)}},t.makeIterator=function(r){var s=typeof Symbol<"u"&&Symbol.iterator&&r[Symbol.iterator];return s?s.call(r):t.arrayIterator(r)},t.ASSUME_ES5=!1,t.ASSUME_NO_NATIVE_MAP=!1,t.ASSUME_NO_NATIVE_SET=!1,t.SIMPLE_FROUND_POLYFILL=!1,t.ISOLATE_POLYFILLS=!1,t.FORCE_POLYFILL_PROMISE=!1,t.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,t.getGlobal=function(r){r=[typeof globalThis=="object"&&globalThis,r,typeof window=="object"&&window,typeof self=="object"&&self,typeof dn=="object"&&dn];for(var s=0;s<r.length;++s){var n=r[s];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")},t.global=t.getGlobal(Ug),t.defineProperty=t.ASSUME_ES5||typeof Object.defineProperties=="function"?Object.defineProperty:function(r,s,n){return r==Array.prototype||r==Object.prototype||(r[s]=n.value),r},t.IS_SYMBOL_NATIVE=typeof Symbol=="function"&&typeof Symbol("x")=="symbol",t.TRUST_ES6_POLYFILLS=!t.ISOLATE_POLYFILLS||t.IS_SYMBOL_NATIVE,t.polyfills={},t.propertyToPolyfillSymbol={},t.POLYFILL_PREFIX="$jscp$",t.polyfill=function(r,s,n,o){s&&(t.ISOLATE_POLYFILLS?t.polyfillIsolated(r,s,n,o):t.polyfillUnisolated(r,s,n,o))},t.polyfillUnisolated=function(r,s,n,o){for(n=t.global,r=r.split("."),o=0;o<r.length-1;o++){var c=r[o];if(!(c in n))return;n=n[c]}r=r[r.length-1],o=n[r],s=s(o),s!=o&&s!=null&&t.defineProperty(n,r,{configurable:!0,writable:!0,value:s})},t.polyfillIsolated=function(r,s,n,o){var c=r.split(".");r=c.length===1,o=c[0],o=!r&&o in t.polyfills?t.polyfills:t.global;for(var l=0;l<c.length-1;l++){var h=c[l];if(!(h in o))return;o=o[h]}c=c[c.length-1],n=t.IS_SYMBOL_NATIVE&&n==="es6"?o[c]:null,s=s(n),s!=null&&(r?t.defineProperty(t.polyfills,c,{configurable:!0,writable:!0,value:s}):s!==n&&(t.propertyToPolyfillSymbol[c]===void 0&&(n=1e9*Math.random()>>>0,t.propertyToPolyfillSymbol[c]=t.IS_SYMBOL_NATIVE?t.global.Symbol(c):t.POLYFILL_PREFIX+n+"$"+c),t.defineProperty(o,t.propertyToPolyfillSymbol[c],{configurable:!0,writable:!0,value:s})))},t.polyfill("Promise",function(r){function s(){this.batch_=null}function n(h){return h instanceof c?h:new c(function(d,f){d(h)})}if(r&&(!(t.FORCE_POLYFILL_PROMISE||t.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&typeof t.global.PromiseRejectionEvent>"u")||!t.global.Promise||t.global.Promise.toString().indexOf("[native code]")===-1))return r;s.prototype.asyncExecute=function(h){if(this.batch_==null){this.batch_=[];var d=this;this.asyncExecuteFunction(function(){d.executeBatch_()})}this.batch_.push(h)};var o=t.global.setTimeout;s.prototype.asyncExecuteFunction=function(h){o(h,0)},s.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var h=this.batch_;this.batch_=[];for(var d=0;d<h.length;++d){var f=h[d];h[d]=null;try{f()}catch(u){this.asyncThrow_(u)}}}this.batch_=null},s.prototype.asyncThrow_=function(h){this.asyncExecuteFunction(function(){throw h})};var c=function(h){this.state_=0,this.result_=void 0,this.onSettledCallbacks_=[],this.isRejectionHandled_=!1;var d=this.createResolveAndReject_();try{h(d.resolve,d.reject)}catch(f){d.reject(f)}};c.prototype.createResolveAndReject_=function(){function h(u){return function(m){f||(f=!0,u.call(d,m))}}var d=this,f=!1;return{resolve:h(this.resolveTo_),reject:h(this.reject_)}},c.prototype.resolveTo_=function(h){if(h===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(h instanceof c)this.settleSameAsPromise_(h);else{e:switch(typeof h){case"object":var d=h!=null;break e;case"function":d=!0;break e;default:d=!1}d?this.resolveToNonPromiseObj_(h):this.fulfill_(h)}},c.prototype.resolveToNonPromiseObj_=function(h){var d=void 0;try{d=h.then}catch(f){this.reject_(f);return}typeof d=="function"?this.settleSameAsThenable_(d,h):this.fulfill_(h)},c.prototype.reject_=function(h){this.settle_(2,h)},c.prototype.fulfill_=function(h){this.settle_(1,h)},c.prototype.settle_=function(h,d){if(this.state_!=0)throw Error("Cannot settle("+h+", "+d+"): Promise already settled in state"+this.state_);this.state_=h,this.result_=d,this.state_===2&&this.scheduleUnhandledRejectionCheck_(),this.executeOnSettledCallbacks_()},c.prototype.scheduleUnhandledRejectionCheck_=function(){var h=this;o(function(){if(h.notifyUnhandledRejection_()){var d=t.global.console;typeof d<"u"&&d.error(h.result_)}},1)},c.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var h=t.global.CustomEvent,d=t.global.Event,f=t.global.dispatchEvent;return typeof f>"u"?!0:(typeof h=="function"?h=new h("unhandledrejection",{cancelable:!0}):typeof d=="function"?h=new d("unhandledrejection",{cancelable:!0}):(h=t.global.document.createEvent("CustomEvent"),h.initCustomEvent("unhandledrejection",!1,!0,h)),h.promise=this,h.reason=this.result_,f(h))},c.prototype.executeOnSettledCallbacks_=function(){if(this.onSettledCallbacks_!=null){for(var h=0;h<this.onSettledCallbacks_.length;++h)l.asyncExecute(this.onSettledCallbacks_[h]);this.onSettledCallbacks_=null}};var l=new s;return c.prototype.settleSameAsPromise_=function(h){var d=this.createResolveAndReject_();h.callWhenSettled_(d.resolve,d.reject)},c.prototype.settleSameAsThenable_=function(h,d){var f=this.createResolveAndReject_();try{h.call(d,f.resolve,f.reject)}catch(u){f.reject(u)}},c.prototype.then=function(h,d){function f(g,b){return typeof g=="function"?function(A){try{u(g(A))}catch(y){m(y)}}:b}var u,m,p=new c(function(g,b){u=g,m=b});return this.callWhenSettled_(f(h,u),f(d,m)),p},c.prototype.catch=function(h){return this.then(void 0,h)},c.prototype.callWhenSettled_=function(h,d){function f(){switch(u.state_){case 1:h(u.result_);break;case 2:d(u.result_);break;default:throw Error("Unexpected state: "+u.state_)}}var u=this;this.onSettledCallbacks_==null?l.asyncExecute(f):this.onSettledCallbacks_.push(f),this.isRejectionHandled_=!0},c.resolve=n,c.reject=function(h){return new c(function(d,f){f(h)})},c.race=function(h){return new c(function(d,f){for(var u=t.makeIterator(h),m=u.next();!m.done;m=u.next())n(m.value).callWhenSettled_(d,f)})},c.all=function(h){var d=t.makeIterator(h),f=d.next();return f.done?n([]):new c(function(u,m){function p(A){return function(y){g[A]=y,b--,b==0&&u(g)}}var g=[],b=0;do g.push(void 0),b++,n(f.value).callWhenSettled_(p(g.length-1),m),f=d.next();while(!f.done)})},c},"es6","es3"),t.owns=function(r,s){return Object.prototype.hasOwnProperty.call(r,s)},t.assign=t.TRUST_ES6_POLYFILLS&&typeof Object.assign=="function"?Object.assign:function(r,s){for(var n=1;n<arguments.length;n++){var o=arguments[n];if(o)for(var c in o)t.owns(o,c)&&(r[c]=o[c])}return r},t.polyfill("Object.assign",function(r){return r||t.assign},"es6","es3"),t.checkStringArgs=function(r,s,n){if(r==null)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(s instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return r+""},t.polyfill("String.prototype.startsWith",function(r){return r||function(s,n){var o=t.checkStringArgs(this,s,"startsWith");s+="";var c=o.length,l=s.length;n=Math.max(0,Math.min(n|0,o.length));for(var h=0;h<l&&n<c;)if(o[n++]!=s[h++])return!1;return h>=l}},"es6","es3"),t.polyfill("Array.prototype.copyWithin",function(r){function s(n){return n=Number(n),n===1/0||n===-1/0?n:n|0}return r||function(n,o,c){var l=this.length;if(n=s(n),o=s(o),c=c===void 0?l:s(c),n=0>n?Math.max(l+n,0):Math.min(n,l),o=0>o?Math.max(l+o,0):Math.min(o,l),c=0>c?Math.max(l+c,0):Math.min(c,l),n<o)for(;o<c;)o in this?this[n++]=this[o++]:(delete this[n++],o++);else for(c=Math.min(c,l+o-n),n+=c-o;c>o;)--c in this?this[--n]=this[c]:delete this[--n];return this}},"es6","es3"),t.typedArrayCopyWithin=function(r){return r||Array.prototype.copyWithin},t.polyfill("Int8Array.prototype.copyWithin",t.typedArrayCopyWithin,"es6","es5"),t.polyfill("Uint8Array.prototype.copyWithin",t.typedArrayCopyWithin,"es6","es5"),t.polyfill("Uint8ClampedArray.prototype.copyWithin",t.typedArrayCopyWithin,"es6","es5"),t.polyfill("Int16Array.prototype.copyWithin",t.typedArrayCopyWithin,"es6","es5"),t.polyfill("Uint16Array.prototype.copyWithin",t.typedArrayCopyWithin,"es6","es5"),t.polyfill("Int32Array.prototype.copyWithin",t.typedArrayCopyWithin,"es6","es5"),t.polyfill("Uint32Array.prototype.copyWithin",t.typedArrayCopyWithin,"es6","es5"),t.polyfill("Float32Array.prototype.copyWithin",t.typedArrayCopyWithin,"es6","es5"),t.polyfill("Float64Array.prototype.copyWithin",t.typedArrayCopyWithin,"es6","es5");var i=(function(){var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),function(s){function n(N){return _.locateFile?_.locateFile(N,de):de+N}function o(){var N=Ut.buffer;_.HEAP8=rt=new Int8Array(N),_.HEAP16=Lt=new Int16Array(N),_.HEAP32=mt=new Int32Array(N),_.HEAPU8=wa=new Uint8Array(N),_.HEAPU16=new Uint16Array(N),_.HEAPU32=gt=new Uint32Array(N),_.HEAPF32=za=new Float32Array(N),_.HEAPF64=new Float64Array(N)}function c(N){throw _.onAbort&&_.onAbort(N),N="Aborted("+N+")",Pe(N),Ga=!0,N=new WebAssembly.RuntimeError(N+". Build with -sASSERTIONS for more info."),J(N),N}function l(N){try{if(N==Je&&pt)return new Uint8Array(pt);if(Ae)return Ae(N);throw"both async and sync fetching of the wasm failed"}catch(j){c(j)}}function h(){if(!pt&&(T||ne)){if(typeof fetch=="function"&&!Je.startsWith("file://"))return fetch(Je,{credentials:"same-origin"}).then(function(N){if(!N.ok)throw"failed to load wasm binary file at '"+Je+"'";return N.arrayBuffer()}).catch(function(){return l(Je)});if(_e)return new Promise(function(N,j){_e(Je,function(G){N(new Uint8Array(G))},j)})}return Promise.resolve().then(function(){return l(Je)})}function d(N){for(;0<N.length;)N.shift()(_)}function f(N){this.excPtr=N,this.ptr=N-24,this.set_type=function(j){gt[this.ptr+4>>2]=j},this.get_type=function(){return gt[this.ptr+4>>2]},this.set_destructor=function(j){gt[this.ptr+8>>2]=j},this.get_destructor=function(){return gt[this.ptr+8>>2]},this.set_refcount=function(j){mt[this.ptr>>2]=j},this.set_caught=function(j){rt[this.ptr+12>>0]=j?1:0},this.get_caught=function(){return rt[this.ptr+12>>0]!=0},this.set_rethrown=function(j){rt[this.ptr+13>>0]=j?1:0},this.get_rethrown=function(){return rt[this.ptr+13>>0]!=0},this.init=function(j,G){this.set_adjusted_ptr(0),this.set_type(j),this.set_destructor(G),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){mt[this.ptr>>2]+=1},this.release_ref=function(){var j=mt[this.ptr>>2];return mt[this.ptr>>2]=j-1,j===1},this.set_adjusted_ptr=function(j){gt[this.ptr+16>>2]=j},this.get_adjusted_ptr=function(){return gt[this.ptr+16>>2]},this.get_exception_ptr=function(){if(zr(this.get_type()))return gt[this.excPtr>>2];var j=this.get_adjusted_ptr();return j!==0?j:this.excPtr}}function u(){function N(){if(!Ea&&(Ea=!0,_.calledRun=!0,!Ga)){if(sa=!0,d(At),q(_),_.onRuntimeInitialized&&_.onRuntimeInitialized(),_.postRun)for(typeof _.postRun=="function"&&(_.postRun=[_.postRun]);_.postRun.length;)va.unshift(_.postRun.shift());d(va)}}if(!(0<$e)){if(_.preRun)for(typeof _.preRun=="function"&&(_.preRun=[_.preRun]);_.preRun.length;)si.unshift(_.preRun.shift());d(si),0<$e||(_.setStatus?(_.setStatus("Running..."),setTimeout(function(){setTimeout(function(){_.setStatus("")},1),N()},1)):N())}}function m(){}function p(N){return(N||m).__cache__}function g(N,j){var G=p(j),H=G[N];return H||(H=Object.create((j||m).prototype),H.ptr=N,G[N]=H)}function b(N){if(typeof N=="string"){for(var j=0,G=0;G<N.length;++G){var H=N.charCodeAt(G);127>=H?j++:2047>=H?j+=2:55296<=H&&57343>=H?(j+=4,++G):j+=3}if(j=Array(j+1),G=0,H=j.length,0<H){H=G+H-1;for(var Q=0;Q<N.length;++Q){var re=N.charCodeAt(Q);if(55296<=re&&57343>=re){var Kr=N.charCodeAt(++Q);re=65536+((re&1023)<<10)|Kr&1023}if(127>=re){if(G>=H)break;j[G++]=re}else{if(2047>=re){if(G+1>=H)break;j[G++]=192|re>>6}else{if(65535>=re){if(G+2>=H)break;j[G++]=224|re>>12}else{if(G+3>=H)break;j[G++]=240|re>>18,j[G++]=128|re>>12&63}j[G++]=128|re>>6&63}j[G++]=128|re&63}}j[G]=0}return N=oe.alloc(j,rt),oe.copy(j,rt,N),N}return N}function A(N){if(typeof N=="object"){var j=oe.alloc(N,rt);return oe.copy(N,rt,j),j}return N}function y(N){if(typeof N=="object"){var j=oe.alloc(N,Lt);return oe.copy(N,Lt,j),j}return N}function x(N){if(typeof N=="object"){var j=oe.alloc(N,mt);return oe.copy(N,mt,j),j}return N}function E(N){if(typeof N=="object"){var j=oe.alloc(N,za);return oe.copy(N,za,j),j}return N}function I(){throw"cannot construct a VoidPtr, no constructor in IDL"}function w(){this.ptr=jt(),p(w)[this.ptr]=this}function v(){this.ptr=et(),p(v)[this.ptr]=this}function M(){this.ptr=pi(),p(M)[this.ptr]=this}function C(){this.ptr=yi(),p(C)[this.ptr]=this}function D(){this.ptr=Ii(),p(D)[this.ptr]=this}function S(){this.ptr=Ci(),p(S)[this.ptr]=this}function k(){this.ptr=Fi(),p(k)[this.ptr]=this}function F(){this.ptr=Bi(),p(F)[this.ptr]=this}function B(){this.ptr=Xi(),p(B)[this.ptr]=this}function O(){this.ptr=dr(),p(O)[this.ptr]=this}function L(N){N&&typeof N=="object"&&(N=N.ptr),this.ptr=vr(N),p(L)[this.ptr]=this}s=s===void 0?{}:s;var _=typeof s<"u"?s:{},q,J;_.ready=new Promise(function(N,j){q=N,J=j});var Z=!1,Y=!1;_.onRuntimeInitialized=function(){Z=!0,Y&&typeof _.onModuleLoaded=="function"&&_.onModuleLoaded(_)},_.onModuleParsed=function(){Y=!0,Z&&typeof _.onModuleLoaded=="function"&&_.onModuleLoaded(_)},_.isVersionSupported=function(N){return typeof N!="string"?!1:(N=N.split("."),2>N.length||3<N.length?!1:N[0]==1&&0<=N[1]&&5>=N[1]?!0:!(N[0]!=0||10<N[1]))};var W=Object.assign({},_),T=typeof window=="object",ne=typeof importScripts=="function",le=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",de="";if(le){var Me=yn,Ne=yn;de=ne?Ne.dirname(de)+"/":__dirname+"/";var ge=function(N,j){return N=N.startsWith("file://")?new URL(N):Ne.normalize(N),Me.readFileSync(N,j?void 0:"utf8")},Ae=function(N){return N=ge(N,!0),N.buffer||(N=new Uint8Array(N)),N},_e=function(N,j,G){N=N.startsWith("file://")?new URL(N):Ne.normalize(N),Me.readFile(N,function(H,Q){H?G(H):j(Q.buffer)})};1<process.argv.length&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),_.inspect=function(){return"[Emscripten Module object]"}}else(T||ne)&&(ne?de=self.location.href:typeof document<"u"&&document.currentScript&&(de=document.currentScript.src),r&&(de=r),de=de.indexOf("blob:")!==0?de.substr(0,de.replace(/[?#].*/,"").lastIndexOf("/")+1):"",ge=function(N){var j=new XMLHttpRequest;return j.open("GET",N,!1),j.send(null),j.responseText},ne&&(Ae=function(N){var j=new XMLHttpRequest;return j.open("GET",N,!1),j.responseType="arraybuffer",j.send(null),new Uint8Array(j.response)}),_e=function(N,j,G){var H=new XMLHttpRequest;H.open("GET",N,!0),H.responseType="arraybuffer",H.onload=function(){H.status==200||H.status==0&&H.response?j(H.response):G()},H.onerror=G,H.send(null)});_.print||console.log.bind(console);var Pe=_.printErr||console.warn.bind(console);Object.assign(_,W),W=null;var pt;_.wasmBinary&&(pt=_.wasmBinary),typeof WebAssembly!="object"&&c("no native wasm support detected");var Ut,Ga=!1,rt,wa,Lt,mt,gt,za,si=[],At=[],va=[],sa=!1,$e=0,na=null,Je="draco_encoder.wasm";Je.startsWith("data:application/octet-stream;base64,")||(Je=n(Je));var ks={b:function(N,j,G){throw new f(N).init(j,G),N},a:function(){c("")},d:function(N,j,G){wa.copyWithin(N,j,j+G)},c:function(N){var j=wa.length;if(N>>>=0,2147483648<N)return!1;for(var G=1;4>=G;G*=2){var H=j*(1+.2/G);H=Math.min(H,N+100663296);var Q=Math;H=Math.max(N,H),Q=Q.min.call(Q,2147483648,H+(65536-H%65536)%65536);e:{H=Ut.buffer;try{Ut.grow(Q-H.byteLength+65535>>>16),o();var re=1;break e}catch{}re=void 0}if(re)return!0}return!1}};(function(){function N(Q,re){_.asm=Q.exports,Ut=_.asm.e,o(),At.unshift(_.asm.f),$e--,_.monitorRunDependencies&&_.monitorRunDependencies($e),$e==0&&na&&(Q=na,na=null,Q())}function j(Q){N(Q.instance)}function G(Q){return h().then(function(re){return WebAssembly.instantiate(re,H)}).then(function(re){return re}).then(Q,function(re){Pe("failed to asynchronously prepare wasm: "+re),c(re)})}var H={a:ks};if($e++,_.monitorRunDependencies&&_.monitorRunDependencies($e),_.instantiateWasm)try{return _.instantiateWasm(H,N)}catch(Q){Pe("Module.instantiateWasm callback failed with error: "+Q),J(Q)}return(function(){return pt||typeof WebAssembly.instantiateStreaming!="function"||Je.startsWith("data:application/octet-stream;base64,")||Je.startsWith("file://")||le||typeof fetch!="function"?G(j):fetch(Je,{credentials:"same-origin"}).then(function(Q){return WebAssembly.instantiateStreaming(Q,H).then(j,function(re){return Pe("wasm streaming compile failed: "+re),Pe("falling back to ArrayBuffer instantiation"),G(j)})})})().catch(J),{}})();var ni=_._emscripten_bind_VoidPtr___destroy___0=function(){return(ni=_._emscripten_bind_VoidPtr___destroy___0=_.asm.h).apply(null,arguments)},jt=_._emscripten_bind_GeometryAttribute_GeometryAttribute_0=function(){return(jt=_._emscripten_bind_GeometryAttribute_GeometryAttribute_0=_.asm.i).apply(null,arguments)},oa=_._emscripten_bind_GeometryAttribute___destroy___0=function(){return(oa=_._emscripten_bind_GeometryAttribute___destroy___0=_.asm.j).apply(null,arguments)},et=_._emscripten_bind_PointAttribute_PointAttribute_0=function(){return(et=_._emscripten_bind_PointAttribute_PointAttribute_0=_.asm.k).apply(null,arguments)},Us=_._emscripten_bind_PointAttribute_size_0=function(){return(Us=_._emscripten_bind_PointAttribute_size_0=_.asm.l).apply(null,arguments)},oi=_._emscripten_bind_PointAttribute_attribute_type_0=function(){return(oi=_._emscripten_bind_PointAttribute_attribute_type_0=_.asm.m).apply(null,arguments)},ci=_._emscripten_bind_PointAttribute_data_type_0=function(){return(ci=_._emscripten_bind_PointAttribute_data_type_0=_.asm.n).apply(null,arguments)},li=_._emscripten_bind_PointAttribute_num_components_0=function(){return(li=_._emscripten_bind_PointAttribute_num_components_0=_.asm.o).apply(null,arguments)},hi=_._emscripten_bind_PointAttribute_normalized_0=function(){return(hi=_._emscripten_bind_PointAttribute_normalized_0=_.asm.p).apply(null,arguments)},di=_._emscripten_bind_PointAttribute_byte_stride_0=function(){return(di=_._emscripten_bind_PointAttribute_byte_stride_0=_.asm.q).apply(null,arguments)},fi=_._emscripten_bind_PointAttribute_byte_offset_0=function(){return(fi=_._emscripten_bind_PointAttribute_byte_offset_0=_.asm.r).apply(null,arguments)},ui=_._emscripten_bind_PointAttribute_unique_id_0=function(){return(ui=_._emscripten_bind_PointAttribute_unique_id_0=_.asm.s).apply(null,arguments)},bi=_._emscripten_bind_PointAttribute___destroy___0=function(){return(bi=_._emscripten_bind_PointAttribute___destroy___0=_.asm.t).apply(null,arguments)},pi=_._emscripten_bind_PointCloud_PointCloud_0=function(){return(pi=_._emscripten_bind_PointCloud_PointCloud_0=_.asm.u).apply(null,arguments)},mi=_._emscripten_bind_PointCloud_num_attributes_0=function(){return(mi=_._emscripten_bind_PointCloud_num_attributes_0=_.asm.v).apply(null,arguments)},gi=_._emscripten_bind_PointCloud_num_points_0=function(){return(gi=_._emscripten_bind_PointCloud_num_points_0=_.asm.w).apply(null,arguments)},Ai=_._emscripten_bind_PointCloud___destroy___0=function(){return(Ai=_._emscripten_bind_PointCloud___destroy___0=_.asm.x).apply(null,arguments)},yi=_._emscripten_bind_Mesh_Mesh_0=function(){return(yi=_._emscripten_bind_Mesh_Mesh_0=_.asm.y).apply(null,arguments)},xi=_._emscripten_bind_Mesh_num_faces_0=function(){return(xi=_._emscripten_bind_Mesh_num_faces_0=_.asm.z).apply(null,arguments)},wi=_._emscripten_bind_Mesh_num_attributes_0=function(){return(wi=_._emscripten_bind_Mesh_num_attributes_0=_.asm.A).apply(null,arguments)},vi=_._emscripten_bind_Mesh_num_points_0=function(){return(vi=_._emscripten_bind_Mesh_num_points_0=_.asm.B).apply(null,arguments)},Ei=_._emscripten_bind_Mesh_set_num_points_1=function(){return(Ei=_._emscripten_bind_Mesh_set_num_points_1=_.asm.C).apply(null,arguments)},Ti=_._emscripten_bind_Mesh___destroy___0=function(){return(Ti=_._emscripten_bind_Mesh___destroy___0=_.asm.D).apply(null,arguments)},Ii=_._emscripten_bind_Metadata_Metadata_0=function(){return(Ii=_._emscripten_bind_Metadata_Metadata_0=_.asm.E).apply(null,arguments)},Mi=_._emscripten_bind_Metadata___destroy___0=function(){return(Mi=_._emscripten_bind_Metadata___destroy___0=_.asm.F).apply(null,arguments)},Ci=_._emscripten_bind_DracoInt8Array_DracoInt8Array_0=function(){return(Ci=_._emscripten_bind_DracoInt8Array_DracoInt8Array_0=_.asm.G).apply(null,arguments)},Di=_._emscripten_bind_DracoInt8Array_GetValue_1=function(){return(Di=_._emscripten_bind_DracoInt8Array_GetValue_1=_.asm.H).apply(null,arguments)},_i=_._emscripten_bind_DracoInt8Array_size_0=function(){return(_i=_._emscripten_bind_DracoInt8Array_size_0=_.asm.I).apply(null,arguments)},Si=_._emscripten_bind_DracoInt8Array___destroy___0=function(){return(Si=_._emscripten_bind_DracoInt8Array___destroy___0=_.asm.J).apply(null,arguments)},Fi=_._emscripten_bind_MetadataBuilder_MetadataBuilder_0=function(){return(Fi=_._emscripten_bind_MetadataBuilder_MetadataBuilder_0=_.asm.K).apply(null,arguments)},Ri=_._emscripten_bind_MetadataBuilder_AddStringEntry_3=function(){return(Ri=_._emscripten_bind_MetadataBuilder_AddStringEntry_3=_.asm.L).apply(null,arguments)},Ni=_._emscripten_bind_MetadataBuilder_AddIntEntry_3=function(){return(Ni=_._emscripten_bind_MetadataBuilder_AddIntEntry_3=_.asm.M).apply(null,arguments)},ki=_._emscripten_bind_MetadataBuilder_AddIntEntryArray_4=function(){return(ki=_._emscripten_bind_MetadataBuilder_AddIntEntryArray_4=_.asm.N).apply(null,arguments)},Ui=_._emscripten_bind_MetadataBuilder_AddDoubleEntry_3=function(){return(Ui=_._emscripten_bind_MetadataBuilder_AddDoubleEntry_3=_.asm.O).apply(null,arguments)},ji=_._emscripten_bind_MetadataBuilder___destroy___0=function(){return(ji=_._emscripten_bind_MetadataBuilder___destroy___0=_.asm.P).apply(null,arguments)},Bi=_._emscripten_bind_PointCloudBuilder_PointCloudBuilder_0=function(){return(Bi=_._emscripten_bind_PointCloudBuilder_PointCloudBuilder_0=_.asm.Q).apply(null,arguments)},Pi=_._emscripten_bind_PointCloudBuilder_AddFloatAttribute_5=function(){return(Pi=_._emscripten_bind_PointCloudBuilder_AddFloatAttribute_5=_.asm.R).apply(null,arguments)},Oi=_._emscripten_bind_PointCloudBuilder_AddInt8Attribute_5=function(){return(Oi=_._emscripten_bind_PointCloudBuilder_AddInt8Attribute_5=_.asm.S).apply(null,arguments)},Vi=_._emscripten_bind_PointCloudBuilder_AddUInt8Attribute_5=function(){return(Vi=_._emscripten_bind_PointCloudBuilder_AddUInt8Attribute_5=_.asm.T).apply(null,arguments)},Li=_._emscripten_bind_PointCloudBuilder_AddInt16Attribute_5=function(){return(Li=_._emscripten_bind_PointCloudBuilder_AddInt16Attribute_5=_.asm.U).apply(null,arguments)},Gi=_._emscripten_bind_PointCloudBuilder_AddUInt16Attribute_5=function(){return(Gi=_._emscripten_bind_PointCloudBuilder_AddUInt16Attribute_5=_.asm.V).apply(null,arguments)},zi=_._emscripten_bind_PointCloudBuilder_AddInt32Attribute_5=function(){return(zi=_._emscripten_bind_PointCloudBuilder_AddInt32Attribute_5=_.asm.W).apply(null,arguments)},Ki=_._emscripten_bind_PointCloudBuilder_AddUInt32Attribute_5=function(){return(Ki=_._emscripten_bind_PointCloudBuilder_AddUInt32Attribute_5=_.asm.X).apply(null,arguments)},Hi=_._emscripten_bind_PointCloudBuilder_AddMetadata_2=function(){return(Hi=_._emscripten_bind_PointCloudBuilder_AddMetadata_2=_.asm.Y).apply(null,arguments)},qi=_._emscripten_bind_PointCloudBuilder_SetMetadataForAttribute_3=function(){return(qi=_._emscripten_bind_PointCloudBuilder_SetMetadataForAttribute_3=_.asm.Z).apply(null,arguments)},Wi=_._emscripten_bind_PointCloudBuilder_SetNormalizedFlagForAttribute_3=function(){return(Wi=_._emscripten_bind_PointCloudBuilder_SetNormalizedFlagForAttribute_3=_.asm._).apply(null,arguments)},Yi=_._emscripten_bind_PointCloudBuilder___destroy___0=function(){return(Yi=_._emscripten_bind_PointCloudBuilder___destroy___0=_.asm.$).apply(null,arguments)},Xi=_._emscripten_bind_MeshBuilder_MeshBuilder_0=function(){return(Xi=_._emscripten_bind_MeshBuilder_MeshBuilder_0=_.asm.aa).apply(null,arguments)},Qi=_._emscripten_bind_MeshBuilder_AddFacesToMesh_3=function(){return(Qi=_._emscripten_bind_MeshBuilder_AddFacesToMesh_3=_.asm.ba).apply(null,arguments)},Ji=_._emscripten_bind_MeshBuilder_AddFloatAttributeToMesh_5=function(){return(Ji=_._emscripten_bind_MeshBuilder_AddFloatAttributeToMesh_5=_.asm.ca).apply(null,arguments)},Zi=_._emscripten_bind_MeshBuilder_AddInt32AttributeToMesh_5=function(){return(Zi=_._emscripten_bind_MeshBuilder_AddInt32AttributeToMesh_5=_.asm.da).apply(null,arguments)},$i=_._emscripten_bind_MeshBuilder_AddMetadataToMesh_2=function(){return($i=_._emscripten_bind_MeshBuilder_AddMetadataToMesh_2=_.asm.ea).apply(null,arguments)},er=_._emscripten_bind_MeshBuilder_AddFloatAttribute_5=function(){return(er=_._emscripten_bind_MeshBuilder_AddFloatAttribute_5=_.asm.fa).apply(null,arguments)},tr=_._emscripten_bind_MeshBuilder_AddInt8Attribute_5=function(){return(tr=_._emscripten_bind_MeshBuilder_AddInt8Attribute_5=_.asm.ga).apply(null,arguments)},ar=_._emscripten_bind_MeshBuilder_AddUInt8Attribute_5=function(){return(ar=_._emscripten_bind_MeshBuilder_AddUInt8Attribute_5=_.asm.ha).apply(null,arguments)},ir=_._emscripten_bind_MeshBuilder_AddInt16Attribute_5=function(){return(ir=_._emscripten_bind_MeshBuilder_AddInt16Attribute_5=_.asm.ia).apply(null,arguments)},rr=_._emscripten_bind_MeshBuilder_AddUInt16Attribute_5=function(){return(rr=_._emscripten_bind_MeshBuilder_AddUInt16Attribute_5=_.asm.ja).apply(null,arguments)},sr=_._emscripten_bind_MeshBuilder_AddInt32Attribute_5=function(){return(sr=_._emscripten_bind_MeshBuilder_AddInt32Attribute_5=_.asm.ka).apply(null,arguments)},nr=_._emscripten_bind_MeshBuilder_AddUInt32Attribute_5=function(){return(nr=_._emscripten_bind_MeshBuilder_AddUInt32Attribute_5=_.asm.la).apply(null,arguments)},or=_._emscripten_bind_MeshBuilder_AddMetadata_2=function(){return(or=_._emscripten_bind_MeshBuilder_AddMetadata_2=_.asm.ma).apply(null,arguments)},cr=_._emscripten_bind_MeshBuilder_SetMetadataForAttribute_3=function(){return(cr=_._emscripten_bind_MeshBuilder_SetMetadataForAttribute_3=_.asm.na).apply(null,arguments)},lr=_._emscripten_bind_MeshBuilder_SetNormalizedFlagForAttribute_3=function(){return(lr=_._emscripten_bind_MeshBuilder_SetNormalizedFlagForAttribute_3=_.asm.oa).apply(null,arguments)},hr=_._emscripten_bind_MeshBuilder___destroy___0=function(){return(hr=_._emscripten_bind_MeshBuilder___destroy___0=_.asm.pa).apply(null,arguments)},dr=_._emscripten_bind_Encoder_Encoder_0=function(){return(dr=_._emscripten_bind_Encoder_Encoder_0=_.asm.qa).apply(null,arguments)},fr=_._emscripten_bind_Encoder_SetEncodingMethod_1=function(){return(fr=_._emscripten_bind_Encoder_SetEncodingMethod_1=_.asm.ra).apply(null,arguments)},ur=_._emscripten_bind_Encoder_SetAttributeQuantization_2=function(){return(ur=_._emscripten_bind_Encoder_SetAttributeQuantization_2=_.asm.sa).apply(null,arguments)},br=_._emscripten_bind_Encoder_SetAttributeExplicitQuantization_5=function(){return(br=_._emscripten_bind_Encoder_SetAttributeExplicitQuantization_5=_.asm.ta).apply(null,arguments)},pr=_._emscripten_bind_Encoder_SetSpeedOptions_2=function(){return(pr=_._emscripten_bind_Encoder_SetSpeedOptions_2=_.asm.ua).apply(null,arguments)},mr=_._emscripten_bind_Encoder_SetTrackEncodedProperties_1=function(){return(mr=_._emscripten_bind_Encoder_SetTrackEncodedProperties_1=_.asm.va).apply(null,arguments)},gr=_._emscripten_bind_Encoder_EncodeMeshToDracoBuffer_2=function(){return(gr=_._emscripten_bind_Encoder_EncodeMeshToDracoBuffer_2=_.asm.wa).apply(null,arguments)},Ar=_._emscripten_bind_Encoder_EncodePointCloudToDracoBuffer_3=function(){return(Ar=_._emscripten_bind_Encoder_EncodePointCloudToDracoBuffer_3=_.asm.xa).apply(null,arguments)},yr=_._emscripten_bind_Encoder_GetNumberOfEncodedPoints_0=function(){return(yr=_._emscripten_bind_Encoder_GetNumberOfEncodedPoints_0=_.asm.ya).apply(null,arguments)},xr=_._emscripten_bind_Encoder_GetNumberOfEncodedFaces_0=function(){return(xr=_._emscripten_bind_Encoder_GetNumberOfEncodedFaces_0=_.asm.za).apply(null,arguments)},wr=_._emscripten_bind_Encoder___destroy___0=function(){return(wr=_._emscripten_bind_Encoder___destroy___0=_.asm.Aa).apply(null,arguments)},vr=_._emscripten_bind_ExpertEncoder_ExpertEncoder_1=function(){return(vr=_._emscripten_bind_ExpertEncoder_ExpertEncoder_1=_.asm.Ba).apply(null,arguments)},Er=_._emscripten_bind_ExpertEncoder_SetEncodingMethod_1=function(){return(Er=_._emscripten_bind_ExpertEncoder_SetEncodingMethod_1=_.asm.Ca).apply(null,arguments)},Tr=_._emscripten_bind_ExpertEncoder_SetAttributeQuantization_2=function(){return(Tr=_._emscripten_bind_ExpertEncoder_SetAttributeQuantization_2=_.asm.Da).apply(null,arguments)},Ir=_._emscripten_bind_ExpertEncoder_SetAttributeExplicitQuantization_5=function(){return(Ir=_._emscripten_bind_ExpertEncoder_SetAttributeExplicitQuantization_5=_.asm.Ea).apply(null,arguments)},Mr=_._emscripten_bind_ExpertEncoder_SetSpeedOptions_2=function(){return(Mr=_._emscripten_bind_ExpertEncoder_SetSpeedOptions_2=_.asm.Fa).apply(null,arguments)},Cr=_._emscripten_bind_ExpertEncoder_SetTrackEncodedProperties_1=function(){return(Cr=_._emscripten_bind_ExpertEncoder_SetTrackEncodedProperties_1=_.asm.Ga).apply(null,arguments)},Dr=_._emscripten_bind_ExpertEncoder_EncodeToDracoBuffer_2=function(){return(Dr=_._emscripten_bind_ExpertEncoder_EncodeToDracoBuffer_2=_.asm.Ha).apply(null,arguments)},_r=_._emscripten_bind_ExpertEncoder_GetNumberOfEncodedPoints_0=function(){return(_r=_._emscripten_bind_ExpertEncoder_GetNumberOfEncodedPoints_0=_.asm.Ia).apply(null,arguments)},Sr=_._emscripten_bind_ExpertEncoder_GetNumberOfEncodedFaces_0=function(){return(Sr=_._emscripten_bind_ExpertEncoder_GetNumberOfEncodedFaces_0=_.asm.Ja).apply(null,arguments)},Fr=_._emscripten_bind_ExpertEncoder___destroy___0=function(){return(Fr=_._emscripten_bind_ExpertEncoder___destroy___0=_.asm.Ka).apply(null,arguments)},Rr=_._emscripten_enum_draco_GeometryAttribute_Type_INVALID=function(){return(Rr=_._emscripten_enum_draco_GeometryAttribute_Type_INVALID=_.asm.La).apply(null,arguments)},Nr=_._emscripten_enum_draco_GeometryAttribute_Type_POSITION=function(){return(Nr=_._emscripten_enum_draco_GeometryAttribute_Type_POSITION=_.asm.Ma).apply(null,arguments)},kr=_._emscripten_enum_draco_GeometryAttribute_Type_NORMAL=function(){return(kr=_._emscripten_enum_draco_GeometryAttribute_Type_NORMAL=_.asm.Na).apply(null,arguments)},Ur=_._emscripten_enum_draco_GeometryAttribute_Type_COLOR=function(){return(Ur=_._emscripten_enum_draco_GeometryAttribute_Type_COLOR=_.asm.Oa).apply(null,arguments)},jr=_._emscripten_enum_draco_GeometryAttribute_Type_TEX_COORD=function(){return(jr=_._emscripten_enum_draco_GeometryAttribute_Type_TEX_COORD=_.asm.Pa).apply(null,arguments)},Br=_._emscripten_enum_draco_GeometryAttribute_Type_GENERIC=function(){return(Br=_._emscripten_enum_draco_GeometryAttribute_Type_GENERIC=_.asm.Qa).apply(null,arguments)},Pr=_._emscripten_enum_draco_EncodedGeometryType_INVALID_GEOMETRY_TYPE=function(){return(Pr=_._emscripten_enum_draco_EncodedGeometryType_INVALID_GEOMETRY_TYPE=_.asm.Ra).apply(null,arguments)},Or=_._emscripten_enum_draco_EncodedGeometryType_POINT_CLOUD=function(){return(Or=_._emscripten_enum_draco_EncodedGeometryType_POINT_CLOUD=_.asm.Sa).apply(null,arguments)},Vr=_._emscripten_enum_draco_EncodedGeometryType_TRIANGULAR_MESH=function(){return(Vr=_._emscripten_enum_draco_EncodedGeometryType_TRIANGULAR_MESH=_.asm.Ta).apply(null,arguments)},Lr=_._emscripten_enum_draco_MeshEncoderMethod_MESH_SEQUENTIAL_ENCODING=function(){return(Lr=_._emscripten_enum_draco_MeshEncoderMethod_MESH_SEQUENTIAL_ENCODING=_.asm.Ua).apply(null,arguments)},Gr=_._emscripten_enum_draco_MeshEncoderMethod_MESH_EDGEBREAKER_ENCODING=function(){return(Gr=_._emscripten_enum_draco_MeshEncoderMethod_MESH_EDGEBREAKER_ENCODING=_.asm.Va).apply(null,arguments)};_._malloc=function(){return(_._malloc=_.asm.Wa).apply(null,arguments)},_._free=function(){return(_._free=_.asm.Xa).apply(null,arguments)};var zr=function(){return(zr=_.asm.Ya).apply(null,arguments)};_.___start_em_js=19116,_.___stop_em_js=19214;var Ea;if(na=function N(){Ea||u(),Ea||(na=N)},_.preInit)for(typeof _.preInit=="function"&&(_.preInit=[_.preInit]);0<_.preInit.length;)_.preInit.pop()();u(),m.prototype=Object.create(m.prototype),m.prototype.constructor=m,m.prototype.__class__=m,m.__cache__={},_.WrapperObject=m,_.getCache=p,_.wrapPointer=g,_.castObject=function(N,j){return g(N.ptr,j)},_.NULL=g(0),_.destroy=function(N){if(!N.__destroy__)throw"Error: Cannot destroy object. (Did you create it yourself?)";N.__destroy__(),delete p(N.__class__)[N.ptr]},_.compare=function(N,j){return N.ptr===j.ptr},_.getPointer=function(N){return N.ptr},_.getClass=function(N){return N.__class__};var oe={buffer:0,size:0,pos:0,temps:[],needed:0,prepare:function(){if(oe.needed){for(var N=0;N<oe.temps.length;N++)_._free(oe.temps[N]);oe.temps.length=0,_._free(oe.buffer),oe.buffer=0,oe.size+=oe.needed,oe.needed=0}oe.buffer||(oe.size+=128,oe.buffer=_._malloc(oe.size),oe.buffer||c(void 0)),oe.pos=0},alloc:function(N,j){return oe.buffer||c(void 0),N=N.length*j.BYTES_PER_ELEMENT,N=N+7&-8,oe.pos+N>=oe.size?(0<N||c(void 0),oe.needed+=N,j=_._malloc(N),oe.temps.push(j)):(j=oe.buffer+oe.pos,oe.pos+=N),j},copy:function(N,j,G){switch(G>>>=0,j.BYTES_PER_ELEMENT){case 2:G>>>=1;break;case 4:G>>>=2;break;case 8:G>>>=3}for(var H=0;H<N.length;H++)j[G+H]=N[H]}};return I.prototype=Object.create(m.prototype),I.prototype.constructor=I,I.prototype.__class__=I,I.__cache__={},_.VoidPtr=I,I.prototype.__destroy__=I.prototype.__destroy__=function(){ni(this.ptr)},w.prototype=Object.create(m.prototype),w.prototype.constructor=w,w.prototype.__class__=w,w.__cache__={},_.GeometryAttribute=w,w.prototype.__destroy__=w.prototype.__destroy__=function(){oa(this.ptr)},v.prototype=Object.create(m.prototype),v.prototype.constructor=v,v.prototype.__class__=v,v.__cache__={},_.PointAttribute=v,v.prototype.size=v.prototype.size=function(){return Us(this.ptr)},v.prototype.attribute_type=v.prototype.attribute_type=function(){return oi(this.ptr)},v.prototype.data_type=v.prototype.data_type=function(){return ci(this.ptr)},v.prototype.num_components=v.prototype.num_components=function(){return li(this.ptr)},v.prototype.normalized=v.prototype.normalized=function(){return!!hi(this.ptr)},v.prototype.byte_stride=v.prototype.byte_stride=function(){return di(this.ptr)},v.prototype.byte_offset=v.prototype.byte_offset=function(){return fi(this.ptr)},v.prototype.unique_id=v.prototype.unique_id=function(){return ui(this.ptr)},v.prototype.__destroy__=v.prototype.__destroy__=function(){bi(this.ptr)},M.prototype=Object.create(m.prototype),M.prototype.constructor=M,M.prototype.__class__=M,M.__cache__={},_.PointCloud=M,M.prototype.num_attributes=M.prototype.num_attributes=function(){return mi(this.ptr)},M.prototype.num_points=M.prototype.num_points=function(){return gi(this.ptr)},M.prototype.__destroy__=M.prototype.__destroy__=function(){Ai(this.ptr)},C.prototype=Object.create(m.prototype),C.prototype.constructor=C,C.prototype.__class__=C,C.__cache__={},_.Mesh=C,C.prototype.num_faces=C.prototype.num_faces=function(){return xi(this.ptr)},C.prototype.num_attributes=C.prototype.num_attributes=function(){return wi(this.ptr)},C.prototype.num_points=C.prototype.num_points=function(){return vi(this.ptr)},C.prototype.set_num_points=C.prototype.set_num_points=function(N){var j=this.ptr;N&&typeof N=="object"&&(N=N.ptr),Ei(j,N)},C.prototype.__destroy__=C.prototype.__destroy__=function(){Ti(this.ptr)},D.prototype=Object.create(m.prototype),D.prototype.constructor=D,D.prototype.__class__=D,D.__cache__={},_.Metadata=D,D.prototype.__destroy__=D.prototype.__destroy__=function(){Mi(this.ptr)},S.prototype=Object.create(m.prototype),S.prototype.constructor=S,S.prototype.__class__=S,S.__cache__={},_.DracoInt8Array=S,S.prototype.GetValue=S.prototype.GetValue=function(N){var j=this.ptr;return N&&typeof N=="object"&&(N=N.ptr),Di(j,N)},S.prototype.size=S.prototype.size=function(){return _i(this.ptr)},S.prototype.__destroy__=S.prototype.__destroy__=function(){Si(this.ptr)},k.prototype=Object.create(m.prototype),k.prototype.constructor=k,k.prototype.__class__=k,k.__cache__={},_.MetadataBuilder=k,k.prototype.AddStringEntry=k.prototype.AddStringEntry=function(N,j,G){var H=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j=j&&typeof j=="object"?j.ptr:b(j),G=G&&typeof G=="object"?G.ptr:b(G),!!Ri(H,N,j,G)},k.prototype.AddIntEntry=k.prototype.AddIntEntry=function(N,j,G){var H=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j=j&&typeof j=="object"?j.ptr:b(j),G&&typeof G=="object"&&(G=G.ptr),!!Ni(H,N,j,G)},k.prototype.AddIntEntryArray=k.prototype.AddIntEntryArray=function(N,j,G,H){var Q=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j=j&&typeof j=="object"?j.ptr:b(j),typeof G=="object"&&(G=x(G)),H&&typeof H=="object"&&(H=H.ptr),!!ki(Q,N,j,G,H)},k.prototype.AddDoubleEntry=k.prototype.AddDoubleEntry=function(N,j,G){var H=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j=j&&typeof j=="object"?j.ptr:b(j),G&&typeof G=="object"&&(G=G.ptr),!!Ui(H,N,j,G)},k.prototype.__destroy__=k.prototype.__destroy__=function(){ji(this.ptr)},F.prototype=Object.create(m.prototype),F.prototype.constructor=F,F.prototype.__class__=F,F.__cache__={},_.PointCloudBuilder=F,F.prototype.AddFloatAttribute=F.prototype.AddFloatAttribute=function(N,j,G,H,Q){var re=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),H&&typeof H=="object"&&(H=H.ptr),typeof Q=="object"&&(Q=E(Q)),Pi(re,N,j,G,H,Q)},F.prototype.AddInt8Attribute=F.prototype.AddInt8Attribute=function(N,j,G,H,Q){var re=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),H&&typeof H=="object"&&(H=H.ptr),typeof Q=="object"&&(Q=A(Q)),Oi(re,N,j,G,H,Q)},F.prototype.AddUInt8Attribute=F.prototype.AddUInt8Attribute=function(N,j,G,H,Q){var re=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),H&&typeof H=="object"&&(H=H.ptr),typeof Q=="object"&&(Q=A(Q)),Vi(re,N,j,G,H,Q)},F.prototype.AddInt16Attribute=F.prototype.AddInt16Attribute=function(N,j,G,H,Q){var re=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),H&&typeof H=="object"&&(H=H.ptr),typeof Q=="object"&&(Q=y(Q)),Li(re,N,j,G,H,Q)},F.prototype.AddUInt16Attribute=F.prototype.AddUInt16Attribute=function(N,j,G,H,Q){var re=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),H&&typeof H=="object"&&(H=H.ptr),typeof Q=="object"&&(Q=y(Q)),Gi(re,N,j,G,H,Q)},F.prototype.AddInt32Attribute=F.prototype.AddInt32Attribute=function(N,j,G,H,Q){var re=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),H&&typeof H=="object"&&(H=H.ptr),typeof Q=="object"&&(Q=x(Q)),zi(re,N,j,G,H,Q)},F.prototype.AddUInt32Attribute=F.prototype.AddUInt32Attribute=function(N,j,G,H,Q){var re=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),H&&typeof H=="object"&&(H=H.ptr),typeof Q=="object"&&(Q=x(Q)),Ki(re,N,j,G,H,Q)},F.prototype.AddMetadata=F.prototype.AddMetadata=function(N,j){var G=this.ptr;return N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),!!Hi(G,N,j)},F.prototype.SetMetadataForAttribute=F.prototype.SetMetadataForAttribute=function(N,j,G){var H=this.ptr;return N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),!!qi(H,N,j,G)},F.prototype.SetNormalizedFlagForAttribute=F.prototype.SetNormalizedFlagForAttribute=function(N,j,G){var H=this.ptr;return N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),!!Wi(H,N,j,G)},F.prototype.__destroy__=F.prototype.__destroy__=function(){Yi(this.ptr)},B.prototype=Object.create(m.prototype),B.prototype.constructor=B,B.prototype.__class__=B,B.__cache__={},_.MeshBuilder=B,B.prototype.AddFacesToMesh=B.prototype.AddFacesToMesh=function(N,j,G){var H=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),typeof G=="object"&&(G=x(G)),!!Qi(H,N,j,G)},B.prototype.AddFloatAttributeToMesh=B.prototype.AddFloatAttributeToMesh=function(N,j,G,H,Q){var re=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),H&&typeof H=="object"&&(H=H.ptr),typeof Q=="object"&&(Q=E(Q)),Ji(re,N,j,G,H,Q)},B.prototype.AddInt32AttributeToMesh=B.prototype.AddInt32AttributeToMesh=function(N,j,G,H,Q){var re=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),H&&typeof H=="object"&&(H=H.ptr),typeof Q=="object"&&(Q=x(Q)),Zi(re,N,j,G,H,Q)},B.prototype.AddMetadataToMesh=B.prototype.AddMetadataToMesh=function(N,j){var G=this.ptr;return N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),!!$i(G,N,j)},B.prototype.AddFloatAttribute=B.prototype.AddFloatAttribute=function(N,j,G,H,Q){var re=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),H&&typeof H=="object"&&(H=H.ptr),typeof Q=="object"&&(Q=E(Q)),er(re,N,j,G,H,Q)},B.prototype.AddInt8Attribute=B.prototype.AddInt8Attribute=function(N,j,G,H,Q){var re=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),H&&typeof H=="object"&&(H=H.ptr),typeof Q=="object"&&(Q=A(Q)),tr(re,N,j,G,H,Q)},B.prototype.AddUInt8Attribute=B.prototype.AddUInt8Attribute=function(N,j,G,H,Q){var re=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),H&&typeof H=="object"&&(H=H.ptr),typeof Q=="object"&&(Q=A(Q)),ar(re,N,j,G,H,Q)},B.prototype.AddInt16Attribute=B.prototype.AddInt16Attribute=function(N,j,G,H,Q){var re=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),H&&typeof H=="object"&&(H=H.ptr),typeof Q=="object"&&(Q=y(Q)),ir(re,N,j,G,H,Q)},B.prototype.AddUInt16Attribute=B.prototype.AddUInt16Attribute=function(N,j,G,H,Q){var re=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),H&&typeof H=="object"&&(H=H.ptr),typeof Q=="object"&&(Q=y(Q)),rr(re,N,j,G,H,Q)},B.prototype.AddInt32Attribute=B.prototype.AddInt32Attribute=function(N,j,G,H,Q){var re=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),H&&typeof H=="object"&&(H=H.ptr),typeof Q=="object"&&(Q=x(Q)),sr(re,N,j,G,H,Q)},B.prototype.AddUInt32Attribute=B.prototype.AddUInt32Attribute=function(N,j,G,H,Q){var re=this.ptr;return oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),H&&typeof H=="object"&&(H=H.ptr),typeof Q=="object"&&(Q=x(Q)),nr(re,N,j,G,H,Q)},B.prototype.AddMetadata=B.prototype.AddMetadata=function(N,j){var G=this.ptr;return N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),!!or(G,N,j)},B.prototype.SetMetadataForAttribute=B.prototype.SetMetadataForAttribute=function(N,j,G){var H=this.ptr;return N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),!!cr(H,N,j,G)},B.prototype.SetNormalizedFlagForAttribute=B.prototype.SetNormalizedFlagForAttribute=function(N,j,G){var H=this.ptr;return N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),!!lr(H,N,j,G)},B.prototype.__destroy__=B.prototype.__destroy__=function(){hr(this.ptr)},O.prototype=Object.create(m.prototype),O.prototype.constructor=O,O.prototype.__class__=O,O.__cache__={},_.Encoder=O,O.prototype.SetEncodingMethod=O.prototype.SetEncodingMethod=function(N){var j=this.ptr;N&&typeof N=="object"&&(N=N.ptr),fr(j,N)},O.prototype.SetAttributeQuantization=O.prototype.SetAttributeQuantization=function(N,j){var G=this.ptr;N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),ur(G,N,j)},O.prototype.SetAttributeExplicitQuantization=O.prototype.SetAttributeExplicitQuantization=function(N,j,G,H,Q){var re=this.ptr;oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),typeof H=="object"&&(H=E(H)),Q&&typeof Q=="object"&&(Q=Q.ptr),br(re,N,j,G,H,Q)},O.prototype.SetSpeedOptions=O.prototype.SetSpeedOptions=function(N,j){var G=this.ptr;N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),pr(G,N,j)},O.prototype.SetTrackEncodedProperties=O.prototype.SetTrackEncodedProperties=function(N){var j=this.ptr;N&&typeof N=="object"&&(N=N.ptr),mr(j,N)},O.prototype.EncodeMeshToDracoBuffer=O.prototype.EncodeMeshToDracoBuffer=function(N,j){var G=this.ptr;return N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),gr(G,N,j)},O.prototype.EncodePointCloudToDracoBuffer=O.prototype.EncodePointCloudToDracoBuffer=function(N,j,G){var H=this.ptr;return N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),Ar(H,N,j,G)},O.prototype.GetNumberOfEncodedPoints=O.prototype.GetNumberOfEncodedPoints=function(){return yr(this.ptr)},O.prototype.GetNumberOfEncodedFaces=O.prototype.GetNumberOfEncodedFaces=function(){return xr(this.ptr)},O.prototype.__destroy__=O.prototype.__destroy__=function(){wr(this.ptr)},L.prototype=Object.create(m.prototype),L.prototype.constructor=L,L.prototype.__class__=L,L.__cache__={},_.ExpertEncoder=L,L.prototype.SetEncodingMethod=L.prototype.SetEncodingMethod=function(N){var j=this.ptr;N&&typeof N=="object"&&(N=N.ptr),Er(j,N)},L.prototype.SetAttributeQuantization=L.prototype.SetAttributeQuantization=function(N,j){var G=this.ptr;N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),Tr(G,N,j)},L.prototype.SetAttributeExplicitQuantization=L.prototype.SetAttributeExplicitQuantization=function(N,j,G,H,Q){var re=this.ptr;oe.prepare(),N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),G&&typeof G=="object"&&(G=G.ptr),typeof H=="object"&&(H=E(H)),Q&&typeof Q=="object"&&(Q=Q.ptr),Ir(re,N,j,G,H,Q)},L.prototype.SetSpeedOptions=L.prototype.SetSpeedOptions=function(N,j){var G=this.ptr;N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),Mr(G,N,j)},L.prototype.SetTrackEncodedProperties=L.prototype.SetTrackEncodedProperties=function(N){var j=this.ptr;N&&typeof N=="object"&&(N=N.ptr),Cr(j,N)},L.prototype.EncodeToDracoBuffer=L.prototype.EncodeToDracoBuffer=function(N,j){var G=this.ptr;return N&&typeof N=="object"&&(N=N.ptr),j&&typeof j=="object"&&(j=j.ptr),Dr(G,N,j)},L.prototype.GetNumberOfEncodedPoints=L.prototype.GetNumberOfEncodedPoints=function(){return _r(this.ptr)},L.prototype.GetNumberOfEncodedFaces=L.prototype.GetNumberOfEncodedFaces=function(){return Sr(this.ptr)},L.prototype.__destroy__=L.prototype.__destroy__=function(){Fr(this.ptr)},(function(){function N(){_.INVALID=Rr(),_.POSITION=Nr(),_.NORMAL=kr(),_.COLOR=Ur(),_.TEX_COORD=jr(),_.GENERIC=Br(),_.INVALID_GEOMETRY_TYPE=Pr(),_.POINT_CLOUD=Or(),_.TRIANGULAR_MESH=Vr(),_.MESH_SEQUENTIAL_ENCODING=Lr(),_.MESH_EDGEBREAKER_ENCODING=Gr()}sa?N():At.unshift(N)})(),typeof _.onModuleParsed=="function"&&_.onModuleParsed(),s.ready}})();a.exports=i})(ln)),ln.exports}var hn={exports:{}},Bg=hn.exports,Zl;function Pg(){return Zl||(Zl=1,(function(a,e){var t=t||{};t.scope={},t.arrayIteratorImpl=function(r){var s=0;return function(){return s<r.length?{done:!1,value:r[s++]}:{done:!0}}},t.arrayIterator=function(r){return{next:t.arrayIteratorImpl(r)}},t.makeIterator=function(r){var s=typeof Symbol<"u"&&Symbol.iterator&&r[Symbol.iterator];return s?s.call(r):t.arrayIterator(r)},t.ASSUME_ES5=!1,t.ASSUME_NO_NATIVE_MAP=!1,t.ASSUME_NO_NATIVE_SET=!1,t.SIMPLE_FROUND_POLYFILL=!1,t.ISOLATE_POLYFILLS=!1,t.FORCE_POLYFILL_PROMISE=!1,t.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,t.getGlobal=function(r){r=[typeof globalThis=="object"&&globalThis,r,typeof window=="object"&&window,typeof self=="object"&&self,typeof dn=="object"&&dn];for(var s=0;s<r.length;++s){var n=r[s];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")},t.global=t.getGlobal(Bg),t.defineProperty=t.ASSUME_ES5||typeof Object.defineProperties=="function"?Object.defineProperty:function(r,s,n){return r==Array.prototype||r==Object.prototype||(r[s]=n.value),r},t.IS_SYMBOL_NATIVE=typeof Symbol=="function"&&typeof Symbol("x")=="symbol",t.TRUST_ES6_POLYFILLS=!t.ISOLATE_POLYFILLS||t.IS_SYMBOL_NATIVE,t.polyfills={},t.propertyToPolyfillSymbol={},t.POLYFILL_PREFIX="$jscp$",t.polyfill=function(r,s,n,o){s&&(t.ISOLATE_POLYFILLS?t.polyfillIsolated(r,s,n,o):t.polyfillUnisolated(r,s,n,o))},t.polyfillUnisolated=function(r,s,n,o){for(n=t.global,r=r.split("."),o=0;o<r.length-1;o++){var c=r[o];if(!(c in n))return;n=n[c]}r=r[r.length-1],o=n[r],s=s(o),s!=o&&s!=null&&t.defineProperty(n,r,{configurable:!0,writable:!0,value:s})},t.polyfillIsolated=function(r,s,n,o){var c=r.split(".");r=c.length===1,o=c[0],o=!r&&o in t.polyfills?t.polyfills:t.global;for(var l=0;l<c.length-1;l++){var h=c[l];if(!(h in o))return;o=o[h]}c=c[c.length-1],n=t.IS_SYMBOL_NATIVE&&n==="es6"?o[c]:null,s=s(n),s!=null&&(r?t.defineProperty(t.polyfills,c,{configurable:!0,writable:!0,value:s}):s!==n&&(t.propertyToPolyfillSymbol[c]===void 0&&(n=1e9*Math.random()>>>0,t.propertyToPolyfillSymbol[c]=t.IS_SYMBOL_NATIVE?t.global.Symbol(c):t.POLYFILL_PREFIX+n+"$"+c),t.defineProperty(o,t.propertyToPolyfillSymbol[c],{configurable:!0,writable:!0,value:s})))},t.polyfill("Promise",function(r){function s(){this.batch_=null}function n(h){return h instanceof c?h:new c(function(d,f){d(h)})}if(r&&(!(t.FORCE_POLYFILL_PROMISE||t.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&typeof t.global.PromiseRejectionEvent>"u")||!t.global.Promise||t.global.Promise.toString().indexOf("[native code]")===-1))return r;s.prototype.asyncExecute=function(h){if(this.batch_==null){this.batch_=[];var d=this;this.asyncExecuteFunction(function(){d.executeBatch_()})}this.batch_.push(h)};var o=t.global.setTimeout;s.prototype.asyncExecuteFunction=function(h){o(h,0)},s.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var h=this.batch_;this.batch_=[];for(var d=0;d<h.length;++d){var f=h[d];h[d]=null;try{f()}catch(u){this.asyncThrow_(u)}}}this.batch_=null},s.prototype.asyncThrow_=function(h){this.asyncExecuteFunction(function(){throw h})};var c=function(h){this.state_=0,this.result_=void 0,this.onSettledCallbacks_=[],this.isRejectionHandled_=!1;var d=this.createResolveAndReject_();try{h(d.resolve,d.reject)}catch(f){d.reject(f)}};c.prototype.createResolveAndReject_=function(){function h(u){return function(m){f||(f=!0,u.call(d,m))}}var d=this,f=!1;return{resolve:h(this.resolveTo_),reject:h(this.reject_)}},c.prototype.resolveTo_=function(h){if(h===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(h instanceof c)this.settleSameAsPromise_(h);else{e:switch(typeof h){case"object":var d=h!=null;break e;case"function":d=!0;break e;default:d=!1}d?this.resolveToNonPromiseObj_(h):this.fulfill_(h)}},c.prototype.resolveToNonPromiseObj_=function(h){var d=void 0;try{d=h.then}catch(f){this.reject_(f);return}typeof d=="function"?this.settleSameAsThenable_(d,h):this.fulfill_(h)},c.prototype.reject_=function(h){this.settle_(2,h)},c.prototype.fulfill_=function(h){this.settle_(1,h)},c.prototype.settle_=function(h,d){if(this.state_!=0)throw Error("Cannot settle("+h+", "+d+"): Promise already settled in state"+this.state_);this.state_=h,this.result_=d,this.state_===2&&this.scheduleUnhandledRejectionCheck_(),this.executeOnSettledCallbacks_()},c.prototype.scheduleUnhandledRejectionCheck_=function(){var h=this;o(function(){if(h.notifyUnhandledRejection_()){var d=t.global.console;typeof d<"u"&&d.error(h.result_)}},1)},c.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var h=t.global.CustomEvent,d=t.global.Event,f=t.global.dispatchEvent;return typeof f>"u"?!0:(typeof h=="function"?h=new h("unhandledrejection",{cancelable:!0}):typeof d=="function"?h=new d("unhandledrejection",{cancelable:!0}):(h=t.global.document.createEvent("CustomEvent"),h.initCustomEvent("unhandledrejection",!1,!0,h)),h.promise=this,h.reason=this.result_,f(h))},c.prototype.executeOnSettledCallbacks_=function(){if(this.onSettledCallbacks_!=null){for(var h=0;h<this.onSettledCallbacks_.length;++h)l.asyncExecute(this.onSettledCallbacks_[h]);this.onSettledCallbacks_=null}};var l=new s;return c.prototype.settleSameAsPromise_=function(h){var d=this.createResolveAndReject_();h.callWhenSettled_(d.resolve,d.reject)},c.prototype.settleSameAsThenable_=function(h,d){var f=this.createResolveAndReject_();try{h.call(d,f.resolve,f.reject)}catch(u){f.reject(u)}},c.prototype.then=function(h,d){function f(g,b){return typeof g=="function"?function(A){try{u(g(A))}catch(y){m(y)}}:b}var u,m,p=new c(function(g,b){u=g,m=b});return this.callWhenSettled_(f(h,u),f(d,m)),p},c.prototype.catch=function(h){return this.then(void 0,h)},c.prototype.callWhenSettled_=function(h,d){function f(){switch(u.state_){case 1:h(u.result_);break;case 2:d(u.result_);break;default:throw Error("Unexpected state: "+u.state_)}}var u=this;this.onSettledCallbacks_==null?l.asyncExecute(f):this.onSettledCallbacks_.push(f),this.isRejectionHandled_=!0},c.resolve=n,c.reject=function(h){return new c(function(d,f){f(h)})},c.race=function(h){return new c(function(d,f){for(var u=t.makeIterator(h),m=u.next();!m.done;m=u.next())n(m.value).callWhenSettled_(d,f)})},c.all=function(h){var d=t.makeIterator(h),f=d.next();return f.done?n([]):new c(function(u,m){function p(A){return function(y){g[A]=y,b--,b==0&&u(g)}}var g=[],b=0;do g.push(void 0),b++,n(f.value).callWhenSettled_(p(g.length-1),m),f=d.next();while(!f.done)})},c},"es6","es3"),t.owns=function(r,s){return Object.prototype.hasOwnProperty.call(r,s)},t.assign=t.TRUST_ES6_POLYFILLS&&typeof Object.assign=="function"?Object.assign:function(r,s){for(var n=1;n<arguments.length;n++){var o=arguments[n];if(o)for(var c in o)t.owns(o,c)&&(r[c]=o[c])}return r},t.polyfill("Object.assign",function(r){return r||t.assign},"es6","es3"),t.checkStringArgs=function(r,s,n){if(r==null)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(s instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return r+""},t.polyfill("String.prototype.startsWith",function(r){return r||function(s,n){var o=t.checkStringArgs(this,s,"startsWith");s+="";var c=o.length,l=s.length;n=Math.max(0,Math.min(n|0,o.length));for(var h=0;h<l&&n<c;)if(o[n++]!=s[h++])return!1;return h>=l}},"es6","es3"),t.polyfill("Array.prototype.copyWithin",function(r){function s(n){return n=Number(n),n===1/0||n===-1/0?n:n|0}return r||function(n,o,c){var l=this.length;if(n=s(n),o=s(o),c=c===void 0?l:s(c),n=0>n?Math.max(l+n,0):Math.min(n,l),o=0>o?Math.max(l+o,0):Math.min(o,l),c=0>c?Math.max(l+c,0):Math.min(c,l),n<o)for(;o<c;)o in this?this[n++]=this[o++]:(delete this[n++],o++);else for(c=Math.min(c,l+o-n),n+=c-o;c>o;)--c in this?this[--n]=this[c]:delete this[--n];return this}},"es6","es3"),t.typedArrayCopyWithin=function(r){return r||Array.prototype.copyWithin},t.polyfill("Int8Array.prototype.copyWithin",t.typedArrayCopyWithin,"es6","es5"),t.polyfill("Uint8Array.prototype.copyWithin",t.typedArrayCopyWithin,"es6","es5"),t.polyfill("Uint8ClampedArray.prototype.copyWithin",t.typedArrayCopyWithin,"es6","es5"),t.polyfill("Int16Array.prototype.copyWithin",t.typedArrayCopyWithin,"es6","es5"),t.polyfill("Uint16Array.prototype.copyWithin",t.typedArrayCopyWithin,"es6","es5"),t.polyfill("Int32Array.prototype.copyWithin",t.typedArrayCopyWithin,"es6","es5"),t.polyfill("Uint32Array.prototype.copyWithin",t.typedArrayCopyWithin,"es6","es5"),t.polyfill("Float32Array.prototype.copyWithin",t.typedArrayCopyWithin,"es6","es5"),t.polyfill("Float64Array.prototype.copyWithin",t.typedArrayCopyWithin,"es6","es5");var i=(function(){var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),function(s){function n(R){return T.locateFile?T.locateFile(R,Pe):Pe+R}function o(R,P){if(R){var z=va,$=R+P;for(P=R;z[P]&&!(P>=$);)++P;if(16<P-R&&z.buffer&&si)z=si.decode(z.subarray(R,P));else{for($="";R<P;){var fe=z[R++];if(fe&128){var ve=z[R++]&63;if((fe&224)==192)$+=String.fromCharCode((fe&31)<<6|ve);else{var Hr=z[R++]&63;fe=(fe&240)==224?(fe&15)<<12|ve<<6|Hr:(fe&7)<<18|ve<<12|Hr<<6|z[R++]&63,65536>fe?$+=String.fromCharCode(fe):(fe-=65536,$+=String.fromCharCode(55296|fe>>10,56320|fe&1023))}}else $+=String.fromCharCode(fe)}z=$}}else z="";return z}function c(){var R=gt.buffer;T.HEAP8=At=new Int8Array(R),T.HEAP16=new Int16Array(R),T.HEAP32=sa=new Int32Array(R),T.HEAPU8=va=new Uint8Array(R),T.HEAPU16=new Uint16Array(R),T.HEAPU32=$e=new Uint32Array(R),T.HEAPF32=new Float32Array(R),T.HEAPF64=new Float64Array(R)}function l(R){throw T.onAbort&&T.onAbort(R),R="Aborted("+R+")",Lt(R),za=!0,R=new WebAssembly.RuntimeError(R+". Build with -sASSERTIONS for more info."),le(R),R}function h(R){try{if(R==et&&mt)return new Uint8Array(mt);if(rt)return rt(R);throw"both async and sync fetching of the wasm failed"}catch(P){l(P)}}function d(){if(!mt&&(ge||Ae)){if(typeof fetch=="function"&&!et.startsWith("file://"))return fetch(et,{credentials:"same-origin"}).then(function(R){if(!R.ok)throw"failed to load wasm binary file at '"+et+"'";return R.arrayBuffer()}).catch(function(){return h(et)});if(wa)return new Promise(function(R,P){wa(et,function(z){R(new Uint8Array(z))},P)})}return Promise.resolve().then(function(){return h(et)})}function f(R){for(;0<R.length;)R.shift()(T)}function u(R){this.excPtr=R,this.ptr=R-24,this.set_type=function(P){$e[this.ptr+4>>2]=P},this.get_type=function(){return $e[this.ptr+4>>2]},this.set_destructor=function(P){$e[this.ptr+8>>2]=P},this.get_destructor=function(){return $e[this.ptr+8>>2]},this.set_refcount=function(P){sa[this.ptr>>2]=P},this.set_caught=function(P){At[this.ptr+12>>0]=P?1:0},this.get_caught=function(){return At[this.ptr+12>>0]!=0},this.set_rethrown=function(P){At[this.ptr+13>>0]=P?1:0},this.get_rethrown=function(){return At[this.ptr+13>>0]!=0},this.init=function(P,z){this.set_adjusted_ptr(0),this.set_type(P),this.set_destructor(z),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){sa[this.ptr>>2]+=1},this.release_ref=function(){var P=sa[this.ptr>>2];return sa[this.ptr>>2]=P-1,P===1},this.set_adjusted_ptr=function(P){$e[this.ptr+16>>2]=P},this.get_adjusted_ptr=function(){return $e[this.ptr+16>>2]},this.get_exception_ptr=function(){if(Pc(this.get_type()))return $e[this.excPtr>>2];var P=this.get_adjusted_ptr();return P!==0?P:this.excPtr}}function m(){function R(){if(!js&&(js=!0,T.calledRun=!0,!za)){if(ni=!0,f(Je),ne(T),T.onRuntimeInitialized&&T.onRuntimeInitialized(),T.postRun)for(typeof T.postRun=="function"&&(T.postRun=[T.postRun]);T.postRun.length;)ks.unshift(T.postRun.shift());f(ks)}}if(!(0<jt)){if(T.preRun)for(typeof T.preRun=="function"&&(T.preRun=[T.preRun]);T.preRun.length;)na.unshift(T.preRun.shift());f(na),0<jt||(T.setStatus?(T.setStatus("Running..."),setTimeout(function(){setTimeout(function(){T.setStatus("")},1),R()},1)):R())}}function p(){}function g(R){return(R||p).__cache__}function b(R,P){var z=g(P),$=z[R];return $||($=Object.create((P||p).prototype),$.ptr=R,z[R]=$)}function A(R){if(typeof R=="string"){for(var P=0,z=0;z<R.length;++z){var $=R.charCodeAt(z);127>=$?P++:2047>=$?P+=2:55296<=$&&57343>=$?(P+=4,++z):P+=3}if(P=Array(P+1),z=0,$=P.length,0<$){$=z+$-1;for(var fe=0;fe<R.length;++fe){var ve=R.charCodeAt(fe);if(55296<=ve&&57343>=ve){var Hr=R.charCodeAt(++fe);ve=65536+((ve&1023)<<10)|Hr&1023}if(127>=ve){if(z>=$)break;P[z++]=ve}else{if(2047>=ve){if(z+1>=$)break;P[z++]=192|ve>>6}else{if(65535>=ve){if(z+2>=$)break;P[z++]=224|ve>>12}else{if(z+3>=$)break;P[z++]=240|ve>>18,P[z++]=128|ve>>12&63}P[z++]=128|ve>>6&63}P[z++]=128|ve&63}}P[z]=0}return R=ye.alloc(P,At),ye.copy(P,At,R),R}return R}function y(R){if(typeof R=="object"){var P=ye.alloc(R,At);return ye.copy(R,At,P),P}return R}function x(){throw"cannot construct a VoidPtr, no constructor in IDL"}function E(){this.ptr=ci(),g(E)[this.ptr]=this}function I(){this.ptr=di(),g(I)[this.ptr]=this}function w(){this.ptr=bi(),g(w)[this.ptr]=this}function v(){this.ptr=mi(),g(v)[this.ptr]=this}function M(){this.ptr=Ci(),g(M)[this.ptr]=this}function C(){this.ptr=Ni(),g(C)[this.ptr]=this}function D(){this.ptr=Bi(),g(D)[this.ptr]=this}function S(){this.ptr=Li(),g(S)[this.ptr]=this}function k(){this.ptr=qi(),g(k)[this.ptr]=this}function F(){throw"cannot construct a Status, no constructor in IDL"}function B(){this.ptr=Zi(),g(B)[this.ptr]=this}function O(){this.ptr=ar(),g(O)[this.ptr]=this}function L(){this.ptr=nr(),g(L)[this.ptr]=this}function _(){this.ptr=hr(),g(_)[this.ptr]=this}function q(){this.ptr=br(),g(q)[this.ptr]=this}function J(){this.ptr=Ar(),g(J)[this.ptr]=this}function Z(){this.ptr=vr(),g(Z)[this.ptr]=this}function Y(){this.ptr=Mr(),g(Y)[this.ptr]=this}function W(){this.ptr=Ur(),g(W)[this.ptr]=this}s=s===void 0?{}:s;var T=typeof s<"u"?s:{},ne,le;T.ready=new Promise(function(R,P){ne=R,le=P});var de=!1,Me=!1;T.onRuntimeInitialized=function(){de=!0,Me&&typeof T.onModuleLoaded=="function"&&T.onModuleLoaded(T)},T.onModuleParsed=function(){Me=!0,de&&typeof T.onModuleLoaded=="function"&&T.onModuleLoaded(T)},T.isVersionSupported=function(R){return typeof R!="string"?!1:(R=R.split("."),2>R.length||3<R.length?!1:R[0]==1&&0<=R[1]&&5>=R[1]?!0:!(R[0]!=0||10<R[1]))};var Ne=Object.assign({},T),ge=typeof window=="object",Ae=typeof importScripts=="function",_e=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",Pe="";if(_e){var pt=yn,Ut=yn;Pe=Ae?Ut.dirname(Pe)+"/":__dirname+"/";var Ga=function(R,P){return R=R.startsWith("file://")?new URL(R):Ut.normalize(R),pt.readFileSync(R,P?void 0:"utf8")},rt=function(R){return R=Ga(R,!0),R.buffer||(R=new Uint8Array(R)),R},wa=function(R,P,z){R=R.startsWith("file://")?new URL(R):Ut.normalize(R),pt.readFile(R,function($,fe){$?z($):P(fe.buffer)})};1<process.argv.length&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),T.inspect=function(){return"[Emscripten Module object]"}}else(ge||Ae)&&(Ae?Pe=self.location.href:typeof document<"u"&&document.currentScript&&(Pe=document.currentScript.src),r&&(Pe=r),Pe=Pe.indexOf("blob:")!==0?Pe.substr(0,Pe.replace(/[?#].*/,"").lastIndexOf("/")+1):"",Ga=function(R){var P=new XMLHttpRequest;return P.open("GET",R,!1),P.send(null),P.responseText},Ae&&(rt=function(R){var P=new XMLHttpRequest;return P.open("GET",R,!1),P.responseType="arraybuffer",P.send(null),new Uint8Array(P.response)}),wa=function(R,P,z){var $=new XMLHttpRequest;$.open("GET",R,!0),$.responseType="arraybuffer",$.onload=function(){$.status==200||$.status==0&&$.response?P($.response):z()},$.onerror=z,$.send(null)});T.print||console.log.bind(console);var Lt=T.printErr||console.warn.bind(console);Object.assign(T,Ne),Ne=null;var mt;T.wasmBinary&&(mt=T.wasmBinary),typeof WebAssembly!="object"&&l("no native wasm support detected");var gt,za=!1,si=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,At,va,sa,$e,na=[],Je=[],ks=[],ni=!1,jt=0,oa=null,et="draco_decoder_gltf.wasm";et.startsWith("data:application/octet-stream;base64,")||(et=n(et));var Us={b:function(R,P,z){throw new u(R).init(P,z),R},a:function(){l("")},d:function(R,P,z){va.copyWithin(R,P,P+z)},c:function(R){var P=va.length;if(R>>>=0,2147483648<R)return!1;for(var z=1;4>=z;z*=2){var $=P*(1+.2/z);$=Math.min($,R+100663296);var fe=Math;$=Math.max(R,$),fe=fe.min.call(fe,2147483648,$+(65536-$%65536)%65536);e:{$=gt.buffer;try{gt.grow(fe-$.byteLength+65535>>>16),c();var ve=1;break e}catch{}ve=void 0}if(ve)return!0}return!1}};(function(){function R(fe,ve){T.asm=fe.exports,gt=T.asm.e,c(),Je.unshift(T.asm.f),jt--,T.monitorRunDependencies&&T.monitorRunDependencies(jt),jt==0&&oa&&(fe=oa,oa=null,fe())}function P(fe){R(fe.instance)}function z(fe){return d().then(function(ve){return WebAssembly.instantiate(ve,$)}).then(function(ve){return ve}).then(fe,function(ve){Lt("failed to asynchronously prepare wasm: "+ve),l(ve)})}var $={a:Us};if(jt++,T.monitorRunDependencies&&T.monitorRunDependencies(jt),T.instantiateWasm)try{return T.instantiateWasm($,R)}catch(fe){Lt("Module.instantiateWasm callback failed with error: "+fe),le(fe)}return(function(){return mt||typeof WebAssembly.instantiateStreaming!="function"||et.startsWith("data:application/octet-stream;base64,")||et.startsWith("file://")||_e||typeof fetch!="function"?z(P):fetch(et,{credentials:"same-origin"}).then(function(fe){return WebAssembly.instantiateStreaming(fe,$).then(P,function(ve){return Lt("wasm streaming compile failed: "+ve),Lt("falling back to ArrayBuffer instantiation"),z(P)})})})().catch(le),{}})();var oi=T._emscripten_bind_VoidPtr___destroy___0=function(){return(oi=T._emscripten_bind_VoidPtr___destroy___0=T.asm.h).apply(null,arguments)},ci=T._emscripten_bind_DecoderBuffer_DecoderBuffer_0=function(){return(ci=T._emscripten_bind_DecoderBuffer_DecoderBuffer_0=T.asm.i).apply(null,arguments)},li=T._emscripten_bind_DecoderBuffer_Init_2=function(){return(li=T._emscripten_bind_DecoderBuffer_Init_2=T.asm.j).apply(null,arguments)},hi=T._emscripten_bind_DecoderBuffer___destroy___0=function(){return(hi=T._emscripten_bind_DecoderBuffer___destroy___0=T.asm.k).apply(null,arguments)},di=T._emscripten_bind_AttributeTransformData_AttributeTransformData_0=function(){return(di=T._emscripten_bind_AttributeTransformData_AttributeTransformData_0=T.asm.l).apply(null,arguments)},fi=T._emscripten_bind_AttributeTransformData_transform_type_0=function(){return(fi=T._emscripten_bind_AttributeTransformData_transform_type_0=T.asm.m).apply(null,arguments)},ui=T._emscripten_bind_AttributeTransformData___destroy___0=function(){return(ui=T._emscripten_bind_AttributeTransformData___destroy___0=T.asm.n).apply(null,arguments)},bi=T._emscripten_bind_GeometryAttribute_GeometryAttribute_0=function(){return(bi=T._emscripten_bind_GeometryAttribute_GeometryAttribute_0=T.asm.o).apply(null,arguments)},pi=T._emscripten_bind_GeometryAttribute___destroy___0=function(){return(pi=T._emscripten_bind_GeometryAttribute___destroy___0=T.asm.p).apply(null,arguments)},mi=T._emscripten_bind_PointAttribute_PointAttribute_0=function(){return(mi=T._emscripten_bind_PointAttribute_PointAttribute_0=T.asm.q).apply(null,arguments)},gi=T._emscripten_bind_PointAttribute_size_0=function(){return(gi=T._emscripten_bind_PointAttribute_size_0=T.asm.r).apply(null,arguments)},Ai=T._emscripten_bind_PointAttribute_GetAttributeTransformData_0=function(){return(Ai=T._emscripten_bind_PointAttribute_GetAttributeTransformData_0=T.asm.s).apply(null,arguments)},yi=T._emscripten_bind_PointAttribute_attribute_type_0=function(){return(yi=T._emscripten_bind_PointAttribute_attribute_type_0=T.asm.t).apply(null,arguments)},xi=T._emscripten_bind_PointAttribute_data_type_0=function(){return(xi=T._emscripten_bind_PointAttribute_data_type_0=T.asm.u).apply(null,arguments)},wi=T._emscripten_bind_PointAttribute_num_components_0=function(){return(wi=T._emscripten_bind_PointAttribute_num_components_0=T.asm.v).apply(null,arguments)},vi=T._emscripten_bind_PointAttribute_normalized_0=function(){return(vi=T._emscripten_bind_PointAttribute_normalized_0=T.asm.w).apply(null,arguments)},Ei=T._emscripten_bind_PointAttribute_byte_stride_0=function(){return(Ei=T._emscripten_bind_PointAttribute_byte_stride_0=T.asm.x).apply(null,arguments)},Ti=T._emscripten_bind_PointAttribute_byte_offset_0=function(){return(Ti=T._emscripten_bind_PointAttribute_byte_offset_0=T.asm.y).apply(null,arguments)},Ii=T._emscripten_bind_PointAttribute_unique_id_0=function(){return(Ii=T._emscripten_bind_PointAttribute_unique_id_0=T.asm.z).apply(null,arguments)},Mi=T._emscripten_bind_PointAttribute___destroy___0=function(){return(Mi=T._emscripten_bind_PointAttribute___destroy___0=T.asm.A).apply(null,arguments)},Ci=T._emscripten_bind_AttributeQuantizationTransform_AttributeQuantizationTransform_0=function(){return(Ci=T._emscripten_bind_AttributeQuantizationTransform_AttributeQuantizationTransform_0=T.asm.B).apply(null,arguments)},Di=T._emscripten_bind_AttributeQuantizationTransform_InitFromAttribute_1=function(){return(Di=T._emscripten_bind_AttributeQuantizationTransform_InitFromAttribute_1=T.asm.C).apply(null,arguments)},_i=T._emscripten_bind_AttributeQuantizationTransform_quantization_bits_0=function(){return(_i=T._emscripten_bind_AttributeQuantizationTransform_quantization_bits_0=T.asm.D).apply(null,arguments)},Si=T._emscripten_bind_AttributeQuantizationTransform_min_value_1=function(){return(Si=T._emscripten_bind_AttributeQuantizationTransform_min_value_1=T.asm.E).apply(null,arguments)},Fi=T._emscripten_bind_AttributeQuantizationTransform_range_0=function(){return(Fi=T._emscripten_bind_AttributeQuantizationTransform_range_0=T.asm.F).apply(null,arguments)},Ri=T._emscripten_bind_AttributeQuantizationTransform___destroy___0=function(){return(Ri=T._emscripten_bind_AttributeQuantizationTransform___destroy___0=T.asm.G).apply(null,arguments)},Ni=T._emscripten_bind_AttributeOctahedronTransform_AttributeOctahedronTransform_0=function(){return(Ni=T._emscripten_bind_AttributeOctahedronTransform_AttributeOctahedronTransform_0=T.asm.H).apply(null,arguments)},ki=T._emscripten_bind_AttributeOctahedronTransform_InitFromAttribute_1=function(){return(ki=T._emscripten_bind_AttributeOctahedronTransform_InitFromAttribute_1=T.asm.I).apply(null,arguments)},Ui=T._emscripten_bind_AttributeOctahedronTransform_quantization_bits_0=function(){return(Ui=T._emscripten_bind_AttributeOctahedronTransform_quantization_bits_0=T.asm.J).apply(null,arguments)},ji=T._emscripten_bind_AttributeOctahedronTransform___destroy___0=function(){return(ji=T._emscripten_bind_AttributeOctahedronTransform___destroy___0=T.asm.K).apply(null,arguments)},Bi=T._emscripten_bind_PointCloud_PointCloud_0=function(){return(Bi=T._emscripten_bind_PointCloud_PointCloud_0=T.asm.L).apply(null,arguments)},Pi=T._emscripten_bind_PointCloud_num_attributes_0=function(){return(Pi=T._emscripten_bind_PointCloud_num_attributes_0=T.asm.M).apply(null,arguments)},Oi=T._emscripten_bind_PointCloud_num_points_0=function(){return(Oi=T._emscripten_bind_PointCloud_num_points_0=T.asm.N).apply(null,arguments)},Vi=T._emscripten_bind_PointCloud___destroy___0=function(){return(Vi=T._emscripten_bind_PointCloud___destroy___0=T.asm.O).apply(null,arguments)},Li=T._emscripten_bind_Mesh_Mesh_0=function(){return(Li=T._emscripten_bind_Mesh_Mesh_0=T.asm.P).apply(null,arguments)},Gi=T._emscripten_bind_Mesh_num_faces_0=function(){return(Gi=T._emscripten_bind_Mesh_num_faces_0=T.asm.Q).apply(null,arguments)},zi=T._emscripten_bind_Mesh_num_attributes_0=function(){return(zi=T._emscripten_bind_Mesh_num_attributes_0=T.asm.R).apply(null,arguments)},Ki=T._emscripten_bind_Mesh_num_points_0=function(){return(Ki=T._emscripten_bind_Mesh_num_points_0=T.asm.S).apply(null,arguments)},Hi=T._emscripten_bind_Mesh___destroy___0=function(){return(Hi=T._emscripten_bind_Mesh___destroy___0=T.asm.T).apply(null,arguments)},qi=T._emscripten_bind_Metadata_Metadata_0=function(){return(qi=T._emscripten_bind_Metadata_Metadata_0=T.asm.U).apply(null,arguments)},Wi=T._emscripten_bind_Metadata___destroy___0=function(){return(Wi=T._emscripten_bind_Metadata___destroy___0=T.asm.V).apply(null,arguments)},Yi=T._emscripten_bind_Status_code_0=function(){return(Yi=T._emscripten_bind_Status_code_0=T.asm.W).apply(null,arguments)},Xi=T._emscripten_bind_Status_ok_0=function(){return(Xi=T._emscripten_bind_Status_ok_0=T.asm.X).apply(null,arguments)},Qi=T._emscripten_bind_Status_error_msg_0=function(){return(Qi=T._emscripten_bind_Status_error_msg_0=T.asm.Y).apply(null,arguments)},Ji=T._emscripten_bind_Status___destroy___0=function(){return(Ji=T._emscripten_bind_Status___destroy___0=T.asm.Z).apply(null,arguments)},Zi=T._emscripten_bind_DracoFloat32Array_DracoFloat32Array_0=function(){return(Zi=T._emscripten_bind_DracoFloat32Array_DracoFloat32Array_0=T.asm._).apply(null,arguments)},$i=T._emscripten_bind_DracoFloat32Array_GetValue_1=function(){return($i=T._emscripten_bind_DracoFloat32Array_GetValue_1=T.asm.$).apply(null,arguments)},er=T._emscripten_bind_DracoFloat32Array_size_0=function(){return(er=T._emscripten_bind_DracoFloat32Array_size_0=T.asm.aa).apply(null,arguments)},tr=T._emscripten_bind_DracoFloat32Array___destroy___0=function(){return(tr=T._emscripten_bind_DracoFloat32Array___destroy___0=T.asm.ba).apply(null,arguments)},ar=T._emscripten_bind_DracoInt8Array_DracoInt8Array_0=function(){return(ar=T._emscripten_bind_DracoInt8Array_DracoInt8Array_0=T.asm.ca).apply(null,arguments)},ir=T._emscripten_bind_DracoInt8Array_GetValue_1=function(){return(ir=T._emscripten_bind_DracoInt8Array_GetValue_1=T.asm.da).apply(null,arguments)},rr=T._emscripten_bind_DracoInt8Array_size_0=function(){return(rr=T._emscripten_bind_DracoInt8Array_size_0=T.asm.ea).apply(null,arguments)},sr=T._emscripten_bind_DracoInt8Array___destroy___0=function(){return(sr=T._emscripten_bind_DracoInt8Array___destroy___0=T.asm.fa).apply(null,arguments)},nr=T._emscripten_bind_DracoUInt8Array_DracoUInt8Array_0=function(){return(nr=T._emscripten_bind_DracoUInt8Array_DracoUInt8Array_0=T.asm.ga).apply(null,arguments)},or=T._emscripten_bind_DracoUInt8Array_GetValue_1=function(){return(or=T._emscripten_bind_DracoUInt8Array_GetValue_1=T.asm.ha).apply(null,arguments)},cr=T._emscripten_bind_DracoUInt8Array_size_0=function(){return(cr=T._emscripten_bind_DracoUInt8Array_size_0=T.asm.ia).apply(null,arguments)},lr=T._emscripten_bind_DracoUInt8Array___destroy___0=function(){return(lr=T._emscripten_bind_DracoUInt8Array___destroy___0=T.asm.ja).apply(null,arguments)},hr=T._emscripten_bind_DracoInt16Array_DracoInt16Array_0=function(){return(hr=T._emscripten_bind_DracoInt16Array_DracoInt16Array_0=T.asm.ka).apply(null,arguments)},dr=T._emscripten_bind_DracoInt16Array_GetValue_1=function(){return(dr=T._emscripten_bind_DracoInt16Array_GetValue_1=T.asm.la).apply(null,arguments)},fr=T._emscripten_bind_DracoInt16Array_size_0=function(){return(fr=T._emscripten_bind_DracoInt16Array_size_0=T.asm.ma).apply(null,arguments)},ur=T._emscripten_bind_DracoInt16Array___destroy___0=function(){return(ur=T._emscripten_bind_DracoInt16Array___destroy___0=T.asm.na).apply(null,arguments)},br=T._emscripten_bind_DracoUInt16Array_DracoUInt16Array_0=function(){return(br=T._emscripten_bind_DracoUInt16Array_DracoUInt16Array_0=T.asm.oa).apply(null,arguments)},pr=T._emscripten_bind_DracoUInt16Array_GetValue_1=function(){return(pr=T._emscripten_bind_DracoUInt16Array_GetValue_1=T.asm.pa).apply(null,arguments)},mr=T._emscripten_bind_DracoUInt16Array_size_0=function(){return(mr=T._emscripten_bind_DracoUInt16Array_size_0=T.asm.qa).apply(null,arguments)},gr=T._emscripten_bind_DracoUInt16Array___destroy___0=function(){return(gr=T._emscripten_bind_DracoUInt16Array___destroy___0=T.asm.ra).apply(null,arguments)},Ar=T._emscripten_bind_DracoInt32Array_DracoInt32Array_0=function(){return(Ar=T._emscripten_bind_DracoInt32Array_DracoInt32Array_0=T.asm.sa).apply(null,arguments)},yr=T._emscripten_bind_DracoInt32Array_GetValue_1=function(){return(yr=T._emscripten_bind_DracoInt32Array_GetValue_1=T.asm.ta).apply(null,arguments)},xr=T._emscripten_bind_DracoInt32Array_size_0=function(){return(xr=T._emscripten_bind_DracoInt32Array_size_0=T.asm.ua).apply(null,arguments)},wr=T._emscripten_bind_DracoInt32Array___destroy___0=function(){return(wr=T._emscripten_bind_DracoInt32Array___destroy___0=T.asm.va).apply(null,arguments)},vr=T._emscripten_bind_DracoUInt32Array_DracoUInt32Array_0=function(){return(vr=T._emscripten_bind_DracoUInt32Array_DracoUInt32Array_0=T.asm.wa).apply(null,arguments)},Er=T._emscripten_bind_DracoUInt32Array_GetValue_1=function(){return(Er=T._emscripten_bind_DracoUInt32Array_GetValue_1=T.asm.xa).apply(null,arguments)},Tr=T._emscripten_bind_DracoUInt32Array_size_0=function(){return(Tr=T._emscripten_bind_DracoUInt32Array_size_0=T.asm.ya).apply(null,arguments)},Ir=T._emscripten_bind_DracoUInt32Array___destroy___0=function(){return(Ir=T._emscripten_bind_DracoUInt32Array___destroy___0=T.asm.za).apply(null,arguments)},Mr=T._emscripten_bind_MetadataQuerier_MetadataQuerier_0=function(){return(Mr=T._emscripten_bind_MetadataQuerier_MetadataQuerier_0=T.asm.Aa).apply(null,arguments)},Cr=T._emscripten_bind_MetadataQuerier_HasEntry_2=function(){return(Cr=T._emscripten_bind_MetadataQuerier_HasEntry_2=T.asm.Ba).apply(null,arguments)},Dr=T._emscripten_bind_MetadataQuerier_GetIntEntry_2=function(){return(Dr=T._emscripten_bind_MetadataQuerier_GetIntEntry_2=T.asm.Ca).apply(null,arguments)},_r=T._emscripten_bind_MetadataQuerier_GetIntEntryArray_3=function(){return(_r=T._emscripten_bind_MetadataQuerier_GetIntEntryArray_3=T.asm.Da).apply(null,arguments)},Sr=T._emscripten_bind_MetadataQuerier_GetDoubleEntry_2=function(){return(Sr=T._emscripten_bind_MetadataQuerier_GetDoubleEntry_2=T.asm.Ea).apply(null,arguments)},Fr=T._emscripten_bind_MetadataQuerier_GetStringEntry_2=function(){return(Fr=T._emscripten_bind_MetadataQuerier_GetStringEntry_2=T.asm.Fa).apply(null,arguments)},Rr=T._emscripten_bind_MetadataQuerier_NumEntries_1=function(){return(Rr=T._emscripten_bind_MetadataQuerier_NumEntries_1=T.asm.Ga).apply(null,arguments)},Nr=T._emscripten_bind_MetadataQuerier_GetEntryName_2=function(){return(Nr=T._emscripten_bind_MetadataQuerier_GetEntryName_2=T.asm.Ha).apply(null,arguments)},kr=T._emscripten_bind_MetadataQuerier___destroy___0=function(){return(kr=T._emscripten_bind_MetadataQuerier___destroy___0=T.asm.Ia).apply(null,arguments)},Ur=T._emscripten_bind_Decoder_Decoder_0=function(){return(Ur=T._emscripten_bind_Decoder_Decoder_0=T.asm.Ja).apply(null,arguments)},jr=T._emscripten_bind_Decoder_DecodeArrayToPointCloud_3=function(){return(jr=T._emscripten_bind_Decoder_DecodeArrayToPointCloud_3=T.asm.Ka).apply(null,arguments)},Br=T._emscripten_bind_Decoder_DecodeArrayToMesh_3=function(){return(Br=T._emscripten_bind_Decoder_DecodeArrayToMesh_3=T.asm.La).apply(null,arguments)},Pr=T._emscripten_bind_Decoder_GetAttributeId_2=function(){return(Pr=T._emscripten_bind_Decoder_GetAttributeId_2=T.asm.Ma).apply(null,arguments)},Or=T._emscripten_bind_Decoder_GetAttributeIdByName_2=function(){return(Or=T._emscripten_bind_Decoder_GetAttributeIdByName_2=T.asm.Na).apply(null,arguments)},Vr=T._emscripten_bind_Decoder_GetAttributeIdByMetadataEntry_3=function(){return(Vr=T._emscripten_bind_Decoder_GetAttributeIdByMetadataEntry_3=T.asm.Oa).apply(null,arguments)},Lr=T._emscripten_bind_Decoder_GetAttribute_2=function(){return(Lr=T._emscripten_bind_Decoder_GetAttribute_2=T.asm.Pa).apply(null,arguments)},Gr=T._emscripten_bind_Decoder_GetAttributeByUniqueId_2=function(){return(Gr=T._emscripten_bind_Decoder_GetAttributeByUniqueId_2=T.asm.Qa).apply(null,arguments)},zr=T._emscripten_bind_Decoder_GetMetadata_1=function(){return(zr=T._emscripten_bind_Decoder_GetMetadata_1=T.asm.Ra).apply(null,arguments)},Ea=T._emscripten_bind_Decoder_GetAttributeMetadata_2=function(){return(Ea=T._emscripten_bind_Decoder_GetAttributeMetadata_2=T.asm.Sa).apply(null,arguments)},oe=T._emscripten_bind_Decoder_GetFaceFromMesh_3=function(){return(oe=T._emscripten_bind_Decoder_GetFaceFromMesh_3=T.asm.Ta).apply(null,arguments)},N=T._emscripten_bind_Decoder_GetTriangleStripsFromMesh_2=function(){return(N=T._emscripten_bind_Decoder_GetTriangleStripsFromMesh_2=T.asm.Ua).apply(null,arguments)},j=T._emscripten_bind_Decoder_GetTrianglesUInt16Array_3=function(){return(j=T._emscripten_bind_Decoder_GetTrianglesUInt16Array_3=T.asm.Va).apply(null,arguments)},G=T._emscripten_bind_Decoder_GetTrianglesUInt32Array_3=function(){return(G=T._emscripten_bind_Decoder_GetTrianglesUInt32Array_3=T.asm.Wa).apply(null,arguments)},H=T._emscripten_bind_Decoder_GetAttributeFloat_3=function(){return(H=T._emscripten_bind_Decoder_GetAttributeFloat_3=T.asm.Xa).apply(null,arguments)},Q=T._emscripten_bind_Decoder_GetAttributeFloatForAllPoints_3=function(){return(Q=T._emscripten_bind_Decoder_GetAttributeFloatForAllPoints_3=T.asm.Ya).apply(null,arguments)},re=T._emscripten_bind_Decoder_GetAttributeIntForAllPoints_3=function(){return(re=T._emscripten_bind_Decoder_GetAttributeIntForAllPoints_3=T.asm.Za).apply(null,arguments)},Kr=T._emscripten_bind_Decoder_GetAttributeInt8ForAllPoints_3=function(){return(Kr=T._emscripten_bind_Decoder_GetAttributeInt8ForAllPoints_3=T.asm._a).apply(null,arguments)},Xo=T._emscripten_bind_Decoder_GetAttributeUInt8ForAllPoints_3=function(){return(Xo=T._emscripten_bind_Decoder_GetAttributeUInt8ForAllPoints_3=T.asm.$a).apply(null,arguments)},Qo=T._emscripten_bind_Decoder_GetAttributeInt16ForAllPoints_3=function(){return(Qo=T._emscripten_bind_Decoder_GetAttributeInt16ForAllPoints_3=T.asm.ab).apply(null,arguments)},Jo=T._emscripten_bind_Decoder_GetAttributeUInt16ForAllPoints_3=function(){return(Jo=T._emscripten_bind_Decoder_GetAttributeUInt16ForAllPoints_3=T.asm.bb).apply(null,arguments)},Zo=T._emscripten_bind_Decoder_GetAttributeInt32ForAllPoints_3=function(){return(Zo=T._emscripten_bind_Decoder_GetAttributeInt32ForAllPoints_3=T.asm.cb).apply(null,arguments)},$o=T._emscripten_bind_Decoder_GetAttributeUInt32ForAllPoints_3=function(){return($o=T._emscripten_bind_Decoder_GetAttributeUInt32ForAllPoints_3=T.asm.db).apply(null,arguments)},ec=T._emscripten_bind_Decoder_GetAttributeDataArrayForAllPoints_5=function(){return(ec=T._emscripten_bind_Decoder_GetAttributeDataArrayForAllPoints_5=T.asm.eb).apply(null,arguments)},tc=T._emscripten_bind_Decoder_SkipAttributeTransform_1=function(){return(tc=T._emscripten_bind_Decoder_SkipAttributeTransform_1=T.asm.fb).apply(null,arguments)},ac=T._emscripten_bind_Decoder_GetEncodedGeometryType_Deprecated_1=function(){return(ac=T._emscripten_bind_Decoder_GetEncodedGeometryType_Deprecated_1=T.asm.gb).apply(null,arguments)},ic=T._emscripten_bind_Decoder_DecodeBufferToPointCloud_2=function(){return(ic=T._emscripten_bind_Decoder_DecodeBufferToPointCloud_2=T.asm.hb).apply(null,arguments)},rc=T._emscripten_bind_Decoder_DecodeBufferToMesh_2=function(){return(rc=T._emscripten_bind_Decoder_DecodeBufferToMesh_2=T.asm.ib).apply(null,arguments)},sc=T._emscripten_bind_Decoder___destroy___0=function(){return(sc=T._emscripten_bind_Decoder___destroy___0=T.asm.jb).apply(null,arguments)},nc=T._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_INVALID_TRANSFORM=function(){return(nc=T._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_INVALID_TRANSFORM=T.asm.kb).apply(null,arguments)},oc=T._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_NO_TRANSFORM=function(){return(oc=T._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_NO_TRANSFORM=T.asm.lb).apply(null,arguments)},cc=T._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_QUANTIZATION_TRANSFORM=function(){return(cc=T._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_QUANTIZATION_TRANSFORM=T.asm.mb).apply(null,arguments)},lc=T._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_OCTAHEDRON_TRANSFORM=function(){return(lc=T._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_OCTAHEDRON_TRANSFORM=T.asm.nb).apply(null,arguments)},hc=T._emscripten_enum_draco_GeometryAttribute_Type_INVALID=function(){return(hc=T._emscripten_enum_draco_GeometryAttribute_Type_INVALID=T.asm.ob).apply(null,arguments)},dc=T._emscripten_enum_draco_GeometryAttribute_Type_POSITION=function(){return(dc=T._emscripten_enum_draco_GeometryAttribute_Type_POSITION=T.asm.pb).apply(null,arguments)},fc=T._emscripten_enum_draco_GeometryAttribute_Type_NORMAL=function(){return(fc=T._emscripten_enum_draco_GeometryAttribute_Type_NORMAL=T.asm.qb).apply(null,arguments)},uc=T._emscripten_enum_draco_GeometryAttribute_Type_COLOR=function(){return(uc=T._emscripten_enum_draco_GeometryAttribute_Type_COLOR=T.asm.rb).apply(null,arguments)},bc=T._emscripten_enum_draco_GeometryAttribute_Type_TEX_COORD=function(){return(bc=T._emscripten_enum_draco_GeometryAttribute_Type_TEX_COORD=T.asm.sb).apply(null,arguments)},pc=T._emscripten_enum_draco_GeometryAttribute_Type_GENERIC=function(){return(pc=T._emscripten_enum_draco_GeometryAttribute_Type_GENERIC=T.asm.tb).apply(null,arguments)},mc=T._emscripten_enum_draco_EncodedGeometryType_INVALID_GEOMETRY_TYPE=function(){return(mc=T._emscripten_enum_draco_EncodedGeometryType_INVALID_GEOMETRY_TYPE=T.asm.ub).apply(null,arguments)},gc=T._emscripten_enum_draco_EncodedGeometryType_POINT_CLOUD=function(){return(gc=T._emscripten_enum_draco_EncodedGeometryType_POINT_CLOUD=T.asm.vb).apply(null,arguments)},Ac=T._emscripten_enum_draco_EncodedGeometryType_TRIANGULAR_MESH=function(){return(Ac=T._emscripten_enum_draco_EncodedGeometryType_TRIANGULAR_MESH=T.asm.wb).apply(null,arguments)},yc=T._emscripten_enum_draco_DataType_DT_INVALID=function(){return(yc=T._emscripten_enum_draco_DataType_DT_INVALID=T.asm.xb).apply(null,arguments)},xc=T._emscripten_enum_draco_DataType_DT_INT8=function(){return(xc=T._emscripten_enum_draco_DataType_DT_INT8=T.asm.yb).apply(null,arguments)},wc=T._emscripten_enum_draco_DataType_DT_UINT8=function(){return(wc=T._emscripten_enum_draco_DataType_DT_UINT8=T.asm.zb).apply(null,arguments)},vc=T._emscripten_enum_draco_DataType_DT_INT16=function(){return(vc=T._emscripten_enum_draco_DataType_DT_INT16=T.asm.Ab).apply(null,arguments)},Ec=T._emscripten_enum_draco_DataType_DT_UINT16=function(){return(Ec=T._emscripten_enum_draco_DataType_DT_UINT16=T.asm.Bb).apply(null,arguments)},Tc=T._emscripten_enum_draco_DataType_DT_INT32=function(){return(Tc=T._emscripten_enum_draco_DataType_DT_INT32=T.asm.Cb).apply(null,arguments)},Ic=T._emscripten_enum_draco_DataType_DT_UINT32=function(){return(Ic=T._emscripten_enum_draco_DataType_DT_UINT32=T.asm.Db).apply(null,arguments)},Mc=T._emscripten_enum_draco_DataType_DT_INT64=function(){return(Mc=T._emscripten_enum_draco_DataType_DT_INT64=T.asm.Eb).apply(null,arguments)},Cc=T._emscripten_enum_draco_DataType_DT_UINT64=function(){return(Cc=T._emscripten_enum_draco_DataType_DT_UINT64=T.asm.Fb).apply(null,arguments)},Dc=T._emscripten_enum_draco_DataType_DT_FLOAT32=function(){return(Dc=T._emscripten_enum_draco_DataType_DT_FLOAT32=T.asm.Gb).apply(null,arguments)},_c=T._emscripten_enum_draco_DataType_DT_FLOAT64=function(){return(_c=T._emscripten_enum_draco_DataType_DT_FLOAT64=T.asm.Hb).apply(null,arguments)},Sc=T._emscripten_enum_draco_DataType_DT_BOOL=function(){return(Sc=T._emscripten_enum_draco_DataType_DT_BOOL=T.asm.Ib).apply(null,arguments)},Fc=T._emscripten_enum_draco_DataType_DT_TYPES_COUNT=function(){return(Fc=T._emscripten_enum_draco_DataType_DT_TYPES_COUNT=T.asm.Jb).apply(null,arguments)},Rc=T._emscripten_enum_draco_StatusCode_OK=function(){return(Rc=T._emscripten_enum_draco_StatusCode_OK=T.asm.Kb).apply(null,arguments)},Nc=T._emscripten_enum_draco_StatusCode_DRACO_ERROR=function(){return(Nc=T._emscripten_enum_draco_StatusCode_DRACO_ERROR=T.asm.Lb).apply(null,arguments)},kc=T._emscripten_enum_draco_StatusCode_IO_ERROR=function(){return(kc=T._emscripten_enum_draco_StatusCode_IO_ERROR=T.asm.Mb).apply(null,arguments)},Uc=T._emscripten_enum_draco_StatusCode_INVALID_PARAMETER=function(){return(Uc=T._emscripten_enum_draco_StatusCode_INVALID_PARAMETER=T.asm.Nb).apply(null,arguments)},jc=T._emscripten_enum_draco_StatusCode_UNSUPPORTED_VERSION=function(){return(jc=T._emscripten_enum_draco_StatusCode_UNSUPPORTED_VERSION=T.asm.Ob).apply(null,arguments)},Bc=T._emscripten_enum_draco_StatusCode_UNKNOWN_VERSION=function(){return(Bc=T._emscripten_enum_draco_StatusCode_UNKNOWN_VERSION=T.asm.Pb).apply(null,arguments)};T._malloc=function(){return(T._malloc=T.asm.Qb).apply(null,arguments)},T._free=function(){return(T._free=T.asm.Rb).apply(null,arguments)};var Pc=function(){return(Pc=T.asm.Sb).apply(null,arguments)};T.___start_em_js=11660,T.___stop_em_js=11758;var js;if(oa=function R(){js||m(),js||(oa=R)},T.preInit)for(typeof T.preInit=="function"&&(T.preInit=[T.preInit]);0<T.preInit.length;)T.preInit.pop()();m(),p.prototype=Object.create(p.prototype),p.prototype.constructor=p,p.prototype.__class__=p,p.__cache__={},T.WrapperObject=p,T.getCache=g,T.wrapPointer=b,T.castObject=function(R,P){return b(R.ptr,P)},T.NULL=b(0),T.destroy=function(R){if(!R.__destroy__)throw"Error: Cannot destroy object. (Did you create it yourself?)";R.__destroy__(),delete g(R.__class__)[R.ptr]},T.compare=function(R,P){return R.ptr===P.ptr},T.getPointer=function(R){return R.ptr},T.getClass=function(R){return R.__class__};var ye={buffer:0,size:0,pos:0,temps:[],needed:0,prepare:function(){if(ye.needed){for(var R=0;R<ye.temps.length;R++)T._free(ye.temps[R]);ye.temps.length=0,T._free(ye.buffer),ye.buffer=0,ye.size+=ye.needed,ye.needed=0}ye.buffer||(ye.size+=128,ye.buffer=T._malloc(ye.size),ye.buffer||l(void 0)),ye.pos=0},alloc:function(R,P){return ye.buffer||l(void 0),R=R.length*P.BYTES_PER_ELEMENT,R=R+7&-8,ye.pos+R>=ye.size?(0<R||l(void 0),ye.needed+=R,P=T._malloc(R),ye.temps.push(P)):(P=ye.buffer+ye.pos,ye.pos+=R),P},copy:function(R,P,z){switch(z>>>=0,P.BYTES_PER_ELEMENT){case 2:z>>>=1;break;case 4:z>>>=2;break;case 8:z>>>=3}for(var $=0;$<R.length;$++)P[z+$]=R[$]}};return x.prototype=Object.create(p.prototype),x.prototype.constructor=x,x.prototype.__class__=x,x.__cache__={},T.VoidPtr=x,x.prototype.__destroy__=x.prototype.__destroy__=function(){oi(this.ptr)},E.prototype=Object.create(p.prototype),E.prototype.constructor=E,E.prototype.__class__=E,E.__cache__={},T.DecoderBuffer=E,E.prototype.Init=E.prototype.Init=function(R,P){var z=this.ptr;ye.prepare(),typeof R=="object"&&(R=y(R)),P&&typeof P=="object"&&(P=P.ptr),li(z,R,P)},E.prototype.__destroy__=E.prototype.__destroy__=function(){hi(this.ptr)},I.prototype=Object.create(p.prototype),I.prototype.constructor=I,I.prototype.__class__=I,I.__cache__={},T.AttributeTransformData=I,I.prototype.transform_type=I.prototype.transform_type=function(){return fi(this.ptr)},I.prototype.__destroy__=I.prototype.__destroy__=function(){ui(this.ptr)},w.prototype=Object.create(p.prototype),w.prototype.constructor=w,w.prototype.__class__=w,w.__cache__={},T.GeometryAttribute=w,w.prototype.__destroy__=w.prototype.__destroy__=function(){pi(this.ptr)},v.prototype=Object.create(p.prototype),v.prototype.constructor=v,v.prototype.__class__=v,v.__cache__={},T.PointAttribute=v,v.prototype.size=v.prototype.size=function(){return gi(this.ptr)},v.prototype.GetAttributeTransformData=v.prototype.GetAttributeTransformData=function(){return b(Ai(this.ptr),I)},v.prototype.attribute_type=v.prototype.attribute_type=function(){return yi(this.ptr)},v.prototype.data_type=v.prototype.data_type=function(){return xi(this.ptr)},v.prototype.num_components=v.prototype.num_components=function(){return wi(this.ptr)},v.prototype.normalized=v.prototype.normalized=function(){return!!vi(this.ptr)},v.prototype.byte_stride=v.prototype.byte_stride=function(){return Ei(this.ptr)},v.prototype.byte_offset=v.prototype.byte_offset=function(){return Ti(this.ptr)},v.prototype.unique_id=v.prototype.unique_id=function(){return Ii(this.ptr)},v.prototype.__destroy__=v.prototype.__destroy__=function(){Mi(this.ptr)},M.prototype=Object.create(p.prototype),M.prototype.constructor=M,M.prototype.__class__=M,M.__cache__={},T.AttributeQuantizationTransform=M,M.prototype.InitFromAttribute=M.prototype.InitFromAttribute=function(R){var P=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),!!Di(P,R)},M.prototype.quantization_bits=M.prototype.quantization_bits=function(){return _i(this.ptr)},M.prototype.min_value=M.prototype.min_value=function(R){var P=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),Si(P,R)},M.prototype.range=M.prototype.range=function(){return Fi(this.ptr)},M.prototype.__destroy__=M.prototype.__destroy__=function(){Ri(this.ptr)},C.prototype=Object.create(p.prototype),C.prototype.constructor=C,C.prototype.__class__=C,C.__cache__={},T.AttributeOctahedronTransform=C,C.prototype.InitFromAttribute=C.prototype.InitFromAttribute=function(R){var P=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),!!ki(P,R)},C.prototype.quantization_bits=C.prototype.quantization_bits=function(){return Ui(this.ptr)},C.prototype.__destroy__=C.prototype.__destroy__=function(){ji(this.ptr)},D.prototype=Object.create(p.prototype),D.prototype.constructor=D,D.prototype.__class__=D,D.__cache__={},T.PointCloud=D,D.prototype.num_attributes=D.prototype.num_attributes=function(){return Pi(this.ptr)},D.prototype.num_points=D.prototype.num_points=function(){return Oi(this.ptr)},D.prototype.__destroy__=D.prototype.__destroy__=function(){Vi(this.ptr)},S.prototype=Object.create(p.prototype),S.prototype.constructor=S,S.prototype.__class__=S,S.__cache__={},T.Mesh=S,S.prototype.num_faces=S.prototype.num_faces=function(){return Gi(this.ptr)},S.prototype.num_attributes=S.prototype.num_attributes=function(){return zi(this.ptr)},S.prototype.num_points=S.prototype.num_points=function(){return Ki(this.ptr)},S.prototype.__destroy__=S.prototype.__destroy__=function(){Hi(this.ptr)},k.prototype=Object.create(p.prototype),k.prototype.constructor=k,k.prototype.__class__=k,k.__cache__={},T.Metadata=k,k.prototype.__destroy__=k.prototype.__destroy__=function(){Wi(this.ptr)},F.prototype=Object.create(p.prototype),F.prototype.constructor=F,F.prototype.__class__=F,F.__cache__={},T.Status=F,F.prototype.code=F.prototype.code=function(){return Yi(this.ptr)},F.prototype.ok=F.prototype.ok=function(){return!!Xi(this.ptr)},F.prototype.error_msg=F.prototype.error_msg=function(){return o(Qi(this.ptr))},F.prototype.__destroy__=F.prototype.__destroy__=function(){Ji(this.ptr)},B.prototype=Object.create(p.prototype),B.prototype.constructor=B,B.prototype.__class__=B,B.__cache__={},T.DracoFloat32Array=B,B.prototype.GetValue=B.prototype.GetValue=function(R){var P=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),$i(P,R)},B.prototype.size=B.prototype.size=function(){return er(this.ptr)},B.prototype.__destroy__=B.prototype.__destroy__=function(){tr(this.ptr)},O.prototype=Object.create(p.prototype),O.prototype.constructor=O,O.prototype.__class__=O,O.__cache__={},T.DracoInt8Array=O,O.prototype.GetValue=O.prototype.GetValue=function(R){var P=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),ir(P,R)},O.prototype.size=O.prototype.size=function(){return rr(this.ptr)},O.prototype.__destroy__=O.prototype.__destroy__=function(){sr(this.ptr)},L.prototype=Object.create(p.prototype),L.prototype.constructor=L,L.prototype.__class__=L,L.__cache__={},T.DracoUInt8Array=L,L.prototype.GetValue=L.prototype.GetValue=function(R){var P=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),or(P,R)},L.prototype.size=L.prototype.size=function(){return cr(this.ptr)},L.prototype.__destroy__=L.prototype.__destroy__=function(){lr(this.ptr)},_.prototype=Object.create(p.prototype),_.prototype.constructor=_,_.prototype.__class__=_,_.__cache__={},T.DracoInt16Array=_,_.prototype.GetValue=_.prototype.GetValue=function(R){var P=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),dr(P,R)},_.prototype.size=_.prototype.size=function(){return fr(this.ptr)},_.prototype.__destroy__=_.prototype.__destroy__=function(){ur(this.ptr)},q.prototype=Object.create(p.prototype),q.prototype.constructor=q,q.prototype.__class__=q,q.__cache__={},T.DracoUInt16Array=q,q.prototype.GetValue=q.prototype.GetValue=function(R){var P=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),pr(P,R)},q.prototype.size=q.prototype.size=function(){return mr(this.ptr)},q.prototype.__destroy__=q.prototype.__destroy__=function(){gr(this.ptr)},J.prototype=Object.create(p.prototype),J.prototype.constructor=J,J.prototype.__class__=J,J.__cache__={},T.DracoInt32Array=J,J.prototype.GetValue=J.prototype.GetValue=function(R){var P=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),yr(P,R)},J.prototype.size=J.prototype.size=function(){return xr(this.ptr)},J.prototype.__destroy__=J.prototype.__destroy__=function(){wr(this.ptr)},Z.prototype=Object.create(p.prototype),Z.prototype.constructor=Z,Z.prototype.__class__=Z,Z.__cache__={},T.DracoUInt32Array=Z,Z.prototype.GetValue=Z.prototype.GetValue=function(R){var P=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),Er(P,R)},Z.prototype.size=Z.prototype.size=function(){return Tr(this.ptr)},Z.prototype.__destroy__=Z.prototype.__destroy__=function(){Ir(this.ptr)},Y.prototype=Object.create(p.prototype),Y.prototype.constructor=Y,Y.prototype.__class__=Y,Y.__cache__={},T.MetadataQuerier=Y,Y.prototype.HasEntry=Y.prototype.HasEntry=function(R,P){var z=this.ptr;return ye.prepare(),R&&typeof R=="object"&&(R=R.ptr),P=P&&typeof P=="object"?P.ptr:A(P),!!Cr(z,R,P)},Y.prototype.GetIntEntry=Y.prototype.GetIntEntry=function(R,P){var z=this.ptr;return ye.prepare(),R&&typeof R=="object"&&(R=R.ptr),P=P&&typeof P=="object"?P.ptr:A(P),Dr(z,R,P)},Y.prototype.GetIntEntryArray=Y.prototype.GetIntEntryArray=function(R,P,z){var $=this.ptr;ye.prepare(),R&&typeof R=="object"&&(R=R.ptr),P=P&&typeof P=="object"?P.ptr:A(P),z&&typeof z=="object"&&(z=z.ptr),_r($,R,P,z)},Y.prototype.GetDoubleEntry=Y.prototype.GetDoubleEntry=function(R,P){var z=this.ptr;return ye.prepare(),R&&typeof R=="object"&&(R=R.ptr),P=P&&typeof P=="object"?P.ptr:A(P),Sr(z,R,P)},Y.prototype.GetStringEntry=Y.prototype.GetStringEntry=function(R,P){var z=this.ptr;return ye.prepare(),R&&typeof R=="object"&&(R=R.ptr),P=P&&typeof P=="object"?P.ptr:A(P),o(Fr(z,R,P))},Y.prototype.NumEntries=Y.prototype.NumEntries=function(R){var P=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),Rr(P,R)},Y.prototype.GetEntryName=Y.prototype.GetEntryName=function(R,P){var z=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),o(Nr(z,R,P))},Y.prototype.__destroy__=Y.prototype.__destroy__=function(){kr(this.ptr)},W.prototype=Object.create(p.prototype),W.prototype.constructor=W,W.prototype.__class__=W,W.__cache__={},T.Decoder=W,W.prototype.DecodeArrayToPointCloud=W.prototype.DecodeArrayToPointCloud=function(R,P,z){var $=this.ptr;return ye.prepare(),typeof R=="object"&&(R=y(R)),P&&typeof P=="object"&&(P=P.ptr),z&&typeof z=="object"&&(z=z.ptr),b(jr($,R,P,z),F)},W.prototype.DecodeArrayToMesh=W.prototype.DecodeArrayToMesh=function(R,P,z){var $=this.ptr;return ye.prepare(),typeof R=="object"&&(R=y(R)),P&&typeof P=="object"&&(P=P.ptr),z&&typeof z=="object"&&(z=z.ptr),b(Br($,R,P,z),F)},W.prototype.GetAttributeId=W.prototype.GetAttributeId=function(R,P){var z=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),Pr(z,R,P)},W.prototype.GetAttributeIdByName=W.prototype.GetAttributeIdByName=function(R,P){var z=this.ptr;return ye.prepare(),R&&typeof R=="object"&&(R=R.ptr),P=P&&typeof P=="object"?P.ptr:A(P),Or(z,R,P)},W.prototype.GetAttributeIdByMetadataEntry=W.prototype.GetAttributeIdByMetadataEntry=function(R,P,z){var $=this.ptr;return ye.prepare(),R&&typeof R=="object"&&(R=R.ptr),P=P&&typeof P=="object"?P.ptr:A(P),z=z&&typeof z=="object"?z.ptr:A(z),Vr($,R,P,z)},W.prototype.GetAttribute=W.prototype.GetAttribute=function(R,P){var z=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),b(Lr(z,R,P),v)},W.prototype.GetAttributeByUniqueId=W.prototype.GetAttributeByUniqueId=function(R,P){var z=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),b(Gr(z,R,P),v)},W.prototype.GetMetadata=W.prototype.GetMetadata=function(R){var P=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),b(zr(P,R),k)},W.prototype.GetAttributeMetadata=W.prototype.GetAttributeMetadata=function(R,P){var z=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),b(Ea(z,R,P),k)},W.prototype.GetFaceFromMesh=W.prototype.GetFaceFromMesh=function(R,P,z){var $=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),z&&typeof z=="object"&&(z=z.ptr),!!oe($,R,P,z)},W.prototype.GetTriangleStripsFromMesh=W.prototype.GetTriangleStripsFromMesh=function(R,P){var z=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),N(z,R,P)},W.prototype.GetTrianglesUInt16Array=W.prototype.GetTrianglesUInt16Array=function(R,P,z){var $=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),z&&typeof z=="object"&&(z=z.ptr),!!j($,R,P,z)},W.prototype.GetTrianglesUInt32Array=W.prototype.GetTrianglesUInt32Array=function(R,P,z){var $=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),z&&typeof z=="object"&&(z=z.ptr),!!G($,R,P,z)},W.prototype.GetAttributeFloat=W.prototype.GetAttributeFloat=function(R,P,z){var $=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),z&&typeof z=="object"&&(z=z.ptr),!!H($,R,P,z)},W.prototype.GetAttributeFloatForAllPoints=W.prototype.GetAttributeFloatForAllPoints=function(R,P,z){var $=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),z&&typeof z=="object"&&(z=z.ptr),!!Q($,R,P,z)},W.prototype.GetAttributeIntForAllPoints=W.prototype.GetAttributeIntForAllPoints=function(R,P,z){var $=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),z&&typeof z=="object"&&(z=z.ptr),!!re($,R,P,z)},W.prototype.GetAttributeInt8ForAllPoints=W.prototype.GetAttributeInt8ForAllPoints=function(R,P,z){var $=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),z&&typeof z=="object"&&(z=z.ptr),!!Kr($,R,P,z)},W.prototype.GetAttributeUInt8ForAllPoints=W.prototype.GetAttributeUInt8ForAllPoints=function(R,P,z){var $=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),z&&typeof z=="object"&&(z=z.ptr),!!Xo($,R,P,z)},W.prototype.GetAttributeInt16ForAllPoints=W.prototype.GetAttributeInt16ForAllPoints=function(R,P,z){var $=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),z&&typeof z=="object"&&(z=z.ptr),!!Qo($,R,P,z)},W.prototype.GetAttributeUInt16ForAllPoints=W.prototype.GetAttributeUInt16ForAllPoints=function(R,P,z){var $=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),z&&typeof z=="object"&&(z=z.ptr),!!Jo($,R,P,z)},W.prototype.GetAttributeInt32ForAllPoints=W.prototype.GetAttributeInt32ForAllPoints=function(R,P,z){var $=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),z&&typeof z=="object"&&(z=z.ptr),!!Zo($,R,P,z)},W.prototype.GetAttributeUInt32ForAllPoints=W.prototype.GetAttributeUInt32ForAllPoints=function(R,P,z){var $=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),z&&typeof z=="object"&&(z=z.ptr),!!$o($,R,P,z)},W.prototype.GetAttributeDataArrayForAllPoints=W.prototype.GetAttributeDataArrayForAllPoints=function(R,P,z,$,fe){var ve=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),z&&typeof z=="object"&&(z=z.ptr),$&&typeof $=="object"&&($=$.ptr),fe&&typeof fe=="object"&&(fe=fe.ptr),!!ec(ve,R,P,z,$,fe)},W.prototype.SkipAttributeTransform=W.prototype.SkipAttributeTransform=function(R){var P=this.ptr;R&&typeof R=="object"&&(R=R.ptr),tc(P,R)},W.prototype.GetEncodedGeometryType_Deprecated=W.prototype.GetEncodedGeometryType_Deprecated=function(R){var P=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),ac(P,R)},W.prototype.DecodeBufferToPointCloud=W.prototype.DecodeBufferToPointCloud=function(R,P){var z=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),b(ic(z,R,P),F)},W.prototype.DecodeBufferToMesh=W.prototype.DecodeBufferToMesh=function(R,P){var z=this.ptr;return R&&typeof R=="object"&&(R=R.ptr),P&&typeof P=="object"&&(P=P.ptr),b(rc(z,R,P),F)},W.prototype.__destroy__=W.prototype.__destroy__=function(){sc(this.ptr)},(function(){function R(){T.ATTRIBUTE_INVALID_TRANSFORM=nc(),T.ATTRIBUTE_NO_TRANSFORM=oc(),T.ATTRIBUTE_QUANTIZATION_TRANSFORM=cc(),T.ATTRIBUTE_OCTAHEDRON_TRANSFORM=lc(),T.INVALID=hc(),T.POSITION=dc(),T.NORMAL=fc(),T.COLOR=uc(),T.TEX_COORD=bc(),T.GENERIC=pc(),T.INVALID_GEOMETRY_TYPE=mc(),T.POINT_CLOUD=gc(),T.TRIANGULAR_MESH=Ac(),T.DT_INVALID=yc(),T.DT_INT8=xc(),T.DT_UINT8=wc(),T.DT_INT16=vc(),T.DT_UINT16=Ec(),T.DT_INT32=Tc(),T.DT_UINT32=Ic(),T.DT_INT64=Mc(),T.DT_UINT64=Cc(),T.DT_FLOAT32=Dc(),T.DT_FLOAT64=_c(),T.DT_BOOL=Sc(),T.DT_TYPES_COUNT=Fc(),T.OK=Rc(),T.DRACO_ERROR=Nc(),T.IO_ERROR=kc(),T.INVALID_PARAMETER=Uc(),T.UNSUPPORTED_VERSION=jc(),T.UNKNOWN_VERSION=Bc()}ni?R():Je.unshift(R)})(),typeof T.onModuleParsed=="function"&&T.onModuleParsed(),T.Decoder.prototype.GetEncodedGeometryType=function(R){if(R.__class__&&R.__class__===T.DecoderBuffer)return T.Decoder.prototype.GetEncodedGeometryType_Deprecated(R);if(8>R.byteLength)return T.INVALID_GEOMETRY_TYPE;switch(R[7]){case 0:return T.POINT_CLOUD;case 1:return T.TRIANGULAR_MESH;default:return T.INVALID_GEOMETRY_TYPE}},s.ready}})();a.exports=i})(hn)),hn.exports}var Jn,$l;function Og(){if($l)return Jn;$l=1;var a=jg(),e=Pg();return Jn={createEncoderModule:a,createDecoderModule:e},Jn}var Vg=Og();const Lg=nh(Vg);async function Gg(){return new Promise(a=>{const e=document.createElement("script");e.src="./draco_decoder.1.5.7.js",e.onload=()=>{a(DracoDecoderModule())},document.body.appendChild(e)})}async function zg(a){let e=[];if(typeof window>"u"&&typeof document>"u"){const E=await Lg.createDecoderModule();e=await new _m().registerExtensions(Ql).registerDependencies({"draco3d.decoder":E,"meshopt.decoder":Qn}).readBinary(new Uint8Array(a))}else{const E=await Gg();await Qn.ready,e=await new Fm().registerExtensions(Ql).registerDependencies({"draco3d.decoder":E,"meshopt.decoder":Qn}).readBinary(new Uint8Array(a))}const r=e.getRoot().listMeshes();if(r.length===0)throw new Error("No meshes found in GLB file.");let s=[],n=0,o=0,c=0,l=!1;for(const E of r)for(const I of E.listPrimitives()){const w=I.getAttribute("POSITION");if(!w)throw new Error("No POSITION attribute found in primitive.");const v=I.getIndices();if(!v)throw new Error("No indices found in primitive.");const M=w.getCount(),C=v.getCount(),D=I.getAttribute("COLOR_0");let S=0;if(D){const k=D.getArray?D.getArray():null;k?S=k.length/M:S=4,l=!0}s.push({primitive:I,vertexCount:M,indexCount:C,colorComponents:S,positionAccessor:w,indicesAccessor:v,colorAccessor:D,name:E.getName()}),n+=M,o+=M*3,c+=C}const h=new Float32Array(o),d=new Uint32Array(c),f=l?new Uint8Array(n*4):null;let u=0,m=0,p=0,g=0,b=s.length>1&&s[0].name.length>0&&l&&s[0].colorComponents>=3,A={R:[],G:[],B:[],I:[],labels:[]};const y=new Float32Array(n);let x=0;for(let E=0;E<s.length;E++){const I=s[E],{primitive:w,vertexCount:v,indexCount:M,colorComponents:C,positionAccessor:D,indicesAccessor:S,colorAccessor:k}=I;if(v<1)continue;const F=Array.from(D.getArray());h.set(F,u),u+=v*3;const B=Array.from(S.getArray());for(let O=0;O<B.length;O++)d[m+O]=B[O]+p;if(m+=B.length,l){if(k){const O=Array.from(k.getArray());if(Math.abs(O.length/v-3)<1e-6)for(let L=0;L<v;L++){let _=O[L*3+0],q=O[L*3+1],J=O[L*3+2];_<=1&&q<=1&&J<=1?(_=Math.round(_*255),q=Math.round(q*255),J=Math.round(J*255)):(_=Math.round(_),q=Math.round(q),J=Math.round(J)),f[g++]=_,f[g++]=q,f[g++]=J,f[g++]=255}else if(Math.abs(O.length/v-4)<1e-6)for(let L=0;L<v;L++){let _=O[L*4+0],q=O[L*4+1],J=O[L*4+2],Z=O[L*4+3];_<=1&&q<=1&&J<=1&&Z<=1?(_=Math.round(_*255),q=Math.round(q*255),J=Math.round(J*255),Z=Math.round(Z*255)):(_=Math.round(_),q=Math.round(q),J=Math.round(J),Z=Math.round(Z)),f[g++]=_,f[g++]=q,f[g++]=J,f[g++]=Z}else for(let L=0;L<v;L++)f[g++]=255,f[g++]=255,f[g++]=255,f[g++]=255}else for(let O=0;O<v;O++)f[g++]=255,f[g++]=255,f[g++]=255,f[g++]=255;if(b){const O=I.name||"(unnamed)",L=f[g-4],_=f[g-3],q=f[g-2];A.R.push(L),A.G.push(_),A.B.push(q),A.I.push(E),A.labels.push(O);for(let J=0;J<v;J++)y[x+J]=E;x+=v}}p+=v}return b&&x>0&&(l=!1),{positions:new Float32Array(h),indices:new Int32Array(d),colors:l?new Uint8Array(f):null,scalars:b&&x>0?y:null,colormapLabel:b?A:null}}async function Kg(a){colorPick.oninput=()=>{const i=colorPick.value,r=parseInt(i.slice(1,3),16)/255,s=parseInt(i.slice(3,5),16)/255,n=parseInt(i.slice(5,7),16)/255;e.opts.backColor=[r,s,n,1],e.drawScene()},meshSelect.onchange=function(){const i=this.selectedIndex;let r="/water-bas-color-print_NIH3D.glb";i===1&&(r="https://niivue.github.io/niivue-demo-images/2UXO-ribbon-rainbow-vis_NIH3D.glb"),e.loadMeshes([{url:r}])},aboutBtn.onclick=async function(){alert("NiiVue glb-loader")};const e=new q0({backColor:[1,1,1,1],show3Dcrosshair:!0});e.attachToCanvas(a);let t=e.meshShaderNames();for(let i=0;i<t.length;i++){let r=document.createElement("button");r.innerHTML=t[i],r.onclick=async function(){e.setMeshShader(e.meshes[0].id,t[i])},shaderBtns.appendChild(r)}e.useLoader(zg,"glb","mz3"),await e.loadMeshes([{url:"/water-bas-color-print_NIH3D.glb"}])}Kg(document.querySelector("#nvCanvas"));
